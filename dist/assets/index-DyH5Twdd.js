const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Manage_Story-CODWWb2j.js","assets/Manage_Story-DP99jAOT.css","assets/Manage_Outline-CCivW2lu.js","assets/Manage_Outline-ihieLhNn.css","assets/Manage_File-D5zh23En.js","assets/Manage_File-bOc6ZX_i.css"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=s(o);fetch(o.href,r)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Si(e){const t=Object.create(null);for(const s of e.split(","))t[s]=1;return s=>s in t}const Oe={},eo=[],zt=()=>{},nd=()=>!1,Jn=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),xi=e=>e.startsWith("onUpdate:"),qe=Object.assign,Ti=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},rd=Object.prototype.hasOwnProperty,Me=(e,t)=>rd.call(e,t),he=Array.isArray,to=e=>Yo(e)==="[object Map]",po=e=>Yo(e)==="[object Set]",la=e=>Yo(e)==="[object Date]",we=e=>typeof e=="function",je=e=>typeof e=="string",At=e=>typeof e=="symbol",Le=e=>e!==null&&typeof e=="object",Xl=e=>(Le(e)||we(e))&&we(e.then)&&we(e.catch),Zl=Object.prototype.toString,Yo=e=>Zl.call(e),id=e=>Yo(e).slice(8,-1),ec=e=>Yo(e)==="[object Object]",Ii=e=>je(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,xo=Si(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Gn=e=>{const t=Object.create(null);return s=>t[s]||(t[s]=e(s))},ad=/-(\w)/g,St=Gn(e=>e.replace(ad,(t,s)=>s?s.toUpperCase():"")),ld=/\B([A-Z])/g,xs=Gn(e=>e.replace(ld,"-$1").toLowerCase()),Wn=Gn(e=>e.charAt(0).toUpperCase()+e.slice(1)),pn=Gn(e=>e?`on${Wn(e)}`:""),ys=(e,t)=>!Object.is(e,t),yn=(e,...t)=>{for(let s=0;s<e.length;s++)e[s](...t)},tc=(e,t,s,n=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:n,value:s})},xn=e=>{const t=parseFloat(e);return isNaN(t)?e:t},cd=e=>{const t=je(e)?Number(e):NaN;return isNaN(t)?e:t};let ca;const Hn=()=>ca||(ca=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function pt(e){if(he(e)){const t={};for(let s=0;s<e.length;s++){const n=e[s],o=je(n)?gd(n):pt(n);if(o)for(const r in o)t[r]=o[r]}return t}else if(je(e)||Le(e))return e}const ud=/;(?![^(]*\))/g,fd=/:([^]+)/,dd=/\/\*[^]*?\*\//g;function gd(e){const t={};return e.replace(dd,"").split(ud).forEach(s=>{if(s){const n=s.split(fd);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function ie(e){let t="";if(je(e))t=e;else if(he(e))for(let s=0;s<e.length;s++){const n=ie(e[s]);n&&(t+=n+" ")}else if(Le(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}const hd="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",md=Si(hd);function sc(e){return!!e||e===""}function pd(e,t){if(e.length!==t.length)return!1;let s=!0;for(let n=0;s&&n<e.length;n++)s=js(e[n],t[n]);return s}function js(e,t){if(e===t)return!0;let s=la(e),n=la(t);if(s||n)return s&&n?e.getTime()===t.getTime():!1;if(s=At(e),n=At(t),s||n)return e===t;if(s=he(e),n=he(t),s||n)return s&&n?pd(e,t):!1;if(s=Le(e),n=Le(t),s||n){if(!s||!n)return!1;const o=Object.keys(e).length,r=Object.keys(t).length;if(o!==r)return!1;for(const i in e){const a=e.hasOwnProperty(i),c=t.hasOwnProperty(i);if(a&&!c||!a&&c||!js(e[i],t[i]))return!1}}return String(e)===String(t)}function Mi(e,t){return e.findIndex(s=>js(s,t))}const oc=e=>!!(e&&e.__v_isRef===!0),F=e=>je(e)?e:e==null?"":he(e)||Le(e)&&(e.toString===Zl||!we(e.toString))?oc(e)?F(e.value):JSON.stringify(e,nc,2):String(e),nc=(e,t)=>oc(t)?nc(e,t.value):to(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((s,[n,o],r)=>(s[br(n,r)+" =>"]=o,s),{})}:po(t)?{[`Set(${t.size})`]:[...t.values()].map(s=>br(s))}:At(t)?br(t):Le(t)&&!he(t)&&!ec(t)?String(t):t,br=(e,t="")=>{var s;return At(e)?`Symbol(${(s=e.description)!=null?s:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let mt;class yd{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=mt,!t&&mt&&(this.index=(mt.scopes||(mt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,s;if(this.scopes)for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].pause();for(t=0,s=this.effects.length;t<s;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,s;if(this.scopes)for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].resume();for(t=0,s=this.effects.length;t<s;t++)this.effects[t].resume()}}run(t){if(this._active){const s=mt;try{return mt=this,t()}finally{mt=s}}}on(){mt=this}off(){mt=this.parent}stop(t){if(this._active){this._active=!1;let s,n;for(s=0,n=this.effects.length;s<n;s++)this.effects[s].stop();for(this.effects.length=0,s=0,n=this.cleanups.length;s<n;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,n=this.scopes.length;s<n;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function bd(){return mt}let Ne;const vr=new WeakSet;class rc{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,mt&&mt.active&&mt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,vr.has(this)&&(vr.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||ac(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ua(this),lc(this);const t=Ne,s=Mt;Ne=this,Mt=!0;try{return this.fn()}finally{cc(this),Ne=t,Mt=s,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Ei(t);this.deps=this.depsTail=void 0,ua(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?vr.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Br(this)&&this.run()}get dirty(){return Br(this)}}let ic=0,To,Io;function ac(e,t=!1){if(e.flags|=8,t){e.next=Io,Io=e;return}e.next=To,To=e}function Pi(){ic++}function Ai(){if(--ic>0)return;if(Io){let t=Io;for(Io=void 0;t;){const s=t.next;t.next=void 0,t.flags&=-9,t=s}}let e;for(;To;){let t=To;for(To=void 0;t;){const s=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){e||(e=n)}t=s}}if(e)throw e}function lc(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function cc(e){let t,s=e.depsTail,n=s;for(;n;){const o=n.prevDep;n.version===-1?(n===s&&(s=o),Ei(n),vd(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=o}e.deps=t,e.depsTail=s}function Br(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(uc(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function uc(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Ro))return;e.globalVersion=Ro;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!Br(e)){e.flags&=-3;return}const s=Ne,n=Mt;Ne=e,Mt=!0;try{lc(e);const o=e.fn(e._value);(t.version===0||ys(o,e._value))&&(e._value=o,t.version++)}catch(o){throw t.version++,o}finally{Ne=s,Mt=n,cc(e),e.flags&=-3}}function Ei(e,t=!1){const{dep:s,prevSub:n,nextSub:o}=e;if(n&&(n.nextSub=o,e.prevSub=void 0),o&&(o.prevSub=n,e.nextSub=void 0),s.subs===e&&(s.subs=n,!n&&s.computed)){s.computed.flags&=-5;for(let r=s.computed.deps;r;r=r.nextDep)Ei(r,!0)}!t&&!--s.sc&&s.map&&s.map.delete(s.key)}function vd(e){const{prevDep:t,nextDep:s}=e;t&&(t.nextDep=s,e.prevDep=void 0),s&&(s.prevDep=t,e.nextDep=void 0)}let Mt=!0;const fc=[];function Ts(){fc.push(Mt),Mt=!1}function Is(){const e=fc.pop();Mt=e===void 0?!0:e}function ua(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const s=Ne;Ne=void 0;try{t()}finally{Ne=s}}}let Ro=0;class wd{constructor(t,s){this.sub=t,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Oi{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!Ne||!Mt||Ne===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==Ne)s=this.activeLink=new wd(Ne,this),Ne.deps?(s.prevDep=Ne.depsTail,Ne.depsTail.nextDep=s,Ne.depsTail=s):Ne.deps=Ne.depsTail=s,dc(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const n=s.nextDep;n.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=n),s.prevDep=Ne.depsTail,s.nextDep=void 0,Ne.depsTail.nextDep=s,Ne.depsTail=s,Ne.deps===s&&(Ne.deps=n)}return s}trigger(t){this.version++,Ro++,this.notify(t)}notify(t){Pi();try{for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{Ai()}}}function dc(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)dc(n)}const s=e.dep.subs;s!==e&&(e.prevSub=s,s&&(s.nextSub=e)),e.dep.subs=e}}const qr=new WeakMap,Fs=Symbol(""),Jr=Symbol(""),Do=Symbol("");function et(e,t,s){if(Mt&&Ne){let n=qr.get(e);n||qr.set(e,n=new Map);let o=n.get(s);o||(n.set(s,o=new Oi),o.map=n,o.key=s),o.track()}}function Yt(e,t,s,n,o,r){const i=qr.get(e);if(!i){Ro++;return}const a=c=>{c&&c.trigger()};if(Pi(),t==="clear")i.forEach(a);else{const c=he(e),f=c&&Ii(s);if(c&&s==="length"){const u=Number(n);i.forEach((d,h)=>{(h==="length"||h===Do||!At(h)&&h>=u)&&a(d)})}else switch((s!==void 0||i.has(void 0))&&a(i.get(s)),f&&a(i.get(Do)),t){case"add":c?f&&a(i.get("length")):(a(i.get(Fs)),to(e)&&a(i.get(Jr)));break;case"delete":c||(a(i.get(Fs)),to(e)&&a(i.get(Jr)));break;case"set":to(e)&&a(i.get(Fs));break}}Ai()}function Ws(e){const t=Se(e);return t===e?t:(et(t,"iterate",Do),$t(e)?t:t.map(tt))}function Kn(e){return et(e=Se(e),"iterate",Do),e}const _d={__proto__:null,[Symbol.iterator](){return wr(this,Symbol.iterator,tt)},concat(...e){return Ws(this).concat(...e.map(t=>he(t)?Ws(t):t))},entries(){return wr(this,"entries",e=>(e[1]=tt(e[1]),e))},every(e,t){return Wt(this,"every",e,t,void 0,arguments)},filter(e,t){return Wt(this,"filter",e,t,s=>s.map(tt),arguments)},find(e,t){return Wt(this,"find",e,t,tt,arguments)},findIndex(e,t){return Wt(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Wt(this,"findLast",e,t,tt,arguments)},findLastIndex(e,t){return Wt(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Wt(this,"forEach",e,t,void 0,arguments)},includes(...e){return _r(this,"includes",e)},indexOf(...e){return _r(this,"indexOf",e)},join(e){return Ws(this).join(e)},lastIndexOf(...e){return _r(this,"lastIndexOf",e)},map(e,t){return Wt(this,"map",e,t,void 0,arguments)},pop(){return vo(this,"pop")},push(...e){return vo(this,"push",e)},reduce(e,...t){return fa(this,"reduce",e,t)},reduceRight(e,...t){return fa(this,"reduceRight",e,t)},shift(){return vo(this,"shift")},some(e,t){return Wt(this,"some",e,t,void 0,arguments)},splice(...e){return vo(this,"splice",e)},toReversed(){return Ws(this).toReversed()},toSorted(e){return Ws(this).toSorted(e)},toSpliced(...e){return Ws(this).toSpliced(...e)},unshift(...e){return vo(this,"unshift",e)},values(){return wr(this,"values",tt)}};function wr(e,t,s){const n=Kn(e),o=n[t]();return n!==e&&!$t(e)&&(o._next=o.next,o.next=()=>{const r=o._next();return r.value&&(r.value=s(r.value)),r}),o}const Cd=Array.prototype;function Wt(e,t,s,n,o,r){const i=Kn(e),a=i!==e&&!$t(e),c=i[t];if(c!==Cd[t]){const d=c.apply(e,r);return a?tt(d):d}let f=s;i!==e&&(a?f=function(d,h){return s.call(this,tt(d),h,e)}:s.length>2&&(f=function(d,h){return s.call(this,d,h,e)}));const u=c.call(i,f,n);return a&&o?o(u):u}function fa(e,t,s,n){const o=Kn(e);let r=s;return o!==e&&($t(e)?s.length>3&&(r=function(i,a,c){return s.call(this,i,a,c,e)}):r=function(i,a,c){return s.call(this,i,tt(a),c,e)}),o[t](r,...n)}function _r(e,t,s){const n=Se(e);et(n,"iterate",Do);const o=n[t](...s);return(o===-1||o===!1)&&Ri(s[0])?(s[0]=Se(s[0]),n[t](...s)):o}function vo(e,t,s=[]){Ts(),Pi();const n=Se(e)[t].apply(e,s);return Ai(),Is(),n}const $d=Si("__proto__,__v_isRef,__isVue"),gc=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(At));function kd(e){At(e)||(e=String(e));const t=Se(this);return et(t,"has",e),t.hasOwnProperty(e)}class hc{constructor(t=!1,s=!1){this._isReadonly=t,this._isShallow=s}get(t,s,n){if(s==="__v_skip")return t.__v_skip;const o=this._isReadonly,r=this._isShallow;if(s==="__v_isReactive")return!o;if(s==="__v_isReadonly")return o;if(s==="__v_isShallow")return r;if(s==="__v_raw")return n===(o?r?Ld:bc:r?yc:pc).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const i=he(t);if(!o){let c;if(i&&(c=_d[s]))return c;if(s==="hasOwnProperty")return kd}const a=Reflect.get(t,s,ot(t)?t:n);return(At(s)?gc.has(s):$d(s))||(o||et(t,"get",s),r)?a:ot(a)?i&&Ii(s)?a:a.value:Le(a)?o?wc(a):Vs(a):a}}class mc extends hc{constructor(t=!1){super(!1,t)}set(t,s,n,o){let r=t[s];if(!this._isShallow){const c=zs(r);if(!$t(n)&&!zs(n)&&(r=Se(r),n=Se(n)),!he(t)&&ot(r)&&!ot(n))return c?!1:(r.value=n,!0)}const i=he(t)&&Ii(s)?Number(s)<t.length:Me(t,s),a=Reflect.set(t,s,n,ot(t)?t:o);return t===Se(o)&&(i?ys(n,r)&&Yt(t,"set",s,n):Yt(t,"add",s,n)),a}deleteProperty(t,s){const n=Me(t,s);t[s];const o=Reflect.deleteProperty(t,s);return o&&n&&Yt(t,"delete",s,void 0),o}has(t,s){const n=Reflect.has(t,s);return(!At(s)||!gc.has(s))&&et(t,"has",s),n}ownKeys(t){return et(t,"iterate",he(t)?"length":Fs),Reflect.ownKeys(t)}}class Sd extends hc{constructor(t=!1){super(!0,t)}set(t,s){return!0}deleteProperty(t,s){return!0}}const xd=new mc,Td=new Sd,Id=new mc(!0);const Gr=e=>e,cn=e=>Reflect.getPrototypeOf(e);function Md(e,t,s){return function(...n){const o=this.__v_raw,r=Se(o),i=to(r),a=e==="entries"||e===Symbol.iterator&&i,c=e==="keys"&&i,f=o[e](...n),u=s?Gr:t?Wr:tt;return!t&&et(r,"iterate",c?Jr:Fs),{next(){const{value:d,done:h}=f.next();return h?{value:d,done:h}:{value:a?[u(d[0]),u(d[1])]:u(d),done:h}},[Symbol.iterator](){return this}}}}function un(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Pd(e,t){const s={get(o){const r=this.__v_raw,i=Se(r),a=Se(o);e||(ys(o,a)&&et(i,"get",o),et(i,"get",a));const{has:c}=cn(i),f=t?Gr:e?Wr:tt;if(c.call(i,o))return f(r.get(o));if(c.call(i,a))return f(r.get(a));r!==i&&r.get(o)},get size(){const o=this.__v_raw;return!e&&et(Se(o),"iterate",Fs),Reflect.get(o,"size",o)},has(o){const r=this.__v_raw,i=Se(r),a=Se(o);return e||(ys(o,a)&&et(i,"has",o),et(i,"has",a)),o===a?r.has(o):r.has(o)||r.has(a)},forEach(o,r){const i=this,a=i.__v_raw,c=Se(a),f=t?Gr:e?Wr:tt;return!e&&et(c,"iterate",Fs),a.forEach((u,d)=>o.call(r,f(u),f(d),i))}};return qe(s,e?{add:un("add"),set:un("set"),delete:un("delete"),clear:un("clear")}:{add(o){!t&&!$t(o)&&!zs(o)&&(o=Se(o));const r=Se(this);return cn(r).has.call(r,o)||(r.add(o),Yt(r,"add",o,o)),this},set(o,r){!t&&!$t(r)&&!zs(r)&&(r=Se(r));const i=Se(this),{has:a,get:c}=cn(i);let f=a.call(i,o);f||(o=Se(o),f=a.call(i,o));const u=c.call(i,o);return i.set(o,r),f?ys(r,u)&&Yt(i,"set",o,r):Yt(i,"add",o,r),this},delete(o){const r=Se(this),{has:i,get:a}=cn(r);let c=i.call(r,o);c||(o=Se(o),c=i.call(r,o)),a&&a.call(r,o);const f=r.delete(o);return c&&Yt(r,"delete",o,void 0),f},clear(){const o=Se(this),r=o.size!==0,i=o.clear();return r&&Yt(o,"clear",void 0,void 0),i}}),["keys","values","entries",Symbol.iterator].forEach(o=>{s[o]=Md(o,e,t)}),s}function Li(e,t){const s=Pd(e,t);return(n,o,r)=>o==="__v_isReactive"?!e:o==="__v_isReadonly"?e:o==="__v_raw"?n:Reflect.get(Me(s,o)&&o in n?s:n,o,r)}const Ad={get:Li(!1,!1)},Ed={get:Li(!1,!0)},Od={get:Li(!0,!1)};const pc=new WeakMap,yc=new WeakMap,bc=new WeakMap,Ld=new WeakMap;function Nd(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Rd(e){return e.__v_skip||!Object.isExtensible(e)?0:Nd(id(e))}function Vs(e){return zs(e)?e:Ni(e,!1,xd,Ad,pc)}function vc(e){return Ni(e,!1,Id,Ed,yc)}function wc(e){return Ni(e,!0,Td,Od,bc)}function Ni(e,t,s,n,o){if(!Le(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const r=o.get(e);if(r)return r;const i=Rd(e);if(i===0)return e;const a=new Proxy(e,i===2?n:s);return o.set(e,a),a}function so(e){return zs(e)?so(e.__v_raw):!!(e&&e.__v_isReactive)}function zs(e){return!!(e&&e.__v_isReadonly)}function $t(e){return!!(e&&e.__v_isShallow)}function Ri(e){return e?!!e.__v_raw:!1}function Se(e){const t=e&&e.__v_raw;return t?Se(t):e}function Dd(e){return!Me(e,"__v_skip")&&Object.isExtensible(e)&&tc(e,"__v_skip",!0),e}const tt=e=>Le(e)?Vs(e):e,Wr=e=>Le(e)?wc(e):e;function ot(e){return e?e.__v_isRef===!0:!1}function Re(e){return _c(e,!1)}function Fd(e){return _c(e,!0)}function _c(e,t){return ot(e)?e:new Vd(e,t)}class Vd{constructor(t,s){this.dep=new Oi,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?t:Se(t),this._value=s?t:tt(t),this.__v_isShallow=s}get value(){return this.dep.track(),this._value}set value(t){const s=this._rawValue,n=this.__v_isShallow||$t(t)||zs(t);t=n?t:Se(t),ys(t,s)&&(this._rawValue=t,this._value=n?t:tt(t),this.dep.trigger())}}function ss(e){return ot(e)?e.value:e}const Ud={get:(e,t,s)=>t==="__v_raw"?e:ss(Reflect.get(e,t,s)),set:(e,t,s,n)=>{const o=e[t];return ot(o)&&!ot(s)?(o.value=s,!0):Reflect.set(e,t,s,n)}};function Cc(e){return so(e)?e:new Proxy(e,Ud)}class jd{constructor(t,s,n){this.fn=t,this.setter=s,this._value=void 0,this.dep=new Oi(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Ro-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&Ne!==this)return ac(this,!0),!0}get value(){const t=this.dep.track();return uc(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function zd(e,t,s=!1){let n,o;return we(e)?n=e:(n=e.get,o=e.set),new jd(n,o,s)}const fn={},Tn=new WeakMap;let Ls;function Bd(e,t=!1,s=Ls){if(s){let n=Tn.get(s);n||Tn.set(s,n=[]),n.push(e)}}function qd(e,t,s=Oe){const{immediate:n,deep:o,once:r,scheduler:i,augmentJob:a,call:c}=s,f=k=>o?k:$t(k)||o===!1||o===0?Xt(k,1):Xt(k);let u,d,h,g,m=!1,y=!1;if(ot(e)?(d=()=>e.value,m=$t(e)):so(e)?(d=()=>f(e),m=!0):he(e)?(y=!0,m=e.some(k=>so(k)||$t(k)),d=()=>e.map(k=>{if(ot(k))return k.value;if(so(k))return f(k);if(we(k))return c?c(k,2):k()})):we(e)?t?d=c?()=>c(e,2):e:d=()=>{if(h){Ts();try{h()}finally{Is()}}const k=Ls;Ls=u;try{return c?c(e,3,[g]):e(g)}finally{Ls=k}}:d=zt,t&&o){const k=d,$=o===!0?1/0:o;d=()=>Xt(k(),$)}const p=bd(),b=()=>{u.stop(),p&&p.active&&Ti(p.effects,u)};if(r&&t){const k=t;t=(...$)=>{k(...$),b()}}let w=y?new Array(e.length).fill(fn):fn;const v=k=>{if(!(!(u.flags&1)||!u.dirty&&!k))if(t){const $=u.run();if(o||m||(y?$.some((I,R)=>ys(I,w[R])):ys($,w))){h&&h();const I=Ls;Ls=u;try{const R=[$,w===fn?void 0:y&&w[0]===fn?[]:w,g];c?c(t,3,R):t(...R),w=$}finally{Ls=I}}}else u.run()};return a&&a(v),u=new rc(d),u.scheduler=i?()=>i(v,!1):v,g=k=>Bd(k,!1,u),h=u.onStop=()=>{const k=Tn.get(u);if(k){if(c)c(k,4);else for(const $ of k)$();Tn.delete(u)}},t?n?v(!0):w=u.run():i?i(v.bind(null,!0),!0):u.run(),b.pause=u.pause.bind(u),b.resume=u.resume.bind(u),b.stop=b,b}function Xt(e,t=1/0,s){if(t<=0||!Le(e)||e.__v_skip||(s=s||new Set,s.has(e)))return e;if(s.add(e),t--,ot(e))Xt(e.value,t,s);else if(he(e))for(let n=0;n<e.length;n++)Xt(e[n],t,s);else if(po(e)||to(e))e.forEach(n=>{Xt(n,t,s)});else if(ec(e)){for(const n in e)Xt(e[n],t,s);for(const n of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,n)&&Xt(e[n],t,s)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Xo(e,t,s,n){try{return n?e(...n):e()}catch(o){Qn(o,t,s)}}function Et(e,t,s,n){if(we(e)){const o=Xo(e,t,s,n);return o&&Xl(o)&&o.catch(r=>{Qn(r,t,s)}),o}if(he(e)){const o=[];for(let r=0;r<e.length;r++)o.push(Et(e[r],t,s,n));return o}}function Qn(e,t,s,n=!0){const o=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:i}=t&&t.appContext.config||Oe;if(t){let a=t.parent;const c=t.proxy,f=`https://vuejs.org/error-reference/#runtime-${s}`;for(;a;){const u=a.ec;if(u){for(let d=0;d<u.length;d++)if(u[d](e,c,f)===!1)return}a=a.parent}if(r){Ts(),Xo(r,null,10,[e,c,f]),Is();return}}Jd(e,s,o,n,i)}function Jd(e,t,s,n=!0,o=!1){if(o)throw e;console.error(e)}const at=[];let Ft=-1;const oo=[];let ds=null,Ks=0;const $c=Promise.resolve();let In=null;function co(e){const t=In||$c;return e?t.then(this?e.bind(this):e):t}function Gd(e){let t=Ft+1,s=at.length;for(;t<s;){const n=t+s>>>1,o=at[n],r=Fo(o);r<e||r===e&&o.flags&2?t=n+1:s=n}return t}function Di(e){if(!(e.flags&1)){const t=Fo(e),s=at[at.length-1];!s||!(e.flags&2)&&t>=Fo(s)?at.push(e):at.splice(Gd(t),0,e),e.flags|=1,kc()}}function kc(){In||(In=$c.then(xc))}function Wd(e){he(e)?oo.push(...e):ds&&e.id===-1?ds.splice(Ks+1,0,e):e.flags&1||(oo.push(e),e.flags|=1),kc()}function da(e,t,s=Ft+1){for(;s<at.length;s++){const n=at[s];if(n&&n.flags&2){if(e&&n.id!==e.uid)continue;at.splice(s,1),s--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function Sc(e){if(oo.length){const t=[...new Set(oo)].sort((s,n)=>Fo(s)-Fo(n));if(oo.length=0,ds){ds.push(...t);return}for(ds=t,Ks=0;Ks<ds.length;Ks++){const s=ds[Ks];s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2}ds=null,Ks=0}}const Fo=e=>e.id==null?e.flags&2?-1:1/0:e.id;function xc(e){try{for(Ft=0;Ft<at.length;Ft++){const t=at[Ft];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Xo(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Ft<at.length;Ft++){const t=at[Ft];t&&(t.flags&=-2)}Ft=-1,at.length=0,Sc(),In=null,(at.length||oo.length)&&xc()}}let Ke=null,Tc=null;function Mn(e){const t=Ke;return Ke=e,Tc=e&&e.type.__scopeId||null,t}function it(e,t=Ke,s){if(!t||e._n)return e;const n=(...o)=>{n._d&&$a(-1);const r=Mn(t);let i;try{i=e(...o)}finally{Mn(r),n._d&&$a(1)}return i};return n._n=!0,n._c=!0,n._d=!0,n}function U(e,t){if(Ke===null)return e;const s=or(Ke),n=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[r,i,a,c=Oe]=t[o];r&&(we(r)&&(r={mounted:r,updated:r}),r.deep&&Xt(i),n.push({dir:r,instance:s,value:i,oldValue:void 0,arg:a,modifiers:c}))}return e}function As(e,t,s,n){const o=e.dirs,r=t&&t.dirs;for(let i=0;i<o.length;i++){const a=o[i];r&&(a.oldValue=r[i].value);let c=a.dir[n];c&&(Ts(),Et(c,s,8,[e.el,a,e,t]),Is())}}const Hd=Symbol("_vte"),Ic=e=>e.__isTeleport,gs=Symbol("_leaveCb"),dn=Symbol("_enterCb");function Mc(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Zo(()=>{e.isMounted=!0}),Dc(()=>{e.isUnmounting=!0}),e}const _t=[Function,Array],Pc={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:_t,onEnter:_t,onAfterEnter:_t,onEnterCancelled:_t,onBeforeLeave:_t,onLeave:_t,onAfterLeave:_t,onLeaveCancelled:_t,onBeforeAppear:_t,onAppear:_t,onAfterAppear:_t,onAppearCancelled:_t},Ac=e=>{const t=e.subTree;return t.component?Ac(t.component):t},Kd={name:"BaseTransition",props:Pc,setup(e,{slots:t}){const s=zi(),n=Mc();return()=>{const o=t.default&&Fi(t.default(),!0);if(!o||!o.length)return;const r=Ec(o),i=Se(e),{mode:a}=i;if(n.isLeaving)return Cr(r);const c=ga(r);if(!c)return Cr(r);let f=Vo(c,i,n,s,d=>f=d);c.type!==lt&&Bs(c,f);let u=s.subTree&&ga(s.subTree);if(u&&u.type!==lt&&!Ns(c,u)&&Ac(s).type!==lt){let d=Vo(u,i,n,s);if(Bs(u,d),a==="out-in"&&c.type!==lt)return n.isLeaving=!0,d.afterLeave=()=>{n.isLeaving=!1,s.job.flags&8||s.update(),delete d.afterLeave,u=void 0},Cr(r);a==="in-out"&&c.type!==lt?d.delayLeave=(h,g,m)=>{const y=Oc(n,u);y[String(u.key)]=u,h[gs]=()=>{g(),h[gs]=void 0,delete f.delayedLeave,u=void 0},f.delayedLeave=()=>{m(),delete f.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return r}}};function Ec(e){let t=e[0];if(e.length>1){for(const s of e)if(s.type!==lt){t=s;break}}return t}const Qd=Kd;function Oc(e,t){const{leavingVNodes:s}=e;let n=s.get(t.type);return n||(n=Object.create(null),s.set(t.type,n)),n}function Vo(e,t,s,n,o){const{appear:r,mode:i,persisted:a=!1,onBeforeEnter:c,onEnter:f,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:h,onLeave:g,onAfterLeave:m,onLeaveCancelled:y,onBeforeAppear:p,onAppear:b,onAfterAppear:w,onAppearCancelled:v}=t,k=String(e.key),$=Oc(s,e),I=(E,N)=>{E&&Et(E,n,9,N)},R=(E,N)=>{const W=N[1];I(E,N),he(E)?E.every(M=>M.length<=1)&&W():E.length<=1&&W()},O={mode:i,persisted:a,beforeEnter(E){let N=c;if(!s.isMounted)if(r)N=p||c;else return;E[gs]&&E[gs](!0);const W=$[k];W&&Ns(e,W)&&W.el[gs]&&W.el[gs](),I(N,[E])},enter(E){let N=f,W=u,M=d;if(!s.isMounted)if(r)N=b||f,W=w||u,M=v||d;else return;let z=!1;const G=E[dn]=pe=>{z||(z=!0,pe?I(M,[E]):I(W,[E]),O.delayedLeave&&O.delayedLeave(),E[dn]=void 0)};N?R(N,[E,G]):G()},leave(E,N){const W=String(e.key);if(E[dn]&&E[dn](!0),s.isUnmounting)return N();I(h,[E]);let M=!1;const z=E[gs]=G=>{M||(M=!0,N(),G?I(y,[E]):I(m,[E]),E[gs]=void 0,$[W]===e&&delete $[W])};$[W]=e,g?R(g,[E,z]):z()},clone(E){const N=Vo(E,t,s,n,o);return o&&o(N),N}};return O}function Cr(e){if(Yn(e))return e=vs(e),e.children=null,e}function ga(e){if(!Yn(e))return Ic(e.type)&&e.children?Ec(e.children):e;const{shapeFlag:t,children:s}=e;if(s){if(t&16)return s[0];if(t&32&&we(s.default))return s.default()}}function Bs(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Bs(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Fi(e,t=!1,s){let n=[],o=0;for(let r=0;r<e.length;r++){let i=e[r];const a=s==null?i.key:String(s)+String(i.key!=null?i.key:r);i.type===ve?(i.patchFlag&128&&o++,n=n.concat(Fi(i.children,t,a))):(t||i.type!==lt)&&n.push(a!=null?vs(i,{key:a}):i)}if(o>1)for(let r=0;r<n.length;r++)n[r].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function Jt(e,t){return we(e)?qe({name:e.name},t,{setup:e}):e}function Lc(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Pn(e,t,s,n,o=!1){if(he(e)){e.forEach((m,y)=>Pn(m,t&&(he(t)?t[y]:t),s,n,o));return}if(no(n)&&!o){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Pn(e,t,s,n.component.subTree);return}const r=n.shapeFlag&4?or(n.component):n.el,i=o?null:r,{i:a,r:c}=e,f=t&&t.r,u=a.refs===Oe?a.refs={}:a.refs,d=a.setupState,h=Se(d),g=d===Oe?()=>!1:m=>Me(h,m);if(f!=null&&f!==c&&(je(f)?(u[f]=null,g(f)&&(d[f]=null)):ot(f)&&(f.value=null)),we(c))Xo(c,a,12,[i,u]);else{const m=je(c),y=ot(c);if(m||y){const p=()=>{if(e.f){const b=m?g(c)?d[c]:u[c]:c.value;o?he(b)&&Ti(b,r):he(b)?b.includes(r)||b.push(r):m?(u[c]=[r],g(c)&&(d[c]=u[c])):(c.value=[r],e.k&&(u[e.k]=c.value))}else m?(u[c]=i,g(c)&&(d[c]=i)):y&&(c.value=i,e.k&&(u[e.k]=i))};i?(p.id=-1,ht(p,s)):p()}}}Hn().requestIdleCallback;Hn().cancelIdleCallback;const no=e=>!!e.type.__asyncLoader,Yn=e=>e.type.__isKeepAlive;function Yd(e,t){Nc(e,"a",t)}function Xd(e,t){Nc(e,"da",t)}function Nc(e,t,s=Ye){const n=e.__wdc||(e.__wdc=()=>{let o=s;for(;o;){if(o.isDeactivated)return;o=o.parent}return e()});if(Xn(t,n,s),s){let o=s.parent;for(;o&&o.parent;)Yn(o.parent.vnode)&&Zd(n,t,s,o),o=o.parent}}function Zd(e,t,s,n){const o=Xn(t,e,n,!0);Zn(()=>{Ti(n[t],o)},s)}function Xn(e,t,s=Ye,n=!1){if(s){const o=s[e]||(s[e]=[]),r=t.__weh||(t.__weh=(...i)=>{Ts();const a=en(s),c=Et(t,s,e,i);return a(),Is(),c});return n?o.unshift(r):o.push(r),r}}const is=e=>(t,s=Ye)=>{(!Bo||e==="sp")&&Xn(e,(...n)=>t(...n),s)},eg=is("bm"),Zo=is("m"),tg=is("bu"),Rc=is("u"),Dc=is("bum"),Zn=is("um"),sg=is("sp"),og=is("rtg"),ng=is("rtc");function rg(e,t=Ye){Xn("ec",e,t)}const Fc="components";function ze(e,t){return Uc(Fc,e,!0,t)||e}const Vc=Symbol.for("v-ndc");function ro(e){return je(e)?Uc(Fc,e,!1)||e:e||Vc}function Uc(e,t,s=!0,n=!1){const o=Ke||Ye;if(o){const r=o.type;{const a=Gg(r,!1);if(a&&(a===t||a===St(t)||a===Wn(St(t))))return r}const i=ha(o[e]||r[e],t)||ha(o.appContext[e],t);return!i&&n?r:i}}function ha(e,t){return e&&(e[t]||e[St(t)]||e[Wn(St(t))])}function Ae(e,t,s,n){let o;const r=s,i=he(e);if(i||je(e)){const a=i&&so(e);let c=!1;a&&(c=!$t(e),e=Kn(e)),o=new Array(e.length);for(let f=0,u=e.length;f<u;f++)o[f]=t(c?tt(e[f]):e[f],f,void 0,r)}else if(typeof e=="number"){o=new Array(e);for(let a=0;a<e;a++)o[a]=t(a+1,a,void 0,r)}else if(Le(e))if(e[Symbol.iterator])o=Array.from(e,(a,c)=>t(a,c,void 0,r));else{const a=Object.keys(e);o=new Array(a.length);for(let c=0,f=a.length;c<f;c++){const u=a[c];o[c]=t(e[u],u,c,r)}}else o=[];return o}function ig(e,t,s={},n,o){if(Ke.ce||Ke.parent&&no(Ke.parent)&&Ke.parent.ce)return S(),Xe(ve,null,[q("slot",s,n)],64);let r=e[t];r&&r._c&&(r._d=!1),S();const i=r&&jc(r(s)),a=s.key||i&&i.key,c=Xe(ve,{key:(a&&!At(a)?a:`_${t}`)+""},i||[],i&&e._===1?64:-2);return c.scopeId&&(c.slotScopeIds=[c.scopeId+"-s"]),r&&r._c&&(r._d=!0),c}function jc(e){return e.some(t=>jo(t)?!(t.type===lt||t.type===ve&&!jc(t.children)):!0)?e:null}function ag(e,t){const s={};for(const n in e)s[pn(n)]=e[n];return s}const Hr=e=>e?au(e)?or(e):Hr(e.parent):null,Mo=qe(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Hr(e.parent),$root:e=>Hr(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Bc(e),$forceUpdate:e=>e.f||(e.f=()=>{Di(e.update)}),$nextTick:e=>e.n||(e.n=co.bind(e.proxy)),$watch:e=>Ig.bind(e)}),$r=(e,t)=>e!==Oe&&!e.__isScriptSetup&&Me(e,t),lg={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:s,setupState:n,data:o,props:r,accessCache:i,type:a,appContext:c}=e;let f;if(t[0]!=="$"){const g=i[t];if(g!==void 0)switch(g){case 1:return n[t];case 2:return o[t];case 4:return s[t];case 3:return r[t]}else{if($r(n,t))return i[t]=1,n[t];if(o!==Oe&&Me(o,t))return i[t]=2,o[t];if((f=e.propsOptions[0])&&Me(f,t))return i[t]=3,r[t];if(s!==Oe&&Me(s,t))return i[t]=4,s[t];Kr&&(i[t]=0)}}const u=Mo[t];let d,h;if(u)return t==="$attrs"&&et(e.attrs,"get",""),u(e);if((d=a.__cssModules)&&(d=d[t]))return d;if(s!==Oe&&Me(s,t))return i[t]=4,s[t];if(h=c.config.globalProperties,Me(h,t))return h[t]},set({_:e},t,s){const{data:n,setupState:o,ctx:r}=e;return $r(o,t)?(o[t]=s,!0):n!==Oe&&Me(n,t)?(n[t]=s,!0):Me(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(r[t]=s,!0)},has({_:{data:e,setupState:t,accessCache:s,ctx:n,appContext:o,propsOptions:r}},i){let a;return!!s[i]||e!==Oe&&Me(e,i)||$r(t,i)||(a=r[0])&&Me(a,i)||Me(n,i)||Me(Mo,i)||Me(o.config.globalProperties,i)},defineProperty(e,t,s){return s.get!=null?e._.accessCache[t]=0:Me(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};function ma(e){return he(e)?e.reduce((t,s)=>(t[s]=null,t),{}):e}let Kr=!0;function cg(e){const t=Bc(e),s=e.proxy,n=e.ctx;Kr=!1,t.beforeCreate&&pa(t.beforeCreate,e,"bc");const{data:o,computed:r,methods:i,watch:a,provide:c,inject:f,created:u,beforeMount:d,mounted:h,beforeUpdate:g,updated:m,activated:y,deactivated:p,beforeDestroy:b,beforeUnmount:w,destroyed:v,unmounted:k,render:$,renderTracked:I,renderTriggered:R,errorCaptured:O,serverPrefetch:E,expose:N,inheritAttrs:W,components:M,directives:z,filters:G}=t;if(f&&ug(f,n,null),i)for(const ye in i){const X=i[ye];we(X)&&(n[ye]=X.bind(s))}if(o){const ye=o.call(s,s);Le(ye)&&(e.data=Vs(ye))}if(Kr=!0,r)for(const ye in r){const X=r[ye],Ee=we(X)?X.bind(s,s):we(X.get)?X.get.bind(s,s):zt,se=!we(X)&&we(X.set)?X.set.bind(s):zt,ke=He({get:Ee,set:se});Object.defineProperty(n,ye,{enumerable:!0,configurable:!0,get:()=>ke.value,set:V=>ke.value=V})}if(a)for(const ye in a)zc(a[ye],n,s,ye);if(c){const ye=we(c)?c.call(s):c;Reflect.ownKeys(ye).forEach(X=>{bn(X,ye[X])})}u&&pa(u,e,"c");function $e(ye,X){he(X)?X.forEach(Ee=>ye(Ee.bind(s))):X&&ye(X.bind(s))}if($e(eg,d),$e(Zo,h),$e(tg,g),$e(Rc,m),$e(Yd,y),$e(Xd,p),$e(rg,O),$e(ng,I),$e(og,R),$e(Dc,w),$e(Zn,k),$e(sg,E),he(N))if(N.length){const ye=e.exposed||(e.exposed={});N.forEach(X=>{Object.defineProperty(ye,X,{get:()=>s[X],set:Ee=>s[X]=Ee})})}else e.exposed||(e.exposed={});$&&e.render===zt&&(e.render=$),W!=null&&(e.inheritAttrs=W),M&&(e.components=M),z&&(e.directives=z),E&&Lc(e)}function ug(e,t,s=zt){he(e)&&(e=Qr(e));for(const n in e){const o=e[n];let r;Le(o)?"default"in o?r=Pt(o.from||n,o.default,!0):r=Pt(o.from||n):r=Pt(o),ot(r)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>r.value,set:i=>r.value=i}):t[n]=r}}function pa(e,t,s){Et(he(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,s)}function zc(e,t,s,n){let o=n.includes(".")?su(s,n):()=>s[n];if(je(e)){const r=t[e];we(r)&&bs(o,r)}else if(we(e))bs(o,e.bind(s));else if(Le(e))if(he(e))e.forEach(r=>zc(r,t,s,n));else{const r=we(e.handler)?e.handler.bind(s):t[e.handler];we(r)&&bs(o,r,e)}}function Bc(e){const t=e.type,{mixins:s,extends:n}=t,{mixins:o,optionsCache:r,config:{optionMergeStrategies:i}}=e.appContext,a=r.get(t);let c;return a?c=a:!o.length&&!s&&!n?c=t:(c={},o.length&&o.forEach(f=>An(c,f,i,!0)),An(c,t,i)),Le(t)&&r.set(t,c),c}function An(e,t,s,n=!1){const{mixins:o,extends:r}=t;r&&An(e,r,s,!0),o&&o.forEach(i=>An(e,i,s,!0));for(const i in t)if(!(n&&i==="expose")){const a=fg[i]||s&&s[i];e[i]=a?a(e[i],t[i]):t[i]}return e}const fg={data:ya,props:ba,emits:ba,methods:ko,computed:ko,beforeCreate:rt,created:rt,beforeMount:rt,mounted:rt,beforeUpdate:rt,updated:rt,beforeDestroy:rt,beforeUnmount:rt,destroyed:rt,unmounted:rt,activated:rt,deactivated:rt,errorCaptured:rt,serverPrefetch:rt,components:ko,directives:ko,watch:gg,provide:ya,inject:dg};function ya(e,t){return t?e?function(){return qe(we(e)?e.call(this,this):e,we(t)?t.call(this,this):t)}:t:e}function dg(e,t){return ko(Qr(e),Qr(t))}function Qr(e){if(he(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function rt(e,t){return e?[...new Set([].concat(e,t))]:t}function ko(e,t){return e?qe(Object.create(null),e,t):t}function ba(e,t){return e?he(e)&&he(t)?[...new Set([...e,...t])]:qe(Object.create(null),ma(e),ma(t??{})):t}function gg(e,t){if(!e)return t;if(!t)return e;const s=qe(Object.create(null),e);for(const n in t)s[n]=rt(e[n],t[n]);return s}function qc(){return{app:null,config:{isNativeTag:nd,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let hg=0;function mg(e,t){return function(n,o=null){we(n)||(n=qe({},n)),o!=null&&!Le(o)&&(o=null);const r=qc(),i=new WeakSet,a=[];let c=!1;const f=r.app={_uid:hg++,_component:n,_props:o,_container:null,_context:r,_instance:null,version:Hg,get config(){return r.config},set config(u){},use(u,...d){return i.has(u)||(u&&we(u.install)?(i.add(u),u.install(f,...d)):we(u)&&(i.add(u),u(f,...d))),f},mixin(u){return r.mixins.includes(u)||r.mixins.push(u),f},component(u,d){return d?(r.components[u]=d,f):r.components[u]},directive(u,d){return d?(r.directives[u]=d,f):r.directives[u]},mount(u,d,h){if(!c){const g=f._ceVNode||q(n,o);return g.appContext=r,h===!0?h="svg":h===!1&&(h=void 0),e(g,u,h),c=!0,f._container=u,u.__vue_app__=f,or(g.component)}},onUnmount(u){a.push(u)},unmount(){c&&(Et(a,f._instance,16),e(null,f._container),delete f._container.__vue_app__)},provide(u,d){return r.provides[u]=d,f},runWithContext(u){const d=io;io=f;try{return u()}finally{io=d}}};return f}}let io=null;function bn(e,t){if(Ye){let s=Ye.provides;const n=Ye.parent&&Ye.parent.provides;n===s&&(s=Ye.provides=Object.create(n)),s[e]=t}}function Pt(e,t,s=!1){const n=Ye||Ke;if(n||io){const o=io?io._context.provides:n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(o&&e in o)return o[e];if(arguments.length>1)return s&&we(t)?t.call(n&&n.proxy):t}}const Jc={},Gc=()=>Object.create(Jc),Wc=e=>Object.getPrototypeOf(e)===Jc;function pg(e,t,s,n=!1){const o={},r=Gc();e.propsDefaults=Object.create(null),Hc(e,t,o,r);for(const i in e.propsOptions[0])i in o||(o[i]=void 0);s?e.props=n?o:vc(o):e.type.props?e.props=o:e.props=r,e.attrs=r}function yg(e,t,s,n){const{props:o,attrs:r,vnode:{patchFlag:i}}=e,a=Se(o),[c]=e.propsOptions;let f=!1;if((n||i>0)&&!(i&16)){if(i&8){const u=e.vnode.dynamicProps;for(let d=0;d<u.length;d++){let h=u[d];if(er(e.emitsOptions,h))continue;const g=t[h];if(c)if(Me(r,h))g!==r[h]&&(r[h]=g,f=!0);else{const m=St(h);o[m]=Yr(c,a,m,g,e,!1)}else g!==r[h]&&(r[h]=g,f=!0)}}}else{Hc(e,t,o,r)&&(f=!0);let u;for(const d in a)(!t||!Me(t,d)&&((u=xs(d))===d||!Me(t,u)))&&(c?s&&(s[d]!==void 0||s[u]!==void 0)&&(o[d]=Yr(c,a,d,void 0,e,!0)):delete o[d]);if(r!==a)for(const d in r)(!t||!Me(t,d))&&(delete r[d],f=!0)}f&&Yt(e.attrs,"set","")}function Hc(e,t,s,n){const[o,r]=e.propsOptions;let i=!1,a;if(t)for(let c in t){if(xo(c))continue;const f=t[c];let u;o&&Me(o,u=St(c))?!r||!r.includes(u)?s[u]=f:(a||(a={}))[u]=f:er(e.emitsOptions,c)||(!(c in n)||f!==n[c])&&(n[c]=f,i=!0)}if(r){const c=Se(s),f=a||Oe;for(let u=0;u<r.length;u++){const d=r[u];s[d]=Yr(o,c,d,f[d],e,!Me(f,d))}}return i}function Yr(e,t,s,n,o,r){const i=e[s];if(i!=null){const a=Me(i,"default");if(a&&n===void 0){const c=i.default;if(i.type!==Function&&!i.skipFactory&&we(c)){const{propsDefaults:f}=o;if(s in f)n=f[s];else{const u=en(o);n=f[s]=c.call(null,t),u()}}else n=c;o.ce&&o.ce._setProp(s,n)}i[0]&&(r&&!a?n=!1:i[1]&&(n===""||n===xs(s))&&(n=!0))}return n}const bg=new WeakMap;function Kc(e,t,s=!1){const n=s?bg:t.propsCache,o=n.get(e);if(o)return o;const r=e.props,i={},a=[];let c=!1;if(!we(e)){const u=d=>{c=!0;const[h,g]=Kc(d,t,!0);qe(i,h),g&&a.push(...g)};!s&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!r&&!c)return Le(e)&&n.set(e,eo),eo;if(he(r))for(let u=0;u<r.length;u++){const d=St(r[u]);va(d)&&(i[d]=Oe)}else if(r)for(const u in r){const d=St(u);if(va(d)){const h=r[u],g=i[d]=he(h)||we(h)?{type:h}:qe({},h),m=g.type;let y=!1,p=!0;if(he(m))for(let b=0;b<m.length;++b){const w=m[b],v=we(w)&&w.name;if(v==="Boolean"){y=!0;break}else v==="String"&&(p=!1)}else y=we(m)&&m.name==="Boolean";g[0]=y,g[1]=p,(y||Me(g,"default"))&&a.push(d)}}const f=[i,a];return Le(e)&&n.set(e,f),f}function va(e){return e[0]!=="$"&&!xo(e)}const Qc=e=>e[0]==="_"||e==="$stable",Vi=e=>he(e)?e.map(Vt):[Vt(e)],vg=(e,t,s)=>{if(t._n)return t;const n=it((...o)=>Vi(t(...o)),s);return n._c=!1,n},Yc=(e,t,s)=>{const n=e._ctx;for(const o in e){if(Qc(o))continue;const r=e[o];if(we(r))t[o]=vg(o,r,n);else if(r!=null){const i=Vi(r);t[o]=()=>i}}},Xc=(e,t)=>{const s=Vi(t);e.slots.default=()=>s},Zc=(e,t,s)=>{for(const n in t)(s||n!=="_")&&(e[n]=t[n])},wg=(e,t,s)=>{const n=e.slots=Gc();if(e.vnode.shapeFlag&32){const o=t._;o?(Zc(n,t,s),s&&tc(n,"_",o,!0)):Yc(t,n)}else t&&Xc(e,t)},_g=(e,t,s)=>{const{vnode:n,slots:o}=e;let r=!0,i=Oe;if(n.shapeFlag&32){const a=t._;a?s&&a===1?r=!1:Zc(o,t,s):(r=!t.$stable,Yc(t,o)),i=t}else t&&(Xc(e,t),i={default:1});if(r)for(const a in o)!Qc(a)&&i[a]==null&&delete o[a]},ht=Ng;function Cg(e){return $g(e)}function $g(e,t){const s=Hn();s.__VUE__=!0;const{insert:n,remove:o,patchProp:r,createElement:i,createText:a,createComment:c,setText:f,setElementText:u,parentNode:d,nextSibling:h,setScopeId:g=zt,insertStaticContent:m}=e,y=(_,C,x,P=null,L=null,D=null,H=void 0,K=null,Q=!!C.dynamicChildren)=>{if(_===C)return;_&&!Ns(_,C)&&(P=A(_),V(_,L,D,!0),_=null),C.patchFlag===-2&&(Q=!1,C.dynamicChildren=null);const{type:j,ref:me,shapeFlag:ee}=C;switch(j){case tr:p(_,C,x,P);break;case lt:b(_,C,x,P);break;case vn:_==null&&w(C,x,P,H);break;case ve:M(_,C,x,P,L,D,H,K,Q);break;default:ee&1?$(_,C,x,P,L,D,H,K,Q):ee&6?z(_,C,x,P,L,D,H,K,Q):(ee&64||ee&128)&&j.process(_,C,x,P,L,D,H,K,Q,le)}me!=null&&L&&Pn(me,_&&_.ref,D,C||_,!C)},p=(_,C,x,P)=>{if(_==null)n(C.el=a(C.children),x,P);else{const L=C.el=_.el;C.children!==_.children&&f(L,C.children)}},b=(_,C,x,P)=>{_==null?n(C.el=c(C.children||""),x,P):C.el=_.el},w=(_,C,x,P)=>{[_.el,_.anchor]=m(_.children,C,x,P,_.el,_.anchor)},v=({el:_,anchor:C},x,P)=>{let L;for(;_&&_!==C;)L=h(_),n(_,x,P),_=L;n(C,x,P)},k=({el:_,anchor:C})=>{let x;for(;_&&_!==C;)x=h(_),o(_),_=x;o(C)},$=(_,C,x,P,L,D,H,K,Q)=>{C.type==="svg"?H="svg":C.type==="math"&&(H="mathml"),_==null?I(C,x,P,L,D,H,K,Q):E(_,C,L,D,H,K,Q)},I=(_,C,x,P,L,D,H,K)=>{let Q,j;const{props:me,shapeFlag:ee,transition:fe,dirs:ne}=_;if(Q=_.el=i(_.type,D,me&&me.is,me),ee&8?u(Q,_.children):ee&16&&O(_.children,Q,null,P,L,kr(_,D),H,K),ne&&As(_,null,P,"created"),R(Q,_,_.scopeId,H,P),me){for(const _e in me)_e!=="value"&&!xo(_e)&&r(Q,_e,null,me[_e],D,P);"value"in me&&r(Q,"value",null,me.value,D),(j=me.onVnodeBeforeMount)&&Nt(j,P,_)}ne&&As(_,null,P,"beforeMount");const de=kg(L,fe);de&&fe.beforeEnter(Q),n(Q,C,x),((j=me&&me.onVnodeMounted)||de||ne)&&ht(()=>{j&&Nt(j,P,_),de&&fe.enter(Q),ne&&As(_,null,P,"mounted")},L)},R=(_,C,x,P,L)=>{if(x&&g(_,x),P)for(let D=0;D<P.length;D++)g(_,P[D]);if(L){let D=L.subTree;if(C===D||nu(D.type)&&(D.ssContent===C||D.ssFallback===C)){const H=L.vnode;R(_,H,H.scopeId,H.slotScopeIds,L.parent)}}},O=(_,C,x,P,L,D,H,K,Q=0)=>{for(let j=Q;j<_.length;j++){const me=_[j]=K?hs(_[j]):Vt(_[j]);y(null,me,C,x,P,L,D,H,K)}},E=(_,C,x,P,L,D,H)=>{const K=C.el=_.el;let{patchFlag:Q,dynamicChildren:j,dirs:me}=C;Q|=_.patchFlag&16;const ee=_.props||Oe,fe=C.props||Oe;let ne;if(x&&Es(x,!1),(ne=fe.onVnodeBeforeUpdate)&&Nt(ne,x,C,_),me&&As(C,_,x,"beforeUpdate"),x&&Es(x,!0),(ee.innerHTML&&fe.innerHTML==null||ee.textContent&&fe.textContent==null)&&u(K,""),j?N(_.dynamicChildren,j,K,x,P,kr(C,L),D):H||X(_,C,K,null,x,P,kr(C,L),D,!1),Q>0){if(Q&16)W(K,ee,fe,x,L);else if(Q&2&&ee.class!==fe.class&&r(K,"class",null,fe.class,L),Q&4&&r(K,"style",ee.style,fe.style,L),Q&8){const de=C.dynamicProps;for(let _e=0;_e<de.length;_e++){const be=de[_e],Ge=ee[be],Fe=fe[be];(Fe!==Ge||be==="value")&&r(K,be,Ge,Fe,L,x)}}Q&1&&_.children!==C.children&&u(K,C.children)}else!H&&j==null&&W(K,ee,fe,x,L);((ne=fe.onVnodeUpdated)||me)&&ht(()=>{ne&&Nt(ne,x,C,_),me&&As(C,_,x,"updated")},P)},N=(_,C,x,P,L,D,H)=>{for(let K=0;K<C.length;K++){const Q=_[K],j=C[K],me=Q.el&&(Q.type===ve||!Ns(Q,j)||Q.shapeFlag&70)?d(Q.el):x;y(Q,j,me,null,P,L,D,H,!0)}},W=(_,C,x,P,L)=>{if(C!==x){if(C!==Oe)for(const D in C)!xo(D)&&!(D in x)&&r(_,D,C[D],null,L,P);for(const D in x){if(xo(D))continue;const H=x[D],K=C[D];H!==K&&D!=="value"&&r(_,D,K,H,L,P)}"value"in x&&r(_,"value",C.value,x.value,L)}},M=(_,C,x,P,L,D,H,K,Q)=>{const j=C.el=_?_.el:a(""),me=C.anchor=_?_.anchor:a("");let{patchFlag:ee,dynamicChildren:fe,slotScopeIds:ne}=C;ne&&(K=K?K.concat(ne):ne),_==null?(n(j,x,P),n(me,x,P),O(C.children||[],x,me,L,D,H,K,Q)):ee>0&&ee&64&&fe&&_.dynamicChildren?(N(_.dynamicChildren,fe,x,L,D,H,K),(C.key!=null||L&&C===L.subTree)&&eu(_,C,!0)):X(_,C,x,me,L,D,H,K,Q)},z=(_,C,x,P,L,D,H,K,Q)=>{C.slotScopeIds=K,_==null?C.shapeFlag&512?L.ctx.activate(C,x,P,H,Q):G(C,x,P,L,D,H,Q):pe(_,C,Q)},G=(_,C,x,P,L,D,H)=>{const K=_.component=jg(_,P,L);if(Yn(_)&&(K.ctx.renderer=le),zg(K,!1,H),K.asyncDep){if(L&&L.registerDep(K,$e,H),!_.el){const Q=K.subTree=q(lt);b(null,Q,C,x)}}else $e(K,_,C,x,L,D,H)},pe=(_,C,x)=>{const P=C.component=_.component;if(Og(_,C,x))if(P.asyncDep&&!P.asyncResolved){ye(P,C,x);return}else P.next=C,P.update();else C.el=_.el,P.vnode=C},$e=(_,C,x,P,L,D,H)=>{const K=()=>{if(_.isMounted){let{next:ee,bu:fe,u:ne,parent:de,vnode:_e}=_;{const gt=tu(_);if(gt){ee&&(ee.el=_e.el,ye(_,ee,H)),gt.asyncDep.then(()=>{_.isUnmounted||K()});return}}let be=ee,Ge;Es(_,!1),ee?(ee.el=_e.el,ye(_,ee,H)):ee=_e,fe&&yn(fe),(Ge=ee.props&&ee.props.onVnodeBeforeUpdate)&&Nt(Ge,de,ee,_e),Es(_,!0);const Fe=_a(_),dt=_.subTree;_.subTree=Fe,y(dt,Fe,d(dt.el),A(dt),_,L,D),ee.el=Fe.el,be===null&&Lg(_,Fe.el),ne&&ht(ne,L),(Ge=ee.props&&ee.props.onVnodeUpdated)&&ht(()=>Nt(Ge,de,ee,_e),L)}else{let ee;const{el:fe,props:ne}=C,{bm:de,m:_e,parent:be,root:Ge,type:Fe}=_,dt=no(C);Es(_,!1),de&&yn(de),!dt&&(ee=ne&&ne.onVnodeBeforeMount)&&Nt(ee,be,C),Es(_,!0);{Ge.ce&&Ge.ce._injectChildStyle(Fe);const gt=_.subTree=_a(_);y(null,gt,x,P,_,L,D),C.el=gt.el}if(_e&&ht(_e,L),!dt&&(ee=ne&&ne.onVnodeMounted)){const gt=C;ht(()=>Nt(ee,be,gt),L)}(C.shapeFlag&256||be&&no(be.vnode)&&be.vnode.shapeFlag&256)&&_.a&&ht(_.a,L),_.isMounted=!0,C=x=P=null}};_.scope.on();const Q=_.effect=new rc(K);_.scope.off();const j=_.update=Q.run.bind(Q),me=_.job=Q.runIfDirty.bind(Q);me.i=_,me.id=_.uid,Q.scheduler=()=>Di(me),Es(_,!0),j()},ye=(_,C,x)=>{C.component=_;const P=_.vnode.props;_.vnode=C,_.next=null,yg(_,C.props,P,x),_g(_,C.children,x),Ts(),da(_),Is()},X=(_,C,x,P,L,D,H,K,Q=!1)=>{const j=_&&_.children,me=_?_.shapeFlag:0,ee=C.children,{patchFlag:fe,shapeFlag:ne}=C;if(fe>0){if(fe&128){se(j,ee,x,P,L,D,H,K,Q);return}else if(fe&256){Ee(j,ee,x,P,L,D,H,K,Q);return}}ne&8?(me&16&&ae(j,L,D),ee!==j&&u(x,ee)):me&16?ne&16?se(j,ee,x,P,L,D,H,K,Q):ae(j,L,D,!0):(me&8&&u(x,""),ne&16&&O(ee,x,P,L,D,H,K,Q))},Ee=(_,C,x,P,L,D,H,K,Q)=>{_=_||eo,C=C||eo;const j=_.length,me=C.length,ee=Math.min(j,me);let fe;for(fe=0;fe<ee;fe++){const ne=C[fe]=Q?hs(C[fe]):Vt(C[fe]);y(_[fe],ne,x,null,L,D,H,K,Q)}j>me?ae(_,L,D,!0,!1,ee):O(C,x,P,L,D,H,K,Q,ee)},se=(_,C,x,P,L,D,H,K,Q)=>{let j=0;const me=C.length;let ee=_.length-1,fe=me-1;for(;j<=ee&&j<=fe;){const ne=_[j],de=C[j]=Q?hs(C[j]):Vt(C[j]);if(Ns(ne,de))y(ne,de,x,null,L,D,H,K,Q);else break;j++}for(;j<=ee&&j<=fe;){const ne=_[ee],de=C[fe]=Q?hs(C[fe]):Vt(C[fe]);if(Ns(ne,de))y(ne,de,x,null,L,D,H,K,Q);else break;ee--,fe--}if(j>ee){if(j<=fe){const ne=fe+1,de=ne<me?C[ne].el:P;for(;j<=fe;)y(null,C[j]=Q?hs(C[j]):Vt(C[j]),x,de,L,D,H,K,Q),j++}}else if(j>fe)for(;j<=ee;)V(_[j],L,D,!0),j++;else{const ne=j,de=j,_e=new Map;for(j=de;j<=fe;j++){const Pe=C[j]=Q?hs(C[j]):Vt(C[j]);Pe.key!=null&&_e.set(Pe.key,j)}let be,Ge=0;const Fe=fe-de+1;let dt=!1,gt=0;const Gt=new Array(Fe);for(j=0;j<Fe;j++)Gt[j]=0;for(j=ne;j<=ee;j++){const Pe=_[j];if(Ge>=Fe){V(Pe,L,D,!0);continue}let Qe;if(Pe.key!=null)Qe=_e.get(Pe.key);else for(be=de;be<=fe;be++)if(Gt[be-de]===0&&Ns(Pe,C[be])){Qe=be;break}Qe===void 0?V(Pe,L,D,!0):(Gt[Qe-de]=j+1,Qe>=gt?gt=Qe:dt=!0,y(Pe,C[Qe],x,null,L,D,H,K,Q),Ge++)}const ln=dt?Sg(Gt):eo;for(be=ln.length-1,j=Fe-1;j>=0;j--){const Pe=de+j,Qe=C[Pe],Ps=Pe+1<me?C[Pe+1].el:P;Gt[j]===0?y(null,Qe,x,Ps,L,D,H,K,Q):dt&&(be<0||j!==ln[be]?ke(Qe,x,Ps,2):be--)}}},ke=(_,C,x,P,L=null)=>{const{el:D,type:H,transition:K,children:Q,shapeFlag:j}=_;if(j&6){ke(_.component.subTree,C,x,P);return}if(j&128){_.suspense.move(C,x,P);return}if(j&64){H.move(_,C,x,le);return}if(H===ve){n(D,C,x);for(let ee=0;ee<Q.length;ee++)ke(Q[ee],C,x,P);n(_.anchor,C,x);return}if(H===vn){v(_,C,x);return}if(P!==2&&j&1&&K)if(P===0)K.beforeEnter(D),n(D,C,x),ht(()=>K.enter(D),L);else{const{leave:ee,delayLeave:fe,afterLeave:ne}=K,de=()=>n(D,C,x),_e=()=>{ee(D,()=>{de(),ne&&ne()})};fe?fe(D,de,_e):_e()}else n(D,C,x)},V=(_,C,x,P=!1,L=!1)=>{const{type:D,props:H,ref:K,children:Q,dynamicChildren:j,shapeFlag:me,patchFlag:ee,dirs:fe,cacheIndex:ne}=_;if(ee===-2&&(L=!1),K!=null&&Pn(K,null,x,_,!0),ne!=null&&(C.renderCache[ne]=void 0),me&256){C.ctx.deactivate(_);return}const de=me&1&&fe,_e=!no(_);let be;if(_e&&(be=H&&H.onVnodeBeforeUnmount)&&Nt(be,C,_),me&6)re(_.component,x,P);else{if(me&128){_.suspense.unmount(x,P);return}de&&As(_,null,C,"beforeUnmount"),me&64?_.type.remove(_,C,x,le,P):j&&!j.hasOnce&&(D!==ve||ee>0&&ee&64)?ae(j,C,x,!1,!0):(D===ve&&ee&384||!L&&me&16)&&ae(Q,C,x),P&&B(_)}(_e&&(be=H&&H.onVnodeUnmounted)||de)&&ht(()=>{be&&Nt(be,C,_),de&&As(_,null,C,"unmounted")},x)},B=_=>{const{type:C,el:x,anchor:P,transition:L}=_;if(C===ve){oe(x,P);return}if(C===vn){k(_);return}const D=()=>{o(x),L&&!L.persisted&&L.afterLeave&&L.afterLeave()};if(_.shapeFlag&1&&L&&!L.persisted){const{leave:H,delayLeave:K}=L,Q=()=>H(x,D);K?K(_.el,D,Q):Q()}else D()},oe=(_,C)=>{let x;for(;_!==C;)x=h(_),o(_),_=x;o(C)},re=(_,C,x)=>{const{bum:P,scope:L,job:D,subTree:H,um:K,m:Q,a:j}=_;wa(Q),wa(j),P&&yn(P),L.stop(),D&&(D.flags|=8,V(H,_,C,x)),K&&ht(K,C),ht(()=>{_.isUnmounted=!0},C),C&&C.pendingBranch&&!C.isUnmounted&&_.asyncDep&&!_.asyncResolved&&_.suspenseId===C.pendingId&&(C.deps--,C.deps===0&&C.resolve())},ae=(_,C,x,P=!1,L=!1,D=0)=>{for(let H=D;H<_.length;H++)V(_[H],C,x,P,L)},A=_=>{if(_.shapeFlag&6)return A(_.component.subTree);if(_.shapeFlag&128)return _.suspense.next();const C=h(_.anchor||_.el),x=C&&C[Hd];return x?h(x):C};let Y=!1;const Z=(_,C,x)=>{_==null?C._vnode&&V(C._vnode,null,null,!0):y(C._vnode||null,_,C,null,null,null,x),C._vnode=_,Y||(Y=!0,da(),Sc(),Y=!1)},le={p:y,um:V,m:ke,r:B,mt:G,mc:O,pc:X,pbc:N,n:A,o:e};return{render:Z,hydrate:void 0,createApp:mg(Z)}}function kr({type:e,props:t},s){return s==="svg"&&e==="foreignObject"||s==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:s}function Es({effect:e,job:t},s){s?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function kg(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function eu(e,t,s=!1){const n=e.children,o=t.children;if(he(n)&&he(o))for(let r=0;r<n.length;r++){const i=n[r];let a=o[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=o[r]=hs(o[r]),a.el=i.el),!s&&a.patchFlag!==-2&&eu(i,a)),a.type===tr&&(a.el=i.el)}}function Sg(e){const t=e.slice(),s=[0];let n,o,r,i,a;const c=e.length;for(n=0;n<c;n++){const f=e[n];if(f!==0){if(o=s[s.length-1],e[o]<f){t[n]=o,s.push(n);continue}for(r=0,i=s.length-1;r<i;)a=r+i>>1,e[s[a]]<f?r=a+1:i=a;f<e[s[r]]&&(r>0&&(t[n]=s[r-1]),s[r]=n)}}for(r=s.length,i=s[r-1];r-- >0;)s[r]=i,i=t[i];return s}function tu(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:tu(t)}function wa(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const xg=Symbol.for("v-scx"),Tg=()=>Pt(xg);function Tk(e,t){return Ui(e,null,t)}function bs(e,t,s){return Ui(e,t,s)}function Ui(e,t,s=Oe){const{immediate:n,deep:o,flush:r,once:i}=s,a=qe({},s),c=t&&n||!t&&r!=="post";let f;if(Bo){if(r==="sync"){const g=Tg();f=g.__watcherHandles||(g.__watcherHandles=[])}else if(!c){const g=()=>{};return g.stop=zt,g.resume=zt,g.pause=zt,g}}const u=Ye;a.call=(g,m,y)=>Et(g,u,m,y);let d=!1;r==="post"?a.scheduler=g=>{ht(g,u&&u.suspense)}:r!=="sync"&&(d=!0,a.scheduler=(g,m)=>{m?g():Di(g)}),a.augmentJob=g=>{t&&(g.flags|=4),d&&(g.flags|=2,u&&(g.id=u.uid,g.i=u))};const h=qd(e,t,a);return Bo&&(f?f.push(h):c&&h()),h}function Ig(e,t,s){const n=this.proxy,o=je(e)?e.includes(".")?su(n,e):()=>n[e]:e.bind(n,n);let r;we(t)?r=t:(r=t.handler,s=t);const i=en(this),a=Ui(o,r.bind(n),s);return i(),a}function su(e,t){const s=t.split(".");return()=>{let n=e;for(let o=0;o<s.length&&n;o++)n=n[s[o]];return n}}const Mg=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${St(t)}Modifiers`]||e[`${xs(t)}Modifiers`];function Pg(e,t,...s){if(e.isUnmounted)return;const n=e.vnode.props||Oe;let o=s;const r=t.startsWith("update:"),i=r&&Mg(n,t.slice(7));i&&(i.trim&&(o=s.map(u=>je(u)?u.trim():u)),i.number&&(o=s.map(xn)));let a,c=n[a=pn(t)]||n[a=pn(St(t))];!c&&r&&(c=n[a=pn(xs(t))]),c&&Et(c,e,6,o);const f=n[a+"Once"];if(f){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Et(f,e,6,o)}}function ou(e,t,s=!1){const n=t.emitsCache,o=n.get(e);if(o!==void 0)return o;const r=e.emits;let i={},a=!1;if(!we(e)){const c=f=>{const u=ou(f,t,!0);u&&(a=!0,qe(i,u))};!s&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}return!r&&!a?(Le(e)&&n.set(e,null),null):(he(r)?r.forEach(c=>i[c]=null):qe(i,r),Le(e)&&n.set(e,i),i)}function er(e,t){return!e||!Jn(t)?!1:(t=t.slice(2).replace(/Once$/,""),Me(e,t[0].toLowerCase()+t.slice(1))||Me(e,xs(t))||Me(e,t))}function _a(e){const{type:t,vnode:s,proxy:n,withProxy:o,propsOptions:[r],slots:i,attrs:a,emit:c,render:f,renderCache:u,props:d,data:h,setupState:g,ctx:m,inheritAttrs:y}=e,p=Mn(e);let b,w;try{if(s.shapeFlag&4){const k=o||n,$=k;b=Vt(f.call($,k,u,d,g,h,m)),w=a}else{const k=t;b=Vt(k.length>1?k(d,{attrs:a,slots:i,emit:c}):k(d,null)),w=t.props?a:Ag(a)}}catch(k){Po.length=0,Qn(k,e,1),b=q(lt)}let v=b;if(w&&y!==!1){const k=Object.keys(w),{shapeFlag:$}=v;k.length&&$&7&&(r&&k.some(xi)&&(w=Eg(w,r)),v=vs(v,w,!1,!0))}return s.dirs&&(v=vs(v,null,!1,!0),v.dirs=v.dirs?v.dirs.concat(s.dirs):s.dirs),s.transition&&Bs(v,s.transition),b=v,Mn(p),b}const Ag=e=>{let t;for(const s in e)(s==="class"||s==="style"||Jn(s))&&((t||(t={}))[s]=e[s]);return t},Eg=(e,t)=>{const s={};for(const n in e)(!xi(n)||!(n.slice(9)in t))&&(s[n]=e[n]);return s};function Og(e,t,s){const{props:n,children:o,component:r}=e,{props:i,children:a,patchFlag:c}=t,f=r.emitsOptions;if(t.dirs||t.transition)return!0;if(s&&c>=0){if(c&1024)return!0;if(c&16)return n?Ca(n,i,f):!!i;if(c&8){const u=t.dynamicProps;for(let d=0;d<u.length;d++){const h=u[d];if(i[h]!==n[h]&&!er(f,h))return!0}}}else return(o||a)&&(!a||!a.$stable)?!0:n===i?!1:n?i?Ca(n,i,f):!0:!!i;return!1}function Ca(e,t,s){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let o=0;o<n.length;o++){const r=n[o];if(t[r]!==e[r]&&!er(s,r))return!0}return!1}function Lg({vnode:e,parent:t},s){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===e&&(n.el=e.el),n===e)(e=t.vnode).el=s,t=t.parent;else break}}const nu=e=>e.__isSuspense;function Ng(e,t){t&&t.pendingBranch?he(e)?t.effects.push(...e):t.effects.push(e):Wd(e)}const ve=Symbol.for("v-fgt"),tr=Symbol.for("v-txt"),lt=Symbol.for("v-cmt"),vn=Symbol.for("v-stc"),Po=[];let vt=null;function S(e=!1){Po.push(vt=e?null:[])}function Rg(){Po.pop(),vt=Po[Po.length-1]||null}let Uo=1;function $a(e,t=!1){Uo+=e,e<0&&vt&&t&&(vt.hasOnce=!0)}function ru(e){return e.dynamicChildren=Uo>0?vt||eo:null,Rg(),Uo>0&&vt&&vt.push(e),e}function T(e,t,s,n,o,r){return ru(l(e,t,s,n,o,r,!0))}function Xe(e,t,s,n,o){return ru(q(e,t,s,n,o,!0))}function jo(e){return e?e.__v_isVNode===!0:!1}function Ns(e,t){return e.type===t.type&&e.key===t.key}const iu=({key:e})=>e??null,wn=({ref:e,ref_key:t,ref_for:s})=>(typeof e=="number"&&(e=""+e),e!=null?je(e)||ot(e)||we(e)?{i:Ke,r:e,k:t,f:!!s}:e:null);function l(e,t=null,s=null,n=0,o=null,r=e===ve?0:1,i=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&iu(t),ref:t&&wn(t),scopeId:Tc,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:n,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Ke};return a?(ji(c,s),r&128&&e.normalize(c)):s&&(c.shapeFlag|=je(s)?8:16),Uo>0&&!i&&vt&&(c.patchFlag>0||r&6)&&c.patchFlag!==32&&vt.push(c),c}const q=Dg;function Dg(e,t=null,s=null,n=0,o=null,r=!1){if((!e||e===Vc)&&(e=lt),jo(e)){const a=vs(e,t,!0);return s&&ji(a,s),Uo>0&&!r&&vt&&(a.shapeFlag&6?vt[vt.indexOf(e)]=a:vt.push(a)),a.patchFlag=-2,a}if(Wg(e)&&(e=e.__vccOpts),t){t=Fg(t);let{class:a,style:c}=t;a&&!je(a)&&(t.class=ie(a)),Le(c)&&(Ri(c)&&!he(c)&&(c=qe({},c)),t.style=pt(c))}const i=je(e)?1:nu(e)?128:Ic(e)?64:Le(e)?4:we(e)?2:0;return l(e,t,s,n,o,i,r,!0)}function Fg(e){return e?Ri(e)||Wc(e)?qe({},e):e:null}function vs(e,t,s=!1,n=!1){const{props:o,ref:r,patchFlag:i,children:a,transition:c}=e,f=t?sr(o||{},t):o,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:f,key:f&&iu(f),ref:t&&t.ref?s&&r?he(r)?r.concat(wn(t)):[r,wn(t)]:wn(t):r,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==ve?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:c,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&vs(e.ssContent),ssFallback:e.ssFallback&&vs(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return c&&n&&Bs(u,c.clone(u)),u}function te(e=" ",t=0){return q(tr,null,e,t)}function zo(e,t){const s=q(vn,null,e);return s.staticCount=t,s}function ge(e="",t=!1){return t?(S(),Xe(lt,null,e)):q(lt,null,e)}function Vt(e){return e==null||typeof e=="boolean"?q(lt):he(e)?q(ve,null,e.slice()):jo(e)?hs(e):q(tr,null,String(e))}function hs(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:vs(e)}function ji(e,t){let s=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(he(t))s=16;else if(typeof t=="object")if(n&65){const o=t.default;o&&(o._c&&(o._d=!1),ji(e,o()),o._c&&(o._d=!0));return}else{s=32;const o=t._;!o&&!Wc(t)?t._ctx=Ke:o===3&&Ke&&(Ke.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else we(t)?(t={default:t,_ctx:Ke},s=32):(t=String(t),n&64?(s=16,t=[te(t)]):s=8);e.children=t,e.shapeFlag|=s}function sr(...e){const t={};for(let s=0;s<e.length;s++){const n=e[s];for(const o in n)if(o==="class")t.class!==n.class&&(t.class=ie([t.class,n.class]));else if(o==="style")t.style=pt([t.style,n.style]);else if(Jn(o)){const r=t[o],i=n[o];i&&r!==i&&!(he(r)&&r.includes(i))&&(t[o]=r?[].concat(r,i):i)}else o!==""&&(t[o]=n[o])}return t}function Nt(e,t,s,n=null){Et(e,t,7,[s,n])}const Vg=qc();let Ug=0;function jg(e,t,s){const n=e.type,o=(t?t.appContext:e.appContext)||Vg,r={uid:Ug++,vnode:e,type:n,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new yd(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Kc(n,o),emitsOptions:ou(n,o),emit:null,emitted:null,propsDefaults:Oe,inheritAttrs:n.inheritAttrs,ctx:Oe,data:Oe,props:Oe,attrs:Oe,slots:Oe,refs:Oe,setupState:Oe,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=Pg.bind(null,r),e.ce&&e.ce(r),r}let Ye=null;const zi=()=>Ye||Ke;let En,Xr;{const e=Hn(),t=(s,n)=>{let o;return(o=e[s])||(o=e[s]=[]),o.push(n),r=>{o.length>1?o.forEach(i=>i(r)):o[0](r)}};En=t("__VUE_INSTANCE_SETTERS__",s=>Ye=s),Xr=t("__VUE_SSR_SETTERS__",s=>Bo=s)}const en=e=>{const t=Ye;return En(e),e.scope.on(),()=>{e.scope.off(),En(t)}},ka=()=>{Ye&&Ye.scope.off(),En(null)};function au(e){return e.vnode.shapeFlag&4}let Bo=!1;function zg(e,t=!1,s=!1){t&&Xr(t);const{props:n,children:o}=e.vnode,r=au(e);pg(e,n,r,t),wg(e,o,s);const i=r?Bg(e,t):void 0;return t&&Xr(!1),i}function Bg(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,lg);const{setup:n}=s;if(n){Ts();const o=e.setupContext=n.length>1?Jg(e):null,r=en(e),i=Xo(n,e,0,[e.props,o]),a=Xl(i);if(Is(),r(),(a||e.sp)&&!no(e)&&Lc(e),a){if(i.then(ka,ka),t)return i.then(c=>{Sa(e,c)}).catch(c=>{Qn(c,e,0)});e.asyncDep=i}else Sa(e,i)}else lu(e)}function Sa(e,t,s){we(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Le(t)&&(e.setupState=Cc(t)),lu(e)}function lu(e,t,s){const n=e.type;e.render||(e.render=n.render||zt);{const o=en(e);Ts();try{cg(e)}finally{Is(),o()}}}const qg={get(e,t){return et(e,"get",""),e[t]}};function Jg(e){const t=s=>{e.exposed=s||{}};return{attrs:new Proxy(e.attrs,qg),slots:e.slots,emit:e.emit,expose:t}}function or(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Cc(Dd(e.exposed)),{get(t,s){if(s in t)return t[s];if(s in Mo)return Mo[s](e)},has(t,s){return s in t||s in Mo}})):e.proxy}function Gg(e,t=!0){return we(e)?e.displayName||e.name:e.name||t&&e.__name}function Wg(e){return we(e)&&"__vccOpts"in e}const He=(e,t)=>zd(e,t,Bo);function nr(e,t,s){const n=arguments.length;return n===2?Le(t)&&!he(t)?jo(t)?q(e,null,[t]):q(e,t):q(e,null,t):(n>3?s=Array.prototype.slice.call(arguments,2):n===3&&jo(s)&&(s=[s]),q(e,t,s))}const Hg="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Zr;const xa=typeof window<"u"&&window.trustedTypes;if(xa)try{Zr=xa.createPolicy("vue",{createHTML:e=>e})}catch{}const cu=Zr?e=>Zr.createHTML(e):e=>e,Kg="http://www.w3.org/2000/svg",Qg="http://www.w3.org/1998/Math/MathML",Kt=typeof document<"u"?document:null,Ta=Kt&&Kt.createElement("template"),Yg={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,n)=>{const o=t==="svg"?Kt.createElementNS(Kg,e):t==="mathml"?Kt.createElementNS(Qg,e):s?Kt.createElement(e,{is:s}):Kt.createElement(e);return e==="select"&&n&&n.multiple!=null&&o.setAttribute("multiple",n.multiple),o},createText:e=>Kt.createTextNode(e),createComment:e=>Kt.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Kt.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,s,n,o,r){const i=s?s.previousSibling:t.lastChild;if(o&&(o===r||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),s),!(o===r||!(o=o.nextSibling)););else{Ta.innerHTML=cu(n==="svg"?`<svg>${e}</svg>`:n==="mathml"?`<math>${e}</math>`:e);const a=Ta.content;if(n==="svg"||n==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}t.insertBefore(a,s)}return[i?i.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}},ls="transition",wo="animation",uo=Symbol("_vtc"),uu={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},fu=qe({},Pc,uu),Xg=e=>(e.displayName="Transition",e.props=fu,e),Zg=Xg((e,{slots:t})=>nr(Qd,du(e),t)),Os=(e,t=[])=>{he(e)?e.forEach(s=>s(...t)):e&&e(...t)},Ia=e=>e?he(e)?e.some(t=>t.length>1):e.length>1:!1;function du(e){const t={};for(const M in e)M in uu||(t[M]=e[M]);if(e.css===!1)return t;const{name:s="v",type:n,duration:o,enterFromClass:r=`${s}-enter-from`,enterActiveClass:i=`${s}-enter-active`,enterToClass:a=`${s}-enter-to`,appearFromClass:c=r,appearActiveClass:f=i,appearToClass:u=a,leaveFromClass:d=`${s}-leave-from`,leaveActiveClass:h=`${s}-leave-active`,leaveToClass:g=`${s}-leave-to`}=e,m=eh(o),y=m&&m[0],p=m&&m[1],{onBeforeEnter:b,onEnter:w,onEnterCancelled:v,onLeave:k,onLeaveCancelled:$,onBeforeAppear:I=b,onAppear:R=w,onAppearCancelled:O=v}=t,E=(M,z,G,pe)=>{M._enterCancelled=pe,fs(M,z?u:a),fs(M,z?f:i),G&&G()},N=(M,z)=>{M._isLeaving=!1,fs(M,d),fs(M,g),fs(M,h),z&&z()},W=M=>(z,G)=>{const pe=M?R:w,$e=()=>E(z,M,G);Os(pe,[z,$e]),Ma(()=>{fs(z,M?c:r),Dt(z,M?u:a),Ia(pe)||Pa(z,n,y,$e)})};return qe(t,{onBeforeEnter(M){Os(b,[M]),Dt(M,r),Dt(M,i)},onBeforeAppear(M){Os(I,[M]),Dt(M,c),Dt(M,f)},onEnter:W(!1),onAppear:W(!0),onLeave(M,z){M._isLeaving=!0;const G=()=>N(M,z);Dt(M,d),M._enterCancelled?(Dt(M,h),ei()):(ei(),Dt(M,h)),Ma(()=>{M._isLeaving&&(fs(M,d),Dt(M,g),Ia(k)||Pa(M,n,p,G))}),Os(k,[M,G])},onEnterCancelled(M){E(M,!1,void 0,!0),Os(v,[M])},onAppearCancelled(M){E(M,!0,void 0,!0),Os(O,[M])},onLeaveCancelled(M){N(M),Os($,[M])}})}function eh(e){if(e==null)return null;if(Le(e))return[Sr(e.enter),Sr(e.leave)];{const t=Sr(e);return[t,t]}}function Sr(e){return cd(e)}function Dt(e,t){t.split(/\s+/).forEach(s=>s&&e.classList.add(s)),(e[uo]||(e[uo]=new Set)).add(t)}function fs(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.remove(n));const s=e[uo];s&&(s.delete(t),s.size||(e[uo]=void 0))}function Ma(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let th=0;function Pa(e,t,s,n){const o=e._endId=++th,r=()=>{o===e._endId&&n()};if(s!=null)return setTimeout(r,s);const{type:i,timeout:a,propCount:c}=gu(e,t);if(!i)return n();const f=i+"end";let u=0;const d=()=>{e.removeEventListener(f,h),r()},h=g=>{g.target===e&&++u>=c&&d()};setTimeout(()=>{u<c&&d()},a+1),e.addEventListener(f,h)}function gu(e,t){const s=window.getComputedStyle(e),n=m=>(s[m]||"").split(", "),o=n(`${ls}Delay`),r=n(`${ls}Duration`),i=Aa(o,r),a=n(`${wo}Delay`),c=n(`${wo}Duration`),f=Aa(a,c);let u=null,d=0,h=0;t===ls?i>0&&(u=ls,d=i,h=r.length):t===wo?f>0&&(u=wo,d=f,h=c.length):(d=Math.max(i,f),u=d>0?i>f?ls:wo:null,h=u?u===ls?r.length:c.length:0);const g=u===ls&&/\b(transform|all)(,|$)/.test(n(`${ls}Property`).toString());return{type:u,timeout:d,propCount:h,hasTransform:g}}function Aa(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((s,n)=>Ea(s)+Ea(e[n])))}function Ea(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function ei(){return document.body.offsetHeight}function sh(e,t,s){const n=e[uo];n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}const On=Symbol("_vod"),hu=Symbol("_vsh"),Xs={beforeMount(e,{value:t},{transition:s}){e[On]=e.style.display==="none"?"":e.style.display,s&&t?s.beforeEnter(e):_o(e,t)},mounted(e,{value:t},{transition:s}){s&&t&&s.enter(e)},updated(e,{value:t,oldValue:s},{transition:n}){!t!=!s&&(n?t?(n.beforeEnter(e),_o(e,!0),n.enter(e)):n.leave(e,()=>{_o(e,!1)}):_o(e,t))},beforeUnmount(e,{value:t}){_o(e,t)}};function _o(e,t){e.style.display=t?e[On]:"none",e[hu]=!t}const oh=Symbol(""),nh=/(^|;)\s*display\s*:/;function rh(e,t,s){const n=e.style,o=je(s);let r=!1;if(s&&!o){if(t)if(je(t))for(const i of t.split(";")){const a=i.slice(0,i.indexOf(":")).trim();s[a]==null&&_n(n,a,"")}else for(const i in t)s[i]==null&&_n(n,i,"");for(const i in s)i==="display"&&(r=!0),_n(n,i,s[i])}else if(o){if(t!==s){const i=n[oh];i&&(s+=";"+i),n.cssText=s,r=nh.test(s)}}else t&&e.removeAttribute("style");On in e&&(e[On]=r?n.display:"",e[hu]&&(n.display="none"))}const Oa=/\s*!important$/;function _n(e,t,s){if(he(s))s.forEach(n=>_n(e,t,n));else if(s==null&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const n=ih(e,t);Oa.test(s)?e.setProperty(xs(n),s.replace(Oa,""),"important"):e[n]=s}}const La=["Webkit","Moz","ms"],xr={};function ih(e,t){const s=xr[t];if(s)return s;let n=St(t);if(n!=="filter"&&n in e)return xr[t]=n;n=Wn(n);for(let o=0;o<La.length;o++){const r=La[o]+n;if(r in e)return xr[t]=r}return t}const Na="http://www.w3.org/1999/xlink";function Ra(e,t,s,n,o,r=md(t)){n&&t.startsWith("xlink:")?s==null?e.removeAttributeNS(Na,t.slice(6,t.length)):e.setAttributeNS(Na,t,s):s==null||r&&!sc(s)?e.removeAttribute(t):e.setAttribute(t,r?"":At(s)?String(s):s)}function Da(e,t,s,n,o){if(t==="innerHTML"||t==="textContent"){s!=null&&(e[t]=t==="innerHTML"?cu(s):s);return}const r=e.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?e.getAttribute("value")||"":e.value,c=s==null?e.type==="checkbox"?"on":"":String(s);(a!==c||!("_value"in e))&&(e.value=c),s==null&&e.removeAttribute(t),e._value=s;return}let i=!1;if(s===""||s==null){const a=typeof e[t];a==="boolean"?s=sc(s):s==null&&a==="string"?(s="",i=!0):a==="number"&&(s=0,i=!0)}try{e[t]=s}catch{}i&&e.removeAttribute(o||t)}function Zt(e,t,s,n){e.addEventListener(t,s,n)}function ah(e,t,s,n){e.removeEventListener(t,s,n)}const Fa=Symbol("_vei");function lh(e,t,s,n,o=null){const r=e[Fa]||(e[Fa]={}),i=r[t];if(n&&i)i.value=n;else{const[a,c]=ch(t);if(n){const f=r[t]=dh(n,o);Zt(e,a,f,c)}else i&&(ah(e,a,i,c),r[t]=void 0)}}const Va=/(?:Once|Passive|Capture)$/;function ch(e){let t;if(Va.test(e)){t={};let n;for(;n=e.match(Va);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):xs(e.slice(2)),t]}let Tr=0;const uh=Promise.resolve(),fh=()=>Tr||(uh.then(()=>Tr=0),Tr=Date.now());function dh(e,t){const s=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=s.attached)return;Et(gh(n,s.value),t,5,[n])};return s.value=e,s.attached=fh(),s}function gh(e,t){if(he(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map(n=>o=>!o._stopped&&n&&n(o))}else return t}const Ua=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,hh=(e,t,s,n,o,r)=>{const i=o==="svg";t==="class"?sh(e,n,i):t==="style"?rh(e,s,n):Jn(t)?xi(t)||lh(e,t,s,n,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):mh(e,t,n,i))?(Da(e,t,n),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Ra(e,t,n,i,r,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!je(n))?Da(e,St(t),n,r,t):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),Ra(e,t,n,i))};function mh(e,t,s,n){if(n)return!!(t==="innerHTML"||t==="textContent"||t in e&&Ua(t)&&we(s));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const o=e.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return Ua(t)&&je(s)?!1:t in e}const mu=new WeakMap,pu=new WeakMap,Ln=Symbol("_moveCb"),ja=Symbol("_enterCb"),ph=e=>(delete e.props.mode,e),yh=ph({name:"TransitionGroup",props:qe({},fu,{tag:String,moveClass:String}),setup(e,{slots:t}){const s=zi(),n=Mc();let o,r;return Rc(()=>{if(!o.length)return;const i=e.moveClass||`${e.name||"v"}-move`;if(!Ch(o[0].el,s.vnode.el,i))return;o.forEach(vh),o.forEach(wh);const a=o.filter(_h);ei(),a.forEach(c=>{const f=c.el,u=f.style;Dt(f,i),u.transform=u.webkitTransform=u.transitionDuration="";const d=f[Ln]=h=>{h&&h.target!==f||(!h||/transform$/.test(h.propertyName))&&(f.removeEventListener("transitionend",d),f[Ln]=null,fs(f,i))};f.addEventListener("transitionend",d)})}),()=>{const i=Se(e),a=du(i);let c=i.tag||ve;if(o=[],r)for(let f=0;f<r.length;f++){const u=r[f];u.el&&u.el instanceof Element&&(o.push(u),Bs(u,Vo(u,a,n,s)),mu.set(u,u.el.getBoundingClientRect()))}r=t.default?Fi(t.default()):[];for(let f=0;f<r.length;f++){const u=r[f];u.key!=null&&Bs(u,Vo(u,a,n,s))}return q(c,null,r)}}}),bh=yh;function vh(e){const t=e.el;t[Ln]&&t[Ln](),t[ja]&&t[ja]()}function wh(e){pu.set(e,e.el.getBoundingClientRect())}function _h(e){const t=mu.get(e),s=pu.get(e),n=t.left-s.left,o=t.top-s.top;if(n||o){const r=e.el.style;return r.transform=r.webkitTransform=`translate(${n}px,${o}px)`,r.transitionDuration="0s",e}}function Ch(e,t,s){const n=e.cloneNode(),o=e[uo];o&&o.forEach(a=>{a.split(/\s+/).forEach(c=>c&&n.classList.remove(c))}),s.split(/\s+/).forEach(a=>a&&n.classList.add(a)),n.style.display="none";const r=t.nodeType===1?t:t.parentNode;r.appendChild(n);const{hasTransform:i}=gu(n);return r.removeChild(n),i}const ws=e=>{const t=e.props["onUpdate:modelValue"]||!1;return he(t)?s=>yn(t,s):t};function $h(e){e.target.composing=!0}function za(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const kt=Symbol("_assign"),ue={created(e,{modifiers:{lazy:t,trim:s,number:n}},o){e[kt]=ws(o);const r=n||o.props&&o.props.type==="number";Zt(e,t?"change":"input",i=>{if(i.target.composing)return;let a=e.value;s&&(a=a.trim()),r&&(a=xn(a)),e[kt](a)}),s&&Zt(e,"change",()=>{e.value=e.value.trim()}),t||(Zt(e,"compositionstart",$h),Zt(e,"compositionend",za),Zt(e,"change",za))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:s,modifiers:{lazy:n,trim:o,number:r}},i){if(e[kt]=ws(i),e.composing)return;const a=(r||e.type==="number")&&!/^0\d/.test(e.value)?xn(e.value):e.value,c=t??"";a!==c&&(document.activeElement===e&&e.type!=="range"&&(n&&t===s||o&&e.value.trim()===c)||(e.value=c))}},Ve={deep:!0,created(e,t,s){e[kt]=ws(s),Zt(e,"change",()=>{const n=e._modelValue,o=fo(e),r=e.checked,i=e[kt];if(he(n)){const a=Mi(n,o),c=a!==-1;if(r&&!c)i(n.concat(o));else if(!r&&c){const f=[...n];f.splice(a,1),i(f)}}else if(po(n)){const a=new Set(n);r?a.add(o):a.delete(o),i(a)}else i(yu(e,r))})},mounted:Ba,beforeUpdate(e,t,s){e[kt]=ws(s),Ba(e,t,s)}};function Ba(e,{value:t,oldValue:s},n){e._modelValue=t;let o;if(he(t))o=Mi(t,n.props.value)>-1;else if(po(t))o=t.has(n.props.value);else{if(t===s)return;o=js(t,yu(e,!0))}e.checked!==o&&(e.checked=o)}const kh={created(e,{value:t},s){e.checked=js(t,s.props.value),e[kt]=ws(s),Zt(e,"change",()=>{e[kt](fo(e))})},beforeUpdate(e,{value:t,oldValue:s},n){e[kt]=ws(n),t!==s&&(e.checked=js(t,n.props.value))}},Ue={deep:!0,created(e,{value:t,modifiers:{number:s}},n){const o=po(t);Zt(e,"change",()=>{const r=Array.prototype.filter.call(e.options,i=>i.selected).map(i=>s?xn(fo(i)):fo(i));e[kt](e.multiple?o?new Set(r):r:r[0]),e._assigning=!0,co(()=>{e._assigning=!1})}),e[kt]=ws(n)},mounted(e,{value:t}){qa(e,t)},beforeUpdate(e,t,s){e[kt]=ws(s)},updated(e,{value:t}){e._assigning||qa(e,t)}};function qa(e,t){const s=e.multiple,n=he(t);if(!(s&&!n&&!po(t))){for(let o=0,r=e.options.length;o<r;o++){const i=e.options[o],a=fo(i);if(s)if(n){const c=typeof a;c==="string"||c==="number"?i.selected=t.some(f=>String(f)===String(a)):i.selected=Mi(t,a)>-1}else i.selected=t.has(a);else if(js(fo(i),t)){e.selectedIndex!==o&&(e.selectedIndex=o);return}}!s&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function fo(e){return"_value"in e?e._value:e.value}function yu(e,t){const s=t?"_trueValue":"_falseValue";return s in e?e[s]:t}const Sh={created(e,t,s){gn(e,t,s,null,"created")},mounted(e,t,s){gn(e,t,s,null,"mounted")},beforeUpdate(e,t,s,n){gn(e,t,s,n,"beforeUpdate")},updated(e,t,s,n){gn(e,t,s,n,"updated")}};function xh(e,t){switch(e){case"SELECT":return Ue;case"TEXTAREA":return ue;default:switch(t){case"checkbox":return Ve;case"radio":return kh;default:return ue}}}function gn(e,t,s,n,o){const i=xh(e.tagName,s.props&&s.props.type)[o];i&&i(e,t,s,n)}const Th=["ctrl","shift","alt","meta"],Ih={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Th.some(s=>e[`${s}Key`]&&!t.includes(s))},ft=(e,t)=>{const s=e._withMods||(e._withMods={}),n=t.join(".");return s[n]||(s[n]=(o,...r)=>{for(let i=0;i<t.length;i++){const a=Ih[t[i]];if(a&&a(o,t))return}return e(o,...r)})},Mh={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},qo=(e,t)=>{const s=e._withKeys||(e._withKeys={}),n=t.join(".");return s[n]||(s[n]=o=>{if(!("key"in o))return;const r=xs(o.key);if(t.some(i=>i===r||Mh[i]===r))return e(o)})},Ph=qe({patchProp:hh},Yg);let Ja;function Ah(){return Ja||(Ja=Cg(Ph))}const bu=(...e)=>{const t=Ah().createApp(...e),{mount:s}=t;return t.mount=n=>{const o=Oh(n);if(!o)return;const r=t._component;!we(r)&&!r.render&&!r.template&&(r.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const i=s(o,!1,Eh(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),i},t};function Eh(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Oh(e){return je(e)?document.querySelector(e):e}/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Qs=typeof document<"u";function vu(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Lh(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&vu(e.default)}const Ie=Object.assign;function Ir(e,t){const s={};for(const n in t){const o=t[n];s[n]=Ot(o)?o.map(e):e(o)}return s}const Ao=()=>{},Ot=Array.isArray,wu=/#/g,Nh=/&/g,Rh=/\//g,Dh=/=/g,Fh=/\?/g,_u=/\+/g,Vh=/%5B/g,Uh=/%5D/g,Cu=/%5E/g,jh=/%60/g,$u=/%7B/g,zh=/%7C/g,ku=/%7D/g,Bh=/%20/g;function Bi(e){return encodeURI(""+e).replace(zh,"|").replace(Vh,"[").replace(Uh,"]")}function qh(e){return Bi(e).replace($u,"{").replace(ku,"}").replace(Cu,"^")}function ti(e){return Bi(e).replace(_u,"%2B").replace(Bh,"+").replace(wu,"%23").replace(Nh,"%26").replace(jh,"`").replace($u,"{").replace(ku,"}").replace(Cu,"^")}function Jh(e){return ti(e).replace(Dh,"%3D")}function Gh(e){return Bi(e).replace(wu,"%23").replace(Fh,"%3F")}function Wh(e){return e==null?"":Gh(e).replace(Rh,"%2F")}function Jo(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const Hh=/\/$/,Kh=e=>e.replace(Hh,"");function Mr(e,t,s="/"){let n,o={},r="",i="";const a=t.indexOf("#");let c=t.indexOf("?");return a<c&&a>=0&&(c=-1),c>-1&&(n=t.slice(0,c),r=t.slice(c+1,a>-1?a:t.length),o=e(r)),a>-1&&(n=n||t.slice(0,a),i=t.slice(a,t.length)),n=Zh(n??t,s),{fullPath:n+(r&&"?")+r+i,path:n,query:o,hash:Jo(i)}}function Qh(e,t){const s=t.query?e(t.query):"";return t.path+(s&&"?")+s+(t.hash||"")}function Ga(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Yh(e,t,s){const n=t.matched.length-1,o=s.matched.length-1;return n>-1&&n===o&&go(t.matched[n],s.matched[o])&&Su(t.params,s.params)&&e(t.query)===e(s.query)&&t.hash===s.hash}function go(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Su(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(!Xh(e[s],t[s]))return!1;return!0}function Xh(e,t){return Ot(e)?Wa(e,t):Ot(t)?Wa(t,e):e===t}function Wa(e,t){return Ot(t)?e.length===t.length&&e.every((s,n)=>s===t[n]):e.length===1&&e[0]===t}function Zh(e,t){if(e.startsWith("/"))return e;if(!e)return t;const s=t.split("/"),n=e.split("/"),o=n[n.length-1];(o===".."||o===".")&&n.push("");let r=s.length-1,i,a;for(i=0;i<n.length;i++)if(a=n[i],a!==".")if(a==="..")r>1&&r--;else break;return s.slice(0,r).join("/")+"/"+n.slice(i).join("/")}const cs={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Go;(function(e){e.pop="pop",e.push="push"})(Go||(Go={}));var Eo;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Eo||(Eo={}));function em(e){if(!e)if(Qs){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Kh(e)}const tm=/^[^#]+#/;function sm(e,t){return e.replace(tm,"#")+t}function om(e,t){const s=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-s.left-(t.left||0),top:n.top-s.top-(t.top||0)}}const rr=()=>({left:window.scrollX,top:window.scrollY});function nm(e){let t;if("el"in e){const s=e.el,n=typeof s=="string"&&s.startsWith("#"),o=typeof s=="string"?n?document.getElementById(s.slice(1)):document.querySelector(s):s;if(!o)return;t=om(o,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function Ha(e,t){return(history.state?history.state.position-t:-1)+e}const si=new Map;function rm(e,t){si.set(e,t)}function im(e){const t=si.get(e);return si.delete(e),t}let am=()=>location.protocol+"//"+location.host;function xu(e,t){const{pathname:s,search:n,hash:o}=t,r=e.indexOf("#");if(r>-1){let a=o.includes(e.slice(r))?e.slice(r).length:1,c=o.slice(a);return c[0]!=="/"&&(c="/"+c),Ga(c,"")}return Ga(s,e)+n+o}function lm(e,t,s,n){let o=[],r=[],i=null;const a=({state:h})=>{const g=xu(e,location),m=s.value,y=t.value;let p=0;if(h){if(s.value=g,t.value=h,i&&i===m){i=null;return}p=y?h.position-y.position:0}else n(g);o.forEach(b=>{b(s.value,m,{delta:p,type:Go.pop,direction:p?p>0?Eo.forward:Eo.back:Eo.unknown})})};function c(){i=s.value}function f(h){o.push(h);const g=()=>{const m=o.indexOf(h);m>-1&&o.splice(m,1)};return r.push(g),g}function u(){const{history:h}=window;h.state&&h.replaceState(Ie({},h.state,{scroll:rr()}),"")}function d(){for(const h of r)h();r=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:c,listen:f,destroy:d}}function Ka(e,t,s,n=!1,o=!1){return{back:e,current:t,forward:s,replaced:n,position:window.history.length,scroll:o?rr():null}}function cm(e){const{history:t,location:s}=window,n={value:xu(e,s)},o={value:t.state};o.value||r(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function r(c,f,u){const d=e.indexOf("#"),h=d>-1?(s.host&&document.querySelector("base")?e:e.slice(d))+c:am()+e+c;try{t[u?"replaceState":"pushState"](f,"",h),o.value=f}catch(g){console.error(g),s[u?"replace":"assign"](h)}}function i(c,f){const u=Ie({},t.state,Ka(o.value.back,c,o.value.forward,!0),f,{position:o.value.position});r(c,u,!0),n.value=c}function a(c,f){const u=Ie({},o.value,t.state,{forward:c,scroll:rr()});r(u.current,u,!0);const d=Ie({},Ka(n.value,c,null),{position:u.position+1},f);r(c,d,!1),n.value=c}return{location:n,state:o,push:a,replace:i}}function um(e){e=em(e);const t=cm(e),s=lm(e,t.state,t.location,t.replace);function n(r,i=!0){i||s.pauseListeners(),history.go(r)}const o=Ie({location:"",base:e,go:n,createHref:sm.bind(null,e)},t,s);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>t.state.value}),o}function fm(e){return typeof e=="string"||e&&typeof e=="object"}function Tu(e){return typeof e=="string"||typeof e=="symbol"}const Iu=Symbol("");var Qa;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Qa||(Qa={}));function ho(e,t){return Ie(new Error,{type:e,[Iu]:!0},t)}function Ht(e,t){return e instanceof Error&&Iu in e&&(t==null||!!(e.type&t))}const Ya="[^/]+?",dm={sensitive:!1,strict:!1,start:!0,end:!0},gm=/[.+*?^${}()[\]/\\]/g;function hm(e,t){const s=Ie({},dm,t),n=[];let o=s.start?"^":"";const r=[];for(const f of e){const u=f.length?[]:[90];s.strict&&!f.length&&(o+="/");for(let d=0;d<f.length;d++){const h=f[d];let g=40+(s.sensitive?.25:0);if(h.type===0)d||(o+="/"),o+=h.value.replace(gm,"\\$&"),g+=40;else if(h.type===1){const{value:m,repeatable:y,optional:p,regexp:b}=h;r.push({name:m,repeatable:y,optional:p});const w=b||Ya;if(w!==Ya){g+=10;try{new RegExp(`(${w})`)}catch(k){throw new Error(`Invalid custom RegExp for param "${m}" (${w}): `+k.message)}}let v=y?`((?:${w})(?:/(?:${w}))*)`:`(${w})`;d||(v=p&&f.length<2?`(?:/${v})`:"/"+v),p&&(v+="?"),o+=v,g+=20,p&&(g+=-8),y&&(g+=-20),w===".*"&&(g+=-50)}u.push(g)}n.push(u)}if(s.strict&&s.end){const f=n.length-1;n[f][n[f].length-1]+=.7000000000000001}s.strict||(o+="/?"),s.end?o+="$":s.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const i=new RegExp(o,s.sensitive?"":"i");function a(f){const u=f.match(i),d={};if(!u)return null;for(let h=1;h<u.length;h++){const g=u[h]||"",m=r[h-1];d[m.name]=g&&m.repeatable?g.split("/"):g}return d}function c(f){let u="",d=!1;for(const h of e){(!d||!u.endsWith("/"))&&(u+="/"),d=!1;for(const g of h)if(g.type===0)u+=g.value;else if(g.type===1){const{value:m,repeatable:y,optional:p}=g,b=m in f?f[m]:"";if(Ot(b)&&!y)throw new Error(`Provided param "${m}" is an array but it is not repeatable (* or + modifiers)`);const w=Ot(b)?b.join("/"):b;if(!w)if(p)h.length<2&&(u.endsWith("/")?u=u.slice(0,-1):d=!0);else throw new Error(`Missing required param "${m}"`);u+=w}}return u||"/"}return{re:i,score:n,keys:r,parse:a,stringify:c}}function mm(e,t){let s=0;for(;s<e.length&&s<t.length;){const n=t[s]-e[s];if(n)return n;s++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function Mu(e,t){let s=0;const n=e.score,o=t.score;for(;s<n.length&&s<o.length;){const r=mm(n[s],o[s]);if(r)return r;s++}if(Math.abs(o.length-n.length)===1){if(Xa(n))return 1;if(Xa(o))return-1}return o.length-n.length}function Xa(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const pm={type:0,value:""},ym=/[a-zA-Z0-9_]/;function bm(e){if(!e)return[[]];if(e==="/")return[[pm]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(g){throw new Error(`ERR (${s})/"${f}": ${g}`)}let s=0,n=s;const o=[];let r;function i(){r&&o.push(r),r=[]}let a=0,c,f="",u="";function d(){f&&(s===0?r.push({type:0,value:f}):s===1||s===2||s===3?(r.length>1&&(c==="*"||c==="+")&&t(`A repeatable param (${f}) must be alone in its segment. eg: '/:ids+.`),r.push({type:1,value:f,regexp:u,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):t("Invalid state to consume buffer"),f="")}function h(){f+=c}for(;a<e.length;){if(c=e[a++],c==="\\"&&s!==2){n=s,s=4;continue}switch(s){case 0:c==="/"?(f&&d(),i()):c===":"?(d(),s=1):h();break;case 4:h(),s=n;break;case 1:c==="("?s=2:ym.test(c)?h():(d(),s=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+c:s=3:u+=c;break;case 3:d(),s=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,u="";break;default:t("Unknown state");break}}return s===2&&t(`Unfinished custom RegExp for param "${f}"`),d(),i(),o}function vm(e,t,s){const n=hm(bm(e.path),s),o=Ie(n,{record:e,parent:t,children:[],alias:[]});return t&&!o.record.aliasOf==!t.record.aliasOf&&t.children.push(o),o}function wm(e,t){const s=[],n=new Map;t=sl({strict:!1,end:!0,sensitive:!1},t);function o(d){return n.get(d)}function r(d,h,g){const m=!g,y=el(d);y.aliasOf=g&&g.record;const p=sl(t,d),b=[y];if("alias"in d){const k=typeof d.alias=="string"?[d.alias]:d.alias;for(const $ of k)b.push(el(Ie({},y,{components:g?g.record.components:y.components,path:$,aliasOf:g?g.record:y})))}let w,v;for(const k of b){const{path:$}=k;if(h&&$[0]!=="/"){const I=h.record.path,R=I[I.length-1]==="/"?"":"/";k.path=h.record.path+($&&R+$)}if(w=vm(k,h,p),g?g.alias.push(w):(v=v||w,v!==w&&v.alias.push(w),m&&d.name&&!tl(w)&&i(d.name)),Pu(w)&&c(w),y.children){const I=y.children;for(let R=0;R<I.length;R++)r(I[R],w,g&&g.children[R])}g=g||w}return v?()=>{i(v)}:Ao}function i(d){if(Tu(d)){const h=n.get(d);h&&(n.delete(d),s.splice(s.indexOf(h),1),h.children.forEach(i),h.alias.forEach(i))}else{const h=s.indexOf(d);h>-1&&(s.splice(h,1),d.record.name&&n.delete(d.record.name),d.children.forEach(i),d.alias.forEach(i))}}function a(){return s}function c(d){const h=$m(d,s);s.splice(h,0,d),d.record.name&&!tl(d)&&n.set(d.record.name,d)}function f(d,h){let g,m={},y,p;if("name"in d&&d.name){if(g=n.get(d.name),!g)throw ho(1,{location:d});p=g.record.name,m=Ie(Za(h.params,g.keys.filter(v=>!v.optional).concat(g.parent?g.parent.keys.filter(v=>v.optional):[]).map(v=>v.name)),d.params&&Za(d.params,g.keys.map(v=>v.name))),y=g.stringify(m)}else if(d.path!=null)y=d.path,g=s.find(v=>v.re.test(y)),g&&(m=g.parse(y),p=g.record.name);else{if(g=h.name?n.get(h.name):s.find(v=>v.re.test(h.path)),!g)throw ho(1,{location:d,currentLocation:h});p=g.record.name,m=Ie({},h.params,d.params),y=g.stringify(m)}const b=[];let w=g;for(;w;)b.unshift(w.record),w=w.parent;return{name:p,path:y,params:m,matched:b,meta:Cm(b)}}e.forEach(d=>r(d));function u(){s.length=0,n.clear()}return{addRoute:r,resolve:f,removeRoute:i,clearRoutes:u,getRoutes:a,getRecordMatcher:o}}function Za(e,t){const s={};for(const n of t)n in e&&(s[n]=e[n]);return s}function el(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:_m(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function _m(e){const t={},s=e.props||!1;if("component"in e)t.default=s;else for(const n in e.components)t[n]=typeof s=="object"?s[n]:s;return t}function tl(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Cm(e){return e.reduce((t,s)=>Ie(t,s.meta),{})}function sl(e,t){const s={};for(const n in e)s[n]=n in t?t[n]:e[n];return s}function $m(e,t){let s=0,n=t.length;for(;s!==n;){const r=s+n>>1;Mu(e,t[r])<0?n=r:s=r+1}const o=km(e);return o&&(n=t.lastIndexOf(o,n-1)),n}function km(e){let t=e;for(;t=t.parent;)if(Pu(t)&&Mu(e,t)===0)return t}function Pu({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Sm(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let o=0;o<n.length;++o){const r=n[o].replace(_u," "),i=r.indexOf("="),a=Jo(i<0?r:r.slice(0,i)),c=i<0?null:Jo(r.slice(i+1));if(a in t){let f=t[a];Ot(f)||(f=t[a]=[f]),f.push(c)}else t[a]=c}return t}function ol(e){let t="";for(let s in e){const n=e[s];if(s=Jh(s),n==null){n!==void 0&&(t+=(t.length?"&":"")+s);continue}(Ot(n)?n.map(r=>r&&ti(r)):[n&&ti(n)]).forEach(r=>{r!==void 0&&(t+=(t.length?"&":"")+s,r!=null&&(t+="="+r))})}return t}function xm(e){const t={};for(const s in e){const n=e[s];n!==void 0&&(t[s]=Ot(n)?n.map(o=>o==null?null:""+o):n==null?n:""+n)}return t}const Tm=Symbol(""),nl=Symbol(""),ir=Symbol(""),Au=Symbol(""),oi=Symbol("");function Co(){let e=[];function t(n){return e.push(n),()=>{const o=e.indexOf(n);o>-1&&e.splice(o,1)}}function s(){e=[]}return{add:t,list:()=>e.slice(),reset:s}}function ms(e,t,s,n,o,r=i=>i()){const i=n&&(n.enterCallbacks[o]=n.enterCallbacks[o]||[]);return()=>new Promise((a,c)=>{const f=h=>{h===!1?c(ho(4,{from:s,to:t})):h instanceof Error?c(h):fm(h)?c(ho(2,{from:t,to:h})):(i&&n.enterCallbacks[o]===i&&typeof h=="function"&&i.push(h),a())},u=r(()=>e.call(n&&n.instances[o],t,s,f));let d=Promise.resolve(u);e.length<3&&(d=d.then(f)),d.catch(h=>c(h))})}function Pr(e,t,s,n,o=r=>r()){const r=[];for(const i of e)for(const a in i.components){let c=i.components[a];if(!(t!=="beforeRouteEnter"&&!i.instances[a]))if(vu(c)){const u=(c.__vccOpts||c)[t];u&&r.push(ms(u,s,n,i,a,o))}else{let f=c();r.push(()=>f.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${a}" at "${i.path}"`);const d=Lh(u)?u.default:u;i.mods[a]=u,i.components[a]=d;const g=(d.__vccOpts||d)[t];return g&&ms(g,s,n,i,a,o)()}))}}return r}function rl(e){const t=Pt(ir),s=Pt(Au),n=He(()=>{const c=ss(e.to);return t.resolve(c)}),o=He(()=>{const{matched:c}=n.value,{length:f}=c,u=c[f-1],d=s.matched;if(!u||!d.length)return-1;const h=d.findIndex(go.bind(null,u));if(h>-1)return h;const g=il(c[f-2]);return f>1&&il(u)===g&&d[d.length-1].path!==g?d.findIndex(go.bind(null,c[f-2])):h}),r=He(()=>o.value>-1&&Em(s.params,n.value.params)),i=He(()=>o.value>-1&&o.value===s.matched.length-1&&Su(s.params,n.value.params));function a(c={}){if(Am(c)){const f=t[ss(e.replace)?"replace":"push"](ss(e.to)).catch(Ao);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>f),f}return Promise.resolve()}return{route:n,href:He(()=>n.value.href),isActive:r,isExactActive:i,navigate:a}}function Im(e){return e.length===1?e[0]:e}const Mm=Jt({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:rl,setup(e,{slots:t}){const s=Vs(rl(e)),{options:n}=Pt(ir),o=He(()=>({[al(e.activeClass,n.linkActiveClass,"router-link-active")]:s.isActive,[al(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:s.isExactActive}));return()=>{const r=t.default&&Im(t.default(s));return e.custom?r:nr("a",{"aria-current":s.isExactActive?e.ariaCurrentValue:null,href:s.href,onClick:s.navigate,class:o.value},r)}}}),Pm=Mm;function Am(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Em(e,t){for(const s in t){const n=t[s],o=e[s];if(typeof n=="string"){if(n!==o)return!1}else if(!Ot(o)||o.length!==n.length||n.some((r,i)=>r!==o[i]))return!1}return!0}function il(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const al=(e,t,s)=>e??t??s,Om=Jt({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:s}){const n=Pt(oi),o=He(()=>e.route||n.value),r=Pt(nl,0),i=He(()=>{let f=ss(r);const{matched:u}=o.value;let d;for(;(d=u[f])&&!d.components;)f++;return f}),a=He(()=>o.value.matched[i.value]);bn(nl,He(()=>i.value+1)),bn(Tm,a),bn(oi,o);const c=Re();return bs(()=>[c.value,a.value,e.name],([f,u,d],[h,g,m])=>{u&&(u.instances[d]=f,g&&g!==u&&f&&f===h&&(u.leaveGuards.size||(u.leaveGuards=g.leaveGuards),u.updateGuards.size||(u.updateGuards=g.updateGuards))),f&&u&&(!g||!go(u,g)||!h)&&(u.enterCallbacks[d]||[]).forEach(y=>y(f))},{flush:"post"}),()=>{const f=o.value,u=e.name,d=a.value,h=d&&d.components[u];if(!h)return ll(s.default,{Component:h,route:f});const g=d.props[u],m=g?g===!0?f.params:typeof g=="function"?g(f):g:null,p=nr(h,Ie({},m,t,{onVnodeUnmounted:b=>{b.component.isUnmounted&&(d.instances[u]=null)},ref:c}));return ll(s.default,{Component:p,route:f})||p}}});function ll(e,t){if(!e)return null;const s=e(t);return s.length===1?s[0]:s}const Eu=Om;function Lm(e){const t=wm(e.routes,e),s=e.parseQuery||Sm,n=e.stringifyQuery||ol,o=e.history,r=Co(),i=Co(),a=Co(),c=Fd(cs);let f=cs;Qs&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Ir.bind(null,A=>""+A),d=Ir.bind(null,Wh),h=Ir.bind(null,Jo);function g(A,Y){let Z,le;return Tu(A)?(Z=t.getRecordMatcher(A),le=Y):le=A,t.addRoute(le,Z)}function m(A){const Y=t.getRecordMatcher(A);Y&&t.removeRoute(Y)}function y(){return t.getRoutes().map(A=>A.record)}function p(A){return!!t.getRecordMatcher(A)}function b(A,Y){if(Y=Ie({},Y||c.value),typeof A=="string"){const x=Mr(s,A,Y.path),P=t.resolve({path:x.path},Y),L=o.createHref(x.fullPath);return Ie(x,P,{params:h(P.params),hash:Jo(x.hash),redirectedFrom:void 0,href:L})}let Z;if(A.path!=null)Z=Ie({},A,{path:Mr(s,A.path,Y.path).path});else{const x=Ie({},A.params);for(const P in x)x[P]==null&&delete x[P];Z=Ie({},A,{params:d(x)}),Y.params=d(Y.params)}const le=t.resolve(Z,Y),Te=A.hash||"";le.params=u(h(le.params));const _=Qh(n,Ie({},A,{hash:qh(Te),path:le.path})),C=o.createHref(_);return Ie({fullPath:_,hash:Te,query:n===ol?xm(A.query):A.query||{}},le,{redirectedFrom:void 0,href:C})}function w(A){return typeof A=="string"?Mr(s,A,c.value.path):Ie({},A)}function v(A,Y){if(f!==A)return ho(8,{from:Y,to:A})}function k(A){return R(A)}function $(A){return k(Ie(w(A),{replace:!0}))}function I(A){const Y=A.matched[A.matched.length-1];if(Y&&Y.redirect){const{redirect:Z}=Y;let le=typeof Z=="function"?Z(A):Z;return typeof le=="string"&&(le=le.includes("?")||le.includes("#")?le=w(le):{path:le},le.params={}),Ie({query:A.query,hash:A.hash,params:le.path!=null?{}:A.params},le)}}function R(A,Y){const Z=f=b(A),le=c.value,Te=A.state,_=A.force,C=A.replace===!0,x=I(Z);if(x)return R(Ie(w(x),{state:typeof x=="object"?Ie({},Te,x.state):Te,force:_,replace:C}),Y||Z);const P=Z;P.redirectedFrom=Y;let L;return!_&&Yh(n,le,Z)&&(L=ho(16,{to:P,from:le}),ke(le,le,!0,!1)),(L?Promise.resolve(L):N(P,le)).catch(D=>Ht(D)?Ht(D,2)?D:se(D):X(D,P,le)).then(D=>{if(D){if(Ht(D,2))return R(Ie({replace:C},w(D.to),{state:typeof D.to=="object"?Ie({},Te,D.to.state):Te,force:_}),Y||P)}else D=M(P,le,!0,C,Te);return W(P,le,D),D})}function O(A,Y){const Z=v(A,Y);return Z?Promise.reject(Z):Promise.resolve()}function E(A){const Y=oe.values().next().value;return Y&&typeof Y.runWithContext=="function"?Y.runWithContext(A):A()}function N(A,Y){let Z;const[le,Te,_]=Nm(A,Y);Z=Pr(le.reverse(),"beforeRouteLeave",A,Y);for(const x of le)x.leaveGuards.forEach(P=>{Z.push(ms(P,A,Y))});const C=O.bind(null,A,Y);return Z.push(C),ae(Z).then(()=>{Z=[];for(const x of r.list())Z.push(ms(x,A,Y));return Z.push(C),ae(Z)}).then(()=>{Z=Pr(Te,"beforeRouteUpdate",A,Y);for(const x of Te)x.updateGuards.forEach(P=>{Z.push(ms(P,A,Y))});return Z.push(C),ae(Z)}).then(()=>{Z=[];for(const x of _)if(x.beforeEnter)if(Ot(x.beforeEnter))for(const P of x.beforeEnter)Z.push(ms(P,A,Y));else Z.push(ms(x.beforeEnter,A,Y));return Z.push(C),ae(Z)}).then(()=>(A.matched.forEach(x=>x.enterCallbacks={}),Z=Pr(_,"beforeRouteEnter",A,Y,E),Z.push(C),ae(Z))).then(()=>{Z=[];for(const x of i.list())Z.push(ms(x,A,Y));return Z.push(C),ae(Z)}).catch(x=>Ht(x,8)?x:Promise.reject(x))}function W(A,Y,Z){a.list().forEach(le=>E(()=>le(A,Y,Z)))}function M(A,Y,Z,le,Te){const _=v(A,Y);if(_)return _;const C=Y===cs,x=Qs?history.state:{};Z&&(le||C?o.replace(A.fullPath,Ie({scroll:C&&x&&x.scroll},Te)):o.push(A.fullPath,Te)),c.value=A,ke(A,Y,Z,C),se()}let z;function G(){z||(z=o.listen((A,Y,Z)=>{if(!re.listening)return;const le=b(A),Te=I(le);if(Te){R(Ie(Te,{replace:!0,force:!0}),le).catch(Ao);return}f=le;const _=c.value;Qs&&rm(Ha(_.fullPath,Z.delta),rr()),N(le,_).catch(C=>Ht(C,12)?C:Ht(C,2)?(R(Ie(w(C.to),{force:!0}),le).then(x=>{Ht(x,20)&&!Z.delta&&Z.type===Go.pop&&o.go(-1,!1)}).catch(Ao),Promise.reject()):(Z.delta&&o.go(-Z.delta,!1),X(C,le,_))).then(C=>{C=C||M(le,_,!1),C&&(Z.delta&&!Ht(C,8)?o.go(-Z.delta,!1):Z.type===Go.pop&&Ht(C,20)&&o.go(-1,!1)),W(le,_,C)}).catch(Ao)}))}let pe=Co(),$e=Co(),ye;function X(A,Y,Z){se(A);const le=$e.list();return le.length?le.forEach(Te=>Te(A,Y,Z)):console.error(A),Promise.reject(A)}function Ee(){return ye&&c.value!==cs?Promise.resolve():new Promise((A,Y)=>{pe.add([A,Y])})}function se(A){return ye||(ye=!A,G(),pe.list().forEach(([Y,Z])=>A?Z(A):Y()),pe.reset()),A}function ke(A,Y,Z,le){const{scrollBehavior:Te}=e;if(!Qs||!Te)return Promise.resolve();const _=!Z&&im(Ha(A.fullPath,0))||(le||!Z)&&history.state&&history.state.scroll||null;return co().then(()=>Te(A,Y,_)).then(C=>C&&nm(C)).catch(C=>X(C,A,Y))}const V=A=>o.go(A);let B;const oe=new Set,re={currentRoute:c,listening:!0,addRoute:g,removeRoute:m,clearRoutes:t.clearRoutes,hasRoute:p,getRoutes:y,resolve:b,options:e,push:k,replace:$,go:V,back:()=>V(-1),forward:()=>V(1),beforeEach:r.add,beforeResolve:i.add,afterEach:a.add,onError:$e.add,isReady:Ee,install(A){const Y=this;A.component("RouterLink",Pm),A.component("RouterView",Eu),A.config.globalProperties.$router=Y,Object.defineProperty(A.config.globalProperties,"$route",{enumerable:!0,get:()=>ss(c)}),Qs&&!B&&c.value===cs&&(B=!0,k(o.location).catch(Te=>{}));const Z={};for(const Te in cs)Object.defineProperty(Z,Te,{get:()=>c.value[Te],enumerable:!0});A.provide(ir,Y),A.provide(Au,vc(Z)),A.provide(oi,c);const le=A.unmount;oe.add(A),A.unmount=function(){oe.delete(A),oe.size<1&&(f=cs,z&&z(),z=null,c.value=cs,B=!1,ye=!1),le()}}};function ae(A){return A.reduce((Y,Z)=>Y.then(()=>E(Z)),Promise.resolve())}return re}function Nm(e,t){const s=[],n=[],o=[],r=Math.max(t.matched.length,e.matched.length);for(let i=0;i<r;i++){const a=t.matched[i];a&&(e.matched.find(f=>go(f,a))?n.push(a):s.push(a));const c=e.matched[i];c&&(t.matched.find(f=>go(f,c))||o.push(c))}return[s,n,o]}function Rm(){return Pt(ir)}const Be=(e,t)=>{const s=e.__vccOpts||e;for(const[n,o]of t)s[n]=o;return s},Dm={components:{RouterView:Eu}};function Fm(e,t,s,n,o,r){const i=ze("router-view");return S(),Xe(i)}const Vm=Be(Dm,[["render",Fm]]);var Um=Object.defineProperty,cl=Object.getOwnPropertySymbols,jm=Object.prototype.hasOwnProperty,zm=Object.prototype.propertyIsEnumerable,ul=(e,t,s)=>t in e?Um(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Ou=(e,t)=>{for(var s in t||(t={}))jm.call(t,s)&&ul(e,s,t[s]);if(cl)for(var s of cl(t))zm.call(t,s)&&ul(e,s,t[s]);return e},ar=e=>typeof e=="function",lr=e=>typeof e=="string",Lu=e=>lr(e)&&e.trim().length>0,Bm=e=>typeof e=="number",Rs=e=>typeof e>"u",Wo=e=>typeof e=="object"&&e!==null,qm=e=>Bt(e,"tag")&&Lu(e.tag),Nu=e=>window.TouchEvent&&e instanceof TouchEvent,Ru=e=>Bt(e,"component")&&Du(e.component),Jm=e=>ar(e)||Wo(e),Du=e=>!Rs(e)&&(lr(e)||Jm(e)||Ru(e)),fl=e=>Wo(e)&&["height","width","right","left","top","bottom"].every(t=>Bm(e[t])),Bt=(e,t)=>(Wo(e)||ar(e))&&t in e,Gm=(e=>()=>e++)(0);function Ar(e){return Nu(e)?e.targetTouches[0].clientX:e.clientX}function dl(e){return Nu(e)?e.targetTouches[0].clientY:e.clientY}var Wm=e=>{Rs(e.remove)?e.parentNode&&e.parentNode.removeChild(e):e.remove()},tn=e=>Ru(e)?tn(e.component):qm(e)?Jt({render(){return e}}):typeof e=="string"?e:Se(ss(e)),Hm=e=>{if(typeof e=="string")return e;const t=Bt(e,"props")&&Wo(e.props)?e.props:{},s=Bt(e,"listeners")&&Wo(e.listeners)?e.listeners:{};return{component:tn(e),props:t,listeners:s}},Km=()=>typeof window<"u",qi=class{constructor(){this.allHandlers={}}getHandlers(e){return this.allHandlers[e]||[]}on(e,t){const s=this.getHandlers(e);s.push(t),this.allHandlers[e]=s}off(e,t){const s=this.getHandlers(e);s.splice(s.indexOf(t)>>>0,1)}emit(e,t){this.getHandlers(e).forEach(n=>n(t))}},Qm=e=>["on","off","emit"].every(t=>Bt(e,t)&&ar(e[t])),yt;(function(e){e.SUCCESS="success",e.ERROR="error",e.WARNING="warning",e.INFO="info",e.DEFAULT="default"})(yt||(yt={}));var Nn;(function(e){e.TOP_LEFT="top-left",e.TOP_CENTER="top-center",e.TOP_RIGHT="top-right",e.BOTTOM_LEFT="bottom-left",e.BOTTOM_CENTER="bottom-center",e.BOTTOM_RIGHT="bottom-right"})(Nn||(Nn={}));var bt;(function(e){e.ADD="add",e.DISMISS="dismiss",e.UPDATE="update",e.CLEAR="clear",e.UPDATE_DEFAULTS="update_defaults"})(bt||(bt={}));var It="Vue-Toastification",Tt={type:{type:String,default:yt.DEFAULT},classNames:{type:[String,Array],default:()=>[]},trueBoolean:{type:Boolean,default:!0}},Fu={type:Tt.type,customIcon:{type:[String,Boolean,Object,Function],default:!0}},Cn={component:{type:[String,Object,Function,Boolean],default:"button"},classNames:Tt.classNames,showOnHover:{type:Boolean,default:!1},ariaLabel:{type:String,default:"close"}},ni={timeout:{type:[Number,Boolean],default:5e3},hideProgressBar:{type:Boolean,default:!1},isRunning:{type:Boolean,default:!1}},Vu={transition:{type:[Object,String],default:`${It}__bounce`}},Ym={position:{type:String,default:Nn.TOP_RIGHT},draggable:Tt.trueBoolean,draggablePercent:{type:Number,default:.6},pauseOnFocusLoss:Tt.trueBoolean,pauseOnHover:Tt.trueBoolean,closeOnClick:Tt.trueBoolean,timeout:ni.timeout,hideProgressBar:ni.hideProgressBar,toastClassName:Tt.classNames,bodyClassName:Tt.classNames,icon:Fu.customIcon,closeButton:Cn.component,closeButtonClassName:Cn.classNames,showCloseButtonOnHover:Cn.showOnHover,accessibility:{type:Object,default:()=>({toastRole:"alert",closeButtonLabel:"close"})},rtl:{type:Boolean,default:!1},eventBus:{type:Object,required:!1,default:()=>new qi}},Xm={id:{type:[String,Number],required:!0,default:0},type:Tt.type,content:{type:[String,Object,Function],required:!0,default:""},onClick:{type:Function,default:void 0},onClose:{type:Function,default:void 0}},Zm={container:{type:[Object,Function],default:()=>document.body},newestOnTop:Tt.trueBoolean,maxToasts:{type:Number,default:20},transition:Vu.transition,toastDefaults:Object,filterBeforeCreate:{type:Function,default:e=>e},filterToasts:{type:Function,default:e=>e},containerClassName:Tt.classNames,onMounted:Function,shareAppContext:[Boolean,Object]},os={CORE_TOAST:Ym,TOAST:Xm,CONTAINER:Zm,PROGRESS_BAR:ni,ICON:Fu,TRANSITION:Vu,CLOSE_BUTTON:Cn},Uu=Jt({name:"VtProgressBar",props:os.PROGRESS_BAR,data(){return{hasClass:!0}},computed:{style(){return{animationDuration:`${this.timeout}ms`,animationPlayState:this.isRunning?"running":"paused",opacity:this.hideProgressBar?0:1}},cpClass(){return this.hasClass?`${It}__progress-bar`:""}},watch:{timeout(){this.hasClass=!1,this.$nextTick(()=>this.hasClass=!0)}},mounted(){this.$el.addEventListener("animationend",this.animationEnded)},beforeUnmount(){this.$el.removeEventListener("animationend",this.animationEnded)},methods:{animationEnded(){this.$emit("close-toast")}}});function ep(e,t){return S(),T("div",{style:pt(e.style),class:ie(e.cpClass)},null,6)}Uu.render=ep;var tp=Uu,ju=Jt({name:"VtCloseButton",props:os.CLOSE_BUTTON,computed:{buttonComponent(){return this.component!==!1?tn(this.component):"button"},classes(){const e=[`${It}__close-button`];return this.showOnHover&&e.push("show-on-hover"),e.concat(this.classNames)}}}),sp=te(" × ");function op(e,t){return S(),Xe(ro(e.buttonComponent),sr({"aria-label":e.ariaLabel,class:e.classes},e.$attrs),{default:it(()=>[sp]),_:1},16,["aria-label","class"])}ju.render=op;var np=ju,zu={},rp={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"check-circle",class:"svg-inline--fa fa-check-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},ip=l("path",{fill:"currentColor",d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},null,-1),ap=[ip];function lp(e,t){return S(),T("svg",rp,ap)}zu.render=lp;var cp=zu,Bu={},up={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"info-circle",class:"svg-inline--fa fa-info-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},fp=l("path",{fill:"currentColor",d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},null,-1),dp=[fp];function gp(e,t){return S(),T("svg",up,dp)}Bu.render=gp;var gl=Bu,qu={},hp={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"exclamation-circle",class:"svg-inline--fa fa-exclamation-circle fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},mp=l("path",{fill:"currentColor",d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},null,-1),pp=[mp];function yp(e,t){return S(),T("svg",hp,pp)}qu.render=yp;var bp=qu,Ju={},vp={"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"exclamation-triangle",class:"svg-inline--fa fa-exclamation-triangle fa-w-18",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},wp=l("path",{fill:"currentColor",d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},null,-1),_p=[wp];function Cp(e,t){return S(),T("svg",vp,_p)}Ju.render=Cp;var $p=Ju,Gu=Jt({name:"VtIcon",props:os.ICON,computed:{customIconChildren(){return Bt(this.customIcon,"iconChildren")?this.trimValue(this.customIcon.iconChildren):""},customIconClass(){return lr(this.customIcon)?this.trimValue(this.customIcon):Bt(this.customIcon,"iconClass")?this.trimValue(this.customIcon.iconClass):""},customIconTag(){return Bt(this.customIcon,"iconTag")?this.trimValue(this.customIcon.iconTag,"i"):"i"},hasCustomIcon(){return this.customIconClass.length>0},component(){return this.hasCustomIcon?this.customIconTag:Du(this.customIcon)?tn(this.customIcon):this.iconTypeComponent},iconTypeComponent(){return{[yt.DEFAULT]:gl,[yt.INFO]:gl,[yt.SUCCESS]:cp,[yt.ERROR]:$p,[yt.WARNING]:bp}[this.type]},iconClasses(){const e=[`${It}__icon`];return this.hasCustomIcon?e.concat(this.customIconClass):e}},methods:{trimValue(e,t=""){return Lu(e)?e.trim():t}}});function kp(e,t){return S(),Xe(ro(e.component),{class:ie(e.iconClasses)},{default:it(()=>[te(F(e.customIconChildren),1)]),_:1},8,["class"])}Gu.render=kp;var Sp=Gu,Wu=Jt({name:"VtToast",components:{ProgressBar:tp,CloseButton:np,Icon:Sp},inheritAttrs:!1,props:Object.assign({},os.CORE_TOAST,os.TOAST),data(){return{isRunning:!0,disableTransitions:!1,beingDragged:!1,dragStart:0,dragPos:{x:0,y:0},dragRect:{}}},computed:{classes(){const e=[`${It}__toast`,`${It}__toast--${this.type}`,`${this.position}`].concat(this.toastClassName);return this.disableTransitions&&e.push("disable-transition"),this.rtl&&e.push(`${It}__toast--rtl`),e},bodyClasses(){return[`${It}__toast-${lr(this.content)?"body":"component-body"}`].concat(this.bodyClassName)},draggableStyle(){return this.dragStart===this.dragPos.x?{}:this.beingDragged?{transform:`translateX(${this.dragDelta}px)`,opacity:1-Math.abs(this.dragDelta/this.removalDistance)}:{transition:"transform 0.2s, opacity 0.2s",transform:"translateX(0)",opacity:1}},dragDelta(){return this.beingDragged?this.dragPos.x-this.dragStart:0},removalDistance(){return fl(this.dragRect)?(this.dragRect.right-this.dragRect.left)*this.draggablePercent:0}},mounted(){this.draggable&&this.draggableSetup(),this.pauseOnFocusLoss&&this.focusSetup()},beforeUnmount(){this.draggable&&this.draggableCleanup(),this.pauseOnFocusLoss&&this.focusCleanup()},methods:{hasProp:Bt,getVueComponentFromObj:tn,closeToast(){this.eventBus.emit(bt.DISMISS,this.id)},clickHandler(){this.onClick&&this.onClick(this.closeToast),this.closeOnClick&&(!this.beingDragged||this.dragStart===this.dragPos.x)&&this.closeToast()},timeoutHandler(){this.closeToast()},hoverPause(){this.pauseOnHover&&(this.isRunning=!1)},hoverPlay(){this.pauseOnHover&&(this.isRunning=!0)},focusPause(){this.isRunning=!1},focusPlay(){this.isRunning=!0},focusSetup(){addEventListener("blur",this.focusPause),addEventListener("focus",this.focusPlay)},focusCleanup(){removeEventListener("blur",this.focusPause),removeEventListener("focus",this.focusPlay)},draggableSetup(){const e=this.$el;e.addEventListener("touchstart",this.onDragStart,{passive:!0}),e.addEventListener("mousedown",this.onDragStart),addEventListener("touchmove",this.onDragMove,{passive:!1}),addEventListener("mousemove",this.onDragMove),addEventListener("touchend",this.onDragEnd),addEventListener("mouseup",this.onDragEnd)},draggableCleanup(){const e=this.$el;e.removeEventListener("touchstart",this.onDragStart),e.removeEventListener("mousedown",this.onDragStart),removeEventListener("touchmove",this.onDragMove),removeEventListener("mousemove",this.onDragMove),removeEventListener("touchend",this.onDragEnd),removeEventListener("mouseup",this.onDragEnd)},onDragStart(e){this.beingDragged=!0,this.dragPos={x:Ar(e),y:dl(e)},this.dragStart=Ar(e),this.dragRect=this.$el.getBoundingClientRect()},onDragMove(e){this.beingDragged&&(e.preventDefault(),this.isRunning&&(this.isRunning=!1),this.dragPos={x:Ar(e),y:dl(e)})},onDragEnd(){this.beingDragged&&(Math.abs(this.dragDelta)>=this.removalDistance?(this.disableTransitions=!0,this.$nextTick(()=>this.closeToast())):setTimeout(()=>{this.beingDragged=!1,fl(this.dragRect)&&this.pauseOnHover&&this.dragRect.bottom>=this.dragPos.y&&this.dragPos.y>=this.dragRect.top&&this.dragRect.left<=this.dragPos.x&&this.dragPos.x<=this.dragRect.right?this.isRunning=!1:this.isRunning=!0}))}}}),xp=["role"];function Tp(e,t){const s=ze("Icon"),n=ze("CloseButton"),o=ze("ProgressBar");return S(),T("div",{class:ie(e.classes),style:pt(e.draggableStyle),onClick:t[0]||(t[0]=(...r)=>e.clickHandler&&e.clickHandler(...r)),onMouseenter:t[1]||(t[1]=(...r)=>e.hoverPause&&e.hoverPause(...r)),onMouseleave:t[2]||(t[2]=(...r)=>e.hoverPlay&&e.hoverPlay(...r))},[e.icon?(S(),Xe(s,{key:0,"custom-icon":e.icon,type:e.type},null,8,["custom-icon","type"])):ge("v-if",!0),l("div",{role:e.accessibility.toastRole||"alert",class:ie(e.bodyClasses)},[typeof e.content=="string"?(S(),T(ve,{key:0},[te(F(e.content),1)],2112)):(S(),Xe(ro(e.getVueComponentFromObj(e.content)),sr({key:1,"toast-id":e.id},e.hasProp(e.content,"props")?e.content.props:{},ag(e.hasProp(e.content,"listeners")?e.content.listeners:{}),{onCloseToast:e.closeToast}),null,16,["toast-id","onCloseToast"]))],10,xp),e.closeButton?(S(),Xe(n,{key:1,component:e.closeButton,"class-names":e.closeButtonClassName,"show-on-hover":e.showCloseButtonOnHover,"aria-label":e.accessibility.closeButtonLabel,onClick:ft(e.closeToast,["stop"])},null,8,["component","class-names","show-on-hover","aria-label","onClick"])):ge("v-if",!0),e.timeout?(S(),Xe(o,{key:2,"is-running":e.isRunning,"hide-progress-bar":e.hideProgressBar,timeout:e.timeout,onCloseToast:e.timeoutHandler},null,8,["is-running","hide-progress-bar","timeout","onCloseToast"])):ge("v-if",!0)],38)}Wu.render=Tp;var Ip=Wu,Hu=Jt({name:"VtTransition",props:os.TRANSITION,emits:["leave"],methods:{hasProp:Bt,leave(e){e instanceof HTMLElement&&(e.style.left=e.offsetLeft+"px",e.style.top=e.offsetTop+"px",e.style.width=getComputedStyle(e).width,e.style.position="absolute")}}});function Mp(e,t){return S(),Xe(bh,{tag:"div","enter-active-class":e.transition.enter?e.transition.enter:`${e.transition}-enter-active`,"move-class":e.transition.move?e.transition.move:`${e.transition}-move`,"leave-active-class":e.transition.leave?e.transition.leave:`${e.transition}-leave-active`,onLeave:e.leave},{default:it(()=>[ig(e.$slots,"default")]),_:3},8,["enter-active-class","move-class","leave-active-class","onLeave"])}Hu.render=Mp;var Pp=Hu,Ku=Jt({name:"VueToastification",devtools:{hide:!0},components:{Toast:Ip,VtTransition:Pp},props:Object.assign({},os.CORE_TOAST,os.CONTAINER,os.TRANSITION),data(){return{count:0,positions:Object.values(Nn),toasts:{},defaults:{}}},computed:{toastArray(){return Object.values(this.toasts)},filteredToasts(){return this.defaults.filterToasts(this.toastArray)}},beforeMount(){const e=this.eventBus;e.on(bt.ADD,this.addToast),e.on(bt.CLEAR,this.clearToasts),e.on(bt.DISMISS,this.dismissToast),e.on(bt.UPDATE,this.updateToast),e.on(bt.UPDATE_DEFAULTS,this.updateDefaults),this.defaults=this.$props},mounted(){this.setup(this.container)},methods:{async setup(e){ar(e)&&(e=await e()),Wm(this.$el),e.appendChild(this.$el)},setToast(e){Rs(e.id)||(this.toasts[e.id]=e)},addToast(e){e.content=Hm(e.content);const t=Object.assign({},this.defaults,e.type&&this.defaults.toastDefaults&&this.defaults.toastDefaults[e.type],e),s=this.defaults.filterBeforeCreate(t,this.toastArray);s&&this.setToast(s)},dismissToast(e){const t=this.toasts[e];!Rs(t)&&!Rs(t.onClose)&&t.onClose(),delete this.toasts[e]},clearToasts(){Object.keys(this.toasts).forEach(e=>{this.dismissToast(e)})},getPositionToasts(e){const t=this.filteredToasts.filter(s=>s.position===e).slice(0,this.defaults.maxToasts);return this.defaults.newestOnTop?t.reverse():t},updateDefaults(e){Rs(e.container)||this.setup(e.container),this.defaults=Object.assign({},this.defaults,e)},updateToast({id:e,options:t,create:s}){this.toasts[e]?(t.timeout&&t.timeout===this.toasts[e].timeout&&t.timeout++,this.setToast(Object.assign({},this.toasts[e],t))):s&&this.addToast(Object.assign({},{id:e},t))},getClasses(e){return[`${It}__container`,e].concat(this.defaults.containerClassName)}}});function Ap(e,t){const s=ze("Toast"),n=ze("VtTransition");return S(),T("div",null,[(S(!0),T(ve,null,Ae(e.positions,o=>(S(),T("div",{key:o},[q(n,{transition:e.defaults.transition,class:ie(e.getClasses(o))},{default:it(()=>[(S(!0),T(ve,null,Ae(e.getPositionToasts(o),r=>(S(),Xe(s,sr({key:r.id},r),null,16))),128))]),_:2},1032,["transition","class"])]))),128))])}Ku.render=Ap;var Ep=Ku,hl=(e={},t=!0)=>{const s=e.eventBus=e.eventBus||new qi;t&&co(()=>{const r=bu(Ep,Ou({},e)),i=r.mount(document.createElement("div")),a=e.onMounted;if(Rs(a)||a(i,r),e.shareAppContext){const c=e.shareAppContext;c===!0?console.warn(`[${It}] App to share context with was not provided.`):(r._context.components=c._context.components,r._context.directives=c._context.directives,r._context.mixins=c._context.mixins,r._context.provides=c._context.provides,r.config.globalProperties=c.config.globalProperties)}});const n=(r,i)=>{const a=Object.assign({},{id:Gm(),type:yt.DEFAULT},i,{content:r});return s.emit(bt.ADD,a),a.id};n.clear=()=>s.emit(bt.CLEAR,void 0),n.updateDefaults=r=>{s.emit(bt.UPDATE_DEFAULTS,r)},n.dismiss=r=>{s.emit(bt.DISMISS,r)};function o(r,{content:i,options:a},c=!1){const f=Object.assign({},a,{content:i});s.emit(bt.UPDATE,{id:r,options:f,create:c})}return n.update=o,n.success=(r,i)=>n(r,Object.assign({},i,{type:yt.SUCCESS})),n.info=(r,i)=>n(r,Object.assign({},i,{type:yt.INFO})),n.error=(r,i)=>n(r,Object.assign({},i,{type:yt.ERROR})),n.warning=(r,i)=>n(r,Object.assign({},i,{type:yt.WARNING})),n},Op=()=>{const e=()=>console.warn(`[${It}] This plugin does not support SSR!`);return new Proxy(e,{get(){return e}})};function Qu(e){return Km()?Qm(e)?hl({eventBus:e},!1):hl(e,!0):Op()}var Yu=Symbol("VueToastification"),Xu=new qi,Lp=(e,t)=>{(t==null?void 0:t.shareAppContext)===!0&&(t.shareAppContext=e);const s=Qu(Ou({eventBus:Xu},t));e.provide(Yu,s)},Zu=e=>{const t=zi()?Pt(Yu,void 0):void 0;return t||Qu(Xu)},Np=Lp;const sn="data";let Ct=null,Ce=2;async function Ji(e=!1){return Ct!==null&&!e?Ct:new Promise((t,s)=>{const n=indexedDB.open(sn);n.onsuccess=o=>{const r=o.target.result;Ct=r.version,r.close(),t(Ct)},n.onerror=o=>{console.log("获取数据库版本失败，使用版本1",o.target.error),Ct=1,t(1)}})}async function _s(e=!1,t=0){try{const s=await Ji(e);return new Promise((n,o)=>{const r=indexedDB.open(sn,s);r.onsuccess=i=>{const a=i.target.result;n(a)},r.onerror=async i=>{const a=i.target.error;if(console.error("打开数据库失败:",a),a.name==="VersionError"&&t<Ce){console.log(`检测到版本错误，正在尝试刷新版本号并重试（${t+1}/${Ce}）`);try{const c=await _s(!0,t+1);n(c)}catch(c){o(c)}}else o(a)},r.onupgradeneeded=i=>{const a=i.target.result;console.log(`数据库版本从 ${i.oldVersion} 升级到 ${i.newVersion}`)},r.onblocked=i=>{console.warn("数据库打开被阻塞，可能是因为有其他连接未关闭")}})}catch(s){throw console.error("初始化数据库连接失败:",s),s}}async function yo(e,t=!1,s=0){let n=null;try{if(n=await _s(t,s),Array.from(n.objectStoreNames).includes(e))return n;const o=n.version;return n.close(),n=null,Ct=o+1,new Promise((r,i)=>{const a=indexedDB.open(sn,Ct);a.onupgradeneeded=c=>{const f=c.target.result;Array.from(f.objectStoreNames).includes(e)||(f.createObjectStore(e),console.log(`创建存储 ${e} 成功`))},a.onsuccess=c=>{console.log(`确保存储 ${e} 存在成功`),r(c.target.result)},a.onerror=async c=>{const f=c.target.error;if(console.error(`确保存储 ${e} 存在失败:`,f),f.name==="VersionError"&&s<Ce){console.log(`检测到版本错误，正在尝试刷新版本号并重试（${s+1}/${Ce}）`);try{const u=await yo(e,!0,s+1);r(u)}catch(u){i(u)}}else i(f)},a.onblocked=c=>{console.warn("数据库升级被阻塞，可能是因为有其他连接未关闭")}})}catch(o){throw console.error(`确保存储 ${e} 存在失败:`,o),n&&n.close(),o}}function Gs(e){const s=(e.startsWith("/")?e:`/${e}`).match(/^\/data\/([^\/]+)(?:\/(.*))?$/);if(!s)throw new Error(`无效的路径格式: ${e}，应为 /data/{title}/[path/to/file]`);const n=s[1],o=s[2]||"";return{title:n,key:o}}function qt(e){return e.startsWith(":")}function Rp(e){if(!e)return"";const t=e.lastIndexOf("/");return t>0?e.substring(0,t):""}async function cr(e,t){return new Promise((s,n)=>{const i=e.transaction([t],"readonly").objectStore(t).getAllKeys();i.onsuccess=a=>{s(a.target.result)},i.onerror=a=>{n(new Error(`获取所有键失败: ${t}, ${a.target.error}`))}})}async function Je(e,t=!1,s=0){const{title:n,key:o}=Gs(e);if(!o)throw new Error(`无法读取：${e} 是根目录`);if(qt(o))throw new Error(`${e} 是文件夹，请使用 listDirectory 函数`);let r=null;try{return r=await yo(n,t,s),new Promise((i,a)=>{const u=r.transaction([n],"readonly").objectStore(n).get(o);u.onsuccess=d=>{const h=d.target.result;h===void 0?a(new Error(`文件不存在: ${e}`)):i(h)},u.onerror=async d=>{const h=d.target.error;if(console.error(`读取文件失败: ${e}`,h),h.name==="VersionError"&&s<Ce){console.log(`读取文件时检测到版本错误，正在尝试刷新版本号并重试（${s+1}/${Ce}）`),r.close(),r=null;try{const g=await Je(e,!0,s+1);i(g)}catch(g){a(g)}}else a(new Error(`读取文件失败: ${e}, ${h}`))}})}catch(i){throw console.error(`读取文件失败: ${e}`,i),i}finally{r&&r.close()}}async function xe(e,t,s=!1,n=0){const{title:o,key:r}=Gs(e);if(!r)throw new Error(`无法写入：${e} 是根目录`);if(qt(r))throw new Error(`${e} 是文件夹，不能写入数据`);let i=null;try{return i=await yo(o,s,n),await ef(i,o,r,s,n),new Promise((a,c)=>{const d=i.transaction([o],"readwrite").objectStore(o).put(t,r);d.onsuccess=()=>{console.log(`文件写入成功: ${e}`),a()},d.onerror=async h=>{const g=h.target.error;if(console.error(`文件写入失败: ${e}`,g),g.name==="VersionError"&&n<Ce){console.log(`写入文件时检测到版本错误，正在尝试刷新版本号并重试（${n+1}/${Ce}）`),i.close(),i=null;try{await xe(e,t,!0,n+1),a()}catch(m){c(m)}}else c(new Error(`文件写入失败: ${e}, ${g}`))}})}catch(a){throw console.error(`文件写入失败: ${e}`,a),a}finally{i&&i.close()}}async function ef(e,t,s,n=!1,o=0){const r=s.split("/");if(r.length<=1)return;let i="";for(let a=0;a<r.length-1;a++){const c=r[a];if(!c)continue;i&&(i+="/"),i+=c;const f=`:${i}`;if(!await tf(e,t,f))try{await new Promise((d,h)=>{const y=e.transaction([t],"readwrite").objectStore(t).put({},f);y.onsuccess=()=>{console.log(`创建文件夹成功: ${f}`),d()},y.onerror=async p=>{const b=p.target.error;console.error(`创建文件夹失败: ${f}`,b),b.name==="VersionError"&&o<Ce?(console.log("创建文件夹时检测到版本错误，将在外部函数中处理重试"),h(b)):h(new Error(`创建文件夹失败: ${f}, ${b}`))}})}catch(d){throw d.name==="VersionError"||console.error(`创建文件夹失败: ${f}`,d),d}}}async function tf(e,t,s){return new Promise((n,o)=>{const a=e.transaction([t],"readonly").objectStore(t).get(s);a.onsuccess=c=>{n(c.target.result!==void 0)},a.onerror=c=>{o(new Error(`检查键失败: ${s}, ${c.target.error}`))}})}async function ts(e,t=!1,s=0){if(e==="/data")throw new Error("不允许删除数据库根目录");const{title:n,key:o}=Gs(e);let r=null;try{if(r=await _s(t,s),!Array.from(r.objectStoreNames).includes(n))throw new Error(`标题 ${n} 不存在`);if(!o)return r.close(),r=null,Ct=await Ji(t)+1,new Promise((f,u)=>{const d=indexedDB.open(sn,Ct);d.onupgradeneeded=h=>{const g=h.target.result;g.objectStoreNames.contains(n)&&(g.deleteObjectStore(n),console.log(`删除标题存储 ${n} 成功`))},d.onsuccess=h=>{h.target.result.close(),f()},d.onerror=async h=>{const g=h.target.error;if(console.error(`删除标题存储 ${n} 失败:`,g),g.name==="VersionError"&&s<Ce){console.log(`删除标题存储时检测到版本错误，正在尝试刷新版本号并重试（${s+1}/${Ce}）`);try{await ts(e,!0,s+1),f()}catch(m){u(m)}}else u(new Error(`删除标题存储 ${n} 失败: ${g}`))},d.onblocked=h=>{console.warn("删除对象存储被阻塞，可能是因为有其他连接未关闭")}});const i=await cr(r,n);if(i.includes(":"+o)){const c=o,f=c?`${c}/`:"",u=i.filter(d=>d===":"+o?!0:qt(d)?d.substring(1).startsWith(f):d.startsWith(f));console.log(`将删除以下键: ${u.join(", ")}`);for(const d of u)await new Promise((h,g)=>{const p=r.transaction([n],"readwrite").objectStore(n).delete(d);p.onsuccess=()=>{console.log(`删除键成功: ${d}`),h()},p.onerror=async b=>{const w=b.target.error;console.error(`删除键失败: ${d}`,w),w.name==="VersionError"?(r.close(),r=null,g(w)):g(new Error(`删除键失败: ${d}, ${w}`))}}).catch(async h=>{if(h.name==="VersionError"&&s<Ce)return console.log("删除键时检测到版本错误，正在尝试从头开始重试删除操作"),r.close(),r=null,await ts(e,!0,s+1);throw h})}else return new Promise((c,f)=>{const h=r.transaction([n],"readwrite").objectStore(n).delete(o);h.onsuccess=()=>{console.log(`删除文件成功: ${e}`),c()},h.onerror=async g=>{const m=g.target.error;if(console.error(`删除文件失败: ${e}`,m),m.name==="VersionError"&&s<Ce){console.log(`删除文件时检测到版本错误，正在尝试刷新版本号并重试（${s+1}/${Ce}）`),r.close(),r=null;try{await ts(e,!0,s+1),c()}catch(y){f(y)}}else f(new Error(`删除文件失败: ${e}, ${m}`))}});console.log(`删除成功: ${e}`)}catch(i){if(i.name==="VersionError"&&s<Ce)return console.log(`删除过程中检测到版本错误，正在尝试刷新版本号并重试（${s+1}/${Ce}）`),r&&r.close(),await ts(e,!0,s+1);throw console.error(`删除失败: ${e}`,i),i}finally{r&&r.close()}}async function Ys(e,t,s=!1,n=0){if(e==="/data")throw new Error("不允许重命名数据库根目录");const{title:o,key:r}=Gs(e);if(!t||t.includes("/"))throw new Error(`新名称无效，不能包含斜杠: ${t}`);if(!r){let a=null;try{if(a=await _s(s,n),!Array.from(a.objectStoreNames).includes(o))throw new Error(`标题 ${o} 不存在`);if(Array.from(a.objectStoreNames).includes(t))throw new Error(`标题 ${t} 已存在`);const c=await of(o,s,n);a.close(),a=null;const f=await Ji(s);if(Ct=f+1,console.log(`开始重命名标题 ${o} 到 ${t}，数据库版本从 ${f} 升级到 ${Ct}`),await new Promise((h,g)=>{const m=indexedDB.open(sn,Ct);m.onupgradeneeded=y=>{const p=y.target.result;try{p.objectStoreNames.contains(t)||(p.createObjectStore(t),console.log(`创建新标题存储 ${t} 成功`)),p.objectStoreNames.contains(o)&&(p.deleteObjectStore(o),console.log(`删除旧标题存储 ${o} 成功`))}catch(b){console.error("在升级过程中创建/删除存储出错:",b),g(b)}},m.onsuccess=y=>{y.target.result.close(),h()},m.onerror=async y=>{const p=y.target.error;if(console.error("升级数据库以重命名标题失败:",p),p.name==="VersionError"&&n<Ce){console.log(`重命名标题时检测到版本错误，正在尝试刷新版本号并重试（${n+1}/${Ce}）`);try{await Ys(e,t,!0,n+1),h()}catch(b){g(b)}}else g(new Error(`升级数据库以重命名标题失败: ${p}`))},m.onblocked=y=>{console.warn("升级数据库被阻塞，可能是因为有其他连接未关闭")}}),console.log(`开始将数据从 ${o} 复制到 ${t}，共 ${Object.keys(c).length} 项`),a=await _s(!0),!Array.from(a.objectStoreNames).includes(t))throw new Error(`创建新标题存储 ${t} 失败，存储不存在`);const d=a.transaction([t],"readwrite").objectStore(t);for(const[h,g]of Object.entries(c))await new Promise((m,y)=>{const p=d.put(g,h);p.onsuccess=()=>{m()},p.onerror=b=>{console.error(`复制数据项 ${h} 失败:`,b.target.error),y(b.target.error)}});console.log(`重命名标题 ${o} 到 ${t} 成功，已复制 ${Object.keys(c).length} 项数据`);return}catch(c){if(c.name==="VersionError"&&n<Ce)return console.log(`重命名标题过程中检测到版本错误，正在尝试刷新版本号并重试（${n+1}/${Ce}）`),a&&a.close(),await Ys(e,t,!0,n+1);throw console.error(`重命名标题失败: ${o} -> ${t}`,c),c}finally{a&&a.close()}}let i=null;try{i=await yo(o,s,n);const a=await cr(i,o);if(!a.includes(r)&&!qt(":"+r))throw new Error(`文件不存在: ${e}`);const c=a.includes(":"+r),f=Rp(c?r.substring(1):r),u=f?`${f}/${t}`:t,d=c?`:${u}`:u;if(c){const h=r,g=h?`${h}/`:"",m=u,y=m?`${m}/`:"",p=a.filter(b=>b===":"+r?!0:qt(b)?b.substring(1).startsWith(g):b.startsWith(g));console.log(`将重命名以下键: ${p.join(", ")}`);for(const b of p)try{let w;b===":"+r?w=d:qt(b)?w=`:${b.substring(1).replace(g,y)}`:w=b.replace(g,y),console.log(`重命名: ${b} -> ${w}`);const v=await new Promise((k,$)=>{const O=i.transaction([o],"readonly").objectStore(o).get(b);O.onsuccess=E=>{k(E.target.result)},O.onerror=E=>{const N=E.target.error;N.name==="VersionError"?$(N):$(new Error(`读取内容失败: ${b}, ${N}`))}});await new Promise((k,$)=>{const O=i.transaction([o],"readwrite").objectStore(o).put(v,w);O.onsuccess=()=>{k()},O.onerror=E=>{const N=E.target.error;N.name==="VersionError"?$(N):$(new Error(`写入新位置失败: ${w}, ${N}`))}}),await new Promise((k,$)=>{const O=i.transaction([o],"readwrite").objectStore(o).delete(b);O.onsuccess=()=>{k()},O.onerror=E=>{const N=E.target.error;N.name==="VersionError"?$(N):$(new Error(`删除旧位置失败: ${b}, ${N}`))}})}catch(w){if(w.name==="VersionError"){if(i.close(),i=null,n<Ce)return console.log(`重命名操作中检测到版本错误，正在尝试刷新版本号并重试（${n+1}/${Ce}）`),await Ys(e,t,!0,n+1);throw w}throw w}}else try{if(!await tf(i,o,r))throw new Error(`文件不存在: ${e}`);const g=await new Promise((m,y)=>{const w=i.transaction([o],"readonly").objectStore(o).get(r);w.onsuccess=v=>{m(v.target.result)},w.onerror=v=>{const k=v.target.error;k.name==="VersionError"?y(k):y(new Error(`读取文件内容失败: ${r}, ${k}`))}});await new Promise((m,y)=>{const w=i.transaction([o],"readwrite").objectStore(o).put(g,d);w.onsuccess=()=>{m()},w.onerror=v=>{const k=v.target.error;k.name==="VersionError"?y(k):y(new Error(`写入新位置失败: ${d}, ${k}`))}}),await new Promise((m,y)=>{const w=i.transaction([o],"readwrite").objectStore(o).delete(r);w.onsuccess=()=>{m()},w.onerror=v=>{const k=v.target.error;k.name==="VersionError"?y(k):y(new Error(`删除旧位置失败: ${r}, ${k}`))}})}catch(h){if(h.name==="VersionError"){if(i.close(),i=null,n<Ce)return console.log(`重命名文件时检测到版本错误，正在尝试刷新版本号并重试（${n+1}/${Ce}）`),await Ys(e,t,!0,n+1);throw h}throw h}console.log(`重命名成功: ${e} -> ${t}`)}catch(a){if(a.name==="VersionError"&&n<Ce)return console.log(`重命名过程中检测到版本错误，正在尝试刷新版本号并重试（${n+1}/${Ce}）`),i&&i.close(),await Ys(e,t,!0,n+1);throw console.error(`重命名失败: ${e} -> ${t}`,a),a}finally{i&&i.close()}}async function sf(e,t=!1,s=0){const{title:n,key:o}=Gs(e);let r=null;try{r=await yo(n,t,s);const i=await cr(r,n),a=o||"",c=a?`${a}/`:"",f=a?`:${a}`:"";if(a&&!i.includes(f)&&!i.some(m=>m.startsWith(c)))throw new Error(`目录不存在: ${e}`);const u=new Set,d=[];for(const m of i)if(!qt(m)&&m.startsWith(c)){const p=m.substring(c.length).split("/");p.length===1?d.push({name:p[0],isFolder:!1,path:`/data/${n}/${m}`,size:0}):p.length>1&&p[0]&&u.add(p[0])}for(const m of i){if(!qt(m))continue;const y=m.substring(1);if(a===""&&!y.includes("/"))d.push({name:y,isFolder:!0,path:`/data/${n}/${y}`,size:0});else if(y.startsWith(c)&&y!==a){const b=y.substring(c.length).split("/");b.length===1?d.push({name:b[0],isFolder:!0,path:`/data/${n}/${y}`,size:0}):b.length>1&&b[0]&&u.add(b[0])}}for(const m of u)if(!d.some(p=>p.name===m&&p.isFolder)){const p=a?`${a}/${m}`:m;d.push({name:m,isFolder:!0,path:`/data/${n}/${p}`,size:0})}const h=[],g=new Set;for(const m of d){const y=`${m.name}:${m.isFolder}`;g.has(y)||(g.add(y),h.push(m))}return h}catch(i){if(i.name==="VersionError"&&s<Ce)return console.log(`列出目录时检测到版本错误，正在尝试刷新版本号并重试（${s+1}/${Ce}）`),r&&r.close(),await sf(e,!0,s+1);throw console.error(`列出目录失败: ${e}`,i),i}finally{r&&r.close()}}async function Cs(e,t=!1,s=0){const{title:n,key:o}=Gs(e),r={exists:!1,isFolder:!1,size:0,lastModified:null};if(!o)return{exists:!0,isFolder:!0,size:0,lastModified:null};let i=null;try{if(i=await _s(t,s),!Array.from(i.objectStoreNames).includes(n))return r;if(qt(o)){const u=i.transaction([n],"readonly").objectStore(n).get(o);if(await new Promise((p,b)=>{u.onsuccess=w=>{p(w.target.result!==void 0)},u.onerror=w=>{const v=w.target.error;v.name==="VersionError"?b(v):p(!1)}}).catch(p=>{if(p.name==="VersionError")throw p;return!1}))return r.exists=!0,r.isFolder=!0,r;const h=await cr(i,n),g=o.substring(1),m=g?`${g}/`:"";return h.some(p=>qt(p)?p.substring(1).startsWith(m):p.startsWith(m))&&(r.exists=!0,r.isFolder=!0),r}else{const u=i.transaction([n],"readonly").objectStore(n).get(o);return new Promise((d,h)=>{u.onsuccess=g=>{const m=g.target.result;if(m!==void 0){if(r.exists=!0,typeof m=="string")r.size=m.length;else if(m instanceof Blob)r.size=m.size;else if(m instanceof ArrayBuffer)r.size=m.byteLength;else try{r.size=JSON.stringify(m).length}catch{r.size=0}r.lastModified=Date.now()}d(r)},u.onerror=g=>{const m=g.target.error;m.name==="VersionError"?h(m):d(r)}}).catch(async d=>{if(d.name==="VersionError"&&s<Ce)return console.log(`获取元信息时检测到版本错误，正在尝试刷新版本号并重试（${s+1}/${Ce}）`),i.close(),i=null,await Cs(e,!0,s+1);throw d})}}catch(a){if(a.name==="VersionError"&&s<Ce)return console.log(`获取元信息过程中检测到版本错误，正在尝试刷新版本号并重试（${s+1}/${Ce}）`),i&&i.close(),await Cs(e,!0,s+1);throw console.error(`获取元信息失败: ${e}`,a),a}finally{i&&i.close()}}async function ao(e=!1,t=0){let s=null;try{return s=await _s(e,t),Array.from(s.objectStoreNames)}catch(n){return n.name==="VersionError"&&t<Ce?(console.log(`获取所有标题时检测到版本错误，正在尝试刷新版本号并重试（${t+1}/${Ce}）`),s&&s.close(),await ao(!0,t+1)):(console.error("获取所有标题失败:",n),[])}finally{s&&s.close()}}async function Lt(e,t=!1,s=0){const{title:n,key:o}=Gs(e);if(!o)throw new Error(`无法创建根目录: ${e}`);let r=null;try{r=await yo(n,t,s);const i=`:${o}`;return await ef(r,n,o,t,s),new Promise((a,c)=>{const d=r.transaction([n],"readwrite").objectStore(n).put({},i);d.onsuccess=()=>{console.log(`创建文件夹成功: ${i}`),a()},d.onerror=async h=>{const g=h.target.error;if(console.error(`创建文件夹失败: ${i}`,g),g.name==="VersionError"&&s<Ce){console.log(`创建文件夹时检测到版本错误，正在尝试刷新版本号并重试（${s+1}/${Ce}）`),r.close(),r=null;try{await Lt(e,!0,s+1),a()}catch(m){c(m)}}else c(new Error(`创建文件夹失败: ${i}, ${g}`))}})}catch(i){if(i.name==="VersionError"&&s<Ce)return console.log(`创建文件夹过程中检测到版本错误，正在尝试刷新版本号并重试（${s+1}/${Ce}）`),r&&r.close(),await Lt(e,!0,s+1);throw console.error(`创建文件夹失败: ${e}`,i),i}finally{r&&r.close()}}async function of(e,t=!1,s=0){let n=null;try{if(n=await _s(t,s),!Array.from(n.objectStoreNames).includes(e))return{};const o={};try{const r=await new Promise((i,a)=>{const u=n.transaction([e],"readonly").objectStore(e).getAllKeys();u.onsuccess=d=>{i(d.target.result)},u.onerror=d=>{const h=d.target.error;h.name==="VersionError"?a(h):a(new Error(`获取所有键失败: ${e}, ${h}`))}});for(const i of r){const a=await new Promise((c,f)=>{const h=n.transaction([e],"readonly").objectStore(e).get(i);h.onsuccess=g=>{c(g.target.result)},h.onerror=g=>{const m=g.target.error;m.name==="VersionError"?f(m):f(new Error(`获取值失败: ${e}/${i}, ${m}`))}});o[i]=a}}catch(r){throw r.name==="VersionError",r}return o}catch(o){if(o.name==="VersionError"&&s<Ce)return console.log(`获取所有数据时检测到版本错误，正在尝试刷新版本号并重试（${s+1}/${Ce}）`),n&&n.close(),await of(e,!0,s+1);throw console.error(`获取所有数据失败: ${e}`,o),o}finally{n&&n.close()}}const ps=new Map,xt=new Set;function Dp(e){const t=[{大纲:["outline","纲要","目录生成","章节规划"]},{正文:["plot","文本生成","故事发展","剧情推进"]},{选项:["choice","choose","option","分支选择","用户决策"]},{人物:["character","character_ai_draw","角色设计","人物设定","NPC生成","角色对话"]},{背景:["background","background_ai_draw","世界观","场景描述","环境设定","地点生成"]},{音乐:["music","music_prompt","BGM推荐","音效建议","氛围音乐","background_music"]},{总结:["summary","要点归纳","内容摘要"]}];for(const s of t)for(const[n,o]of Object.entries(s))if(o.map(r=>r.toLowerCase()).includes(e.toLowerCase()))return n;return e}function nf(){try{const e=localStorage.getItem("aiGalgameConfig");return e?JSON.parse(e):{}}catch(e){return console.error("加载配置错误:",e),{}}}function Fp(e,t){var o;const s=[],n=nf();if(!n||!n.模型||!n.模型.configs){xt.add(e);return}for(const r of t){const i=r.config,a=r.model;try{const f=(o=n.模型.configs[i])==null?void 0:o.models;if(!f)continue;const u=f.find(d=>d.name===a);if(!u)continue;s.push({config:i,model:a,weigh:parseInt(r.weigh),priority:parseInt(r.priority),max_retry:parseInt(u.max_retry||3),temperature:u.temperature||"",top_p:u.top_p||"",penalty:u.frequency_penalty||"",max_tokens:u.max_tokens||""})}catch(c){console.error(`初始化模型错误 (${i}/${a}):`,c);continue}}if(s.length===0){xt.add(e);return}ps.set(e,s)}function Vp(e){if(!e||e.length===0)return null;const t={};for(const a of e){const c=a.priority;t[c]||(t[c]=[]),t[c].push(a)}if(Object.keys(t).length===0)return null;const s=Math.max(...Object.keys(t).map(Number)),n=t[s],o=n.reduce((a,c)=>a+c.weigh,0);if(o<=0)return null;const r=n.map(a=>a.weigh);let i=Math.random()*o;for(let a=0;a<n.length;a++)if(i-=r[a],i<=0)return n[a];return n[0]}async function Ms(e,t,s,n){if(xt.has(n))return xt.delete(n),st(n),"over_times";if(!ps.has(n)&&xt.has(n))return"over_times";const o=Dp(s),r=nf();if(!r||!r.模型)return console.error("配置丢失"),"over_times";let i=null;for(const g of[o,"默认"]){const m=`${g}_setting`;if(r.模型[m]&&!(Array.isArray(r.模型[m])&&r.模型[m].length===0)&&!(typeof r.模型[m]=="object"&&r.模型[m]!==null&&Object.keys(r.模型[m]).length===0)){i=r.模型[m];break}}if(!i)return console.error("未在接入模型配置中配置模型"),"over_times";if(!ps.has(n)&&(Fp(n,i),xt.has(n)))return"over_times";const a=ps.get(n)||[];if(a.length===0)return xt.add(n),"over_times";const c=Vp(a);if(!c)return xt.add(n),"over_times";let f,u;try{f=r.模型.configs[c.config].model_baseurl,u=r.模型.configs[c.config].api_key}catch(g){return console.error("API配置错误:",g),xt.add(n),"error"}const d={model:c.model,messages:[{role:"system",content:e},{role:"user",content:t}]};for(const g of["temperature","top_p","penalty"]){const m=String(c[g]).trim();if(m)try{d[g]=parseFloat(m)}catch(y){console.warn(`参数转换错误 (${g}):`,y)}}let h;try{const g=await fetch(`${f}/chat/completions`,{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify(d)});if(!g.ok)throw new Error(`HTTP error! Status: ${g.status}`);h=(await g.json()).choices[0].message.content.replace(/<think>[\s\S]*?<\/think>/g,"")}catch(g){console.error("API请求错误:",g),h="error"}if(c.max_retry-=1,c.max_retry<=0){const g=a.filter(m=>m!==c);ps.set(n,g)}return(ps.get(n)||[]).length===0&&xt.add(n),h}function st(e){xt.delete(e),ps.has(e)&&ps.delete(e)}async function ct(e){var t,s;try{let a=function(k,$){try{for(const I of $){const R=I.isDigit?parseInt(I):I;k=k[R]}return k}catch{return null}},c=function(k,$,I,R,O){try{$=$.trim(),I=I.trim(),R=R.trim(),O=O.trim();let E="";if(O&&O.includes(",")){const N=O.split(",").map(M=>M.trim()),W=a(n,N);E=W!==null?String(W):""}if($){let N=null;if($&&$.includes(",")){const z=$.split(",").map(G=>G.trim());N=a(n,z)}let W,M=N!==null?N:!1;if(/^\d+$/.test(I))W=parseInt(I)%2===1,M=!!M;else{if(I.includes(",")){const z=I.split(",").map(pe=>pe.trim()),G=a(n,z);W=G!==null?String(G):""}else{if(I.startsWith("!")&&String(I.substring(1))!==String(M))return`${R}${E}`;W=I}M=M!==null?String(M):""}return String(M)===String(W)?`${R}${E}`:""}else return`${R}${E}`}catch(E){return console.error("Config replacement error:",E),""}};const n=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}"),o=((t=n==null?void 0:n.剧情)==null?void 0:t.language)||"中文",r=((s=n==null?void 0:n.剧情)==null?void 0:s.story_title)||"",i=`/data/${r}`;async function f(k,$){try{const I=$.replace(/\\/g,"/").trim();let R;I.startsWith("/data/")?R=I:I.startsWith("/")?R=`/data/${r}${I}`:R=`${i}${I}`,console.log(`尝试读取文件: ${R}`);const O=await Je(R);if(O==null)return"";if(typeof O=="string")return O;if(O instanceof Blob)return await new Promise(E=>{const N=new FileReader;N.onload=()=>E(N.result),N.onerror=()=>E(`[二进制文件: ${$}]`),N.readAsText(O)});if(typeof O=="object")try{return JSON.stringify(O,null,2)}catch(E){return console.error("JSON转换失败:",E),`[无法序列化对象: ${$}]`}else return String(O)}catch(I){return console.error("读取文件失败:",I),`[无法读取文件: ${$}]`}}const d=((n==null?void 0:n.提示词)||[]).find(k=>k.kind===e);if(!d)return["error","error"];const h={};for(const k of d.content)h[k.id]=k.prompt||"";const m={中文:["1","2"],英文:["3","4"],日文:["5","6"]}[o]||["1","2"];let y=h[m[0]]||"",p=h[m[1]]||"";if(!y.trim()&&!p.trim()&&(y=h[1]||"",p=h[2]||"",!y.trim()&&!p.trim()))return console.error("No prompt templates set"),["error","error"];async function b(k){let $=k.replace(/\|([^|]*)\|([^|]*)\|([^|]*)\|([^|]*)\|/g,(R,O,E,N,W)=>c(R,O,E,N,W));$=$.replace(/{data_path}/g,i),$=$.replace(/,\}/g,"}").replace(/,\]/g,"]");const I=$.match(/\{getfile\((.*?)\)\}/g)||[];for(const R of I){const O=R.match(/\{getfile\((.*?)\)\}/)[1],E=await f(R,O);$=$.replace(R,E)}return $}const w=y.trim()?await b(y):"",v=p.trim()?await b(p):"";return[w,v]}catch(n){return console.error("Error processing prompt:",n),["error","error"]}}/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */function Up(e,t,s){return(t=zp(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function ml(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),s.push.apply(s,n)}return s}function J(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?ml(Object(s),!0).forEach(function(n){Up(e,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ml(Object(s)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(s,n))})}return e}function jp(e,t){if(typeof e!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var n=s.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zp(e){var t=jp(e,"string");return typeof t=="symbol"?t:t+""}const pl=()=>{};let Gi={},rf={},af=null,lf={mark:pl,measure:pl};try{typeof window<"u"&&(Gi=window),typeof document<"u"&&(rf=document),typeof MutationObserver<"u"&&(af=MutationObserver),typeof performance<"u"&&(lf=performance)}catch{}const{userAgent:yl=""}=Gi.navigator||{},$s=Gi,De=rf,bl=af,hn=lf;$s.document;const as=!!De.documentElement&&!!De.head&&typeof De.addEventListener=="function"&&typeof De.createElement=="function",cf=~yl.indexOf("MSIE")||~yl.indexOf("Trident/");var Bp=/fa(s|r|l|t|d|dr|dl|dt|b|k|kd|ss|sr|sl|st|sds|sdr|sdl|sdt)?[\-\ ]/,qp=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp Duotone|Sharp|Kit)?.*/i,uf={classic:{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fab:"brands","fa-brands":"brands"},duotone:{fa:"solid",fad:"solid","fa-solid":"solid","fa-duotone":"solid",fadr:"regular","fa-regular":"regular",fadl:"light","fa-light":"light",fadt:"thin","fa-thin":"thin"},sharp:{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"},"sharp-duotone":{fa:"solid",fasds:"solid","fa-solid":"solid",fasdr:"regular","fa-regular":"regular",fasdl:"light","fa-light":"light",fasdt:"thin","fa-thin":"thin"}},Jp={GROUP:"duotone-group",PRIMARY:"primary",SECONDARY:"secondary"},ff=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],nt="classic",ur="duotone",Gp="sharp",Wp="sharp-duotone",df=[nt,ur,Gp,Wp],Hp={classic:{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},duotone:{900:"fad",400:"fadr",300:"fadl",100:"fadt"},sharp:{900:"fass",400:"fasr",300:"fasl",100:"fast"},"sharp-duotone":{900:"fasds",400:"fasdr",300:"fasdl",100:"fasdt"}},Kp={"Font Awesome 6 Free":{900:"fas",400:"far"},"Font Awesome 6 Pro":{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},"Font Awesome 6 Brands":{400:"fab",normal:"fab"},"Font Awesome 6 Duotone":{900:"fad",400:"fadr",normal:"fadr",300:"fadl",100:"fadt"},"Font Awesome 6 Sharp":{900:"fass",400:"fasr",normal:"fasr",300:"fasl",100:"fast"},"Font Awesome 6 Sharp Duotone":{900:"fasds",400:"fasdr",normal:"fasdr",300:"fasdl",100:"fasdt"}},Qp=new Map([["classic",{defaultShortPrefixId:"fas",defaultStyleId:"solid",styleIds:["solid","regular","light","thin","brands"],futureStyleIds:[],defaultFontWeight:900}],["sharp",{defaultShortPrefixId:"fass",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["duotone",{defaultShortPrefixId:"fad",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["sharp-duotone",{defaultShortPrefixId:"fasds",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}]]),Yp={classic:{solid:"fas",regular:"far",light:"fal",thin:"fat",brands:"fab"},duotone:{solid:"fad",regular:"fadr",light:"fadl",thin:"fadt"},sharp:{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"},"sharp-duotone":{solid:"fasds",regular:"fasdr",light:"fasdl",thin:"fasdt"}},Xp=["fak","fa-kit","fakd","fa-kit-duotone"],vl={kit:{fak:"kit","fa-kit":"kit"},"kit-duotone":{fakd:"kit-duotone","fa-kit-duotone":"kit-duotone"}},Zp=["kit"],e1={kit:{"fa-kit":"fak"}},t1=["fak","fakd"],s1={kit:{fak:"fa-kit"}},wl={kit:{kit:"fak"},"kit-duotone":{"kit-duotone":"fakd"}},mn={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},o1=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],n1=["fak","fa-kit","fakd","fa-kit-duotone"],r1={"Font Awesome Kit":{400:"fak",normal:"fak"},"Font Awesome Kit Duotone":{400:"fakd",normal:"fakd"}},i1={classic:{"fa-brands":"fab","fa-duotone":"fad","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},duotone:{"fa-regular":"fadr","fa-light":"fadl","fa-thin":"fadt"},sharp:{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"},"sharp-duotone":{"fa-solid":"fasds","fa-regular":"fasdr","fa-light":"fasdl","fa-thin":"fasdt"}},a1={classic:["fas","far","fal","fat","fad"],duotone:["fadr","fadl","fadt"],sharp:["fass","fasr","fasl","fast"],"sharp-duotone":["fasds","fasdr","fasdl","fasdt"]},ri={classic:{fab:"fa-brands",fad:"fa-duotone",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},duotone:{fadr:"fa-regular",fadl:"fa-light",fadt:"fa-thin"},sharp:{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"},"sharp-duotone":{fasds:"fa-solid",fasdr:"fa-regular",fasdl:"fa-light",fasdt:"fa-thin"}},l1=["fa-solid","fa-regular","fa-light","fa-thin","fa-duotone","fa-brands"],ii=["fa","fas","far","fal","fat","fad","fadr","fadl","fadt","fab","fass","fasr","fasl","fast","fasds","fasdr","fasdl","fasdt",...o1,...l1],c1=["solid","regular","light","thin","duotone","brands"],gf=[1,2,3,4,5,6,7,8,9,10],u1=gf.concat([11,12,13,14,15,16,17,18,19,20]),f1=[...Object.keys(a1),...c1,"2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",mn.GROUP,mn.SWAP_OPACITY,mn.PRIMARY,mn.SECONDARY].concat(gf.map(e=>"".concat(e,"x"))).concat(u1.map(e=>"w-".concat(e))),d1={"Font Awesome 5 Free":{900:"fas",400:"far"},"Font Awesome 5 Pro":{900:"fas",400:"far",normal:"far",300:"fal"},"Font Awesome 5 Brands":{400:"fab",normal:"fab"},"Font Awesome 5 Duotone":{900:"fad"}};const ns="___FONT_AWESOME___",ai=16,hf="fa",mf="svg-inline--fa",qs="data-fa-i2svg",li="data-fa-pseudo-element",g1="data-fa-pseudo-element-pending",Wi="data-prefix",Hi="data-icon",_l="fontawesome-i2svg",h1="async",m1=["HTML","HEAD","STYLE","SCRIPT"],pf=(()=>{try{return!0}catch{return!1}})();function on(e){return new Proxy(e,{get(t,s){return s in t?t[s]:t[nt]}})}const yf=J({},uf);yf[nt]=J(J(J(J({},{"fa-duotone":"duotone"}),uf[nt]),vl.kit),vl["kit-duotone"]);const p1=on(yf),ci=J({},Yp);ci[nt]=J(J(J(J({},{duotone:"fad"}),ci[nt]),wl.kit),wl["kit-duotone"]);const Cl=on(ci),ui=J({},ri);ui[nt]=J(J({},ui[nt]),s1.kit);const Ki=on(ui),fi=J({},i1);fi[nt]=J(J({},fi[nt]),e1.kit);on(fi);const y1=Bp,bf="fa-layers-text",b1=qp,v1=J({},Hp);on(v1);const w1=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],Er=Jp,_1=[...Zp,...f1],Oo=$s.FontAwesomeConfig||{};function C1(e){var t=De.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}function $1(e){return e===""?!0:e==="false"?!1:e==="true"?!0:e}De&&typeof De.querySelector=="function"&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(t=>{let[s,n]=t;const o=$1(C1(s));o!=null&&(Oo[n]=o)});const vf={styleDefault:"solid",familyDefault:nt,cssPrefix:hf,replacementClass:mf,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};Oo.familyPrefix&&(Oo.cssPrefix=Oo.familyPrefix);const mo=J(J({},vf),Oo);mo.autoReplaceSvg||(mo.observeMutations=!1);const ce={};Object.keys(vf).forEach(e=>{Object.defineProperty(ce,e,{enumerable:!0,set:function(t){mo[e]=t,Lo.forEach(s=>s(ce))},get:function(){return mo[e]}})});Object.defineProperty(ce,"familyPrefix",{enumerable:!0,set:function(e){mo.cssPrefix=e,Lo.forEach(t=>t(ce))},get:function(){return mo.cssPrefix}});$s.FontAwesomeConfig=ce;const Lo=[];function k1(e){return Lo.push(e),()=>{Lo.splice(Lo.indexOf(e),1)}}const us=ai,Ut={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function S1(e){if(!e||!as)return;const t=De.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;const s=De.head.childNodes;let n=null;for(let o=s.length-1;o>-1;o--){const r=s[o],i=(r.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(i)>-1&&(n=r)}return De.head.insertBefore(t,n),e}const x1="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function Ho(){let e=12,t="";for(;e-- >0;)t+=x1[Math.random()*62|0];return t}function bo(e){const t=[];for(let s=(e||[]).length>>>0;s--;)t[s]=e[s];return t}function Qi(e){return e.classList?bo(e.classList):(e.getAttribute("class")||"").split(" ").filter(t=>t)}function wf(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function T1(e){return Object.keys(e||{}).reduce((t,s)=>t+"".concat(s,'="').concat(wf(e[s]),'" '),"").trim()}function fr(e){return Object.keys(e||{}).reduce((t,s)=>t+"".concat(s,": ").concat(e[s].trim(),";"),"")}function Yi(e){return e.size!==Ut.size||e.x!==Ut.x||e.y!==Ut.y||e.rotate!==Ut.rotate||e.flipX||e.flipY}function I1(e){let{transform:t,containerWidth:s,iconWidth:n}=e;const o={transform:"translate(".concat(s/2," 256)")},r="translate(".concat(t.x*32,", ").concat(t.y*32,") "),i="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),a="rotate(".concat(t.rotate," 0 0)"),c={transform:"".concat(r," ").concat(i," ").concat(a)},f={transform:"translate(".concat(n/2*-1," -256)")};return{outer:o,inner:c,path:f}}function M1(e){let{transform:t,width:s=ai,height:n=ai,startCentered:o=!1}=e,r="";return o&&cf?r+="translate(".concat(t.x/us-s/2,"em, ").concat(t.y/us-n/2,"em) "):o?r+="translate(calc(-50% + ".concat(t.x/us,"em), calc(-50% + ").concat(t.y/us,"em)) "):r+="translate(".concat(t.x/us,"em, ").concat(t.y/us,"em) "),r+="scale(".concat(t.size/us*(t.flipX?-1:1),", ").concat(t.size/us*(t.flipY?-1:1),") "),r+="rotate(".concat(t.rotate,"deg) "),r}var P1=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-regular: normal 400 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-light: normal 300 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-thin: normal 100 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-regular: normal 400 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-light: normal 300 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-thin: normal 100 1em/1 "Font Awesome 6 Sharp Duotone";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-counter-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(-1 * var(--fa-li-width, 2em));
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  animation-name: fa-beat;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  animation-name: fa-bounce;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  animation-name: fa-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  animation-name: fa-beat-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  animation-name: fa-flip;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  animation-name: fa-shake;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  animation-name: fa-spin;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 2s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  animation-name: fa-spin;
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    animation-delay: -1ms;
    animation-duration: 1ms;
    animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@keyframes fa-beat {
  0%, 90% {
    transform: scale(1);
  }
  45% {
    transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-bounce {
  0% {
    transform: scale(1, 1) translateY(0);
  }
  10% {
    transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    transform: scale(1, 1) translateY(0);
  }
  100% {
    transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-flip {
  50% {
    transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-shake {
  0% {
    transform: rotate(-15deg);
  }
  4% {
    transform: rotate(15deg);
  }
  8%, 24% {
    transform: rotate(-18deg);
  }
  12%, 28% {
    transform: rotate(18deg);
  }
  16% {
    transform: rotate(-22deg);
  }
  20% {
    transform: rotate(22deg);
  }
  32% {
    transform: rotate(-12deg);
  }
  36% {
    transform: rotate(12deg);
  }
  40%, 100% {
    transform: rotate(0deg);
  }
}
@keyframes fa-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  transform: rotate(90deg);
}

.fa-rotate-180 {
  transform: rotate(180deg);
}

.fa-rotate-270 {
  transform: rotate(270deg);
}

.fa-flip-horizontal {
  transform: scale(-1, 1);
}

.fa-flip-vertical {
  transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  transform: scale(-1, -1);
}

.fa-rotate-by {
  transform: rotate(var(--fa-rotate-angle, 0));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}`;function _f(){const e=hf,t=mf,s=ce.cssPrefix,n=ce.replacementClass;let o=P1;if(s!==e||n!==t){const r=new RegExp("\\.".concat(e,"\\-"),"g"),i=new RegExp("\\--".concat(e,"\\-"),"g"),a=new RegExp("\\.".concat(t),"g");o=o.replace(r,".".concat(s,"-")).replace(i,"--".concat(s,"-")).replace(a,".".concat(n))}return o}let $l=!1;function Or(){ce.autoAddCss&&!$l&&(S1(_f()),$l=!0)}var A1={mixout(){return{dom:{css:_f,insertCss:Or}}},hooks(){return{beforeDOMElementCreation(){Or()},beforeI2svg(){Or()}}}};const rs=$s||{};rs[ns]||(rs[ns]={});rs[ns].styles||(rs[ns].styles={});rs[ns].hooks||(rs[ns].hooks={});rs[ns].shims||(rs[ns].shims=[]);var jt=rs[ns];const Cf=[],$f=function(){De.removeEventListener("DOMContentLoaded",$f),Rn=1,Cf.map(e=>e())};let Rn=!1;as&&(Rn=(De.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(De.readyState),Rn||De.addEventListener("DOMContentLoaded",$f));function E1(e){as&&(Rn?setTimeout(e,0):Cf.push(e))}function nn(e){const{tag:t,attributes:s={},children:n=[]}=e;return typeof e=="string"?wf(e):"<".concat(t," ").concat(T1(s),">").concat(n.map(nn).join(""),"</").concat(t,">")}function kl(e,t,s){if(e&&e[t]&&e[t][s])return{prefix:t,iconName:s,icon:e[t][s]}}var Lr=function(t,s,n,o){var r=Object.keys(t),i=r.length,a=s,c,f,u;for(n===void 0?(c=1,u=t[r[0]]):(c=0,u=n);c<i;c++)f=r[c],u=a(u,t[f],f,t);return u};function O1(e){const t=[];let s=0;const n=e.length;for(;s<n;){const o=e.charCodeAt(s++);if(o>=55296&&o<=56319&&s<n){const r=e.charCodeAt(s++);(r&64512)==56320?t.push(((o&1023)<<10)+(r&1023)+65536):(t.push(o),s--)}else t.push(o)}return t}function di(e){const t=O1(e);return t.length===1?t[0].toString(16):null}function L1(e,t){const s=e.length;let n=e.charCodeAt(t),o;return n>=55296&&n<=56319&&s>t+1&&(o=e.charCodeAt(t+1),o>=56320&&o<=57343)?(n-55296)*1024+o-56320+65536:n}function Sl(e){return Object.keys(e).reduce((t,s)=>{const n=e[s];return!!n.icon?t[n.iconName]=n.icon:t[s]=n,t},{})}function gi(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{skipHooks:n=!1}=s,o=Sl(t);typeof jt.hooks.addPack=="function"&&!n?jt.hooks.addPack(e,Sl(t)):jt.styles[e]=J(J({},jt.styles[e]||{}),o),e==="fas"&&gi("fa",t)}const{styles:Ko,shims:N1}=jt,kf=Object.keys(Ki),R1=kf.reduce((e,t)=>(e[t]=Object.keys(Ki[t]),e),{});let Xi=null,Sf={},xf={},Tf={},If={},Mf={};function D1(e){return~_1.indexOf(e)}function F1(e,t){const s=t.split("-"),n=s[0],o=s.slice(1).join("-");return n===e&&o!==""&&!D1(o)?o:null}const Pf=()=>{const e=n=>Lr(Ko,(o,r,i)=>(o[i]=Lr(r,n,{}),o),{});Sf=e((n,o,r)=>(o[3]&&(n[o[3]]=r),o[2]&&o[2].filter(a=>typeof a=="number").forEach(a=>{n[a.toString(16)]=r}),n)),xf=e((n,o,r)=>(n[r]=r,o[2]&&o[2].filter(a=>typeof a=="string").forEach(a=>{n[a]=r}),n)),Mf=e((n,o,r)=>{const i=o[2];return n[r]=r,i.forEach(a=>{n[a]=r}),n});const t="far"in Ko||ce.autoFetchSvg,s=Lr(N1,(n,o)=>{const r=o[0];let i=o[1];const a=o[2];return i==="far"&&!t&&(i="fas"),typeof r=="string"&&(n.names[r]={prefix:i,iconName:a}),typeof r=="number"&&(n.unicodes[r.toString(16)]={prefix:i,iconName:a}),n},{names:{},unicodes:{}});Tf=s.names,If=s.unicodes,Xi=dr(ce.styleDefault,{family:ce.familyDefault})};k1(e=>{Xi=dr(e.styleDefault,{family:ce.familyDefault})});Pf();function Zi(e,t){return(Sf[e]||{})[t]}function V1(e,t){return(xf[e]||{})[t]}function Ds(e,t){return(Mf[e]||{})[t]}function Af(e){return Tf[e]||{prefix:null,iconName:null}}function U1(e){const t=If[e],s=Zi("fas",e);return t||(s?{prefix:"fas",iconName:s}:null)||{prefix:null,iconName:null}}function ks(){return Xi}const Ef=()=>({prefix:null,iconName:null,rest:[]});function j1(e){let t=nt;const s=kf.reduce((n,o)=>(n[o]="".concat(ce.cssPrefix,"-").concat(o),n),{});return df.forEach(n=>{(e.includes(s[n])||e.some(o=>R1[n].includes(o)))&&(t=n)}),t}function dr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{family:s=nt}=t,n=p1[s][e];if(s===ur&&!e)return"fad";const o=Cl[s][e]||Cl[s][n],r=e in jt.styles?e:null;return o||r||null}function z1(e){let t=[],s=null;return e.forEach(n=>{const o=F1(ce.cssPrefix,n);o?s=o:n&&t.push(n)}),{iconName:s,rest:t}}function xl(e){return e.sort().filter((t,s,n)=>n.indexOf(t)===s)}function gr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{skipLookups:s=!1}=t;let n=null;const o=ii.concat(n1),r=xl(e.filter(d=>o.includes(d))),i=xl(e.filter(d=>!ii.includes(d))),a=r.filter(d=>(n=d,!ff.includes(d))),[c=null]=a,f=j1(r),u=J(J({},z1(i)),{},{prefix:dr(c,{family:f})});return J(J(J({},u),G1({values:e,family:f,styles:Ko,config:ce,canonical:u,givenPrefix:n})),B1(s,n,u))}function B1(e,t,s){let{prefix:n,iconName:o}=s;if(e||!n||!o)return{prefix:n,iconName:o};const r=t==="fa"?Af(o):{},i=Ds(n,o);return o=r.iconName||i||o,n=r.prefix||n,n==="far"&&!Ko.far&&Ko.fas&&!ce.autoFetchSvg&&(n="fas"),{prefix:n,iconName:o}}const q1=df.filter(e=>e!==nt||e!==ur),J1=Object.keys(ri).filter(e=>e!==nt).map(e=>Object.keys(ri[e])).flat();function G1(e){const{values:t,family:s,canonical:n,givenPrefix:o="",styles:r={},config:i={}}=e,a=s===ur,c=t.includes("fa-duotone")||t.includes("fad"),f=i.familyDefault==="duotone",u=n.prefix==="fad"||n.prefix==="fa-duotone";if(!a&&(c||f||u)&&(n.prefix="fad"),(t.includes("fa-brands")||t.includes("fab"))&&(n.prefix="fab"),!n.prefix&&q1.includes(s)&&(Object.keys(r).find(h=>J1.includes(h))||i.autoFetchSvg)){const h=Qp.get(s).defaultShortPrefixId;n.prefix=h,n.iconName=Ds(n.prefix,n.iconName)||n.iconName}return(n.prefix==="fa"||o==="fa")&&(n.prefix=ks()||"fas"),n}class W1{constructor(){this.definitions={}}add(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];const o=s.reduce(this._pullDefinitions,{});Object.keys(o).forEach(r=>{this.definitions[r]=J(J({},this.definitions[r]||{}),o[r]),gi(r,o[r]);const i=Ki[nt][r];i&&gi(i,o[r]),Pf()})}reset(){this.definitions={}}_pullDefinitions(t,s){const n=s.prefix&&s.iconName&&s.icon?{0:s}:s;return Object.keys(n).map(o=>{const{prefix:r,iconName:i,icon:a}=n[o],c=a[2];t[r]||(t[r]={}),c.length>0&&c.forEach(f=>{typeof f=="string"&&(t[r][f]=a)}),t[r][i]=a}),t}}let Tl=[],Zs={};const lo={},H1=Object.keys(lo);function K1(e,t){let{mixoutsTo:s}=t;return Tl=e,Zs={},Object.keys(lo).forEach(n=>{H1.indexOf(n)===-1&&delete lo[n]}),Tl.forEach(n=>{const o=n.mixout?n.mixout():{};if(Object.keys(o).forEach(r=>{typeof o[r]=="function"&&(s[r]=o[r]),typeof o[r]=="object"&&Object.keys(o[r]).forEach(i=>{s[r]||(s[r]={}),s[r][i]=o[r][i]})}),n.hooks){const r=n.hooks();Object.keys(r).forEach(i=>{Zs[i]||(Zs[i]=[]),Zs[i].push(r[i])})}n.provides&&n.provides(lo)}),s}function hi(e,t){for(var s=arguments.length,n=new Array(s>2?s-2:0),o=2;o<s;o++)n[o-2]=arguments[o];return(Zs[e]||[]).forEach(i=>{t=i.apply(null,[t,...n])}),t}function Js(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];(Zs[e]||[]).forEach(r=>{r.apply(null,s)})}function Ss(){const e=arguments[0],t=Array.prototype.slice.call(arguments,1);return lo[e]?lo[e].apply(null,t):void 0}function mi(e){e.prefix==="fa"&&(e.prefix="fas");let{iconName:t}=e;const s=e.prefix||ks();if(t)return t=Ds(s,t)||t,kl(Of.definitions,s,t)||kl(jt.styles,s,t)}const Of=new W1,Q1=()=>{ce.autoReplaceSvg=!1,ce.observeMutations=!1,Js("noAuto")},Y1={i2svg:function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return as?(Js("beforeI2svg",e),Ss("pseudoElements2svg",e),Ss("i2svg",e)):Promise.reject(new Error("Operation requires a DOM of some kind."))},watch:function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:t}=e;ce.autoReplaceSvg===!1&&(ce.autoReplaceSvg=!0),ce.observeMutations=!0,E1(()=>{Z1({autoReplaceSvgRoot:t}),Js("watch",e)})}},X1={icon:e=>{if(e===null)return null;if(typeof e=="object"&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:Ds(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&e.length===2){const t=e[1].indexOf("fa-")===0?e[1].slice(3):e[1],s=dr(e[0]);return{prefix:s,iconName:Ds(s,t)||t}}if(typeof e=="string"&&(e.indexOf("".concat(ce.cssPrefix,"-"))>-1||e.match(y1))){const t=gr(e.split(" "),{skipLookups:!0});return{prefix:t.prefix||ks(),iconName:Ds(t.prefix,t.iconName)||t.iconName}}if(typeof e=="string"){const t=ks();return{prefix:t,iconName:Ds(t,e)||e}}}},wt={noAuto:Q1,config:ce,dom:Y1,parse:X1,library:Of,findIconDefinition:mi,toHtml:nn},Z1=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:t=De}=e;(Object.keys(jt.styles).length>0||ce.autoFetchSvg)&&as&&ce.autoReplaceSvg&&wt.dom.i2svg({node:t})};function hr(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(s=>nn(s))}}),Object.defineProperty(e,"node",{get:function(){if(!as)return;const s=De.createElement("div");return s.innerHTML=e.html,s.children}}),e}function e2(e){let{children:t,main:s,mask:n,attributes:o,styles:r,transform:i}=e;if(Yi(i)&&s.found&&!n.found){const{width:a,height:c}=s,f={x:a/c/2,y:.5};o.style=fr(J(J({},r),{},{"transform-origin":"".concat(f.x+i.x/16,"em ").concat(f.y+i.y/16,"em")}))}return[{tag:"svg",attributes:o,children:t}]}function t2(e){let{prefix:t,iconName:s,children:n,attributes:o,symbol:r}=e;const i=r===!0?"".concat(t,"-").concat(ce.cssPrefix,"-").concat(s):r;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:J(J({},o),{},{id:i}),children:n}]}]}function ea(e){const{icons:{main:t,mask:s},prefix:n,iconName:o,transform:r,symbol:i,title:a,maskId:c,titleId:f,extra:u,watchable:d=!1}=e,{width:h,height:g}=s.found?s:t,m=t1.includes(n),y=[ce.replacementClass,o?"".concat(ce.cssPrefix,"-").concat(o):""].filter($=>u.classes.indexOf($)===-1).filter($=>$!==""||!!$).concat(u.classes).join(" ");let p={children:[],attributes:J(J({},u.attributes),{},{"data-prefix":n,"data-icon":o,class:y,role:u.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(h," ").concat(g)})};const b=m&&!~u.classes.indexOf("fa-fw")?{width:"".concat(h/g*16*.0625,"em")}:{};d&&(p.attributes[qs]=""),a&&(p.children.push({tag:"title",attributes:{id:p.attributes["aria-labelledby"]||"title-".concat(f||Ho())},children:[a]}),delete p.attributes.title);const w=J(J({},p),{},{prefix:n,iconName:o,main:t,mask:s,maskId:c,transform:r,symbol:i,styles:J(J({},b),u.styles)}),{children:v,attributes:k}=s.found&&t.found?Ss("generateAbstractMask",w)||{children:[],attributes:{}}:Ss("generateAbstractIcon",w)||{children:[],attributes:{}};return w.children=v,w.attributes=k,i?t2(w):e2(w)}function Il(e){const{content:t,width:s,height:n,transform:o,title:r,extra:i,watchable:a=!1}=e,c=J(J(J({},i.attributes),r?{title:r}:{}),{},{class:i.classes.join(" ")});a&&(c[qs]="");const f=J({},i.styles);Yi(o)&&(f.transform=M1({transform:o,startCentered:!0,width:s,height:n}),f["-webkit-transform"]=f.transform);const u=fr(f);u.length>0&&(c.style=u);const d=[];return d.push({tag:"span",attributes:c,children:[t]}),r&&d.push({tag:"span",attributes:{class:"sr-only"},children:[r]}),d}function s2(e){const{content:t,title:s,extra:n}=e,o=J(J(J({},n.attributes),s?{title:s}:{}),{},{class:n.classes.join(" ")}),r=fr(n.styles);r.length>0&&(o.style=r);const i=[];return i.push({tag:"span",attributes:o,children:[t]}),s&&i.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),i}const{styles:Nr}=jt;function pi(e){const t=e[0],s=e[1],[n]=e.slice(4);let o=null;return Array.isArray(n)?o={tag:"g",attributes:{class:"".concat(ce.cssPrefix,"-").concat(Er.GROUP)},children:[{tag:"path",attributes:{class:"".concat(ce.cssPrefix,"-").concat(Er.SECONDARY),fill:"currentColor",d:n[0]}},{tag:"path",attributes:{class:"".concat(ce.cssPrefix,"-").concat(Er.PRIMARY),fill:"currentColor",d:n[1]}}]}:o={tag:"path",attributes:{fill:"currentColor",d:n}},{found:!0,width:t,height:s,icon:o}}const o2={found:!1,width:512,height:512};function n2(e,t){!pf&&!ce.showMissingIcons&&e&&console.error('Icon with name "'.concat(e,'" and prefix "').concat(t,'" is missing.'))}function yi(e,t){let s=t;return t==="fa"&&ce.styleDefault!==null&&(t=ks()),new Promise((n,o)=>{if(s==="fa"){const r=Af(e)||{};e=r.iconName||e,t=r.prefix||t}if(e&&t&&Nr[t]&&Nr[t][e]){const r=Nr[t][e];return n(pi(r))}n2(e,t),n(J(J({},o2),{},{icon:ce.showMissingIcons&&e?Ss("missingIconAbstract")||{}:{}}))})}const Ml=()=>{},bi=ce.measurePerformance&&hn&&hn.mark&&hn.measure?hn:{mark:Ml,measure:Ml},So='FA "6.7.2"',r2=e=>(bi.mark("".concat(So," ").concat(e," begins")),()=>Lf(e)),Lf=e=>{bi.mark("".concat(So," ").concat(e," ends")),bi.measure("".concat(So," ").concat(e),"".concat(So," ").concat(e," begins"),"".concat(So," ").concat(e," ends"))};var ta={begin:r2,end:Lf};const $n=()=>{};function Pl(e){return typeof(e.getAttribute?e.getAttribute(qs):null)=="string"}function i2(e){const t=e.getAttribute?e.getAttribute(Wi):null,s=e.getAttribute?e.getAttribute(Hi):null;return t&&s}function a2(e){return e&&e.classList&&e.classList.contains&&e.classList.contains(ce.replacementClass)}function l2(){return ce.autoReplaceSvg===!0?kn.replace:kn[ce.autoReplaceSvg]||kn.replace}function c2(e){return De.createElementNS("http://www.w3.org/2000/svg",e)}function u2(e){return De.createElement(e)}function Nf(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{ceFn:s=e.tag==="svg"?c2:u2}=t;if(typeof e=="string")return De.createTextNode(e);const n=s(e.tag);return Object.keys(e.attributes||[]).forEach(function(r){n.setAttribute(r,e.attributes[r])}),(e.children||[]).forEach(function(r){n.appendChild(Nf(r,{ceFn:s}))}),n}function f2(e){let t=" ".concat(e.outerHTML," ");return t="".concat(t,"Font Awesome fontawesome.com "),t}const kn={replace:function(e){const t=e[0];if(t.parentNode)if(e[1].forEach(s=>{t.parentNode.insertBefore(Nf(s),t)}),t.getAttribute(qs)===null&&ce.keepOriginalSource){let s=De.createComment(f2(t));t.parentNode.replaceChild(s,t)}else t.remove()},nest:function(e){const t=e[0],s=e[1];if(~Qi(t).indexOf(ce.replacementClass))return kn.replace(e);const n=new RegExp("".concat(ce.cssPrefix,"-.*"));if(delete s[0].attributes.id,s[0].attributes.class){const r=s[0].attributes.class.split(" ").reduce((i,a)=>(a===ce.replacementClass||a.match(n)?i.toSvg.push(a):i.toNode.push(a),i),{toNode:[],toSvg:[]});s[0].attributes.class=r.toSvg.join(" "),r.toNode.length===0?t.removeAttribute("class"):t.setAttribute("class",r.toNode.join(" "))}const o=s.map(r=>nn(r)).join(`
`);t.setAttribute(qs,""),t.innerHTML=o}};function Al(e){e()}function Rf(e,t){const s=typeof t=="function"?t:$n;if(e.length===0)s();else{let n=Al;ce.mutateApproach===h1&&(n=$s.requestAnimationFrame||Al),n(()=>{const o=l2(),r=ta.begin("mutate");e.map(o),r(),s()})}}let sa=!1;function Df(){sa=!0}function vi(){sa=!1}let Dn=null;function El(e){if(!bl||!ce.observeMutations)return;const{treeCallback:t=$n,nodeCallback:s=$n,pseudoElementsCallback:n=$n,observeMutationsRoot:o=De}=e;Dn=new bl(r=>{if(sa)return;const i=ks();bo(r).forEach(a=>{if(a.type==="childList"&&a.addedNodes.length>0&&!Pl(a.addedNodes[0])&&(ce.searchPseudoElements&&n(a.target),t(a.target)),a.type==="attributes"&&a.target.parentNode&&ce.searchPseudoElements&&n(a.target.parentNode),a.type==="attributes"&&Pl(a.target)&&~w1.indexOf(a.attributeName))if(a.attributeName==="class"&&i2(a.target)){const{prefix:c,iconName:f}=gr(Qi(a.target));a.target.setAttribute(Wi,c||i),f&&a.target.setAttribute(Hi,f)}else a2(a.target)&&s(a.target)})}),as&&Dn.observe(o,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}function d2(){Dn&&Dn.disconnect()}function g2(e){const t=e.getAttribute("style");let s=[];return t&&(s=t.split(";").reduce((n,o)=>{const r=o.split(":"),i=r[0],a=r.slice(1);return i&&a.length>0&&(n[i]=a.join(":").trim()),n},{})),s}function h2(e){const t=e.getAttribute("data-prefix"),s=e.getAttribute("data-icon"),n=e.innerText!==void 0?e.innerText.trim():"";let o=gr(Qi(e));return o.prefix||(o.prefix=ks()),t&&s&&(o.prefix=t,o.iconName=s),o.iconName&&o.prefix||(o.prefix&&n.length>0&&(o.iconName=V1(o.prefix,e.innerText)||Zi(o.prefix,di(e.innerText))),!o.iconName&&ce.autoFetchSvg&&e.firstChild&&e.firstChild.nodeType===Node.TEXT_NODE&&(o.iconName=e.firstChild.data)),o}function m2(e){const t=bo(e.attributes).reduce((o,r)=>(o.name!=="class"&&o.name!=="style"&&(o[r.name]=r.value),o),{}),s=e.getAttribute("title"),n=e.getAttribute("data-fa-title-id");return ce.autoA11y&&(s?t["aria-labelledby"]="".concat(ce.replacementClass,"-title-").concat(n||Ho()):(t["aria-hidden"]="true",t.focusable="false")),t}function p2(){return{iconName:null,title:null,titleId:null,prefix:null,transform:Ut,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function Ol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0};const{iconName:s,prefix:n,rest:o}=h2(e),r=m2(e),i=hi("parseNodeAttributes",{},e);let a=t.styleParser?g2(e):[];return J({iconName:s,title:e.getAttribute("title"),titleId:e.getAttribute("data-fa-title-id"),prefix:n,transform:Ut,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:o,styles:a,attributes:r}},i)}const{styles:y2}=jt;function Ff(e){const t=ce.autoReplaceSvg==="nest"?Ol(e,{styleParser:!1}):Ol(e);return~t.extra.classes.indexOf(bf)?Ss("generateLayersText",e,t):Ss("generateSvgReplacementMutation",e,t)}function b2(){return[...Xp,...ii]}function Ll(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!as)return Promise.resolve();const s=De.documentElement.classList,n=u=>s.add("".concat(_l,"-").concat(u)),o=u=>s.remove("".concat(_l,"-").concat(u)),r=ce.autoFetchSvg?b2():ff.concat(Object.keys(y2));r.includes("fa")||r.push("fa");const i=[".".concat(bf,":not([").concat(qs,"])")].concat(r.map(u=>".".concat(u,":not([").concat(qs,"])"))).join(", ");if(i.length===0)return Promise.resolve();let a=[];try{a=bo(e.querySelectorAll(i))}catch{}if(a.length>0)n("pending"),o("complete");else return Promise.resolve();const c=ta.begin("onTree"),f=a.reduce((u,d)=>{try{const h=Ff(d);h&&u.push(h)}catch(h){pf||h.name==="MissingIcon"&&console.error(h)}return u},[]);return new Promise((u,d)=>{Promise.all(f).then(h=>{Rf(h,()=>{n("active"),n("complete"),o("pending"),typeof t=="function"&&t(),c(),u()})}).catch(h=>{c(),d(h)})})}function v2(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Ff(e).then(s=>{s&&Rf([s],t)})}function w2(e){return function(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=(t||{}).icon?t:mi(t||{});let{mask:o}=s;return o&&(o=(o||{}).icon?o:mi(o||{})),e(n,J(J({},s),{},{mask:o}))}}const _2=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:s=Ut,symbol:n=!1,mask:o=null,maskId:r=null,title:i=null,titleId:a=null,classes:c=[],attributes:f={},styles:u={}}=t;if(!e)return;const{prefix:d,iconName:h,icon:g}=e;return hr(J({type:"icon"},e),()=>(Js("beforeDOMElementCreation",{iconDefinition:e,params:t}),ce.autoA11y&&(i?f["aria-labelledby"]="".concat(ce.replacementClass,"-title-").concat(a||Ho()):(f["aria-hidden"]="true",f.focusable="false")),ea({icons:{main:pi(g),mask:o?pi(o.icon):{found:!1,width:null,height:null,icon:{}}},prefix:d,iconName:h,transform:J(J({},Ut),s),symbol:n,title:i,maskId:r,titleId:a,extra:{attributes:f,styles:u,classes:c}})))};var C2={mixout(){return{icon:w2(_2)}},hooks(){return{mutationObserverCallbacks(e){return e.treeCallback=Ll,e.nodeCallback=v2,e}}},provides(e){e.i2svg=function(t){const{node:s=De,callback:n=()=>{}}=t;return Ll(s,n)},e.generateSvgReplacementMutation=function(t,s){const{iconName:n,title:o,titleId:r,prefix:i,transform:a,symbol:c,mask:f,maskId:u,extra:d}=s;return new Promise((h,g)=>{Promise.all([yi(n,i),f.iconName?yi(f.iconName,f.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(m=>{let[y,p]=m;h([t,ea({icons:{main:y,mask:p},prefix:i,iconName:n,transform:a,symbol:c,maskId:u,title:o,titleId:r,extra:d,watchable:!0})])}).catch(g)})},e.generateAbstractIcon=function(t){let{children:s,attributes:n,main:o,transform:r,styles:i}=t;const a=fr(i);a.length>0&&(n.style=a);let c;return Yi(r)&&(c=Ss("generateAbstractTransformGrouping",{main:o,transform:r,containerWidth:o.width,iconWidth:o.width})),s.push(c||o.icon),{children:s,attributes:n}}}},$2={mixout(){return{layer(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{classes:s=[]}=t;return hr({type:"layer"},()=>{Js("beforeDOMElementCreation",{assembler:e,params:t});let n=[];return e(o=>{Array.isArray(o)?o.map(r=>{n=n.concat(r.abstract)}):n=n.concat(o.abstract)}),[{tag:"span",attributes:{class:["".concat(ce.cssPrefix,"-layers"),...s].join(" ")},children:n}]})}}}},k2={mixout(){return{counter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{title:s=null,classes:n=[],attributes:o={},styles:r={}}=t;return hr({type:"counter",content:e},()=>(Js("beforeDOMElementCreation",{content:e,params:t}),s2({content:e.toString(),title:s,extra:{attributes:o,styles:r,classes:["".concat(ce.cssPrefix,"-layers-counter"),...n]}})))}}}},S2={mixout(){return{text(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:s=Ut,title:n=null,classes:o=[],attributes:r={},styles:i={}}=t;return hr({type:"text",content:e},()=>(Js("beforeDOMElementCreation",{content:e,params:t}),Il({content:e,transform:J(J({},Ut),s),title:n,extra:{attributes:r,styles:i,classes:["".concat(ce.cssPrefix,"-layers-text"),...o]}})))}}},provides(e){e.generateLayersText=function(t,s){const{title:n,transform:o,extra:r}=s;let i=null,a=null;if(cf){const c=parseInt(getComputedStyle(t).fontSize,10),f=t.getBoundingClientRect();i=f.width/c,a=f.height/c}return ce.autoA11y&&!n&&(r.attributes["aria-hidden"]="true"),Promise.resolve([t,Il({content:t.innerHTML,width:i,height:a,transform:o,title:n,extra:r,watchable:!0})])}}};const x2=new RegExp('"',"ug"),Nl=[1105920,1112319],Rl=J(J(J(J({},{FontAwesome:{normal:"fas",400:"fas"}}),Kp),d1),r1),wi=Object.keys(Rl).reduce((e,t)=>(e[t.toLowerCase()]=Rl[t],e),{}),T2=Object.keys(wi).reduce((e,t)=>{const s=wi[t];return e[t]=s[900]||[...Object.entries(s)][0][1],e},{});function I2(e){const t=e.replace(x2,""),s=L1(t,0),n=s>=Nl[0]&&s<=Nl[1],o=t.length===2?t[0]===t[1]:!1;return{value:di(o?t[0]:t),isSecondary:n||o}}function M2(e,t){const s=e.replace(/^['"]|['"]$/g,"").toLowerCase(),n=parseInt(t),o=isNaN(n)?"normal":n;return(wi[s]||{})[o]||T2[s]}function Dl(e,t){const s="".concat(g1).concat(t.replace(":","-"));return new Promise((n,o)=>{if(e.getAttribute(s)!==null)return n();const i=bo(e.children).filter(h=>h.getAttribute(li)===t)[0],a=$s.getComputedStyle(e,t),c=a.getPropertyValue("font-family"),f=c.match(b1),u=a.getPropertyValue("font-weight"),d=a.getPropertyValue("content");if(i&&!f)return e.removeChild(i),n();if(f&&d!=="none"&&d!==""){const h=a.getPropertyValue("content");let g=M2(c,u);const{value:m,isSecondary:y}=I2(h),p=f[0].startsWith("FontAwesome");let b=Zi(g,m),w=b;if(p){const v=U1(m);v.iconName&&v.prefix&&(b=v.iconName,g=v.prefix)}if(b&&!y&&(!i||i.getAttribute(Wi)!==g||i.getAttribute(Hi)!==w)){e.setAttribute(s,w),i&&e.removeChild(i);const v=p2(),{extra:k}=v;k.attributes[li]=t,yi(b,g).then($=>{const I=ea(J(J({},v),{},{icons:{main:$,mask:Ef()},prefix:g,iconName:w,extra:k,watchable:!0})),R=De.createElementNS("http://www.w3.org/2000/svg","svg");t==="::before"?e.insertBefore(R,e.firstChild):e.appendChild(R),R.outerHTML=I.map(O=>nn(O)).join(`
`),e.removeAttribute(s),n()}).catch(o)}else n()}else n()})}function P2(e){return Promise.all([Dl(e,"::before"),Dl(e,"::after")])}function A2(e){return e.parentNode!==document.head&&!~m1.indexOf(e.tagName.toUpperCase())&&!e.getAttribute(li)&&(!e.parentNode||e.parentNode.tagName!=="svg")}function Fl(e){if(as)return new Promise((t,s)=>{const n=bo(e.querySelectorAll("*")).filter(A2).map(P2),o=ta.begin("searchPseudoElements");Df(),Promise.all(n).then(()=>{o(),vi(),t()}).catch(()=>{o(),vi(),s()})})}var E2={hooks(){return{mutationObserverCallbacks(e){return e.pseudoElementsCallback=Fl,e}}},provides(e){e.pseudoElements2svg=function(t){const{node:s=De}=t;ce.searchPseudoElements&&Fl(s)}}};let Vl=!1;var O2={mixout(){return{dom:{unwatch(){Df(),Vl=!0}}}},hooks(){return{bootstrap(){El(hi("mutationObserverCallbacks",{}))},noAuto(){d2()},watch(e){const{observeMutationsRoot:t}=e;Vl?vi():El(hi("mutationObserverCallbacks",{observeMutationsRoot:t}))}}}};const Ul=e=>{let t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e.toLowerCase().split(" ").reduce((s,n)=>{const o=n.toLowerCase().split("-"),r=o[0];let i=o.slice(1).join("-");if(r&&i==="h")return s.flipX=!0,s;if(r&&i==="v")return s.flipY=!0,s;if(i=parseFloat(i),isNaN(i))return s;switch(r){case"grow":s.size=s.size+i;break;case"shrink":s.size=s.size-i;break;case"left":s.x=s.x-i;break;case"right":s.x=s.x+i;break;case"up":s.y=s.y-i;break;case"down":s.y=s.y+i;break;case"rotate":s.rotate=s.rotate+i;break}return s},t)};var L2={mixout(){return{parse:{transform:e=>Ul(e)}}},hooks(){return{parseNodeAttributes(e,t){const s=t.getAttribute("data-fa-transform");return s&&(e.transform=Ul(s)),e}}},provides(e){e.generateAbstractTransformGrouping=function(t){let{main:s,transform:n,containerWidth:o,iconWidth:r}=t;const i={transform:"translate(".concat(o/2," 256)")},a="translate(".concat(n.x*32,", ").concat(n.y*32,") "),c="scale(".concat(n.size/16*(n.flipX?-1:1),", ").concat(n.size/16*(n.flipY?-1:1),") "),f="rotate(".concat(n.rotate," 0 0)"),u={transform:"".concat(a," ").concat(c," ").concat(f)},d={transform:"translate(".concat(r/2*-1," -256)")},h={outer:i,inner:u,path:d};return{tag:"g",attributes:J({},h.outer),children:[{tag:"g",attributes:J({},h.inner),children:[{tag:s.icon.tag,children:s.icon.children,attributes:J(J({},s.icon.attributes),h.path)}]}]}}}};const Rr={x:0,y:0,width:"100%",height:"100%"};function jl(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function N2(e){return e.tag==="g"?e.children:[e]}var R2={hooks(){return{parseNodeAttributes(e,t){const s=t.getAttribute("data-fa-mask"),n=s?gr(s.split(" ").map(o=>o.trim())):Ef();return n.prefix||(n.prefix=ks()),e.mask=n,e.maskId=t.getAttribute("data-fa-mask-id"),e}}},provides(e){e.generateAbstractMask=function(t){let{children:s,attributes:n,main:o,mask:r,maskId:i,transform:a}=t;const{width:c,icon:f}=o,{width:u,icon:d}=r,h=I1({transform:a,containerWidth:u,iconWidth:c}),g={tag:"rect",attributes:J(J({},Rr),{},{fill:"white"})},m=f.children?{children:f.children.map(jl)}:{},y={tag:"g",attributes:J({},h.inner),children:[jl(J({tag:f.tag,attributes:J(J({},f.attributes),h.path)},m))]},p={tag:"g",attributes:J({},h.outer),children:[y]},b="mask-".concat(i||Ho()),w="clip-".concat(i||Ho()),v={tag:"mask",attributes:J(J({},Rr),{},{id:b,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[g,p]},k={tag:"defs",children:[{tag:"clipPath",attributes:{id:w},children:N2(d)},v]};return s.push(k,{tag:"rect",attributes:J({fill:"currentColor","clip-path":"url(#".concat(w,")"),mask:"url(#".concat(b,")")},Rr)}),{children:s,attributes:n}}}},D2={provides(e){let t=!1;$s.matchMedia&&(t=$s.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){const s=[],n={fill:"currentColor"},o={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};s.push({tag:"path",attributes:J(J({},n),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});const r=J(J({},o),{},{attributeName:"opacity"}),i={tag:"circle",attributes:J(J({},n),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||i.children.push({tag:"animate",attributes:J(J({},o),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:J(J({},r),{},{values:"1;0;1;1;0;1;"})}),s.push(i),s.push({tag:"path",attributes:J(J({},n),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:J(J({},r),{},{values:"1;0;0;0;0;1;"})}]}),t||s.push({tag:"path",attributes:J(J({},n),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:J(J({},r),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:s}}}},F2={hooks(){return{parseNodeAttributes(e,t){const s=t.getAttribute("data-fa-symbol"),n=s===null?!1:s===""?!0:s;return e.symbol=n,e}}}},V2=[A1,C2,$2,k2,S2,E2,O2,L2,R2,D2,F2];K1(V2,{mixoutsTo:wt});wt.noAuto;wt.config;const Vf=wt.library;wt.dom;const _i=wt.parse;wt.findIconDefinition;wt.toHtml;const U2=wt.icon;wt.layer;wt.text;wt.counter;function zl(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),s.push.apply(s,n)}return s}function es(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?zl(Object(s),!0).forEach(function(n){ut(e,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):zl(Object(s)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(s,n))})}return e}function j2(e,t){if(typeof e!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var n=s.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function z2(e){var t=j2(e,"string");return typeof t=="symbol"?t:t+""}function Fn(e){"@babel/helpers - typeof";return Fn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fn(e)}function ut(e,t,s){return t=z2(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function B2(e,t){if(e==null)return{};var s={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;s[n]=e[n]}return s}function q2(e,t){if(e==null)return{};var s=B2(e,t),n,o;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var J2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Uf={exports:{}};(function(e){(function(t){var s=function(b,w,v){if(!f(w)||d(w)||h(w)||g(w)||c(w))return w;var k,$=0,I=0;if(u(w))for(k=[],I=w.length;$<I;$++)k.push(s(b,w[$],v));else{k={};for(var R in w)Object.prototype.hasOwnProperty.call(w,R)&&(k[b(R,v)]=s(b,w[R],v))}return k},n=function(b,w){w=w||{};var v=w.separator||"_",k=w.split||/(?=[A-Z])/;return b.split(k).join(v)},o=function(b){return m(b)?b:(b=b.replace(/[\-_\s]+(.)?/g,function(w,v){return v?v.toUpperCase():""}),b.substr(0,1).toLowerCase()+b.substr(1))},r=function(b){var w=o(b);return w.substr(0,1).toUpperCase()+w.substr(1)},i=function(b,w){return n(b,w).toLowerCase()},a=Object.prototype.toString,c=function(b){return typeof b=="function"},f=function(b){return b===Object(b)},u=function(b){return a.call(b)=="[object Array]"},d=function(b){return a.call(b)=="[object Date]"},h=function(b){return a.call(b)=="[object RegExp]"},g=function(b){return a.call(b)=="[object Boolean]"},m=function(b){return b=b-0,b===b},y=function(b,w){var v=w&&"process"in w?w.process:w;return typeof v!="function"?b:function(k,$){return v(k,b,$)}},p={camelize:o,decamelize:i,pascalize:r,depascalize:i,camelizeKeys:function(b,w){return s(y(o,w),b)},decamelizeKeys:function(b,w){return s(y(i,w),b,w)},pascalizeKeys:function(b,w){return s(y(r,w),b)},depascalizeKeys:function(){return this.decamelizeKeys.apply(this,arguments)}};e.exports?e.exports=p:t.humps=p})(J2)})(Uf);var G2=Uf.exports,W2=["class","style"];function H2(e){return e.split(";").map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,s){var n=s.indexOf(":"),o=G2.camelize(s.slice(0,n)),r=s.slice(n+1).trim();return t[o]=r,t},{})}function K2(e){return e.split(/\s+/).reduce(function(t,s){return t[s]=!0,t},{})}function jf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string")return e;var n=(e.children||[]).map(function(c){return jf(c)}),o=Object.keys(e.attributes||{}).reduce(function(c,f){var u=e.attributes[f];switch(f){case"class":c.class=K2(u);break;case"style":c.style=H2(u);break;default:c.attrs[f]=u}return c},{attrs:{},class:{},style:{}});s.class;var r=s.style,i=r===void 0?{}:r,a=q2(s,W2);return nr(e.tag,es(es(es({},t),{},{class:o.class,style:es(es({},o.style),i)},o.attrs),a),n)}var zf=!1;try{zf=!0}catch{}function Q2(){if(!zf&&console&&typeof console.error=="function"){var e;(e=console).error.apply(e,arguments)}}function Dr(e,t){return Array.isArray(t)&&t.length>0||!Array.isArray(t)&&t?ut({},e,t):{}}function Y2(e){var t,s=(t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-li":e.listItem,"fa-inverse":e.inverse,"fa-flip":e.flip===!0,"fa-flip-horizontal":e.flip==="horizontal"||e.flip==="both","fa-flip-vertical":e.flip==="vertical"||e.flip==="both"},ut(ut(ut(ut(ut(ut(ut(ut(ut(ut(t,"fa-".concat(e.size),e.size!==null),"fa-rotate-".concat(e.rotation),e.rotation!==null),"fa-pull-".concat(e.pull),e.pull!==null),"fa-swap-opacity",e.swapOpacity),"fa-bounce",e.bounce),"fa-shake",e.shake),"fa-beat",e.beat),"fa-fade",e.fade),"fa-beat-fade",e.beatFade),"fa-flash",e.flash),ut(ut(t,"fa-spin-pulse",e.spinPulse),"fa-spin-reverse",e.spinReverse));return Object.keys(s).map(function(n){return s[n]?n:null}).filter(function(n){return n})}function Bl(e){if(e&&Fn(e)==="object"&&e.prefix&&e.iconName&&e.icon)return e;if(_i.icon)return _i.icon(e);if(e===null)return null;if(Fn(e)==="object"&&e.prefix&&e.iconName)return e;if(Array.isArray(e)&&e.length===2)return{prefix:e[0],iconName:e[1]};if(typeof e=="string")return{prefix:"fas",iconName:e}}var Bf=Jt({name:"FontAwesomeIcon",props:{border:{type:Boolean,default:!1},fixedWidth:{type:Boolean,default:!1},flip:{type:[Boolean,String],default:!1,validator:function(t){return[!0,!1,"horizontal","vertical","both"].indexOf(t)>-1}},icon:{type:[Object,Array,String],required:!0},mask:{type:[Object,Array,String],default:null},maskId:{type:String,default:null},listItem:{type:Boolean,default:!1},pull:{type:String,default:null,validator:function(t){return["right","left"].indexOf(t)>-1}},pulse:{type:Boolean,default:!1},rotation:{type:[String,Number],default:null,validator:function(t){return[90,180,270].indexOf(Number.parseInt(t,10))>-1}},swapOpacity:{type:Boolean,default:!1},size:{type:String,default:null,validator:function(t){return["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"].indexOf(t)>-1}},spin:{type:Boolean,default:!1},transform:{type:[String,Object],default:null},symbol:{type:[Boolean,String],default:!1},title:{type:String,default:null},titleId:{type:String,default:null},inverse:{type:Boolean,default:!1},bounce:{type:Boolean,default:!1},shake:{type:Boolean,default:!1},beat:{type:Boolean,default:!1},fade:{type:Boolean,default:!1},beatFade:{type:Boolean,default:!1},flash:{type:Boolean,default:!1},spinPulse:{type:Boolean,default:!1},spinReverse:{type:Boolean,default:!1}},setup:function(t,s){var n=s.attrs,o=He(function(){return Bl(t.icon)}),r=He(function(){return Dr("classes",Y2(t))}),i=He(function(){return Dr("transform",typeof t.transform=="string"?_i.transform(t.transform):t.transform)}),a=He(function(){return Dr("mask",Bl(t.mask))}),c=He(function(){return U2(o.value,es(es(es(es({},r.value),i.value),a.value),{},{symbol:t.symbol,title:t.title,titleId:t.titleId,maskId:t.maskId}))});bs(c,function(u){if(!u)return Q2("Could not find one or more icon(s)",o.value,a.value)},{immediate:!0});var f=He(function(){return c.value?jf(c.value.abstract[0],{},n):null});return function(){return f.value}}});/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const X2={prefix:"fas",iconName:"trash-can",icon:[448,512,[61460,"trash-alt"],"f2ed","M135.2 17.7C140.6 6.8 151.7 0 163.8 0L284.2 0c12.1 0 23.2 6.8 28.6 17.7L320 32l96 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 96C14.3 96 0 81.7 0 64S14.3 32 32 32l96 0 7.2-14.3zM32 128l384 0 0 320c0 35.3-28.7 64-64 64L96 512c-35.3 0-64-28.7-64-64l0-320zm96 64c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16z"]},qf=X2,Z2={prefix:"fas",iconName:"info",icon:[192,512,[],"f129","M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32l64 0c17.7 0 32 14.3 32 32l0 224 32 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 512c-17.7 0-32-14.3-32-32s14.3-32 32-32l32 0 0-192-32 0c-17.7 0-32-14.3-32-32z"]},e0={prefix:"fas",iconName:"file-lines",icon:[384,512,[128441,128462,61686,"file-alt","file-text"],"f15c","M64 0C28.7 0 0 28.7 0 64L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-288-128 0c-17.7 0-32-14.3-32-32L224 0 64 0zM256 0l0 128 128 0L256 0zM112 256l160 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-160 0c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64l160 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-160 0c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64l160 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-160 0c-8.8 0-16-7.2-16-16s7.2-16 16-16z"]},t0={prefix:"fas",iconName:"pencil",icon:[512,512,[9999,61504,"pencil-alt"],"f303","M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1 0 32c0 8.8 7.2 16 16 16l32 0zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"]},s0=t0,o0={prefix:"fas",iconName:"clipboard-list",icon:[384,512,[],"f46d","M192 0c-41.8 0-77.4 26.7-90.5 64L64 64C28.7 64 0 92.7 0 128L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64l-37.5 0C269.4 26.7 233.8 0 192 0zm0 64a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM72 272a24 24 0 1 1 48 0 24 24 0 1 1 -48 0zm104-16l128 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-128 0c-8.8 0-16-7.2-16-16s7.2-16 16-16zM72 368a24 24 0 1 1 48 0 24 24 0 1 1 -48 0zm88 0c0-8.8 7.2-16 16-16l128 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-128 0c-8.8 0-16-7.2-16-16z"]},n0={prefix:"fas",iconName:"film",icon:[512,512,[127902],"f008","M0 96C0 60.7 28.7 32 64 32l384 0c35.3 0 64 28.7 64 64l0 320c0 35.3-28.7 64-64 64L64 480c-35.3 0-64-28.7-64-64L0 96zM48 368l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16zm368-16c-8.8 0-16 7.2-16 16l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0zM48 240l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0c-8.8 0-16 7.2-16 16zm368-16c-8.8 0-16 7.2-16 16l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0zM48 112l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16L64 96c-8.8 0-16 7.2-16 16zM416 96c-8.8 0-16 7.2-16 16l0 32c0 8.8 7.2 16 16 16l32 0c8.8 0 16-7.2 16-16l0-32c0-8.8-7.2-16-16-16l-32 0zM160 128l0 64c0 17.7 14.3 32 32 32l128 0c17.7 0 32-14.3 32-32l0-64c0-17.7-14.3-32-32-32L192 96c-17.7 0-32 14.3-32 32zm32 160c-17.7 0-32 14.3-32 32l0 64c0 17.7 14.3 32 32 32l128 0c17.7 0 32-14.3 32-32l0-64c0-17.7-14.3-32-32-32l-128 0z"]},r0={prefix:"fas",iconName:"circle-exclamation",icon:[512,512,["exclamation-circle"],"f06a","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24l0 112c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-112c0-13.3 10.7-24 24-24zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"]},i0=r0,a0={prefix:"fas",iconName:"gamepad",icon:[640,512,[],"f11b","M192 64C86 64 0 150 0 256S86 448 192 448l256 0c106 0 192-86 192-192s-86-192-192-192L192 64zM496 168a40 40 0 1 1 0 80 40 40 0 1 1 0-80zM392 304a40 40 0 1 1 80 0 40 40 0 1 1 -80 0zM168 200c0-13.3 10.7-24 24-24s24 10.7 24 24l0 32 32 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-32 0 0 32c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-32-32 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l32 0 0-32z"]},l0={prefix:"fas",iconName:"circle-dot",icon:[512,512,[128280,"dot-circle"],"f192","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-352a96 96 0 1 1 0 192 96 96 0 1 1 0-192z"]},c0=l0,u0={prefix:"fas",iconName:"paintbrush",icon:[576,512,[128396,"paint-brush"],"f1fc","M339.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L568.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S517.7-4.4 499.1 9.6L262.4 187.2c-24 18-38.2 46.1-38.4 76.1L339.3 367.1zm-19.6 25.4l-116-104.4C143.9 290.3 96 339.6 96 400c0 3.9 .2 7.8 .6 11.6C98.4 429.1 86.4 448 68.8 448L64 448c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"]},f0=u0,d0={prefix:"fas",iconName:"pen-to-square",icon:[512,512,["edit"],"f044","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160L0 416c0 53 43 96 96 96l256 0c53 0 96-43 96-96l0-96c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7-14.3 32-32 32L96 448c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 64z"]},g0={prefix:"fas",iconName:"users",icon:[640,512,[],"f0c0","M144 0a80 80 0 1 1 0 160A80 80 0 1 1 144 0zM512 0a80 80 0 1 1 0 160A80 80 0 1 1 512 0zM0 298.7C0 239.8 47.8 192 106.7 192l42.7 0c15.9 0 31 3.5 44.6 9.7c-1.3 7.2-1.9 14.7-1.9 22.3c0 38.2 16.8 72.5 43.3 96c-.2 0-.4 0-.7 0L21.3 320C9.6 320 0 310.4 0 298.7zM405.3 320c-.2 0-.4 0-.7 0c26.6-23.5 43.3-57.8 43.3-96c0-7.6-.7-15-1.9-22.3c13.6-6.3 28.7-9.7 44.6-9.7l42.7 0C592.2 192 640 239.8 640 298.7c0 11.8-9.6 21.3-21.3 21.3l-213.3 0zM224 224a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zM128 485.3C128 411.7 187.7 352 261.3 352l117.3 0C452.3 352 512 411.7 512 485.3c0 14.7-11.9 26.7-26.7 26.7l-330.7 0c-14.7 0-26.7-11.9-26.7-26.7z"]},h0={prefix:"fas",iconName:"angle-right",icon:[320,512,[8250],"f105","M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"]},m0={prefix:"fas",iconName:"folder",icon:[512,512,[128193,128447,61716,"folder-blank"],"f07b","M64 480H448c35.3 0 64-28.7 64-64V160c0-35.3-28.7-64-64-64H288c-10.1 0-19.6-4.7-25.6-12.8L243.2 57.6C231.1 41.5 212.1 32 192 32H64C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64z"]},p0={prefix:"fas",iconName:"globe",icon:[512,512,[127760],"f0ac","M352 256c0 22.2-1.2 43.6-3.3 64l-185.3 0c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64l185.3 0c2.2 20.4 3.3 41.8 3.3 64zm28.8-64l123.1 0c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64l-123.1 0c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64zm112.6-32l-116.7 0c-10-63.9-29.8-117.4-55.3-151.6c78.3 20.7 142 77.5 171.9 151.6zm-149.1 0l-176.6 0c6.1-36.4 15.5-68.6 27-94.7c10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5c11.6 26 20.9 58.2 27 94.7zm-209 0L18.6 160C48.6 85.9 112.2 29.1 190.6 8.4C165.1 42.6 145.3 96.1 135.3 160zM8.1 192l123.1 0c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64L8.1 320C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64zM194.7 446.6c-11.6-26-20.9-58.2-27-94.6l176.6 0c-6.1 36.4-15.5 68.6-27 94.6c-10.5 23.6-22.2 40.7-33.5 51.5C272.6 508.8 263.3 512 256 512s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6C112.2 482.9 48.6 426.1 18.6 352l116.7 0zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6c25.5-34.2 45.2-87.7 55.3-151.6l116.7 0z"]},y0={prefix:"fas",iconName:"ban",icon:[512,512,[128683,"cancel"],"f05e","M367.2 412.5L99.5 144.8C77.1 176.1 64 214.5 64 256c0 106 86 192 192 192c41.5 0 79.9-13.1 111.2-35.5zm45.3-45.3C434.9 335.9 448 297.5 448 256c0-106-86-192-192-192c-41.5 0-79.9 13.1-111.2 35.5L412.5 367.2zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256z"]},b0={prefix:"fas",iconName:"folder-open",icon:[576,512,[128194,128449,61717],"f07c","M88.7 223.8L0 375.8 0 96C0 60.7 28.7 32 64 32l117.5 0c17 0 33.3 6.7 45.3 18.7l26.5 26.5c12 12 28.3 18.7 45.3 18.7L416 96c35.3 0 64 28.7 64 64l0 32-336 0c-22.8 0-43.8 12.1-55.3 31.8zm27.6 16.1C122.1 230 132.6 224 144 224l400 0c11.5 0 22 6.1 27.7 16.1s5.7 22.2-.1 32.1l-112 192C453.9 474 443.4 480 432 480L32 480c-11.5 0-22-6.1-27.7-16.1s-5.7-22.2 .1-32.1l112-192z"]},v0={prefix:"fas",iconName:"image",icon:[512,512,[],"f03e","M0 96C0 60.7 28.7 32 64 32l384 0c35.3 0 64 28.7 64 64l0 320c0 35.3-28.7 64-64 64L64 480c-35.3 0-64-28.7-64-64L0 96zM323.8 202.5c-4.5-6.6-11.9-10.5-19.8-10.5s-15.4 3.9-19.8 10.5l-87 127.6L170.7 297c-4.6-5.7-11.5-9-18.7-9s-14.2 3.3-18.7 9l-64 80c-5.8 7.2-6.9 17.1-2.9 25.4s12.4 13.6 21.6 13.6l96 0 32 0 208 0c8.9 0 17.1-4.9 21.2-12.8s3.6-17.4-1.4-24.7l-120-176zM112 192a48 48 0 1 0 0-96 48 48 0 1 0 0 96z"]},w0={prefix:"fas",iconName:"microphone",icon:[384,512,[],"f130","M192 0C139 0 96 43 96 96l0 160c0 53 43 96 96 96s96-43 96-96l0-160c0-53-43-96-96-96zM64 216c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40c0 89.1 66.2 162.7 152 174.4l0 33.6-48 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l72 0 72 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-48 0 0-33.6c85.8-11.7 152-85.3 152-174.4l0-40c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 40c0 70.7-57.3 128-128 128s-128-57.3-128-128l0-40z"]},_0={prefix:"fas",iconName:"angles-right",icon:[512,512,[187,"angle-double-right"],"f101","M470.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 256 265.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160zm-352 160l160-160c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L210.7 256 73.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0z"]},C0=_0,$0={prefix:"fas",iconName:"circle-check",icon:[512,512,[61533,"check-circle"],"f058","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"]},k0={prefix:"fas",iconName:"file-import",icon:[512,512,["arrow-right-to-file"],"f56f","M128 64c0-35.3 28.7-64 64-64L352 0l0 128c0 17.7 14.3 32 32 32l128 0 0 288c0 35.3-28.7 64-64 64l-256 0c-35.3 0-64-28.7-64-64l0-112 174.1 0-39 39c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l80-80c9.4-9.4 9.4-24.6 0-33.9l-80-80c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l39 39L128 288l0-224zm0 224l0 48L24 336c-13.3 0-24-10.7-24-24s10.7-24 24-24l104 0zM512 128l-128 0L384 0 512 128z"]},S0={prefix:"fas",iconName:"scroll",icon:[576,512,[128220],"f70e","M0 80l0 48c0 17.7 14.3 32 32 32l16 0 48 0 0-80c0-26.5-21.5-48-48-48S0 53.5 0 80zM112 32c10 13.4 16 30 16 48l0 304c0 35.3 28.7 64 64 64s64-28.7 64-64l0-5.3c0-32.4 26.3-58.7 58.7-58.7L480 320l0-192c0-53-43-96-96-96L112 32zM464 480c61.9 0 112-50.1 112-112c0-8.8-7.2-16-16-16l-245.3 0c-14.7 0-26.7 11.9-26.7 26.7l0 5.3c0 53-43 96-96 96l176 0 96 0z"]},Jf={prefix:"fas",iconName:"arrows-rotate",icon:[512,512,[128472,"refresh","sync"],"f021","M105.1 202.6c7.7-21.8 20.2-42.3 37.8-59.8c62.5-62.5 163.8-62.5 226.3 0L386.3 160 352 160c-17.7 0-32 14.3-32 32s14.3 32 32 32l111.5 0c0 0 0 0 0 0l.4 0c17.7 0 32-14.3 32-32l0-112c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 35.2L414.4 97.6c-87.5-87.5-229.3-87.5-316.8 0C73.2 122 55.6 150.7 44.8 181.4c-5.9 16.7 2.9 34.9 19.5 40.8s34.9-2.9 40.8-19.5zM39 289.3c-5 1.5-9.8 4.2-13.7 8.2c-4 4-6.7 8.8-8.1 14c-.3 1.2-.6 2.5-.8 3.8c-.3 1.7-.4 3.4-.4 5.1L16 432c0 17.7 14.3 32 32 32s32-14.3 32-32l0-35.1 17.6 17.5c0 0 0 0 0 0c87.5 87.4 229.3 87.4 316.7 0c24.4-24.4 42.1-53.1 52.9-83.8c5.9-16.7-2.9-34.9-19.5-40.8s-34.9 2.9-40.8 19.5c-7.7 21.8-20.2 42.3-37.8 59.8c-62.5 62.5-163.8 62.5-226.3 0l-.1-.1L125.6 352l34.4 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L48.4 288c-1.6 0-3.2 .1-4.8 .3s-3.1 .5-4.6 1z"]},x0=Jf,T0={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"]},I0={prefix:"fas",iconName:"pen",icon:[512,512,[128394],"f304","M362.7 19.3L314.3 67.7 444.3 197.7l48.4-48.4c25-25 25-65.5 0-90.5L453.3 19.3c-25-25-65.5-25-90.5 0zm-71 71L58.6 323.5c-10.4 10.4-18 23.3-22.2 37.4L1 481.2C-1.5 489.7 .8 498.8 7 505s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L421.7 220.3 291.7 90.3z"]},M0={prefix:"fas",iconName:"file-code",icon:[384,512,[],"f1c9","M64 0C28.7 0 0 28.7 0 64L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-288-128 0c-17.7 0-32-14.3-32-32L224 0 64 0zM256 0l0 128 128 0L256 0zM153 289l-31 31 31 31c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0L71 337c-9.4-9.4-9.4-24.6 0-33.9l48-48c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9zM265 255l48 48c9.4 9.4 9.4 24.6 0 33.9l-48 48c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l31-31-31-31c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0z"]},Gf={prefix:"fas",iconName:"floppy-disk",icon:[448,512,[128190,128426,"save"],"f0c7","M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-242.7c0-17-6.7-33.3-18.7-45.3L352 50.7C340 38.7 323.7 32 306.7 32L64 32zm0 96c0-17.7 14.3-32 32-32l192 0c17.7 0 32 14.3 32 32l0 64c0 17.7-14.3 32-32 32L96 224c-17.7 0-32-14.3-32-32l0-64zM224 288a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"]},P0=Gf,A0={prefix:"fas",iconName:"envelope",icon:[512,512,[128386,9993,61443],"f0e0","M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48L48 64zM0 176L0 384c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-208L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"]},E0={prefix:"fas",iconName:"circle-info",icon:[512,512,["info-circle"],"f05a","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336l24 0 0-64-24 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l48 0c13.3 0 24 10.7 24 24l0 88 8 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-80 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"]},O0=E0,L0={prefix:"fas",iconName:"camera",icon:[512,512,[62258,"camera-alt"],"f030","M149.1 64.8L138.7 96 64 96C28.7 96 0 124.7 0 160L0 416c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-256c0-35.3-28.7-64-64-64l-74.7 0L362.9 64.8C356.4 45.2 338.1 32 317.4 32L194.6 32c-20.7 0-39 13.2-45.5 32.8zM256 192a96 96 0 1 1 0 192 96 96 0 1 1 0-192z"]},N0={prefix:"fas",iconName:"minus",icon:[448,512,[8211,8722,10134,"subtract"],"f068","M432 256c0 17.7-14.3 32-32 32L48 288c-17.7 0-32-14.3-32-32s14.3-32 32-32l352 0c17.7 0 32 14.3 32 32z"]},R0={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"]},D0=R0,F0={prefix:"fas",iconName:"flask",icon:[448,512,[],"f0c3","M288 0L160 0 128 0C110.3 0 96 14.3 96 32s14.3 32 32 32l0 132.8c0 11.8-3.3 23.5-9.5 33.5L10.3 406.2C3.6 417.2 0 429.7 0 442.6C0 480.9 31.1 512 69.4 512l309.2 0c38.3 0 69.4-31.1 69.4-69.4c0-12.8-3.6-25.4-10.3-36.4L329.5 230.4c-6.2-10.1-9.5-21.7-9.5-33.5L320 64c17.7 0 32-14.3 32-32s-14.3-32-32-32L288 0zM192 196.8L192 64l64 0 0 132.8c0 23.7 6.6 46.9 19 67.1L309.5 320l-171 0L173 263.9c12.4-20.2 19-43.4 19-67.1z"]},V0={prefix:"fas",iconName:"download",icon:[512,512,[],"f019","M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 242.7-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7 288 32zM64 352c-35.3 0-64 28.7-64 64l0 32c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-32c0-35.3-28.7-64-64-64l-101.5 0-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352 64 352zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"]},U0={prefix:"fas",iconName:"house",icon:[576,512,[127968,63498,63500,"home","home-alt","home-lg-alt"],"f015","M575.8 255.5c0 18-15 32.1-32 32.1l-32 0 .7 160.2c0 2.7-.2 5.4-.5 8.1l0 16.2c0 22.1-17.9 40-40 40l-16 0c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1L416 512l-24 0c-22.1 0-40-17.9-40-40l0-24 0-64c0-17.7-14.3-32-32-32l-64 0c-17.7 0-32 14.3-32 32l0 64 0 24c0 22.1-17.9 40-40 40l-24 0-31.9 0c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2l-16 0c-22.1 0-40-17.9-40-40l0-112c0-.9 0-1.9 .1-2.8l0-69.7-32 0c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"]},j0=U0,z0={prefix:"fas",iconName:"upload",icon:[512,512,[],"f093","M288 109.3L288 352c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-242.7-73.4 73.4c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l128-128c12.5-12.5 32.8-12.5 45.3 0l128 128c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L288 109.3zM64 352l128 0c0 35.3 28.7 64 64 64s64-28.7 64-64l128 0c35.3 0 64 28.7 64 64l0 32c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64l0-32c0-35.3 28.7-64 64-64zM432 456a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"]},B0={prefix:"fas",iconName:"sun",icon:[512,512,[9728],"f185","M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"]},q0={prefix:"fas",iconName:"file",icon:[384,512,[128196,128459,61462],"f15b","M0 64C0 28.7 28.7 0 64 0L224 0l0 128c0 17.7 14.3 32 32 32l128 0 0 288c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zm384 64l-128 0L256 0 384 128z"]},J0={prefix:"fas",iconName:"boxes-stacked",icon:[576,512,[62625,"boxes","boxes-alt"],"f468","M248 0L208 0c-26.5 0-48 21.5-48 48l0 112c0 35.3 28.7 64 64 64l128 0c35.3 0 64-28.7 64-64l0-112c0-26.5-21.5-48-48-48L328 0l0 80c0 8.8-7.2 16-16 16l-48 0c-8.8 0-16-7.2-16-16l0-80zM64 256c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l160 0c35.3 0 64-28.7 64-64l0-128c0-35.3-28.7-64-64-64l-40 0 0 80c0 8.8-7.2 16-16 16l-48 0c-8.8 0-16-7.2-16-16l0-80-40 0zM352 512l160 0c35.3 0 64-28.7 64-64l0-128c0-35.3-28.7-64-64-64l-40 0 0 80c0 8.8-7.2 16-16 16l-48 0c-8.8 0-16-7.2-16-16l0-80-40 0c-15 0-28.8 5.1-39.7 13.8c4.9 10.4 7.7 22 7.7 34.2l0 160c0 12.2-2.8 23.8-7.7 34.2C323.2 506.9 337 512 352 512z"]},G0={prefix:"fas",iconName:"play",icon:[384,512,[9654],"f04b","M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80L0 432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"]},W0={prefix:"fas",iconName:"magnifying-glass",icon:[512,512,[128269,"search"],"f002","M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"]},H0=W0,K0={prefix:"fas",iconName:"plus",icon:[448,512,[10133,61543,"add"],"2b","M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"]},Q0={prefix:"fas",iconName:"xmark",icon:[384,512,[128473,10005,10006,10060,215,"close","multiply","remove","times"],"f00d","M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"]},Y0=Q0,X0={prefix:"fas",iconName:"chevron-right",icon:[320,512,[9002],"f054","M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"]},Z0={prefix:"fas",iconName:"thumbtack",icon:[384,512,[128204,128392,"thumb-tack"],"f08d","M32 32C32 14.3 46.3 0 64 0L320 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-29.5 0 11.4 148.2c36.7 19.9 65.7 53.2 79.5 94.7l1 3c3.3 9.8 1.6 20.5-4.4 28.8s-15.7 13.3-26 13.3L32 352c-10.3 0-19.9-4.9-26-13.3s-7.7-19.1-4.4-28.8l1-3c13.8-41.5 42.8-74.8 79.5-94.7L93.5 64 64 64C46.3 64 32 49.7 32 32zM160 384l64 0 0 96c0 17.7-14.3 32-32 32s-32-14.3-32-32l0-96z"]},ey={prefix:"fas",iconName:"rotate",icon:[512,512,[128260,"sync-alt"],"f2f1","M142.9 142.9c-17.5 17.5-30.1 38-37.8 59.8c-5.9 16.7-24.2 25.4-40.8 19.5s-25.4-24.2-19.5-40.8C55.6 150.7 73.2 122 97.6 97.6c87.2-87.2 228.3-87.5 315.8-1L455 55c6.9-6.9 17.2-8.9 26.2-5.2s14.8 12.5 14.8 22.2l0 128c0 13.3-10.7 24-24 24l-8.4 0c0 0 0 0 0 0L344 224c-9.7 0-18.5-5.8-22.2-14.8s-1.7-19.3 5.2-26.2l41.1-41.1c-62.6-61.5-163.1-61.2-225.3 1zM16 312c0-13.3 10.7-24 24-24l7.6 0 .7 0L168 288c9.7 0 18.5 5.8 22.2 14.8s1.7 19.3-5.2 26.2l-41.1 41.1c62.6 61.5 163.1 61.2 225.3-1c17.5-17.5 30.1-38 37.8-59.8c5.9-16.7 24.2-25.4 40.8-19.5s25.4 24.2 19.5 40.8c-10.8 30.6-28.4 59.3-52.9 83.8c-87.2 87.2-228.3 87.5-315.8 1L57 457c-6.9 6.9-17.2 8.9-26.2 5.2S16 449.7 16 440l0-119.6 0-.7 0-7.6z"]},ty=ey,sy={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"]},oy={prefix:"fas",iconName:"angles-left",icon:[512,512,[171,"angle-double-left"],"f100","M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"]},ny=oy,ry={prefix:"fas",iconName:"file-export",icon:[576,512,["arrow-right-from-file"],"f56e","M0 64C0 28.7 28.7 0 64 0L224 0l0 128c0 17.7 14.3 32 32 32l128 0 0 128-168 0c-13.3 0-24 10.7-24 24s10.7 24 24 24l168 0 0 112c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 64zM384 336l0-48 110.1 0-39-39c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l80 80c9.4 9.4 9.4 24.6 0 33.9l-80 80c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l39-39L384 336zm0-208l-128 0L256 0 384 128z"]},iy={prefix:"fas",iconName:"wand-magic",icon:[512,512,["magic"],"f0d0","M14.1 463.3c-18.7-18.7-18.7-49.1 0-67.9L395.4 14.1c18.7-18.7 49.1-18.7 67.9 0l34.6 34.6c18.7 18.7 18.7 49.1 0 67.9L116.5 497.9c-18.7 18.7-49.1 18.7-67.9 0L14.1 463.3zM347.6 187.6l105-105L429.4 59.3l-105 105 23.3 23.3z"]},ay=iy,ly={prefix:"fas",iconName:"moon",icon:[384,512,[127769,9214],"f186","M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"]},cy={prefix:"fas",iconName:"music",icon:[512,512,[127925],"f001","M499.1 6.3c8.1 6 12.9 15.6 12.9 25.7l0 72 0 264c0 44.2-43 80-96 80s-96-35.8-96-80s43-80 96-80c11.2 0 22 1.6 32 4.6L448 147 192 223.8 192 432c0 44.2-43 80-96 80s-96-35.8-96-80s43-80 96-80c11.2 0 22 1.6 32 4.6L128 200l0-72c0-14.1 9.3-26.6 22.8-30.7l320-96c9.7-2.9 20.2-1.1 28.3 5z"]},uy={prefix:"fas",iconName:"book",icon:[448,512,[128212],"f02d","M96 0C43 0 0 43 0 96L0 416c0 53 43 96 96 96l288 0 32 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l0-64c17.7 0 32-14.3 32-32l0-320c0-17.7-14.3-32-32-32L384 0 96 0zm0 384l256 0 0 64L96 448c-17.7 0-32-14.3-32-32s14.3-32 32-32zm32-240c0-8.8 7.2-16 16-16l192 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-192 0c-8.8 0-16-7.2-16-16zm16 48l192 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-192 0c-8.8 0-16-7.2-16-16s7.2-16 16-16z"]},fy={prefix:"fas",iconName:"angle-left",icon:[320,512,[8249],"f104","M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"]},dy={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5l0-377.4c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C93.5 32 46.3 45.3 18.1 56.1C6.8 60.5 0 71.7 0 83.8L0 454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5l0-370.3c0-12.1-6.8-23.3-18.1-27.6C529.7 45.3 482.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11L304 456c0 11.4 11.7 19.3 22.4 15.5z"]},gy={prefix:"fas",iconName:"triangle-exclamation",icon:[512,512,[9888,"exclamation-triangle","warning"],"f071","M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480L40 480c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24l0 112c0 13.3 10.7 24 24 24s24-10.7 24-24l0-112c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"]},hy=gy,my={prefix:"fas",iconName:"brain",icon:[512,512,[129504],"f5dc","M184 0c30.9 0 56 25.1 56 56l0 400c0 30.9-25.1 56-56 56c-28.9 0-52.7-21.9-55.7-50.1c-5.2 1.4-10.7 2.1-16.3 2.1c-35.3 0-64-28.7-64-64c0-7.4 1.3-14.6 3.6-21.2C21.4 367.4 0 338.2 0 304c0-31.9 18.7-59.5 45.8-72.3C37.1 220.8 32 207 32 192c0-30.7 21.6-56.3 50.4-62.6C80.8 123.9 80 118 80 112c0-29.9 20.6-55.1 48.3-62.1C131.3 21.9 155.1 0 184 0zM328 0c28.9 0 52.6 21.9 55.7 49.9c27.8 7 48.3 32.1 48.3 62.1c0 6-.8 11.9-2.4 17.4c28.8 6.2 50.4 31.9 50.4 62.6c0 15-5.1 28.8-13.8 39.7C493.3 244.5 512 272.1 512 304c0 34.2-21.4 63.4-51.6 74.8c2.3 6.6 3.6 13.8 3.6 21.2c0 35.3-28.7 64-64 64c-5.6 0-11.1-.7-16.3-2.1c-3 28.2-26.8 50.1-55.7 50.1c-30.9 0-56-25.1-56-56l0-400c0-30.9 25.1-56 56-56z"]},py={prefix:"fas",iconName:"circle-xmark",icon:[512,512,[61532,"times-circle","xmark-circle"],"f057","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM175 175c9.4-9.4 24.6-9.4 33.9 0l47 47 47-47c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6 0-33.9z"]},yy={prefix:"fas",iconName:"turn-up",icon:[384,512,[10548,"level-up-alt"],"f3bf","M350 177.5c3.8-8.8 2-19-4.6-26l-136-144C204.9 2.7 198.6 0 192 0s-12.9 2.7-17.4 7.5l-136 144c-6.6 7-8.4 17.2-4.6 26s12.5 14.5 22 14.5l88 0 0 192c0 17.7-14.3 32-32 32l-80 0c-17.7 0-32 14.3-32 32l0 32c0 17.7 14.3 32 32 32l80 0c70.7 0 128-57.3 128-128l0-192 88 0c9.6 0 18.2-5.7 22-14.5z"]},by=yy;Vf.add(D0,G0,s0,qf,k0,P0,Jf);const vy={name:"Home",components:{FontAwesomeIcon:Bf},data(){return{timestamp:"2025-04-17 15:00:01",username:"aaaaaa",outlineSwitch:!1,language:"",storyTitle:"",storyNames:[],outlineContent:"",showImportDialog:!1,importStoryName:"",importCharacterIntro:!1,importOpeningText:!1,importOutline:!1,characterFile:null,openingFile:null,outlineFile:null,characterFileName:"",openingFileName:"",outlineFileName:"",isLoading:!1,loadingText:"加载中...",showMessage:!1,messageType:"success",messageContent:"",messageTimeout:null,showAdvancedOptionsDialog:!1,proxyUrl:"http://127.0.0.1:5436/proxy",proxyPassword:"defaultpassword",defaultProxyUrl:"http://127.0.0.1:5436/proxy",defaultProxyPassword:"defaultpassword"}},mounted(){this.loadStoryList(),this.loadHomeConfig()},methods:{async loadHomeConfig(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.剧情&&(this.outlineSwitch=e.剧情.if_on||!1,this.language=e.剧情.language||"",this.storyTitle=e.剧情.story_title||"",this.outlineContent=e.剧情.outline_content_entry||""),e.高级配置?(this.proxyUrl=e.高级配置.proxyUrl||this.defaultProxyUrl,this.proxyPassword=e.高级配置.proxyPassword||this.defaultProxyPassword):(this.proxyUrl=this.defaultProxyUrl,this.proxyPassword=this.defaultProxyPassword)}catch(e){console.error("Failed to load configuration:",e)}},saveConfig(e){try{localStorage.setItem("aiGalgameConfig",JSON.stringify(e))}catch(t){console.error("Failed to save configuration:",t),this.$emit("show-message",{title:"error",message:"保存配置失败"})}},saveOutlineSwitch(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.剧情||(e.剧情={}),e.剧情.if_on=this.outlineSwitch,this.saveConfig(e)}catch(e){console.error("Failed to save outline switch state:",e),this.$emit("show-message",{title:"error",message:"保存配置失败"})}},saveLanguage(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.剧情||(e.剧情={}),e.剧情.language=this.language,this.saveConfig(e),this.$emit("show-message",{title:"success",message:`成功切换到语言：${this.language}`})}catch(e){console.error("Failed to save language:",e),this.$emit("show-message",{title:"error",message:"保存配置失败"})}},saveStoryTitle(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.剧情||(e.剧情={}),e.剧情.story_title=this.storyTitle,this.saveConfig(e),this.storyTitle?this.$emit("show-message",{title:"success",message:`成功切换故事到${this.storyTitle}`}):this.$emit("show-message",{title:"success",message:"已选择空项，开始游戏将会创建新故事"})}catch(e){console.error("Failed to save story title:",e),this.$emit("show-message",{title:"error",message:"保存配置失败"})}},saveOutlineContent(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.剧情||(e.剧情={}),e.剧情.outline_content_entry=this.outlineContent,this.saveConfig(e)}catch(e){console.error("Failed to save outline content:",e),this.$emit("show-message",{title:"error",message:"保存配置失败"})}},openAdvancedOptionsDialog(){this.loadAdvancedConfig(),this.showAdvancedOptionsDialog=!0},loadAdvancedConfig(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.高级配置?(this.proxyUrl=e.高级配置.proxyUrl||this.defaultProxyUrl,this.proxyPassword=e.高级配置.proxyPassword||this.defaultProxyPassword):(this.proxyUrl=this.defaultProxyUrl,this.proxyPassword=this.defaultProxyPassword)}catch(e){console.error("Failed to load advanced configuration:",e),this.$emit("show-message",{title:"error",message:"加载高级配置失败"}),this.proxyUrl=this.defaultProxyUrl,this.proxyPassword=this.defaultProxyPassword}},saveAdvancedConfig(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.高级配置||(e.高级配置={}),e.高级配置.proxyUrl=this.proxyUrl,e.高级配置.proxyPassword=this.proxyPassword,this.saveConfig(e),this.$emit("show-message",{title:"success",message:"高级配置保存成功"}),this.showAdvancedOptionsDialog=!1}catch(e){console.error("Failed to save advanced configuration:",e),this.$emit("show-message",{title:"error",message:"保存高级配置失败"})}},resetAdvancedConfig(){this.proxyUrl=this.defaultProxyUrl,this.proxyPassword=this.defaultProxyPassword,this.saveAdvancedConfig(),this.$emit("show-message",{title:"success",message:"高级配置已恢复默认值并保存"})},async loadStoryList(){try{const e=await ao();let t=e.indexOf("test");t!==-1&&e.splice(t,1),this.storyNames=e.sort()}catch(e){console.error("Failed to load story list:",e),this.storyNames=[],this.$emit("show-message",{title:"error",message:"加载故事列表失败"})}},async renameStory(){if(!this.storyTitle){this.$emit("show-message",{title:"error",message:"当前未选中故事"});return}const e=prompt("请输入新的故事名称:",this.storyTitle);if(!e||e.trim()===""||e===this.storyTitle){e&&e.trim()===""&&this.$emit("show-message",{title:"error",message:"故事名称不能为空"});return}try{if((await ao()).map(n=>n.toLowerCase()).includes(e.trim().toLowerCase())){this.$emit("show-message",{title:"error",message:"故事名称已存在"});return}this.isLoading=!0,this.loadingText="正在重命名故事...",await Ys(`/data/${this.storyTitle}`,`${e.trim()}`);const s=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");s.剧情&&s.剧情.story_title===this.storyTitle&&(s.剧情.story_title=e.trim(),this.saveConfig(s)),this.storyTitle=e.trim(),await this.loadStoryList(),this.isLoading=!1,this.$emit("show-message",{title:"success",message:"故事重命名成功"})}catch(t){console.error("Failed to rename story:",t),this.isLoading=!1,this.$emit("show-message",{title:"error",message:`重命名故事失败: ${t.message}`})}},async deleteStory(){if(!this.storyTitle){this.$emit("show-message",{title:"error",message:"当前未选中故事"});return}if(confirm(`确定要删除故事 "${this.storyTitle}" 吗？此操作不可撤销。`))try{this.isLoading=!0,this.loadingText="正在删除故事...",await ts(`/data/${this.storyTitle}`);const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.剧情&&e.剧情.story_title===this.storyTitle&&(e.剧情.story_title="",this.saveConfig(e)),this.storyTitle="",await this.loadStoryList(),this.isLoading=!1,this.$emit("show-message",{title:"success",message:"故事删除成功"})}catch(e){console.error("Failed to delete story:",e),this.isLoading=!1,this.$emit("show-message",{title:"error",message:`删除故事失败: ${e.message}`})}},startGame(){this.saveOutlineContent(),this.storyTitle||this.monitorStoryTitle();const e=`${window.location.origin}/start`;window.open(e,"_blank")},monitorStoryTitle(){const e=setInterval(()=>{var t;try{const n=((t=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}").剧情)==null?void 0:t.story_title)||"";n&&n!==this.storyTitle&&(this.storyTitle=n,this.loadStoryList(),clearInterval(e))}catch(s){console.error("Error monitoring story title:",s),clearInterval(e)}},5e3);setTimeout(()=>{clearInterval(e),console.log("Stopped monitoring for new story title.")},18e4)},handleFileSelection(e){const t=this.$refs[`${e}FileInput`];if(t.files.length>0){const s=t.files[0];switch(e){case"character":this.characterFile=s,this.characterFileName=s.name;break;case"opening":this.openingFile=s,this.openingFileName=s.name;break;case"outline":this.outlineFile=s,this.outlineFileName=s.name;break}}else switch(e){case"character":this.characterFile=null,this.characterFileName="";break;case"opening":this.openingFile=null,this.openingFileName="";break;case"outline":this.outlineFile=null,this.outlineFileName="";break}},async confirmImport(){if(!this.importStoryName.trim()){this.$emit("show-message",{title:"error",message:"请输入故事名称"});return}if(!this.importCharacterIntro&&!this.importOpeningText&&!this.importOutline){this.$emit("show-message",{title:"error",message:"请至少选择一项导入内容"});return}if(this.importCharacterIntro&&!this.characterFile||this.importOpeningText&&!this.openingFile||this.importOutline&&!this.outlineFile){this.$emit("show-message",{title:"error",message:"请为所有选中的内容选择文件"});return}try{this.isLoading=!0,this.loadingText="正在导入故事...";const e=this.importStoryName.trim();if((await ao()).map(f=>f.toLowerCase()).includes(e.toLowerCase())){if(!confirm(`故事"${e}"已存在，是否覆盖？`)){this.isLoading=!1;return}await ts(`/data/${e}`).catch(f=>console.warn("Failed to delete existing story before overwrite:",f))}const s=this.importCharacterIntro?await this.readFileContent(this.characterFile):null,n=this.importOpeningText?await this.readFileContent(this.openingFile):null,o=this.importOutline?await this.readFileContent(this.outlineFile):null;await this.loadLocalStory(e,s,n,o,this.importOutline);const r=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");r.剧情||(r.剧情={}),r.剧情.story_title=e,this.saveConfig(r),this.storyTitle=e,await this.loadStoryList(),this.resetImportDialog(),this.isLoading=!1,this.$emit("show-message",{title:"success",message:"故事导入成功！"});const i=this.importCharacterIntro?this.processCharacterData(s)==="pass":!0,a=this.importOutline?this.processOutlineData(o)==="pass":!0,c=this.importOpeningText?this.processStoryData(n)==="pass":!0;i&&a&&this.importOutline||i&&c&&this.importOpeningText?setTimeout(()=>{this.storyTitle===e?this.startGame():console.warn("Imported story is not the selected story, skipping auto-start.")},1e3):console.log("Imported data not sufficient for auto-start, staying on Home.")}catch(e){console.error("Failed to import story:",e),this.isLoading=!1,this.$emit("show-message",{title:"error",message:`导入故事失败: ${e.message}`})}},resetImportDialog(){this.showImportDialog=!1,this.importStoryName="",this.importCharacterIntro=!1,this.importOpeningText=!1,this.importOutline=!1,this.characterFile=null,this.openingFile=null,this.outlineFile=null,this.characterFileName="",this.openingFileName="",this.outlineFileName="",this.$refs.characterFileInput&&(this.$refs.characterFileInput.value=null),this.$refs.openingFileInput&&(this.$refs.openingFileInput.value=null),this.$refs.outlineFileInput&&(this.$refs.outlineFileInput.value=null)},async readFileContent(e){return new Promise((t,s)=>{const n=new FileReader;n.onload=o=>{t(o.target.result)},n.onerror=o=>{s(o)},n.readAsText(e)})},async loadLocalStory(e,t,s,n,o){let r="null",i="null",a="null";if(t!==null&&(r=this.processCharacterData(t),r==="pass")){let d=typeof t=="string"?this.parseCharacterData(t):t;Array.isArray(d)?await xe(`/data/${e}/character.json`,d):(console.warn("Processed character data was not an array, skipping save to character.json"),r="fail")}if(s!==null&&(i=this.processStoryData(s),i==="pass")){let d=typeof s=="string"?this.parseStoryData(s):s;d&&Array.isArray(d.conversations)?await xe(`/data/${e}/story/0.json`,d):(console.warn("Processed story data was not in expected format, skipping save to story/0.json"),i="fail")}if(n!==null&&(a=this.processOutlineData(n),a==="pass")){let d=n;try{d=JSON.parse(this.extractJson(n)||n)}catch{console.log("Outline data is not JSON, saving as text.")}await xe(`/data/${e}/outline.json`,d)}const c=o?a:"pass",f=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");if(f.剧情||(f.剧情={}),f.剧情.local_story={character_content:t?String(t):"",story_content:s?String(s):"",outline_content:n?String(n):"",character_status:r,story_status:i,outline_status:c},this.saveConfig(f),!(r==="pass"&&c==="pass"||r==="pass"&&i==="pass")){console.log("Imported data insufficient. Attempting GPT generation...");const d=await this.useGptForImport(e,t,s,n);d==="success"?this.$emit("show-message",{title:"success",message:"GPT已尝试补全故事内容"}):d==="error"&&this.$emit("show-message",{title:"error",message:"GPT补全故事内容失败"}),this.loadHomeConfig()}return"success"},parseCharacterData(e){if(typeof e!="string")return e;try{const t=e.trim();if(t.startsWith("[")||t.startsWith("{"))try{const o=JSON.parse(this.extractJson(e)||e);return Array.isArray(o)?o:[]}catch(o){return console.error("Could not parse character data as JSON:",o),[]}const s=t.split(`
`).filter(o=>o.trim()),n=[];for(const o of s){const r=o.split("：");if(r.length>=2){const i=r[0].trim(),a=r.slice(1).join("：").trim();i&&n.push({name:i,description:a})}}return n}catch(t){return console.error("Error parsing character text data:",t),[]}},processCharacterData(e){const t=this.parseCharacterData(e);return Array.isArray(t)&&t.length>0&&t.every(s=>typeof s=="object"&&s!==null&&typeof s.name=="string"&&s.name.trim()!=="")?"pass":"fail"},parseStoryData(e){if(typeof e!="string")return e;try{const t=e.trim();if(t.startsWith("{")||t.startsWith("["))try{const o=JSON.parse(this.extractJson(e)||e);return o&&Array.isArray(o.conversations)?o:Array.isArray(o)?{conversations:o}:(console.warn("Parsed story JSON is not in expected format."),{conversations:[]})}catch(o){return console.error("Could not parse story data as JSON:",o),{conversations:[]}}const s=t.split(`
`).filter(o=>o.trim()),n=[];for(const o of s){const r=o.match(/^(?:\[.*?\]\s*)?([^：]+)[\s]*：[\s]*(.*)$/);if(r&&r[1].trim()!==""){const i=r[1].trim(),a=r[2].trim();n.push({character:i,text:a})}else o.trim()&&n.push({text:o.trim()})}return{conversations:n}}catch(t){return console.error("Error parsing story text data:",t),{conversations:[]}}},processStoryData(e){const t=this.parseStoryData(e);return t&&Array.isArray(t.conversations)&&t.conversations.length>0?"pass":"fail"},processOutlineData(e){return typeof e=="string"?e.trim()!==""?"pass":"fail":e!=null?"pass":"fail"},async useGptForImport(e,t,s,n){try{this.loadingText="数据不足，正在尝试使用AI补全内容...";const o=this.processCharacterData(t),r=this.processStoryData(s),i=this.processOutlineData(n),a=o!=="pass",c=r!=="pass",f=this.importOutline&&i!=="pass";if(!a&&!c&&!f)return console.log("GPT not needed, all imported data was valid."),"pass";const u={title:e,character_content:o==="pass"?t:null,story_content:r==="pass"?s:null,outline_content:i==="pass"?n:null,needs:{character:a,story:c,outline:f}},[d,h]=await ct("本地导入",u);if(!d||!h)return console.error("Failed to get prompts from PromptService."),"error";const g=Math.floor(Math.random()*1e5)+1,m=await Ms(d,h,"本地导入",g);if(m==="over_times"||m==="error")return console.error("GPT处理失败:",m),st(g),"error";const y=this.extractJson(m);if(!y)return console.error("无法从GPT响应中提取JSON:",m),st(g),"error";try{const p=JSON.parse(y);let b=!1;if(a&&this.processCharacterData(p.character)==="pass"){const w=this.parseCharacterData(p.character);Array.isArray(w)?(await xe(`/data/${e}/character.json`,w),b=!0,console.log("GPT generated character data saved.")):console.warn("GPT generated character data was not array, skipping save.")}if(f&&this.processOutlineData(p.outline)==="pass"){let w=p.outline;try{w=JSON.parse(this.extractJson(p.outline)||p.outline)}catch{}await xe(`/data/${e}/outline.json`,w),b=!0,console.log("GPT generated outline data saved.")}if(c&&this.processStoryData(p.conversations||{conversations:p.story})==="pass"){let w=p.conversations||p.story;Array.isArray(w)?w={conversations:w}:w&&Array.isArray(w.conversations)||(w={conversations:[]}),w&&Array.isArray(w.conversations)&&w.conversations.length>0?(await xe(`/data/${e}/story/0.json`,w),b=!0,console.log("GPT generated story data saved.")):console.warn("GPT generated story data was not in expected format, skipping save.")}return st(g),b?"success":"error"}catch(p){return console.error("处理GPT响应失败:",p),st(g),"error"}}catch(o){return console.error("GPT处理或prompt生成失败:",o),"error"}},extractJson(e){if(typeof e!="string"||!e)return null;const t=e.match(/\{[\s\S]*\}|\[[\s\S]*\]/);return t?t[0]:(console.warn("No JSON object or array found in string:",e),null)}}},wy={class:"home-container"},_y={class:"settings-panel"},Cy={class:"settings-grid"},$y={class:"settings-column"},ky={class:"setting-item"},Sy={class:"toggle-switch"},xy={class:"setting-item"},Ty={class:"settings-column"},Iy={class:"setting-item"},My=["value"],Py={class:"button-group"},Ay=["disabled"],Ey=["disabled"],Oy={class:"content-panel"},Ly={class:"content-container"},Ny={class:"action-container"},Ry={class:"left-action"},Dy={class:"right-action"},Fy={key:0,class:"modal"},Vy={class:"modal-content"},Uy={class:"modal-header"},jy={class:"modal-body"},zy={class:"form-group"},By={class:"import-options"},qy={class:"checkbox-group"},Jy={class:"checkbox-label"},Gy={class:"checkbox-label"},Wy={class:"checkbox-label"},Hy={key:0,class:"form-group"},Ky={class:"file-input"},Qy=["value"],Yy={key:1,class:"form-group"},Xy={class:"file-input"},Zy=["value"],eb={key:2,class:"form-group"},tb={class:"file-input"},sb=["value"],ob={class:"modal-footer"},nb={key:1,class:"modal"},rb={class:"modal-content"},ib={class:"modal-header"},ab={class:"modal-body"},lb={class:"form-group"},cb={class:"form-group"},ub={class:"modal-footer"},fb={key:2,class:"loading-overlay"},db={class:"loading-text"};function gb(e,t,s,n,o,r){const i=ze("font-awesome-icon");return S(),T("div",wy,[t[59]||(t[59]=l("div",{class:"header-section"},[l("h1",{class:"welcome-title"},"欢迎使用AI Galgame生成器"),l("div",{class:"separator"})],-1)),l("div",_y,[t[39]||(t[39]=l("h2",{class:"panel-title"},"游戏设置",-1)),l("div",Cy,[l("div",$y,[l("div",ky,[t[31]||(t[31]=l("label",{class:"setting-label"},"大纲指导生成:",-1)),l("div",Sy,[U(l("input",{type:"checkbox",id:"outline-switch","onUpdate:modelValue":t[0]||(t[0]=a=>o.outlineSwitch=a),onChange:t[1]||(t[1]=(...a)=>r.saveOutlineSwitch&&r.saveOutlineSwitch(...a))},null,544),[[Ve,o.outlineSwitch]]),t[30]||(t[30]=l("label",{for:"outline-switch",class:"toggle-label"},null,-1))])]),l("div",xy,[t[33]||(t[33]=l("label",{class:"setting-label"},"游戏语言:",-1)),U(l("select",{class:"dropdown","onUpdate:modelValue":t[2]||(t[2]=a=>o.language=a),onChange:t[3]||(t[3]=(...a)=>r.saveLanguage&&r.saveLanguage(...a))},t[32]||(t[32]=[l("option",{value:""},"-- 请选择 --",-1),l("option",{value:"中文"},"中文",-1),l("option",{value:"英文"},"英文",-1),l("option",{value:"日文"},"日文",-1)]),544),[[Ue,o.language]])])]),l("div",Ty,[l("div",Iy,[t[35]||(t[35]=l("label",{class:"setting-label"},"选择故事:",-1)),U(l("select",{class:"dropdown","onUpdate:modelValue":t[4]||(t[4]=a=>o.storyTitle=a),onChange:t[5]||(t[5]=(...a)=>r.saveStoryTitle&&r.saveStoryTitle(...a))},[t[34]||(t[34]=l("option",{value:""},"-- 创建新故事 --",-1)),(S(!0),T(ve,null,Ae(o.storyNames,a=>(S(),T("option",{key:a,value:a},F(a),9,My))),128))],544),[[Ue,o.storyTitle]])]),l("div",Py,[l("button",{class:"btn btn-outline",onClick:t[6]||(t[6]=(...a)=>r.renameStory&&r.renameStory(...a)),disabled:!o.storyTitle},[q(i,{icon:["fas","pencil-alt"],class:"btn-icon"}),t[36]||(t[36]=te(" 故事改名 "))],8,Ay),l("button",{class:"btn btn-danger",onClick:t[7]||(t[7]=(...a)=>r.deleteStory&&r.deleteStory(...a)),disabled:!o.storyTitle},[q(i,{icon:["fas","trash-alt"],class:"btn-icon"}),t[37]||(t[37]=te(" 删除故事 "))],8,Ey),l("button",{class:"btn btn-outline",onClick:t[8]||(t[8]=a=>o.showImportDialog=!0)},[q(i,{icon:["fas","file-import"],class:"btn-icon"}),t[38]||(t[38]=te(" 本地导入 "))])])])])]),l("div",Oy,[t[40]||(t[40]=l("h2",{class:"panel-title"},"故事生成提示",-1)),l("div",Ly,[U(l("textarea",{class:"story-textarea","onUpdate:modelValue":t[9]||(t[9]=a=>o.outlineContent=a),placeholder:"请在此处输入您的故事背景、角色设定和情节提示，AI将根据您的描述生成游戏内容...",onBlur:t[10]||(t[10]=(...a)=>r.saveOutlineContent&&r.saveOutlineContent(...a))},null,544),[[ue,o.outlineContent]])]),t[41]||(t[41]=l("div",{class:"hint-text"}," 请在此处输入您的故事背景、角色设定和情节提示，AI将根据您的描述生成游戏内容... ",-1))]),l("div",Ny,[l("div",Ry,[l("button",{class:"btn btn-success btn-large",onClick:t[11]||(t[11]=(...a)=>r.startGame&&r.startGame(...a))},[q(i,{icon:["fas","play"],class:"btn-icon"}),t[42]||(t[42]=te(" 开始游戏 "))])]),l("div",Dy,[l("button",{class:"btn btn-outline",onClick:t[12]||(t[12]=(...a)=>r.openAdvancedOptionsDialog&&r.openAdvancedOptionsDialog(...a))},[q(i,{icon:["fas","cog"],class:"btn-icon"}),t[43]||(t[43]=te(" 高级选项 "))])])]),o.showImportDialog?(S(),T("div",Fy,[l("div",Vy,[l("div",Uy,[t[44]||(t[44]=l("h2",null,"本地导入故事",-1)),l("span",{class:"close-btn",onClick:t[13]||(t[13]=a=>o.showImportDialog=!1)},"×")]),l("div",jy,[l("div",zy,[t[45]||(t[45]=l("label",null,"故事名称:",-1)),U(l("input",{type:"text","onUpdate:modelValue":t[14]||(t[14]=a=>o.importStoryName=a),class:"text-input"},null,512),[[ue,o.importStoryName]])]),l("div",By,[t[49]||(t[49]=l("h3",null,"包含内容",-1)),l("div",qy,[l("label",Jy,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[15]||(t[15]=a=>o.importCharacterIntro=a)},null,512),[[Ve,o.importCharacterIntro]]),t[46]||(t[46]=te(" 人物介绍 "))]),l("label",Gy,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[16]||(t[16]=a=>o.importOpeningText=a)},null,512),[[Ve,o.importOpeningText]]),t[47]||(t[47]=te(" 开头文本 "))]),l("label",Wy,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[17]||(t[17]=a=>o.importOutline=a)},null,512),[[Ve,o.importOutline]]),t[48]||(t[48]=te(" 故事大纲 "))])])]),o.importCharacterIntro?(S(),T("div",Hy,[t[50]||(t[50]=l("label",null,"人物介绍:",-1)),l("div",Ky,[l("input",{ref:"characterFileInput",type:"file",accept:".txt,.json",onChange:t[18]||(t[18]=a=>r.handleFileSelection("character")),class:"real-file-input"},null,544),l("input",{type:"text",value:o.characterFileName||"未选择文件",readonly:"",class:"text-input"},null,8,Qy),l("button",{class:"btn btn-outline",onClick:t[19]||(t[19]=a=>e.$refs.characterFileInput.click())},"浏览...")])])):ge("",!0),o.importOpeningText?(S(),T("div",Yy,[t[51]||(t[51]=l("label",null,"开头文本:",-1)),l("div",Xy,[l("input",{ref:"openingFileInput",type:"file",accept:".txt,.json",onChange:t[20]||(t[20]=a=>r.handleFileSelection("opening")),class:"real-file-input"},null,544),l("input",{type:"text",value:o.openingFileName||"未选择文件",readonly:"",class:"text-input"},null,8,Zy),l("button",{class:"btn btn-outline",onClick:t[21]||(t[21]=a=>e.$refs.openingFileInput.click())},"浏览...")])])):ge("",!0),o.importOutline?(S(),T("div",eb,[t[52]||(t[52]=l("label",null,"故事大纲:",-1)),l("div",tb,[l("input",{ref:"outlineFileInput",type:"file",accept:".txt,.json",onChange:t[22]||(t[22]=a=>r.handleFileSelection("outline")),class:"real-file-input"},null,544),l("input",{type:"text",value:o.outlineFileName||"未选择文件",readonly:"",class:"text-input"},null,8,sb),l("button",{class:"btn btn-outline",onClick:t[23]||(t[23]=a=>e.$refs.outlineFileInput.click())},"浏览...")])])):ge("",!0)]),l("div",ob,[l("button",{class:"btn btn-success",onClick:t[24]||(t[24]=(...a)=>r.confirmImport&&r.confirmImport(...a))},"确认导入")])])])):ge("",!0),o.showAdvancedOptionsDialog?(S(),T("div",nb,[l("div",rb,[l("div",ib,[t[53]||(t[53]=l("h2",null,"高级选项",-1)),l("span",{class:"close-btn",onClick:t[25]||(t[25]=a=>o.showAdvancedOptionsDialog=!1)},"×")]),l("div",ab,[l("div",lb,[t[54]||(t[54]=l("label",null,"跨域代理URL:",-1)),U(l("input",{type:"text","onUpdate:modelValue":t[26]||(t[26]=a=>o.proxyUrl=a),class:"text-input"},null,512),[[ue,o.proxyUrl]])]),l("div",cb,[t[55]||(t[55]=l("label",null,"代理密码:",-1)),U(l("input",{type:"text","onUpdate:modelValue":t[27]||(t[27]=a=>o.proxyPassword=a),class:"text-input"},null,512),[[ue,o.proxyPassword]])])]),l("div",ub,[l("button",{class:"btn btn-outline",onClick:t[28]||(t[28]=(...a)=>r.resetAdvancedConfig&&r.resetAdvancedConfig(...a))},[q(i,{icon:["fas","arrows-rotate"],class:"btn-icon"}),t[56]||(t[56]=te(" 恢复默认 "))]),l("button",{class:"btn btn-success",onClick:t[29]||(t[29]=(...a)=>r.saveAdvancedConfig&&r.saveAdvancedConfig(...a))},[q(i,{icon:["fas","save"],class:"btn-icon"}),t[57]||(t[57]=te(" 保存 "))])])])])):ge("",!0),o.isLoading?(S(),T("div",fb,[t[58]||(t[58]=l("div",{class:"loading-spinner"},null,-1)),l("div",db,F(o.loadingText),1)])):ge("",!0),l("div",{class:ie(["message-bubble",{active:o.showMessage,success:o.messageType==="success",error:o.messageType==="error"}])},[l("span",null,F(o.messageContent),1)],2)])}const hb=Be(vy,[["render",gb]]),mb={name:"LLMConfig_modelaccess",data(){return{tabs:["默认","大纲","正文","选项","人物","背景","音乐","对话","总结","本地导入","其他","提示词"],activeTab:"默认",configNames:[],modelNames:[],modelsByConfig:{},settings:[],kindNumberData:[{kind:"大纲",number:6},{kind:"选项",number:6},{kind:"故事开头",number:6},{kind:"故事继续",number:6},{kind:"故事结尾",number:6},{kind:"全部人物绘画",number:2},{kind:"单个人物绘画",number:2},{kind:"故事地点绘画",number:2},{kind:"背景音乐生成",number:2},{kind:"开头音乐生成",number:6},{kind:"结尾音乐生成",number:6},{kind:"故事总结",number:6},{kind:"本地导入",number:6},{kind:"重写提示词",number:1},{kind:"首页背景生成",number:2},{kind:"翻译",number:6}],selectedKind:"",selectedId:"",idOptions:[],promptContent:"",currentKind:"",currentId:"",statusMessage:"准备就绪",showTestResultModal:!1,activeResultTab:"prompt1",testResult:{prompt1:"",prompt2:""},fileUploadType:null}},mounted(){this.loadConfigNames(),this.loadModelNames(),this.loadSettings(),this.kindNumberData.length>0&&(this.selectedKind=this.kindNumberData[0].kind,this.updateIdDropdown())},methods:{loadConfigNames(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.模型&&e.模型.configs&&(this.configNames=Object.keys(e.模型.configs).sort())}catch(e){console.error("Failed to load config names:",e)}},loadModelNames(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");if(this.modelsByConfig={},e.模型&&e.模型.configs)for(const t in e.模型.configs){const s=e.模型.configs[t].models||[];this.modelsByConfig[t]=s.map(n=>n.name)}this.updateModelDropdowns()}catch(e){console.error("Failed to load model names:",e)}},updateModelDropdowns(){this.settings.forEach(e=>{const t=this.modelsByConfig[e.config]||[];t.length>0&&!t.includes(e.model)&&(e.model=t[0])})},watch:{activeTab(){this.loadSettings()},settings:{deep:!0,handler(e,t){if(e&&t){for(let s=0;s<e.length;s++)if(s>=t.length||e[s].config!==t[s].config){const n=this.modelsByConfig[e[s].config]||[];n.length>0&&!n.includes(e[s].model)&&(e[s].model=n[0])}}}}},loadSettings(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.模型&&e.模型[`${this.activeTab}_setting`]?this.settings=e.模型[`${this.activeTab}_setting`].map(t=>{var s,n;return{config:t.config||"",model:t.model||"",weight:((s=t.weigh)==null?void 0:s.toString())||"1",priority:((n=t.priority)==null?void 0:n.toString())||"0"}}):this.settings=[]}catch(e){console.error(`Failed to load settings for ${this.activeTab}:`,e)}},addSetting(){this.settings.push({config:this.configNames.length>0?this.configNames[0]:"",model:this.modelNames.length>0?this.modelNames[0]:"",weight:"1",priority:"0"}),this.$nextTick(()=>{this.$refs.settingsContainer&&(this.$refs.settingsContainer.scrollTop=this.$refs.settingsContainer.scrollHeight)})},deleteSetting(e){this.settings.splice(e,1)},saveSettings(){try{for(let s=0;s<this.settings.length;s++){const n=this.settings[s];if(!n.config){this.showMessage("error",`配置项不能为空 (行: ${s+1})`);return}if(!n.model){this.showMessage("error",`模型项不能为空 (行: ${s+1})`);return}if(!n.weight||!this.isPositiveInt(n.weight)){this.showMessage("error",`权重必须是正整数 (行: ${s+1})`);return}if(!n.priority||!this.isNatureInt(n.priority)){this.showMessage("error",`优先级必须是非负整数 (行: ${s+1})`);return}}const e=this.settings.map(s=>({config:s.config,model:s.model,weigh:parseInt(s.weight),priority:parseInt(s.priority)})),t=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");t.模型||(t.模型={}),t.模型[`${this.activeTab}_setting`]=e,localStorage.setItem("aiGalgameConfig",JSON.stringify(t)),this.showMessage("success",`${this.activeTab} 设置已保存！`)}catch(e){console.error("Failed to save settings:",e),this.showMessage("error",`保存 ${this.activeTab} 设置时出错: ${e.message}`)}},validatePositiveInt(e,t,s){const n=e.target.value;n===""||this.isPositiveInt(n)?t[s]=n:(e.target.classList.add("invalid-input"),setTimeout(()=>{e.target.classList.remove("invalid-input")},1e3))},validateNatureInt(e,t,s){const n=e.target.value;n===""||this.isNatureInt(n)?t[s]=n:(e.target.classList.add("invalid-input"),setTimeout(()=>{e.target.classList.remove("invalid-input")},1e3))},isPositiveInt(e){return/^[1-9]\d*$/.test(e)},isNatureInt(e){return/^(0|[1-9]\d*)$/.test(e)},updateIdDropdown(){this.saveCurrentPrompt();const e=this.selectedKind;if(!e){this.idOptions=[],this.selectedId="",this.promptContent="";return}const t=this.kindNumberData.find(s=>s.kind===e);if(t){const s=t.number;this.idOptions=Array.from({length:s},(n,o)=>(o+1).toString()),this.selectedId=this.idOptions.length>0?this.idOptions[0]:"",this.loadPromptContent()}this.currentKind=e,this.currentId=this.selectedId,this.statusMessage=`已选择: ${e} - ${this.selectedId}`},loadPromptContent(){this.saveCurrentPrompt();const e=this.selectedKind,t=this.selectedId;if(!e||!t){this.promptContent="",this.currentKind="",this.currentId="";return}const s=this.loadPromptSettings();let n=!1;for(const o of s)if(o.kind===e){for(const r of o.content)if(r.id===t){this.promptContent=r.prompt||"",n=!0;break}if(n)break}n||(this.promptContent=""),this.currentKind=e,this.currentId=t,this.statusMessage=`已加载: ${e} - ${t}`},saveCurrentPrompt(){const e=this.currentKind,t=this.currentId,s=this.promptContent.trim();if(!e||!t)return!1;const n=this.loadPromptSettings();let o=n.find(i=>i.kind===e);o||(o={kind:e,content:[]},n.push(o));let r=o.content.find(i=>i.id===t);r?r.prompt=s:(r={id:t,prompt:s},o.content.push(r));try{const i=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");i.提示词||(i.提示词=[]);const a=i.提示词.findIndex(c=>c.kind===e);return a!==-1?i.提示词[a]=o:i.提示词.push(o),localStorage.setItem("aiGalgameConfig",JSON.stringify(i)),!0}catch(i){return console.error("Failed to save prompt:",i),!1}},savePromptConfig(){this.saveCurrentPrompt()&&(this.showMessage("success","提示词配置已保存！"),this.statusMessage="配置已保存")},loadPromptSettings(){try{return JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}").提示词||[]}catch(e){return console.error("Failed to load prompt settings:",e),[]}},importPromptConfig(){this.fileUploadType="prompt",this.$refs.fileInput.click()},handleFileUpload(e){const t=e.target.files[0];if(!t)return;const s=new FileReader;s.onload=n=>{try{const o=JSON.parse(n.target.result);this.fileUploadType==="prompt"&&this.processPromptImport(o)}catch(o){console.error("Failed to process file:",o),this.showMessage("error",`文件处理失败: ${o.message}`)}this.$refs.fileInput.value=""},s.readAsText(t)},processPromptImport(e){try{if(!Array.isArray(e))throw new Error("无效的JSON格式：应为列表");for(const s of e)if(!s.kind||!Array.isArray(s.content))throw new Error("无效的JSON格式：每个项目必须包含kind和content字段");const t=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");t.提示词=e,localStorage.setItem("aiGalgameConfig",JSON.stringify(t)),this.updateIdDropdown(),this.showMessage("success","提示词已成功导入"),this.statusMessage="导入成功"}catch(t){this.showMessage("error",`导入失败: ${t.message}`),this.statusMessage="导入失败"}},exportPromptConfig(){this.saveCurrentPrompt();const e=this.loadPromptSettings(),t=JSON.stringify(e,null,2),s="data:application/json;charset=utf-8,"+encodeURIComponent(t),n="ai_galgame_prompts.json",o=document.createElement("a");o.setAttribute("href",s),o.setAttribute("download",n),o.click(),this.showMessage("success","提示词已导出"),this.statusMessage="导出成功"},async testPrompt(){this.saveCurrentPrompt();const e=this.selectedKind;if(!e){this.showMessage("error","请选择提示词类型");return}this.statusMessage="正在测试提示词...";try{const[t,s]=await ct(e);if(t==="error"&&s==="error"){this.showMessage("error","提示词处理失败"),this.statusMessage="测试失败";return}this.testResult.prompt1=t,this.testResult.prompt2=s,this.showTestResultModal=!0,this.activeResultTab="prompt1",this.statusMessage="测试完成"}catch(t){console.error("Failed to test prompt:",t),this.showMessage("error",`测试失败: ${t.message}`),this.statusMessage="测试失败"}},closeTestResultModal(){this.showTestResultModal=!1},copyTestResult(){const e=this.activeResultTab==="prompt1"?this.testResult.prompt1:this.testResult.prompt2;navigator.clipboard.writeText(e).then(()=>{this.showMessage("success","内容已复制到剪贴板")}).catch(t=>{console.error("Failed to copy text:",t),this.showMessage("error","复制失败")})},showMessage(e,t){this.$emit("show-message",e,t)}},watch:{activeTab(){this.loadSettings()}}},pb={class:"model-access-container"},yb={class:"modal-header"},bb={class:"modal-content"},vb={class:"tab-navigation"},wb=["onClick"],_b={class:"tab-content"},Cb={key:0,class:"model-settings"},$b={class:"settings-controls"},kb={class:"controls-left"},Sb={class:"settings-container",ref:"settingsContainer"},xb={class:"setting-config"},Tb=["onUpdate:modelValue"],Ib=["value"],Mb={class:"setting-model"},Pb=["onUpdate:modelValue"],Ab=["value"],Eb={class:"setting-weight"},Ob=["onUpdate:modelValue","onInput"],Lb={class:"setting-priority"},Nb=["onUpdate:modelValue","onInput"],Rb={class:"setting-action"},Db=["onClick"],Fb={key:1,class:"prompt-config"},Vb={class:"prompt-controls"},Ub={class:"controls-left"},jb={class:"prompt-selector"},zb={class:"selector-item"},Bb=["value"],qb={class:"selector-item"},Jb=["value"],Gb={class:"prompt-editor"},Wb={class:"editor-container"},Hb={class:"editor-status"},Kb={class:"status-text"},Qb={class:"modal-header"},Yb={class:"modal-body"},Xb={class:"result-tabs"},Zb={class:"result-content"},ev={class:"modal-footer"};function tv(e,t,s,n,o,r){return S(),T("div",pb,[l("div",yb,[t[22]||(t[22]=l("h2",null,"接入模型配置区",-1)),l("button",{class:"close-button",onClick:t[0]||(t[0]=i=>e.$emit("close"))},"×")]),l("div",bb,[l("div",vb,[(S(!0),T(ve,null,Ae(o.tabs,i=>(S(),T("div",{key:i,class:ie(["tab-item",{active:o.activeTab===i}]),onClick:a=>o.activeTab=i},F(i),11,wb))),128))]),l("div",_b,[o.activeTab!=="提示词"?(S(),T("div",Cb,[l("div",$b,[l("div",kb,[l("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...i)=>r.addSetting&&r.addSetting(...i))},t[23]||(t[23]=[l("i",{class:"icon"},"➕",-1),te(" 新增设置 ")])),l("button",{class:"btn btn-accent",onClick:t[2]||(t[2]=(...i)=>r.saveSettings&&r.saveSettings(...i))},t[24]||(t[24]=[l("i",{class:"icon"},"💾",-1),te(" 保存设置 ")]))]),t[25]||(t[25]=zo('<div class="controls-right" data-v-49287a0c><div class="tooltip-container" data-v-49287a0c><button class="btn btn-icon btn-help" data-v-49287a0c><i class="icon" data-v-49287a0c>ℹ️</i></button><div class="tooltip-text" data-v-49287a0c> 程序会首先使用最高优先级下的模型：同一优先级下权重越高的模型被选中的概率越大， 当该优先级下的全部模型均超出尝试次数而失败时，程序会选择下一优先级。 当对应项未选择接入模型时，则使用默认配置，否则优先使用对应项下的配置 </div></div></div>',1))]),t[27]||(t[27]=zo('<div class="settings-header" data-v-49287a0c><div class="header-config" data-v-49287a0c>配置</div><div class="header-model" data-v-49287a0c>模型</div><div class="header-weight" data-v-49287a0c>权重</div><div class="header-priority" data-v-49287a0c>优先级</div><div class="header-action" data-v-49287a0c>操作</div></div>',1)),l("div",Sb,[(S(!0),T(ve,null,Ae(o.settings,(i,a)=>(S(),T("div",{key:a,class:ie(["setting-row",{"odd-row":a%2===0,"even-row":a%2===1}])},[l("div",xb,[U(l("select",{"onUpdate:modelValue":c=>i.config=c,class:"config-dropdown"},[(S(!0),T(ve,null,Ae(o.configNames,c=>(S(),T("option",{key:c,value:c},F(c),9,Ib))),128))],8,Tb),[[Ue,i.config]])]),l("div",Mb,[U(l("select",{"onUpdate:modelValue":c=>i.model=c,class:"model-dropdown"},[(S(!0),T(ve,null,Ae(o.modelsByConfig[i.config]||[],c=>(S(),T("option",{key:c,value:c},F(c),9,Ab))),128))],8,Pb),[[Ue,i.model]])]),l("div",Eb,[U(l("input",{type:"text","onUpdate:modelValue":c=>i.weight=c,class:"weight-input",onInput:c=>r.validatePositiveInt(c,i,"weight")},null,40,Ob),[[ue,i.weight]])]),l("div",Lb,[U(l("input",{type:"text","onUpdate:modelValue":c=>i.priority=c,class:"priority-input",onInput:c=>r.validateNatureInt(c,i,"priority")},null,40,Nb),[[ue,i.priority]])]),l("div",Rb,[l("button",{class:"btn btn-danger btn-sm",onClick:c=>r.deleteSetting(a)},t[26]||(t[26]=[l("i",{class:"icon"},"🗑",-1),te(" 删除 ")]),8,Db)])],2))),128))],512)])):(S(),T("div",Fb,[t[36]||(t[36]=l("div",{class:"prompt-header"},[l("h3",null,"提示词模板配置"),l("p",{class:"subtitle"},"配置各种场景下使用的提示词模板")],-1)),l("div",Vb,[l("div",Ub,[l("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=(...i)=>r.importPromptConfig&&r.importPromptConfig(...i))},t[28]||(t[28]=[l("i",{class:"icon"},"📥",-1),te(" 导入提示词 ")])),l("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=(...i)=>r.exportPromptConfig&&r.exportPromptConfig(...i))},t[29]||(t[29]=[l("i",{class:"icon"},"📤",-1),te(" 导出提示词 ")])),l("button",{class:"btn btn-accent",onClick:t[5]||(t[5]=(...i)=>r.savePromptConfig&&r.savePromptConfig(...i))},t[30]||(t[30]=[l("i",{class:"icon"},"💾",-1),te(" 保存配置 ")])),l("button",{class:"btn btn-primary",onClick:t[6]||(t[6]=(...i)=>r.testPrompt&&r.testPrompt(...i))},t[31]||(t[31]=[l("i",{class:"icon"},"🔍",-1),te(" 测试提示词 ")]))])]),l("div",jb,[l("div",zb,[t[32]||(t[32]=l("label",null,"提示词类型:",-1)),U(l("select",{"onUpdate:modelValue":t[7]||(t[7]=i=>o.selectedKind=i),class:"kind-dropdown",onChange:t[8]||(t[8]=(...i)=>r.updateIdDropdown&&r.updateIdDropdown(...i))},[(S(!0),T(ve,null,Ae(o.kindNumberData,i=>(S(),T("option",{key:i.kind,value:i.kind},F(i.kind),9,Bb))),128))],544),[[Ue,o.selectedKind]])]),l("div",qb,[t[33]||(t[33]=l("label",null,"提示词编号:",-1)),U(l("select",{"onUpdate:modelValue":t[9]||(t[9]=i=>o.selectedId=i),class:"id-dropdown",onChange:t[10]||(t[10]=(...i)=>r.loadPromptContent&&r.loadPromptContent(...i))},[(S(!0),T(ve,null,Ae(o.idOptions,i=>(S(),T("option",{key:i,value:i},F(i),9,Jb))),128))],544),[[Ue,o.selectedId]])])]),l("div",Gb,[t[35]||(t[35]=l("div",{class:"editor-hint"}," 在此编辑提示词模板。您可以使用变量 {variable_name} 来表示需要在运行时替换的值。 提示词应当简明扼要，明确指示AI需要执行的任务和期望的输出格式。 ",-1)),l("div",Wb,[U(l("textarea",{"onUpdate:modelValue":t[11]||(t[11]=i=>o.promptContent=i),class:"prompt-textarea",placeholder:"请输入提示词内容..."},null,512),[[ue,o.promptContent]])]),l("div",Hb,[l("div",Kb,F(o.statusMessage),1),t[34]||(t[34]=l("div",{class:"shortcut-hints"},"提示: Ctrl+Z 撤销, Ctrl+Y 重做, Ctrl+A 全选",-1))])])]))])]),o.showTestResultModal?(S(),T("div",{key:0,class:"modal-overlay",onClick:t[20]||(t[20]=(...i)=>r.closeTestResultModal&&r.closeTestResultModal(...i))},[l("div",{class:"modal-container result-modal",onClick:t[19]||(t[19]=ft(()=>{},["stop"]))},[l("div",Qb,[t[37]||(t[37]=l("h2",null,"提示词测试结果",-1)),l("button",{class:"close-button",onClick:t[12]||(t[12]=(...i)=>r.closeTestResultModal&&r.closeTestResultModal(...i))},"×")]),l("div",Yb,[l("div",Xb,[l("div",{class:ie(["result-tab",{active:o.activeResultTab==="prompt1"}]),onClick:t[13]||(t[13]=i=>o.activeResultTab="prompt1")}," 提示词1 ",2),l("div",{class:ie(["result-tab",{active:o.activeResultTab==="prompt2"}]),onClick:t[14]||(t[14]=i=>o.activeResultTab="prompt2")}," 提示词2 ",2)]),l("div",Zb,[o.activeResultTab==="prompt1"?U((S(),T("textarea",{key:0,class:"result-textarea","onUpdate:modelValue":t[15]||(t[15]=i=>o.testResult.prompt1=i),readonly:""},null,512)),[[ue,o.testResult.prompt1]]):U((S(),T("textarea",{key:1,class:"result-textarea","onUpdate:modelValue":t[16]||(t[16]=i=>o.testResult.prompt2=i),readonly:""},null,512)),[[ue,o.testResult.prompt2]])])]),l("div",ev,[l("button",{class:"btn btn-primary",onClick:t[17]||(t[17]=(...i)=>r.copyTestResult&&r.copyTestResult(...i))}," 复制当前内容 "),l("button",{class:"btn btn-default",onClick:t[18]||(t[18]=(...i)=>r.closeTestResultModal&&r.closeTestResultModal(...i))}," 关闭 ")])])])):ge("",!0),l("input",{type:"file",ref:"fileInput",style:{display:"none"},accept:".json",onChange:t[21]||(t[21]=(...i)=>r.handleFileUpload&&r.handleFileUpload(...i))},null,544)])}const sv=Be(mb,[["render",tv],["__scopeId","data-v-49287a0c"]]),ov={name:"LLMConfig",components:{LLMConfig_modelaccess:sv},data(){return{activeTab:"basic",showApiKey:!1,showIntegrationModal:!1,showModelSelectionModal:!1,showInputDialog:!1,inputDialogTitle:"",inputDialogValue:"",inputDialogCallback:null,configNames:[],selectedConfig:"",modelBaseUrl:"",apiKey:"",modelNames:[],selectedModel:"",currentModelName:"",models:[],modelRetry:"3",temperature:"",topP:"",frequencyPenalty:"",presencePenalty:"",maxTokens:"",allModels:[],filteredModels:[],modelSelections:{},modelFilter:"",pageSize:36,currentPage:0,totalPages:1,showMessage:!1,messageType:"success",messageContent:"",messageTimeout:null}},computed:{paginatedModels(){const e=this.currentPage*this.pageSize,t=e+this.pageSize;return this.filteredModels.slice(e,t)},pageLabels(){const e=[];for(let t=0;t<this.totalPages;t++){const s=t*this.pageSize,n=Math.min(s+this.pageSize,this.filteredModels.length);if(s<n){const o=this.filteredModels[s],r=this.filteredModels[n-1],i=o[0].toUpperCase(),a=r[0].toUpperCase();e.push(`第 ${t+1} 页 (${i}-${a}) [${n-s}项]`)}else e.push(`第 ${t+1} 页 (空页)`)}return e}},mounted(){this.loadConfig()},methods:{loadConfig(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");(!e.模型||!e.模型.configs)&&(e.模型={configs:{}},localStorage.setItem("aiGalgameConfig",JSON.stringify(e))),this.configNames=Object.keys(e.模型.configs).sort(),this.configNames.length>0&&(this.selectedConfig=this.configNames[0],this.loadConfigValues(this.selectedConfig))}catch(e){console.error("Failed to load configuration:",e),this.showMessageBubble("error","加载配置失败")}},loadConfigValues(e){try{const s=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}").模型.configs[e]||{};this.modelBaseUrl=s.model_baseurl||"",this.apiKey=s.api_key||"",this.models=s.models||[],this.modelNames=this.models.map(n=>n.name),this.modelNames.length>0?(this.selectedModel=this.modelNames[0],this.loadModelValues(this.selectedModel)):(this.selectedModel="",this.clearModelValues())}catch(t){console.error("Failed to load config values:",t),this.showMessageBubble("error","加载配置值失败")}},saveLLMConfig(){try{if(!this.selectedConfig){this.showMessageBubble("error","请先选择一个配置");return}const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.模型||(e.模型={configs:{}}),e.模型.configs[this.selectedConfig]||(e.模型.configs[this.selectedConfig]={models:[]}),e.模型.configs[this.selectedConfig].model_baseurl=this.modelBaseUrl,e.模型.configs[this.selectedConfig].api_key=this.apiKey,localStorage.setItem("aiGalgameConfig",JSON.stringify(e)),this.showMessageBubble("success","成功保存配置信息！")}catch(e){console.error("Failed to save config:",e),this.showMessageBubble("error","保存配置失败")}},onConfigSelect(){this.saveModelConfig(),this.loadConfigValues(this.selectedConfig)},addLLMConfig(){this.inputDialogTitle="新增配置",this.inputDialogValue="",this.inputDialogCallback=this.confirmAddConfig,this.showInputDialog=!0},confirmAddConfig(){const e=this.inputDialogValue.trim();if(!e){this.showMessageBubble("error","配置名称不能为空");return}try{const t=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");if(t.模型||(t.模型={configs:{}}),t.模型.configs[e]){this.showMessageBubble("error","配置名称已存在");return}t.模型.configs[e]={model_baseurl:"",api_key:"",models:[]},localStorage.setItem("aiGalgameConfig",JSON.stringify(t)),this.configNames.push(e),this.configNames.sort(),this.selectedConfig=e,this.clearConfigValues(),this.clearModelValues(),this.closeInputDialog(),this.showMessageBubble("success","成功创建新配置")}catch(t){console.error("Failed to add config:",t),this.showMessageBubble("error","创建配置失败")}},copyLLMConfig(){if(!this.selectedConfig){this.showMessageBubble("error","请选择要复制的配置");return}this.inputDialogTitle="复制配置",this.inputDialogValue=`${this.selectedConfig} 副本`,this.inputDialogCallback=this.confirmCopyConfig,this.showInputDialog=!0},confirmCopyConfig(){const e=this.inputDialogValue.trim();if(!e){this.showMessageBubble("error","配置名称不能为空");return}try{const t=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");if(t.模型.configs[e]){this.showMessageBubble("error","配置名称已存在");return}const s=t.模型.configs[this.selectedConfig];t.模型.configs[e]=JSON.parse(JSON.stringify(s)),localStorage.setItem("aiGalgameConfig",JSON.stringify(t)),this.configNames.push(e),this.configNames.sort(),this.selectedConfig=e,this.loadConfigValues(e),this.closeInputDialog(),this.showMessageBubble("success","成功复制配置")}catch(t){console.error("Failed to copy config:",t),this.showMessageBubble("error","复制配置失败")}},deleteLLMConfig(){if(!this.selectedConfig){this.showMessageBubble("error","请选择要删除的配置");return}if(confirm(`确定要删除配置 "${this.selectedConfig}" 吗？`))try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");delete e.模型.configs[this.selectedConfig],localStorage.setItem("aiGalgameConfig",JSON.stringify(e));const t=this.configNames.indexOf(this.selectedConfig);this.configNames.splice(t,1),this.configNames.length>0?(this.selectedConfig=this.configNames[0],this.loadConfigValues(this.selectedConfig)):(this.selectedConfig="",this.clearConfigValues(),this.clearModelValues()),this.showMessageBubble("success","已删除")}catch(e){console.error("Failed to delete config:",e),this.showMessageBubble("error","删除配置失败")}},clearConfigValues(){this.modelBaseUrl="",this.apiKey="",this.models=[],this.modelNames=[],this.selectedModel=""},loadModelValues(e){this.currentModelName=e;const t=this.models.find(s=>s.name===e);t?(this.modelRetry=t.max_retry||"3",this.temperature=t.temperature||"",this.topP=t.top_p||"",this.frequencyPenalty=t.frequency_penalty||"",this.presencePenalty=t.presence_penalty||"",this.maxTokens=t.max_tokens||""):this.clearModelValues()},saveModelConfig(){if(!(!this.selectedConfig||!this.currentModelName))try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}"),t=e.模型.configs[this.selectedConfig].models||[],s=t.findIndex(n=>n.name===this.currentModelName);s!==-1&&(t[s]={name:this.currentModelName,max_retry:this.modelRetry,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens}),localStorage.setItem("aiGalgameConfig",JSON.stringify(e)),this.showMessageBubble("success","模型参数已保存")}catch(e){console.error("Failed to save model config:",e),this.showMessageBubble("error","保存模型参数失败")}},onModelSelect(){this.saveModelConfig(),this.loadModelValues(this.selectedModel)},addLLMModel(){if(!this.selectedConfig){this.showMessageBubble("error","请先选择一个配置");return}this.inputDialogTitle="新增模型",this.inputDialogValue="",this.inputDialogCallback=this.confirmAddModel,this.showInputDialog=!0},confirmAddModel(){const e=this.inputDialogValue.trim();if(!e){this.showMessageBubble("error","模型名称不能为空");return}if(this.modelNames.includes(e)){this.showMessageBubble("error","模型名称已存在");return}try{const t=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}"),s={name:e,max_retry:"3",temperature:"",top_p:"",frequency_penalty:"",presence_penalty:"",max_tokens:""};t.模型.configs[this.selectedConfig].models.push(s),localStorage.setItem("aiGalgameConfig",JSON.stringify(t)),this.models.push(s),this.modelNames.push(e),this.selectedModel=e,this.currentModelName=e,this.clearModelValues(),this.modelRetry="3",this.closeInputDialog(),this.showMessageBubble("success","成功添加新模型")}catch(t){console.error("Failed to add model:",t),this.showMessageBubble("error","添加模型失败")}},deleteLLMModel(){if(!this.selectedConfig){this.showMessageBubble("error","请先选择一个配置");return}if(!this.selectedModel){this.showMessageBubble("error","请选择要删除的模型");return}if(confirm(`确定要删除模型 "${this.selectedModel}" 吗？`))try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}"),t=e.模型.configs[this.selectedConfig].models,s=t.findIndex(o=>o.name===this.selectedModel);s!==-1&&t.splice(s,1),localStorage.setItem("aiGalgameConfig",JSON.stringify(e));const n=this.modelNames.indexOf(this.selectedModel);this.models.splice(n,1),this.modelNames.splice(n,1),this.modelNames.length>0?(this.selectedModel=this.modelNames[0],this.loadModelValues(this.selectedModel)):(this.selectedModel="",this.clearModelValues()),this.showMessageBubble("success","已删除模型")}catch(e){console.error("Failed to delete model:",e),this.showMessageBubble("error","删除模型失败")}},clearModelValues(){this.modelRetry="3",this.temperature="",this.topP="",this.frequencyPenalty="",this.presencePenalty="",this.maxTokens=""},openIntegrationWindow(){this.showIntegrationModal=!0},closeIntegrationModal(){this.showIntegrationModal=!1},closeInputDialog(){this.showInputDialog=!1,this.inputDialogValue=""},confirmInputDialog(){this.inputDialogCallback&&this.inputDialogCallback()},getModelsFromServer(){if(!this.modelBaseUrl||!this.apiKey){this.showMessageBubble("error","请先填写模型baseurl和api-key");return}this.showMessageBubble("success","正在从服务器获取模型列表..."),this.fetchModelsFromServer(this.modelBaseUrl,this.apiKey).then(e=>{this.allModels=e,this.filteredModels=[...e],this.updateTotalPages(),this.modelSelections={},this.allModels.forEach(t=>{this.modelSelections[t]=this.modelNames.includes(t)}),this.showModelSelectionModal=!0}).catch(e=>{console.error("Failed to fetch models:",e),this.showMessageBubble("error","获取模型列表失败")})},async fetchModelsFromServer(e,t){try{const s=`${e}/models`,r=await(await fetch(s,{headers:{Authorization:t}})).json();return r&&r.data?r.data.filter(a=>a.id).map(a=>a.id).sort((a,c)=>{const f=/[\u4e00-\u9fa5]/.test(a),u=/[\u4e00-\u9fa5]/.test(c);return f&&!u?-1:!f&&u?1:a.toLowerCase().localeCompare(c.toLowerCase())}):[]}catch(s){throw console.error("Error fetching models:",s),s}},applyModelFilter(){const e=this.modelFilter.toLowerCase();e?this.filteredModels=this.allModels.filter(t=>t.toLowerCase().includes(e)):this.filteredModels=[...this.allModels],this.currentPage=0,this.updateTotalPages()},updateTotalPages(){this.totalPages=Math.max(1,Math.ceil(this.filteredModels.length/this.pageSize))},prevPage(){this.currentPage>0&&this.currentPage--},nextPage(){this.currentPage<this.totalPages-1&&this.currentPage++},selectAllModels(){const e=this.currentPage*this.pageSize,t=Math.min(e+this.pageSize,this.filteredModels.length);for(let s=e;s<t;s++){const n=this.filteredModels[s];this.modelSelections[n]=!0}},deselectAllModels(){const e=this.currentPage*this.pageSize,t=Math.min(e+this.pageSize,this.filteredModels.length);for(let s=e;s<t;s++){const n=this.filteredModels[s];this.modelSelections[n]=!1}},truncateText(e){return e.length>40?e.substring(0,40)+"...":e},confirmModelSelection(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}"),t=[],s=[];Object.keys(this.modelSelections).forEach(n=>{const o=this.modelSelections[n],r=this.modelNames.includes(n);o&&!r?t.push(n):!o&&r&&s.push(n)}),t.forEach(n=>{const o={name:n,max_retry:"3",temperature:"",top_p:"",frequency_penalty:"",presence_penalty:"",max_tokens:""};e.模型.configs[this.selectedConfig].models.push(o),this.models.push(o),this.modelNames.push(n)}),s.forEach(n=>{const o=e.模型.configs[this.selectedConfig].models,r=o.findIndex(a=>a.name===n);r!==-1&&o.splice(r,1);const i=this.modelNames.indexOf(n);this.models.splice(i,1),this.modelNames.splice(i,1)}),localStorage.setItem("aiGalgameConfig",JSON.stringify(e)),s.includes(this.selectedModel)&&(this.modelNames.length>0?(this.selectedModel=this.modelNames[0],this.loadModelValues(this.selectedModel)):(this.selectedModel="",this.clearModelValues())),this.closeModelSelectionModal(),this.showMessageBubble("success","模型列表已更新")}catch(e){console.error("Failed to update models:",e),this.showMessageBubble("error","更新模型列表失败")}},closeModelSelectionModal(){this.showModelSelectionModal=!1,this.modelFilter="",this.currentPage=0},testLLMModel(){if(!this.modelBaseUrl||!this.apiKey||!this.selectedModel){this.showMessageBubble("error","请先填写模型baseurl、api-key和选择模型");return}this.showMessageBubble("success",`开始测试${this.selectedModel}`),this.testModel(this.modelBaseUrl,this.apiKey,this.selectedModel).then(e=>{e?this.showMessageBubble("success",`${this.selectedModel}测试通过`):this.showMessageBubble("error",`${this.selectedModel}测试失败`)}).catch(()=>{this.showMessageBubble("error",`${this.selectedModel}测试不通过`)})},async testModel(e,t,s){try{const n=`${e}/chat/completions`,a=await(await fetch(n,{method:"POST",headers:{Accept:"application/json",Authorization:t,"Content-Type":"application/json"},body:JSON.stringify({model:s,messages:[{role:"user",content:"你好"}]})})).json();return!!(a.choices&&a.choices.length>0&&a.choices[0].message&&a.choices[0].message.content)}catch(n){throw console.error("Error testing model:",n),n}},showMessageBubble(e,t){this.$emit("show-message",{title:e,message:t})}}},nv={class:"llm-config-container"},rv={class:"config-panel"},iv={class:"config-selection-row"},av={class:"config-dropdown-container"},lv=["value"],cv={class:"config-buttons"},uv={class:"integration-row"},fv={class:"content-tabs"},dv={class:"tab-headers"},gv={class:"tab-content"},hv={class:"form-group"},mv={class:"form-group"},pv={class:"api-key-container"},yv=["type"],bv={class:"show-key-label"},vv={class:"form-actions"},wv={class:"tab-content"},_v={class:"model-section"},Cv={class:"model-selection-row"},$v=["value"],kv={class:"model-buttons-row"},Sv={class:"model-buttons-left"},xv={class:"model-buttons-right"},Tv={class:"params-section"},Iv={class:"params-grid"},Mv={class:"param-cell"},Pv={class:"param-cell"},Av={class:"param-cell"},Ev={class:"param-cell"},Ov={class:"param-cell"},Lv={class:"param-cell"},Nv={class:"form-actions"},Rv={class:"modal-header"},Dv={class:"modal-body"},Fv={class:"filter-section"},Vv={class:"filter-container"},Uv={class:"pagination-section"},jv=["value"],zv={class:"page-buttons"},Bv=["disabled"],qv=["disabled"],Jv={class:"model-list"},Gv={class:"model-checkbox"},Wv=["onUpdate:modelValue"],Hv=["title"],Kv={class:"selection-actions"},Qv={class:"modal-footer"},Yv={class:"dialog-buttons"};function Xv(e,t,s,n,o,r){const i=ze("LLMConfig_modelaccess");return S(),T("div",nv,[t[73]||(t[73]=l("div",{class:"title-section"},[l("h1",{class:"page-title"},"大语言模型配置"),l("div",{class:"separator"})],-1)),l("div",rv,[t[51]||(t[51]=l("h2",{class:"panel-title"},"配置管理",-1)),l("div",iv,[l("div",av,[t[46]||(t[46]=l("label",null,"选择配置:",-1)),U(l("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>o.selectedConfig=a),class:"config-dropdown",onChange:t[1]||(t[1]=(...a)=>r.onConfigSelect&&r.onConfigSelect(...a))},[(S(!0),T(ve,null,Ae(o.configNames,a=>(S(),T("option",{key:a,value:a},F(a),9,lv))),128))],544),[[Ue,o.selectedConfig]])]),l("div",cv,[l("button",{class:"btn btn-default",onClick:t[2]||(t[2]=(...a)=>r.addLLMConfig&&r.addLLMConfig(...a))},t[47]||(t[47]=[l("i",{class:"icon"},"➕",-1),te(" 新增 ")])),l("button",{class:"btn btn-default",onClick:t[3]||(t[3]=(...a)=>r.copyLLMConfig&&r.copyLLMConfig(...a))},t[48]||(t[48]=[l("i",{class:"icon"},"📋",-1),te(" 复制 ")])),l("button",{class:"btn btn-danger",onClick:t[4]||(t[4]=(...a)=>r.deleteLLMConfig&&r.deleteLLMConfig(...a))},t[49]||(t[49]=[l("i",{class:"icon"},"🗑",-1),te(" 删除 ")]))])]),l("div",uv,[l("button",{class:"btn btn-accent",onClick:t[5]||(t[5]=(...a)=>r.openIntegrationWindow&&r.openIntegrationWindow(...a))},t[50]||(t[50]=[l("i",{class:"icon"},"⚙️",-1),te(" 接入模型配置 ")]))])]),l("div",fv,[l("div",dv,[l("div",{class:ie(["tab-header",{active:o.activeTab==="basic"}]),onClick:t[6]||(t[6]=a=>o.activeTab="basic")}," 基本连接信息 ",2),l("div",{class:ie(["tab-header",{active:o.activeTab==="model"}]),onClick:t[7]||(t[7]=a=>o.activeTab="model")}," 模型参数设置 ",2)]),U(l("div",gv,[l("div",hv,[t[52]||(t[52]=l("label",null,"模型 BaseURL:",-1)),U(l("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=a=>o.modelBaseUrl=a),class:"text-input",placeholder:"例如: https://api.openai.com/v1"},null,512),[[ue,o.modelBaseUrl]])]),l("div",mv,[t[54]||(t[54]=l("label",null,"API Key:",-1)),l("div",pv,[U(l("input",{type:o.showApiKey?"text":"password","onUpdate:modelValue":t[9]||(t[9]=a=>o.apiKey=a),class:"text-input",placeholder:"输入您的API密钥"},null,8,yv),[[Sh,o.apiKey]]),l("label",bv,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=a=>o.showApiKey=a)},null,512),[[Ve,o.showApiKey]]),t[53]||(t[53]=te(" 显示 "))])])]),l("div",vv,[l("button",{class:"btn btn-accent",onClick:t[11]||(t[11]=(...a)=>r.saveLLMConfig&&r.saveLLMConfig(...a))},t[55]||(t[55]=[l("i",{class:"icon"},"💾",-1),te(" 保存基本配置 ")]))])],512),[[Xs,o.activeTab==="basic"]]),U(l("div",wv,[l("div",_v,[t[61]||(t[61]=l("h3",{class:"section-title"},"模型管理",-1)),l("div",Cv,[t[56]||(t[56]=l("label",null,"选择模型:",-1)),U(l("select",{"onUpdate:modelValue":t[12]||(t[12]=a=>o.selectedModel=a),class:"model-dropdown",onChange:t[13]||(t[13]=(...a)=>r.onModelSelect&&r.onModelSelect(...a))},[(S(!0),T(ve,null,Ae(o.modelNames,a=>(S(),T("option",{key:a,value:a},F(a),9,$v))),128))],544),[[Ue,o.selectedModel]])]),l("div",kv,[l("div",Sv,[l("button",{class:"btn btn-default",onClick:t[14]||(t[14]=(...a)=>r.addLLMModel&&r.addLLMModel(...a))},t[57]||(t[57]=[l("i",{class:"icon"},"➕",-1),te(" 新增模型 ")])),l("button",{class:"btn btn-danger",onClick:t[15]||(t[15]=(...a)=>r.deleteLLMModel&&r.deleteLLMModel(...a))},t[58]||(t[58]=[l("i",{class:"icon"},"🗑",-1),te(" 删除模型 ")]))]),l("div",xv,[l("button",{class:"btn btn-default",onClick:t[16]||(t[16]=(...a)=>r.getModelsFromServer&&r.getModelsFromServer(...a))},t[59]||(t[59]=[l("i",{class:"icon"},"📥",-1),te(" 从服务器获取模型 ")])),l("button",{class:"btn btn-default",onClick:t[17]||(t[17]=(...a)=>r.testLLMModel&&r.testLLMModel(...a))},t[60]||(t[60]=[l("i",{class:"icon"},"✔",-1),te(" 测试模型 ")]))])])]),l("div",Tv,[t[69]||(t[69]=l("h3",{class:"section-title"},"模型参数",-1)),l("div",Iv,[l("div",Mv,[t[62]||(t[62]=l("label",null,"最大尝试次数:",-1)),U(l("input",{type:"number","onUpdate:modelValue":t[18]||(t[18]=a=>o.modelRetry=a),class:"param-input",min:"1"},null,512),[[ue,o.modelRetry]])]),l("div",Pv,[t[63]||(t[63]=l("label",null,"Temperature:",-1)),U(l("input",{type:"number","onUpdate:modelValue":t[19]||(t[19]=a=>o.temperature=a),class:"param-input",min:"0",max:"2",step:"0.1"},null,512),[[ue,o.temperature]])]),l("div",Av,[t[64]||(t[64]=l("label",null,"Top P:",-1)),U(l("input",{type:"number","onUpdate:modelValue":t[20]||(t[20]=a=>o.topP=a),class:"param-input",min:"0",max:"1",step:"0.1"},null,512),[[ue,o.topP]])]),l("div",Ev,[t[65]||(t[65]=l("label",null,"Freq Penalty:",-1)),U(l("input",{type:"number","onUpdate:modelValue":t[21]||(t[21]=a=>o.frequencyPenalty=a),class:"param-input",min:"-2",max:"2",step:"0.1"},null,512),[[ue,o.frequencyPenalty]])]),l("div",Ov,[t[66]||(t[66]=l("label",null,"Pres Penalty:",-1)),U(l("input",{type:"number","onUpdate:modelValue":t[22]||(t[22]=a=>o.presencePenalty=a),class:"param-input",min:"-2",max:"2",step:"0.1"},null,512),[[ue,o.presencePenalty]])]),l("div",Lv,[t[67]||(t[67]=l("label",null,"Max Tokens:",-1)),U(l("input",{type:"number","onUpdate:modelValue":t[23]||(t[23]=a=>o.maxTokens=a),class:"param-input",min:"1"},null,512),[[ue,o.maxTokens]])])]),l("div",Nv,[l("button",{class:"btn btn-accent",onClick:t[24]||(t[24]=(...a)=>r.saveModelConfig&&r.saveModelConfig(...a))},t[68]||(t[68]=[l("i",{class:"icon"},"💾",-1),te(" 保存模型参数 ")]))])])],512),[[Xs,o.activeTab==="model"]])]),o.showIntegrationModal?(S(),T("div",{key:0,class:"modal-overlay",onClick:t[26]||(t[26]=(...a)=>r.closeIntegrationModal&&r.closeIntegrationModal(...a))},[l("div",{class:"modal-container",onClick:t[25]||(t[25]=ft(()=>{},["stop"]))},[o.showIntegrationModal?(S(),Xe(i,{key:0,onClose:r.closeIntegrationModal,onShowMessage:r.showMessageBubble},null,8,["onClose","onShowMessage"])):ge("",!0)])])):ge("",!0),o.showModelSelectionModal?(S(),T("div",{key:1,class:"modal-overlay",onClick:t[39]||(t[39]=(...a)=>r.closeModelSelectionModal&&r.closeModelSelectionModal(...a))},[l("div",{class:"modal-container model-selection-modal",onClick:t[38]||(t[38]=ft(()=>{},["stop"]))},[l("div",Rv,[t[70]||(t[70]=l("h2",null,"选择需要导入的模型",-1)),l("button",{class:"close-button",onClick:t[27]||(t[27]=(...a)=>r.closeModelSelectionModal&&r.closeModelSelectionModal(...a))},"×")]),l("div",Dv,[l("div",Fv,[t[71]||(t[71]=l("label",null,"筛选:",-1)),l("div",Vv,[U(l("input",{type:"text","onUpdate:modelValue":t[28]||(t[28]=a=>o.modelFilter=a),class:"filter-input",onKeyup:t[29]||(t[29]=qo((...a)=>r.applyModelFilter&&r.applyModelFilter(...a),["enter"])),placeholder:"输入关键词筛选模型"},null,544),[[ue,o.modelFilter]]),l("button",{class:"btn btn-default",onClick:t[30]||(t[30]=(...a)=>r.applyModelFilter&&r.applyModelFilter(...a))},"筛选")])]),l("div",Uv,[t[72]||(t[72]=l("label",null,"页面:",-1)),U(l("select",{"onUpdate:modelValue":t[31]||(t[31]=a=>o.currentPage=a),class:"page-dropdown"},[(S(!0),T(ve,null,Ae(r.pageLabels,(a,c)=>(S(),T("option",{key:c,value:c},F(a),9,jv))),128))],512),[[Ue,o.currentPage]]),l("div",zv,[l("button",{class:"btn btn-small",onClick:t[32]||(t[32]=(...a)=>r.prevPage&&r.prevPage(...a)),disabled:o.currentPage===0},"上一页",8,Bv),l("button",{class:"btn btn-small",onClick:t[33]||(t[33]=(...a)=>r.nextPage&&r.nextPage(...a)),disabled:o.currentPage>=o.totalPages-1},"下一页",8,qv)])]),l("div",Jv,[(S(!0),T(ve,null,Ae(r.paginatedModels,(a,c)=>(S(),T("div",{key:c,class:"model-item"},[l("label",Gv,[U(l("input",{type:"checkbox","onUpdate:modelValue":f=>o.modelSelections[a]=f},null,8,Wv),[[Ve,o.modelSelections[a]]]),l("span",{title:a},F(r.truncateText(a)),9,Hv)])]))),128))]),l("div",Kv,[l("button",{class:"btn btn-default",onClick:t[34]||(t[34]=(...a)=>r.selectAllModels&&r.selectAllModels(...a))},"全选"),l("button",{class:"btn btn-default",onClick:t[35]||(t[35]=(...a)=>r.deselectAllModels&&r.deselectAllModels(...a))},"取消全选")])]),l("div",Qv,[l("button",{class:"btn btn-default",onClick:t[36]||(t[36]=(...a)=>r.closeModelSelectionModal&&r.closeModelSelectionModal(...a))},"取消"),l("button",{class:"btn btn-accent",onClick:t[37]||(t[37]=(...a)=>r.confirmModelSelection&&r.confirmModelSelection(...a))},"确定")])])])):ge("",!0),o.showInputDialog?(S(),T("div",{key:2,class:"modal-overlay",onClick:t[45]||(t[45]=(...a)=>r.closeInputDialog&&r.closeInputDialog(...a))},[l("div",{class:"input-dialog",onClick:t[44]||(t[44]=ft(()=>{},["stop"]))},[l("h3",null,F(o.inputDialogTitle),1),U(l("input",{type:"text","onUpdate:modelValue":t[40]||(t[40]=a=>o.inputDialogValue=a),class:"text-input",onKeyup:t[41]||(t[41]=qo((...a)=>r.confirmInputDialog&&r.confirmInputDialog(...a),["enter"]))},null,544),[[ue,o.inputDialogValue]]),l("div",Yv,[l("button",{class:"btn btn-default",onClick:t[42]||(t[42]=(...a)=>r.closeInputDialog&&r.closeInputDialog(...a))},"取消"),l("button",{class:"btn btn-accent",onClick:t[43]||(t[43]=(...a)=>r.confirmInputDialog&&r.confirmInputDialog(...a))},"确定")])])])):ge("",!0),l("div",{class:ie(["message-bubble",{active:o.showMessage,success:o.messageType==="success",error:o.messageType==="error"}])},F(o.messageContent),3)])}const Zv=Be(ov,[["render",Xv]]),ew={name:"VoiceConfig",data(){return{emotions:[{value:"normal",label:"普通",icon:"😐"},{value:"happy",label:"开心",icon:"😄"},{value:"sad",label:"悲伤",icon:"😢"},{value:"angry",label:"生气",icon:"😠"}],currentEmotion:"normal",filePaths:Array(7).fill(""),textContents:Array(7).fill(""),modelNames:Array(7).fill(""),batchModelName:"",showMessage:!1,messageType:"success",messageContent:"",messageTimeout:null,useLocalProxy:!1,sovitsURL:"http://127.0.0.1:9880"}},mounted(){this.loadConfig()},watch:{useLocalProxy(e){this.saveConfig()},sovitsURL(e){this.saveConfig()}},methods:{switchEmotion(e){this.saveConfig(!0),this.currentEmotion=e,this.loadConfig()},getCurrentEmotionLabel(){return this.emotions.find(e=>e.value===this.currentEmotion).label},getCurrentEmotionIcon(){return this.emotions.find(e=>e.value===this.currentEmotion).icon},getConfigKeySuffix(){return this.currentEmotion==="normal"?"":`_${this.currentEmotion}`},fillTextContent(){for(let e=0;e<this.filePaths.length;e++)if(this.filePaths[e])try{let n=this.filePaths[e].trim().split(/[\/\\]/).pop().split(".")[0];n=n.replace(/\【.*?\】/g,""),n=n.replace(/\[.*?\]/g,""),this.textContents[e]=n.trim()}catch(t){console.error(`Error processing file path at index ${e}:`,t)}this.showMessageBubble("success","文本内容已根据文件名填充")},fillModelNames(){this.batchModelName.trim()?(this.modelNames=this.modelNames.map(()=>this.batchModelName.trim()),this.showMessageBubble("success","模型名称已批量设置")):this.showMessageBubble("error","请先输入要应用的模型名称")},loadConfig(){try{const t=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}").SOVITS||{},s=this.getConfigKeySuffix();for(let n=0;n<7;n++){const o=`path${n+1}${s}`,r=`text${n+1}${s}`,i=`model${n+1}${s}`;this.filePaths[n]=t[o]||"",this.textContents[n]=t[r]||"",this.modelNames[n]=t[i]||""}this.useLocalProxy=t.useLocalProxy!==void 0?t.useLocalProxy:!1,this.sovitsURL=t.sovitsURL||"http://127.0.0.1:9880"}catch(e){console.error("Error loading voice configuration:",e),this.showMessageBubble("error","加载配置失败")}},saveConfig(e=!1){try{const t=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");t.SOVITS||(t.SOVITS={});const s=this.getConfigKeySuffix();for(let n=0;n<7;n++){const o=`path${n+1}${s}`,r=`text${n+1}${s}`,i=`model${n+1}${s}`;t.SOVITS[o]=this.filePaths[n].trim(),t.SOVITS[r]=this.textContents[n].trim(),t.SOVITS[i]=this.modelNames[n].trim()}t.SOVITS.useLocalProxy=this.useLocalProxy,t.SOVITS.sovitsURL=this.sovitsURL,localStorage.setItem("aiGalgameConfig",JSON.stringify(t)),this.showMessageBubble("success",`${this.getCurrentEmotionLabel()}语气配置已保存`)}catch(t){console.error("Error saving voice configuration:",t),e||this.showMessageBubble("error","保存配置失败")}},showMessageBubble(e,t){this.$emit("show-message",{title:e,message:t})}}},tw={class:"voice-config"},sw={class:"header-section"},ow={class:"proxy-config"},nw={class:"toggle-switch"},rw={class:"sovits-url-config"},iw={class:"emotion-switcher"},aw={class:"emotion-options"},lw=["onClick"],cw={class:"emotion-icon"},uw={class:"emotion-label"},fw={class:"content-section"},dw={class:"emotion-indicator-icon"},gw={class:"emotion-indicator-text"},hw={class:"entries-container-no-scroll"},mw={class:"col-index"},pw={class:"col-file"},yw=["onUpdate:modelValue"],bw={class:"col-text"},vw=["onUpdate:modelValue"],ww={class:"col-model"},_w=["onUpdate:modelValue"],Cw={class:"control-panel"},$w={class:"control-row"},kw={class:"model-fill-section"},Sw={class:"control-row"},xw={class:"help-text"};function Tw(e,t,s,n,o,r){return S(),T("div",tw,[l("div",sw,[t[10]||(t[10]=l("h1",{class:"title"},"语音合成配置",-1)),t[11]||(t[11]=l("p",{class:"subtitle"},"配置语音文件、文本内容和模型参数",-1)),l("div",ow,[t[7]||(t[7]=l("label",{for:"proxy-switch",class:"proxy-label"},"使用本地代理:",-1)),l("label",nw,[U(l("input",{type:"checkbox",id:"proxy-switch","onUpdate:modelValue":t[0]||(t[0]=i=>o.useLocalProxy=i)},null,512),[[Ve,o.useLocalProxy]]),t[6]||(t[6]=l("span",{class:"toggle-label-switch"},null,-1))])]),l("div",rw,[t[8]||(t[8]=l("label",{for:"sovits-url"},"SoVITS URL:",-1)),U(l("input",{type:"text",id:"sovits-url","onUpdate:modelValue":t[1]||(t[1]=i=>o.sovitsURL=i),placeholder:"http://127.0.0.1:9880"},null,512),[[ue,o.sovitsURL]])]),l("div",iw,[t[9]||(t[9]=l("div",{class:"emotion-title"},"语气选择:",-1)),l("div",aw,[(S(!0),T(ve,null,Ae(o.emotions,i=>(S(),T("button",{key:i.value,onClick:a=>r.switchEmotion(i.value),class:ie(["emotion-btn",{active:o.currentEmotion===i.value}])},[l("span",cw,F(i.icon),1),l("span",uw,F(i.label),1)],10,lw))),128))])]),t[12]||(t[12]=l("div",{class:"separator"},null,-1))]),l("div",fw,[l("div",{class:ie(["current-emotion-indicator",`emotion-${o.currentEmotion}`])},[l("span",dw,F(r.getCurrentEmotionIcon()),1),l("span",gw,"当前配置语气: "+F(r.getCurrentEmotionLabel()),1)],2),t[13]||(t[13]=zo('<div class="table-header" data-v-26a8d77f><div class="col-index" data-v-26a8d77f>序号</div><div class="col-file" data-v-26a8d77f>音频文件</div><div class="col-text" data-v-26a8d77f>文本内容</div><div class="col-model" data-v-26a8d77f>模型名称</div></div>',1)),l("div",hw,[(S(),T(ve,null,Ae(7,(i,a)=>l("div",{key:a,class:ie(["entry-row",{"even-row":a%2===1}])},[l("div",mw,F(a+1),1),l("div",pw,[U(l("textarea",{"onUpdate:modelValue":c=>o.filePaths[a]=c,placeholder:"输入音频文件路径",rows:"2"},null,8,yw),[[ue,o.filePaths[a]]])]),l("div",bw,[U(l("textarea",{"onUpdate:modelValue":c=>o.textContents[a]=c,placeholder:"输入文本内容",rows:"2"},null,8,vw),[[ue,o.textContents[a]]])]),l("div",ww,[U(l("textarea",{"onUpdate:modelValue":c=>o.modelNames[a]=c,placeholder:"输入模型名称",rows:"2"},null,8,_w),[[ue,o.modelNames[a]]])])],2)),64))])]),l("div",Cw,[t[21]||(t[21]=l("h3",{class:"panel-title"},"批量操作",-1)),l("div",$w,[l("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=(...i)=>r.fillTextContent&&r.fillTextContent(...i))},t[14]||(t[14]=[l("span",{class:"btn-icon"},"✍️",-1),te(" 一键填入文本内容 ")])),l("div",kw,[t[16]||(t[16]=l("label",null,"批量设置模型名称:",-1)),U(l("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=i=>o.batchModelName=i),placeholder:"输入要应用的模型名称"},null,512),[[ue,o.batchModelName]]),l("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=(...i)=>r.fillModelNames&&r.fillModelNames(...i))},t[15]||(t[15]=[l("span",{class:"btn-icon"},"✍️",-1),te(" 应用到全部 ")]))])]),l("div",Sw,[l("span",xw,[t[17]||(t[17]=l("span",{class:"tip-highlight"},"提示:",-1)),t[18]||(t[18]=te(" 当前编辑的是")),l("strong",null,F(r.getCurrentEmotionLabel()),1),t[19]||(t[19]=te("语气的配置 "))]),l("button",{class:"btn btn-success",onClick:t[5]||(t[5]=(...i)=>r.saveConfig&&r.saveConfig(...i))},t[20]||(t[20]=[l("span",{class:"btn-icon"},"💾",-1),te(" 保存配置 ")]))])]),l("div",{class:ie(["message-bubble",{active:o.showMessage,success:o.messageType==="success",error:o.messageType==="error"}])},[l("span",null,F(o.messageContent),1)],2)])}const Iw=Be(ew,[["render",Tw],["__scopeId","data-v-26a8d77f"]]),Mw=new URL("/assets/image-processing.worker-sXmRlqyz.js",import.meta.url);async function mr(e,t,s={}){return new Promise(async(n,o)=>{let r=null,i=0,a=0;try{const u=await Pw(t);i=u.width,a=u.height;const d=document.createElement("canvas");d.width=i,d.height=a;const h=d.getContext("2d");h.drawImage(u,0,0),r=h.getImageData(0,0,i,a)}catch(u){return console.error(`[Main] Failed to load image data for worker task "${e}":`,u),o(new Error(`Failed to load image data: ${u.message}`))}const c=new Worker(Mw,{type:"module"}),f=Date.now()+"-"+Math.random();c.onmessage=u=>{const{id:d,status:h,method:g,error:m,...y}=u.data;if(d!==f){console.warn(`[Main] Received message for unknown task ID: ${d}`);return}if(h==="success")if(console.debug(`[Main] Worker task "${g}" (${d}) successful.`),g==="resize_image_strategy"){const{data:p,width:b,height:w}=y,v=document.createElement("canvas");v.width=b,v.height=w;const k=v.getContext("2d"),$=new ImageData(p,b,w);k.putImageData($,0,0),v.toBlob(I=>{I?(console.debug(`[Main] Successfully created blob for resized image (${d}).`),n(I)):(console.error(`[Main] Failed to create blob from canvas for resized image (${d}).`),o(new Error("Failed to create resized image Blob"))),c.terminate()},t.type||"image/png")}else console.debug(`[Main] Received score result for ${g} (${d}):`,y.score),n(y.score),c.terminate();else h==="error"?(console.error(`[Main] Worker task "${g}" (${d}) failed:`,(m==null?void 0:m.message)||"Unknown error"),o(new Error(`Worker error in "${g}": ${(m==null?void 0:m.message)||"Unknown error"}`)),c.terminate()):(console.warn(`[Main] Worker task "${e}" (${d}) sent unknown status: "${h}"`),o(new Error(`Worker returned unknown status: ${h}`)),c.terminate())},c.onerror=u=>{console.error(`[Main] Uncaught error in worker for task "${e}" (${f}):`,u),o(new Error(`Worker encountered an error: ${u.message}`)),c.terminate()},c.postMessage({id:f,method:e,imageData:r.data,width:i,height:a,params:s},[r.data.buffer])})}async function Wf(e,t,s,n){console.debug("Offloading method_a to worker...");try{return await mr("method_a",e,{targetWidth:t,targetHeight:s,strategy:n})}catch(o){throw console.error("Method A worker failed:",o),o}}async function Hf(e,t,s,n){console.debug("Offloading method_b to worker...");try{return await mr("method_b",e,{targetWidth:t,targetHeight:s,strategy:n})}catch(o){throw console.error("Method B worker failed:",o),o}}async function Kf(e,t,s,n){console.debug("Offloading method_c to worker...");try{return await mr("method_c",e,{targetWidth:t,targetHeight:s,strategy:n})}catch(o){throw console.error("Method C worker failed:",o),o}}async function Qf(e,t,s,n){console.debug("Offloading resize_image_strategy to worker...");try{return await mr("resize_image_strategy",e,{targetWidth:t,targetHeight:s,strategy:n})}catch(o){throw console.error("Resize worker failed:",o),o}}async function Pw(e){return new Promise((t,s)=>{const n=new FileReader;n.onload=o=>{const r=new Image;r.onload=()=>t(r),r.onerror=()=>s(new Error("Failed to load image for HTMLImageElement")),r.src=o.target.result},n.onerror=o=>{var r,i;return s(new Error(`Failed to read file for image element: ${(i=(r=o.target)==null?void 0:r.error)==null?void 0:i.message}`))},n.readAsDataURL(e)})}function We(e){return new Promise(t=>setTimeout(t,e))}function pr(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function Yf(e,t,s=1){if(e.length!==t.length)throw new Error("Population and weights must have the same length.");if(s<=0)return[];const n=t.reduce((a,c)=>a+c,0);if(n<=0){console.warn("Total weight is zero or negative, falling back to uniform random choice.");const a=[];for(let c=0;c<s;c++)a.push(e[Math.floor(Math.random()*e.length)]);return a}const o=[];let r=0;for(const a of t)r+=a,o.push(r);const i=[];for(let a=0;a<s;a++){const c=Math.random()*n,f=o.findIndex(u=>c<u);i.push(e[f===-1?e.length-1:f])}return i}function Vn(e,t){if(!t||e==null)return null;try{const s=t.match(/\[\s*(?:'([^']+)'|"([^"]+)"|(\d+))\s*\]/g);if(!s)return console.warn(`Path '${t}' doesn't match expected format ['key'] or [index]`),null;let n=e;for(const o of s){const r=o.slice(1,-1).trim();let i;if(r.startsWith("'")&&r.endsWith("'")||r.startsWith('"')&&r.endsWith('"')?i=r.slice(1,-1):/^\d+$/.test(r)?i=parseInt(r,10):i=r,typeof i=="number"){if(!Array.isArray(n)||i<0||i>=n.length)return null;n=n[i]}else{if(typeof n!="object"||n===null||!(i in n))return null;n=n[i]}if(n===null||typeof n>"u")return null}return n}catch(s){return console.error(`Error accessing path '${t}':`,s),null}}const $o=Symbol("EvalFailed");function Rt(e,t,s){if(!e)return!1;const n=e.match(/^\s*(.+?)\s*(==|!=)\s*(.+?)\s*$/);if(!n)return console.warn(`Could not parse condition string: '${e}'`),null;const[,o,r,i]=n,a=u=>{const d=u.trim();if(d==="response.status_code"||d==="response.status")return t?t.status:$o;if(d.startsWith("result[")){const h=d.substring(6),g=Vn(s,h);return g!==null?g:$o}if(d.startsWith("'")&&d.endsWith("'")||d.startsWith('"')&&d.endsWith('"'))return d.slice(1,-1);if(!isNaN(d)&&d.trim()!==""){const h=parseFloat(d);return Number.isInteger(h)&&d.indexOf(".")===-1?parseInt(d,10):h}return d.toLowerCase()==="true"?!0:d.toLowerCase()==="false"?!1:d.toLowerCase()==="none"||d.toLowerCase()==="null"?null:(console.warn(`Unrecognized operand format: '${d}' in condition '${e}'`),$o)},c=a(o),f=a(i);if(c===$o||f===$o)return null;try{return r==="=="?c==f:r==="!="?c!=f:null}catch(u){return console.warn(`Type error during comparison in condition '${e}': ${u}. Operands: ${typeof c}, ${typeof f}`),null}}function Aw(e){if(e==null||typeof e!="string")return"error";try{let t=e.replace(/-/g,"+").replace(/_/g,"/");const s=t.length%4;s&&(t+="=".repeat(4-s));const n=window.atob(t),o=n.length,r=new Uint8Array(o);for(let i=0;i<o;i++)r[i]=n.charCodeAt(i);return r}catch(t){return console.error(`Error decoding base64: ${t}`,e.substring(0,50)),"error"}}function Ew(e){return e!==""?e:"error"}const ql={b64decode:Aw,direct:Ew};async function Jl(e,t,s,n,o,r){if(!e||typeof e!="string")return"error";const i=e.match(/^\s*(\w+)\s*\(\s*(.+)\s*\)\s*$/);if(!i)return console.error(`Could not parse userdefine string format: '${e}'`),"error";const[,a,c]=i,f=c.trim();let u=null;try{if(f==="result")u=r;else if(f.startsWith("result[")){const d=f.substring(6);u=Vn(o,d)}else if(f==="response.text"||f==="text")u=s;else if(f==="response.content"||f==="content"){if(u=n,u===null)return console.error("Error: Userdefine requested 'content', but it was not pre-read or available."),"error"}else return console.error(`Unrecognized argument '${f}' in userdefine string.`),"error";if(u==null&&f!=="result")return console.error(`Failed to evaluate argument '${f}' (value is null or undefined).`),"error";if(a in ql){const d=ql[a];console.debug(`Calling userdefine function '${a}'...`);const h=await d(u);return h==="error"?(console.error(`Mapped function '${a}' signalled an internal error.`),"error"):h}else return console.error(`Function name '${a}' not found in USERDEFINE_FUNCTION_MAP.`),"error"}catch(d){return console.error(`Error processing userdefine '${e}':`,d),"error"}}function Gl(e){const t={};if(Array.isArray(e))for(const s of e)Array.isArray(s)&&s.length===2&&(t[s[0]]=s[1]);return t}function Ow(e){if(!e||e==="error")return console.error("Error: GPT response is empty or error."),null;const t=e.match(/\[\s*\{[\s\S]*?\}\s*\]/);if(!t){console.error("Error: Could not find JSON array structure in GPT response."),console.log("GPT Response Snippet:",e.substring(0,500));const n=e.indexOf("["),o=e.lastIndexOf("]");if(n!==-1&&o>n){const r=e.substring(n,o+1);console.warn("Attempting fallback JSON parsing using bracket matching.");try{const i=JSON.parse(r);if(Array.isArray(i))return i}catch(i){console.error("Fallback JSON parsing failed:",i),console.log("Fallback Snippet:",r.substring(0,500))}}return null}const s=t[0];try{const n=JSON.parse(s);if(!Array.isArray(n))return console.error("Error: Parsed JSON is not a list."),null;if(n.length===0)return console.warn("Warning: GPT returned an empty list of tasks."),[];const o=[];for(const r of n){if(typeof r!="object"||r===null)return console.error("Error: Item in JSON list is not an object:",r),null;if(!("name"in r)||!("prompt"in r))return console.error("Error: Object item missing 'name' or 'prompt':",r),null;const i=String(r.name).trim(),a=String(r.prompt).trim();if(!i){console.warn("Warning: Item has empty name, skipping:",r);continue}o.push({name:i,prompt:a})}return o}catch(n){return console.error(`Error: Failed to decode JSON from GPT response: ${n}`),console.log("Extracted JSON String:",s.substring(0,500)),null}}class Un{constructor(t="UnnamedLock"){this._locked=!1,this._queue=[],this.name=t,this.holder=null}acquire(t="anonymous"){return new Promise(s=>{const n=()=>{this._locked=!0,this.holder=t,s()};this._locked?this._queue.push({resolve:n,requester:t}):n()})}release(t="anonymous"){if(!this._locked){console.warn(`LOCK [${this.name}]: Attempted to release by ${t} when already unlocked!`);return}if(this.holder!==t&&this.holder,this.holder=null,this._queue.length>0){const s=this._queue.shift();setTimeout(s.resolve,0)}else this._locked=!1}async withLock(t,s="withLockCaller"){const n=`${s}-${pr(100,999)}`;await this.acquire(n);try{return await t()}finally{this.release(n)}}isLocked(){return this._locked}getQueueLength(){return this._queue.length}}const Lw="http://127.0.0.1:5436/proxy",Nw="defaultpassword";async function Ci(e,t={}){const{method:s="GET",headers:n={},body:o=void 0,signal:r=void 0}=t;let i;try{i=JSON.parse(localStorage.getItem("aiGalgameConfig"))||{}}catch(g){console.error("Error parsing aiGalgameConfig from localStorage:",g),i={}}const a=i.高级配置||{},c=a.proxyUrl||Lw,f=a.proxyPassword||Nw,u=["POST","PUT","PATCH"].includes(s.toUpperCase()),d=JSON.stringify({method:s.toUpperCase(),url:e,headers:n,body:u?o:void 0,proxyPassword:f});return await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:d,signal:r})}let Hs=null,oa="/data",Us="",Sn=`${oa}/${Us}/images`;async function Rw(e){return e!=="error"&&e!=="rembg_error"&&e!=="cheak_error"?1:(console.debug("DEBUG: func1JS() called. Returning 0 (no split). Status:",e),0)}async function Dw(e,t,s,n,o){console.debug(`DEBUG: func2JS called for ${t} (attempt ${n+1} with ${s})`);try{const[r,i]=await ct("重写提示词"),a=e,c=pr(1,1e5);for(let f=0;f<3;f++){const u=await Ms(r,a,o,c);if(u==="over_times"){console.warn("GPT call for prompt rewrite exceeded retries within gpt function.");continue}else if(u&&u!=="error"){const d=u.match(/"prompt":\s*"((?:[^"\\]|\\.)*)"/);if(d&&d[1]){await st(c);const h=d[1].replace(/\\"/g,'"');return console.debug(`DEBUG: func2JS returning new prompt: ${h}`),h}else console.warn("Could not extract new prompt from func2 GPT response:",u.substring(0,100))}else console.warn("func2 GPT call failed or returned error."),await We(500)}return await st(c),console.error("func2JS failed to get a valid rewritten prompt after multiple retries."),"error"}catch(r){return console.error("Error in func2JS calling GPT:",r),"error"}}class na{constructor(t,s,n,o=null,r=!1){this.config=t,this.kind=s,this.total_tasks=n,this.is_sub_manager=r,this.main_manager_ref=o||(r?null:this),this.all_priorities=null,this.models=[],this.current_priority_index=0,this.terminate_flag=!1,this.lock=new Un,this._global_model_usage={},this._global_lock=new Un,this.is_sub_manager||this._initialize_global_usage(),this._global_model_usage=this.main_manager_ref._global_model_usage,this._global_lock=this.main_manager_ref._global_lock}async initialize(){await this.load_models_by_highest_priority()}_initialize_global_usage(){console.log("Initializing Global Model Usage Tracker..."),this._global_lock.withLock(()=>{var s,n;this._global_model_usage={};const t=((n=(s=this.config)==null?void 0:s.AI_draw)==null?void 0:n.configs)||{};if(Object.keys(t).length===0){console.warn("Warning: No 'configs' section found in AI_draw config for global usage tracking.");return}for(const[o,r]of Object.entries(t)){let i=1;try{const a=r==null?void 0:r.maxconcurrency;if(a!=null&&String(a).trim()){const c=parseInt(String(a).trim(),10);isNaN(c)?console.warn(`Warning: Invalid maxconcurrency '${a}' for model '${o}'. Using default 1.`):i=Math.max(0,c)}}catch(a){console.warn(`Warning: Error parsing maxconcurrency for model '${o}'. Using default 1.`,a),i=1}this._global_model_usage[o]={max:i,current:0}}})}async load_models_by_highest_priority(){const t=this.is_sub_manager?"SubMgr(...)":"MainMgr";console.log(`${t}: --> Preparing to acquire lock for load_models_by_highest_priority. Index: ${this.current_priority_index}.`);try{return await this.lock.withLock(async()=>{var s,n,o,r,i,a;if(console.log(`${t}:     Acquired lock for load_models_by_highest_priority. Index: ${this.current_priority_index}. Terminated: ${this.terminate_flag}`),this.all_priorities===null){console.log(`${t}:     Initializing priorities...`);const c=`${this.kind}_config`,f=(n=(s=this.config)==null?void 0:s.AI_draw)==null?void 0:n[c];if(!Array.isArray(f)||f.length===0)return console.warn(`${t}: Warning: No config found for '${c}'`),console.log("所有模型用尽 (配置中未找到有效优先级列表)"),this.terminate_flag=!0,!1;const u=f.filter(d=>typeof(d==null?void 0:d.priority)=="number"&&Number.isInteger(d.priority));if(u.length===0)return console.warn(`${t}: Warning: No models with valid integer priorities in '${c}'`),console.log("所有模型用尽 (配置中未找到带有效优先级的模型)"),this.terminate_flag=!0,!1;if(this.all_priorities=[...new Set(u.map(d=>d.priority))].sort((d,h)=>h-d),console.log(`${t}:     Priorities initialized: [${this.all_priorities.join(", ")}]. Current index remains ${this.current_priority_index}.`),this.current_priority_index>=this.all_priorities.length)return console.log(`${t}:     Initial index ${this.current_priority_index} is >= total priorities ${this.all_priorities.length}.`),console.log("所有模型用尽 (初始索引已超出范围)"),this.terminate_flag=!0,!1}for(console.log(`${t}:     Starting priority loop. Index: ${this.current_priority_index}, Total Priorities: ${this.all_priorities.length}`);this.current_priority_index<this.all_priorities.length;){const c=this.current_priority_index,f=this.all_priorities[c];console.log(`${t}:     Checking index ${c}, Priority: ${f}...`);const d=(((r=(o=this.config)==null?void 0:o.AI_draw)==null?void 0:r[`${this.kind}_config`])||[]).filter(g=>(g==null?void 0:g.priority)===f);if(d.length===0){console.log(`${t}:     No models configured for priority ${f}. Incrementing index.`),this.current_priority_index++,console.log(`${t}:     Index is now ${this.current_priority_index}. Continuing loop.`);continue}console.log(`${t}:     Found ${d.length} config(s) for priority ${f}. Validating...`);const h=[];for(const g of d){const m=g==null?void 0:g.config;if(!m)continue;if(!((a=(i=this.main_manager_ref)==null?void 0:i._global_model_usage)==null?void 0:a[m])){console.warn(`${t}: Model '${m}' (prio ${f}) not in global configs. Skipping.`);continue}const p=typeof g.weigh=="number"?g.weigh:1;h.push({name:m,weigh:p,priority:f})}if(h.length>0)return this.models=h,console.log(`${t}:     Successfully loaded ${this.models.length} models for priority ${f} at index ${c}.`),console.log(`${t}:     Exiting load_models_by_highest_priority with TRUE.`),!0;console.log(`${t}:     No VALID models found for priority ${f} after checks. Incrementing index.`),this.models=[],this.current_priority_index++,console.log(`${t}:     Index is now ${this.current_priority_index}. Continuing loop.`)}return console.log(`${t}:     Loop finished. Index (${this.current_priority_index}) is >= Total Priorities (${this.all_priorities.length}).`),console.log("所有模型用尽"),this.models=[],this.terminate_flag=!0,console.log(`${t}:     Exiting load_models_by_highest_priority with FALSE.`),!1})}catch(s){return console.error(`${t}: !!! ERROR within load_models_by_highest_priority or its lock acquisition !!!`,s),this.terminate_flag=!0,!1}finally{console.log(`${t}: <-- Finished attempt to run/acquire lock for load_models_by_highest_priority. Index: ${this.current_priority_index}. Terminated: ${this.terminate_flag}.`)}}get_current_priority_value(){return this.all_priorities&&this.current_priority_index>=0&&this.current_priority_index<this.all_priorities.length?this.all_priorities[this.current_priority_index]:null}async get_model(){if(this.is_sub_manager)return console.error("ERROR: Sub-manager called get_model."),null;const t="MainMgr";for(;!this.terminate_flag;){let s=null,n=!1,o=!1;if(await this.lock.withLock(async()=>{if(this.terminate_flag)return;if(this.models.length===0){o=!0,console.log(`${t}: Models list empty for current priority index ${this.current_priority_index}. Flagging for load check.`);return}const r=[];if(await this._global_lock.withLock(()=>{if(!this.terminate_flag)for(const c of this.models){const f=this._global_model_usage[c.name];f&&f.current<f.max&&r.push(c)}}),r.length===0){s=null;return}const i=r.map(c=>c.weigh),a=Yf(r,i,1);a&&a.length>0?s=a[0]:r.length>0?(console.warn(`${t}: Weighted choice failed, using random.`),s=r[Math.floor(Math.random()*r.length)]):s=null}),this.terminate_flag){console.log(`${t}: Terminate flag checked after lock release. Exiting get_model.`);break}if(o){console.log(`${t}: needsLoadCheck is true. Incrementing index and calling load_models...`),this.current_priority_index++;let r=!1;try{console.log(`${t}: Calling await load_models_by_highest_priority() (Index is now ${this.current_priority_index})...`),r=await this.load_models_by_highest_priority(),console.log(`${t}: await load_models_by_highest_priority() returned: ${r}`)}catch(i){console.error(`${t}: ERROR during await load_models_by_highest_priority():`,i),this.terminate_flag=!0,r=!1}console.log(`${t}: Load attempt finished. Continuing get_model loop. Terminated: ${this.terminate_flag}`);continue}if(s){const r=s.name;if(await this._global_lock.withLock(()=>{if(this.terminate_flag)return;const i=this._global_model_usage[r];i&&i.current<i.max?(i.current++,n=!0,console.log(`${t}: Acquired Global Lock for: ${r} (Usage: ${i.current}/${i.max})`)):(console.warn(`${t}: Failed acquire global lock for ${r} (race?). Retrying.`),n=!1)}),this.terminate_flag){n&&(console.warn(`${t}: Releasing ${r} immediately due to termination after acquire.`),await this._global_lock.withLock(()=>{const i=this._global_model_usage[r];i&&i.current>0?i.current--:console.warn(`${t}: Usage count was already 0 when trying to release ${r} during termination.`)}),n=!1),console.log(`${t}: Terminate flag checked after global lock attempt. Exiting get_model.`);break}if(n)return console.log(`${t}: Returning acquired model: ${r}`),{...s};if(this.terminate_flag)break;await We(100+Math.random()*100),console.log(`${t}: Global acquire failed for ${r}. Continuing get_model loop.`);continue}if(!s&&!o){if(console.log(`${t}: No model selected (all busy globally?). Waiting... Terminated: ${this.terminate_flag}`),this.terminate_flag)break;await We(500);continue}console.warn(`${t}: Reached end of get_model loop unexpectedly. Breaking.`);break}return console.log(`${t}: Exiting get_model function because terminate_flag is set.`),null}async release_model(t,s){if(this.is_sub_manager){console.error("ERROR: Sub-manager called release_model. Use release_split_task_model.");return}await this._global_lock.withLock(()=>{const n=this._global_model_usage[t];n&&(n.current>0?(n.current--,console.log(`Main Manager Released: ${t} (Global Usage: ${n.current}/${n.max})`)):console.warn(`WARN: Attempted to release ${t} globally, but current usage was already 0.`))}),s==="retry_over_times"&&await this.lock.withLock(()=>{const n=this.models.length;if(this.models=this.models.filter(o=>o.name===t?(console.log(`Main Manager: Model ${t} removed from priority ${o.priority} due to exceeding retry limits.`),!1):!0),n===this.models.length&&console.warn(`Warning: Main Manager tried to remove ${t} on failure, but it wasn't found in current priority list (maybe already removed or priority changed).`),this.models.length===0&&!this.terminate_flag){const o=this.get_current_priority_value();o!==null&&console.log(`Main Manager: All models from priority ${o} exhausted or removed. Will load next on next get_model().`)}})}async can_split_task_use_model(t,s){if(!this.main_manager_ref)return console.error("ERROR: Main manager reference not set in can_split_task_use_model."),!1;let n=null,o=null,r=!1;await this.main_manager_ref.lock.withLock(()=>{n=this.main_manager_ref.models.find(a=>a.name===t),o=this.main_manager_ref.get_current_priority_value()});let i=!1;return n?i=!0:o===null||s===null?(console.log(`Split Check Denied: Cannot compare priorities (None) for ${t}.`),i=!1):s<o?(console.log(`Split Check Info: Priority check passed for ${t} (SubPrio ${s} < MainPrio ${o}). Checking global concurrency...`),i=!0):(console.log(`Split Check Denied: Priority condition unmet for ${t} (SubPrio ${s} >= MainPrio ${o}, not in main list).`),i=!1),i&&await this.main_manager_ref._global_lock.withLock(()=>{const a=this.main_manager_ref._global_model_usage[t];a&&a.current<a.max?(a.current++,console.log(`Split Task Acquired: ${t} (Global Usage: ${a.current}/${a.max})`),r=!0):(console.log(a?`Split Check Denied: Global concurrency full for ${t} (${a.current}/${a.max}).`:`Split Check Denied: Model ${t} not found in global usage tracker.`),r=!1)}),r}async release_split_task_model(t){this.main_manager_ref&&await this.main_manager_ref._global_lock.withLock(()=>{const s=this.main_manager_ref._global_model_usage[t];s&&(s.current>0?(s.current--,console.log(`Split Task Released: ${t} (Global Usage: ${s.current}/${s.max})`)):console.warn(`WARN: Split task attempted to release ${t} globally, but usage was already 0.`))})}async remove_current_priority_models(t=""){await this.lock.withLock(async()=>{const s=this.get_current_priority_value();if(s!==null){const n=this.is_sub_manager?"Sub-Manager":"Main Manager";console.log(`${n}: Removing all models for its priority ${s}. Reason: ${t}`),this.models=[],console.log(`${n}: Attempting to load its next priority...`),this.current_priority_index++,await this.load_models_by_highest_priority()}else{const n=this.is_sub_manager?"Sub-Manager":"Main Manager";console.log(`${n}: Cannot remove models, no valid current priority.`)}})}async copy(t){let s=null;return await this.lock.withLock(async()=>{console.debug(`DEBUG: Copying ModelManager state (current priority index: ${this.current_priority_index}) for sub-task`),s=new na(this.config,this.kind,1,t,!0),s.all_priorities=this.all_priorities?[...this.all_priorities]:null,s.models=this.models.map(n=>({...n})),s.current_priority_index=this.current_priority_index,s.terminate_flag=this.terminate_flag,await s.initialize(),console.debug(`DEBUG: Copied Sub-Manager created. Models: ${s.models.map(n=>n.name)}, Priority Index: ${s.current_priority_index}, Terminated: ${s.terminate_flag}`)}),s}}function Fw(e,t){var O,E;const s=(E=(O=e==null?void 0:e.AI_draw)==null?void 0:O.configs)==null?void 0:E[t];if(!s)return console.error(`Error: Configuration for model '${t}' not found.`),["","GET",{},"","","","","","",!1,"","GET",{},"","","","","","",30,15];const n=s.request_url||"",o=s.request_method||"GET",r=Gl(s.headers||[]),i=s.request_body||"",a=s.json_path||"",c=s.success_condition||"",f=s.fail_condition||"",u=s.forbid_condition||"",d=s.userdefine||"",h=s.second_request||!1,g=s.second_request_url||"",m=s.second_request_method||"GET",y=Gl(s.second_headers||[]),p=s.second_request_body||"",b=s.second_json_path||"",w=s.second_success_condition||"",v=s.second_fail_condition||"",k=s.second_forbid_condition||"",$=s.second_userdefine||"";let I=3e4;try{const N=s.request_timeout;if(N&&String(N).trim()){const W=parseInt(String(N).trim(),10);isNaN(W)||(I=W*1e3)}}catch{}let R=15e3;try{const N=s.second_request_timeout;if(N&&String(N).trim()){const W=parseInt(String(N).trim(),10);isNaN(W)||(R=W*1e3)}}catch{}return[n,o,r,i,a,c,f,u,d,h,g,m,y,p,b,w,v,k,$,I,R]}async function Qt(e,t){try{let s=t;return t instanceof Uint8Array&&(s=new Blob([t]),console.debug("Converted Uint8Array to Blob for writing.")),await xe(e,s),!0}catch(s){return console.error(`Error writing file ${e}:`,s),!1}}async function Wl(e,t,s=fetch){try{const n=await s(t,{method:"GET"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const o=await n.blob();return await Qt(e,o)}catch(n){return console.error(`Error downloading file from ${t} to ${e}:`,n),!1}}async function ra(e,t,s,n,o){var Z,le,Te,_;const r=String(pr(1,1e8)),i=Fw(e,o);if(!i[0])return"error";const[a,c,f,u,d,h,g,m,y,p,b,w,v,k,$,I,R,O,E,N,W]=i,M=(le=(Z=e==null?void 0:e.AI_draw)==null?void 0:Z.configs)==null?void 0:le[o],G=(M==null?void 0:M.use_cors)===!0?Ci:fetch,pe=`${t}/${n}.png`,$e="{prompt}",ye="{random}",X="{result}",Ee=a.replace($e,encodeURIComponent(s)).replace(ye,r);let se,ke={...f};if(typeof u=="string")se=u.replace($e,s).replace(ye,r);else if(typeof u=="object"&&u!==null){const C=x=>{const P={};for(const L in x)typeof x[L]=="string"?P[L]=x[L].replace($e,s).replace(ye,r):typeof x[L]=="object"&&x[L]!==null?P[L]=C(x[L]):P[L]=x[L];return P};se=C(u),(Te=f["Content-Type"])!=null&&Te.toLowerCase().includes("application/json")?se=JSON.stringify(se):(console.warn("Handling non-JSON object body - ensure config format is correct."),se=JSON.stringify(se).replace($e,s).replace(ye,r))}else se="";let V=null,B=null,oe="",re=null,ae=null;const A=new AbortController,Y=setTimeout(()=>A.abort(),N);try{console.debug(`DEBUG: Request 1 for ${n} (${o}) - ${c} ${Ee}`),V=await G(Ee,{method:c,headers:ke,body:c==="POST"||c==="PUT"||c==="PATCH"?se:void 0,signal:A.signal}),clearTimeout(Y),B=V.status;try{oe=await V.clone().text()}catch(ne){console.warn("Could not read response 1 body as text:",ne)}if(oe)try{ae=JSON.parse(oe)}catch{console.debug("Response 1 text is not valid JSON."),ae=null}if(!V.ok){if(console.error(`Req1 HTTP Error: ${B} ${V.statusText}`),Rt(g,{status:B},ae)===!0)return console.log(`Req1 FailCond met after HTTP error: ${g}`),"error";const de=Rt(m,{status:B},ae);return m&&de===!0?(console.log("Req1 ForbidCond met after HTTP error."),"forbid"):"error"}if(Rt(g,{status:B},ae)===!0)return console.log(`Req1 FailCond met: ${g}`),"error";const x=Rt(m,{status:B},ae);if(m&&x===!0)return console.log("Req1 ForbidCond met."),"forbid";let P=null,L=!1;d&&(d.toLowerCase()==="response.text"||d.toLowerCase()==="text"?P=oe:d.toLowerCase()==="response.content"||d.toLowerCase()==="content"?L=!0:P=Vn(ae,d));const D=y&&y.includes("(content)");if((L||D)&&V&&V.bodyUsed===!1)try{console.debug("Reading response 1 body as blob..."),re=await V.blob(),L&&(P=re)}catch(ne){if(console.error("Could not read response 1 as blob:",ne),L||D)return"error";re=null}else if((L||D)&&V&&V.bodyUsed===!0&&(console.warn("Cannot read response 1 as blob: body already used (likely by prior .text() or failed clone?)"),L||D))return"error";let H=null;if(y&&y.trim()){if(console.debug(`Processing userdefine1: ${y}`),H=await Jl(y,B,oe,re,ae,P),H==="error")return console.error(`Error processing userdefine1 '${y}'. Task failed.`),"error";if(p)console.debug("Using userdefine1 output as intermediate result for request 2."),P=H;else return console.debug("Saving output from userdefine1 (no second request)."),H instanceof Uint8Array||H instanceof Blob?await Qt(pe,H)?"success":(console.error("Write userdefine1 blob output error"),"error"):typeof H=="string"||typeof H=="object"?await Qt(pe,H)?"success":(console.error("Write userdefine1 string/object output error"),"error"):(console.error("Error: userdefine1 output was not Blob/Uint8Array/String/Object."),"error")}else if(!p){if(h){const ne=Rt(h,{status:B},ae);if(ne!==!0)return console.log(`Req1 SuccCond Fail or non-true: ${h}. Evaluation: ${ne}`),"error"}return P==null?(console.error(`Error: Path1 '${d}' failed or result is null/undefined. Cannot get image data/URL.`),"error"):typeof P=="string"&&(P.startsWith("http://")||P.startsWith("https://"))?await Wl(pe,P,G)?"success":(console.error("Download fail (Req1)"),"error"):P instanceof Blob||P instanceof ArrayBuffer||P instanceof Uint8Array?await Qt(pe,P)?"success":(console.error("Write intermediate data error (Req1)"),"error"):(console.error(`Error: Path1 '${d}' result is not a valid URL or binary data. Result:`,P),"error")}if(p&&P==null)return console.error(`Error evaluating intermediate path '${d}' or userdefine1 result for Request 2.`),"error";const K=String(P??""),Q=b.replace(X,encodeURIComponent(K));let j,me={...v};if(typeof k=="string")j=k.replace(X,K);else if(typeof k=="object"&&k!==null){const ne=de=>{const _e={};for(const be in de)typeof de[be]=="string"?_e[be]=de[be].replace(X,K):typeof de[be]=="object"&&de[be]!==null?_e[be]=ne(de[be]):_e[be]=de[be];return _e};j=ne(k),(_=v["Content-Type"])!=null&&_.toLowerCase().includes("application/json")||console.warn("Handling non-JSON object body for Req2 - ensure config format."),j=JSON.stringify(j)}else j="";const ee=60,fe=1e3;for(let ne=0;ne<ee;ne++){let de=null,_e=null,be="",Ge=null,Fe=null;const dt=new AbortController,gt=setTimeout(()=>dt.abort(),W);try{de=await G(Q,{method:w,headers:me,body:w==="POST"||w==="PUT"||w==="PATCH"?j:void 0,signal:dt.signal}),clearTimeout(gt),_e=de.status;try{be=await de.clone().text()}catch(Ze){console.warn("Could not read response 2 body as text:",Ze)}if(be)try{Fe=JSON.parse(be)}catch{Fe=null}if(!de.ok){if(console.error(`Req2 HTTP Error: ${_e} ${de.statusText}`),Rt(R,{status:_e},Fe)===!0)return console.log(`Req2 FailCond met after HTTP error: ${R}`),"error";const od=Rt(O,{status:_e},Fe);if(O&&od===!0)return console.log("Req2 ForbidCond met after HTTP error."),"forbid";if(ne===ee-1)return"error";await We(fe);continue}if(Rt(R,{status:_e},Fe)===!0)return console.log(`Req2 FailCond met: ${R}`),"error";const ln=Rt(O,{status:_e},Fe);if(O&&ln===!0)return console.log("Req2 ForbidCond met."),"forbid";let Pe=null,Qe=!1;$&&($.toLowerCase()==="response.text"||$.toLowerCase()==="text"?Pe=be:$.toLowerCase()==="response.content"||$.toLowerCase()==="content"?Qe=!0:Pe=Vn(Fe,$));const Ps=E&&E.includes("(content)");if((Qe||Ps)&&de&&!de.bodyUsed)try{console.debug("Reading response 2 body as blob..."),Ge=await de.blob(),Qe&&(Pe=Ge)}catch(Ze){if(console.error("Could not read response 2 as blob:",Ze),Qe||Ps)return"error";Ge=null}else if((Qe||Ps)&&de&&de.bodyUsed&&(console.warn("Cannot read response 2 as blob: body already used."),Qe||Ps))return"error";if(E&&E.trim()){console.debug(`Processing second_userdefine: ${E}`);const Ze=await Jl(E,_e,be,Ge,Fe,Pe);return Ze==="error"?(console.error(`Error processing second_userdefine '${E}'. Task failed.`),"error"):(console.debug("Saving output from second_userdefine."),Ze instanceof Uint8Array||Ze instanceof Blob?await Qt(pe,Ze)?"success":(console.error("Write second_userdefine blob output err"),"error"):typeof Ze=="string"||typeof Ze=="object"?await Qt(pe,Ze)?"success":(console.error("Write second_userdefine string/object output err"),"error"):(console.error("Error: second_userdefine output was not Blob/Uint8Array/String/Object."),"error"))}else if(I){const Ze=Rt(I,{status:_e},Fe);if(Ze===!0)return Pe==null?(console.error(`Error: Path2 '${$}' failed or result is null/undefined after success condition met.`),"error"):typeof Pe=="string"&&(Pe.startsWith("http://")||Pe.startsWith("https://"))?await Wl(pe,Pe,G)?"success":(console.error("Download fail (Req2)"),"error"):Pe instanceof Blob||Pe instanceof ArrayBuffer||Pe instanceof Uint8Array?await Qt(pe,Pe)?"success":(console.error("Write intermediate data error (Req2)"),"error"):(console.error(`Error: Path2 '${$}' result is not a valid URL or binary data after success condition. Result:`,Pe),"error");console.debug(`Req2 SuccessCond not met or false (${Ze}), continuing poll attempt ${ne+1}...`)}else console.debug(`Req2 No success condition, continuing poll attempt ${ne+1}...`);await We(fe)}catch(Gt){if(clearTimeout(gt),Gt.name==="AbortError"){if(console.warn(`Req2 timed out on attempt ${ne+1}.`),ne===ee-1)return console.error("Req2 timed out on final attempt."),"error"}else return console.error(`Req2 Error on attempt ${ne+1}:`,Gt),"error";await We(fe);continue}}return console.error(`Error: Req2 polling failed after ${ee} attempts.`),"error"}catch(C){return clearTimeout(Y),C.name==="AbortError"?console.error("Req1 timed out."):console.error("Req1 Unexpected Error:",C),"error"}}async function Vw(e,t,s,n,o){var p,b,w,v;if(n!=="character")return"pass";const r=(p=e==null?void 0:e.剧情)==null?void 0:p.story_title,i=`/read/${encodeURIComponent(r)}/images/${encodeURIComponent(s)}.png`,a=`${t}/${s}.png`;try{const k=await Cs(a);if(!k.exists||k.isFolder)return console.error(`Error: Cannot rembg ${s}, source file not found or is directory at ${a}.`),"error"}catch(k){return console.error(`Error checking metadata for rembg target ${a}:`,k),"error"}const c=((b=e==null?void 0:e.AI_draw)==null?void 0:b.processing_config)||{};if(!((((v=(w=e==null?void 0:e.AI_draw)==null?void 0:w.configs)==null?void 0:v[o])||{}).use_rembg??c.use_rembg??!1))return"pass";const h=`/rembg-model/${c.rembg_model||"isnet-anime"}.onnx`,g=c.rembg_resolution||1024,m=c.rembg_debug||!1,y=(c.rembg_timeout||60)*1e3;return new Promise((k,$)=>{const I=new Worker(new URL("/assets/rembg.worker-DBta2Cxm.js",import.meta.url),{type:"module"});let R=null;const O=Date.now()+Math.random();console.debug(`[Main] Creating worker for rembg job ${O} (${s})`),R=setTimeout(()=>{console.error(`[Main] Rembg job ${O} (${s}) timed out after ${y/1e3}s. Terminating worker.`),I.terminate(),$(new Error("Rembg operation timed out"))},y),I.onmessage=async N=>{var M;const W=N.data;if(W.id===O){if(W.status==="ready"){console.debug(`[Main] Worker for job ${O} reported ready.`);return}if(clearTimeout(R),W.status==="success"&&W.blob){console.log(`[Main] Rembg job ${O} (${s}) successful. Writing result.`);try{await Qt(a,W.blob)?(console.log(`[Main] Successfully wrote rembg result for ${s}.`),k("success")):(console.error(`[Main] Failed to write rembg result for ${s} back to IndexedDB.`),k("error"))}catch(z){console.error(`[Main] Error writing rembg result for ${s}:`,z),k("error")}finally{I.terminate()}}else W.status==="error"?(console.error(`[Main] Rembg job ${O} (${s}) failed in worker:`,((M=W.error)==null?void 0:M.message)||"Unknown worker error"),k("error"),I.terminate()):(console.warn(`[Main] Received unknown message status from worker for job ${O}:`,W),k("error"),I.terminate())}},I.onerror=N=>{clearTimeout(R),console.error(`[Main] Error in rembg worker for job ${O} (${s}):`,N.message,N),$(new Error(`Worker error: ${N.message}`)),I.terminate()};const E={debug:m,model:h,resolution:g};console.debug(`[Main] Sending job ${O} to worker for ${s}`),I.postMessage({id:O,imageReadUrl:i,options:E,timeout:y})})}async function Uw(e,t,s,n){var m;const o=`${t}/${s}.png`;let r=null;try{if(r=await Je(o),!r||!(r instanceof Blob))return console.warn(`Quality check skipped: Could not read valid image data for ${s} from ${o}`),!1}catch(y){return console.warn(`Quality check skipped: Error reading ${o}:`,y),!1}const i=((m=e==null?void 0:e.AI_draw)==null?void 0:m.judging_config)||{};if(!i[`${n}_quality_judgment`])return!0;console.debug(`Performing quality judgment for ${s} (${n})...`);const a=i.selected_method||"a",u=((i.methods||{})[a]||{})[`${n}_quality_threshold`]||"10",d=(i.judgment_timeout||60)*1e3;let h=10;try{const y=parseFloat(u);isNaN(y)?console.warn(`Invalid quality threshold '${u}' for ${n}, using default 10.`):h=y}catch{}let g;switch(a){case"a":g=Wf;break;case"b":g=Hf;break;case"c":g=Kf;break;default:return console.error(`Error: Unknown quality judgment method '${a}'. Skipping check.`),!0}try{const y=g(r,"a","a","a"),p=new Promise((w,v)=>setTimeout(()=>v(new Error(`Quality judgment timed out after ${d/1e3}s`)),d)),b=await Promise.race([y,p]);return typeof b!="number"||isNaN(b)?(console.error(`Error: Quality judgment for ${s} returned non-numeric score: ${b}`),!1):(console.debug(`Quality score for ${s} (${n}, method ${a}): ${b}`),b<h?(console.log(`Quality Check Failed: ${s} (${n}) score ${b} is below threshold ${h}.`),!1):(console.debug(`Quality check passed for ${s}.`),!0))}catch(y){return console.error(`Error during quality judgment for ${s}:`,y),!1}}async function jw(e,t,s,n){var b,w,v,k,$;const o=((b=e==null?void 0:e.AI_draw)==null?void 0:b.processing_config)||{},r=o[`${n}_resize`];if(!o[`${n}_resolution`]||!r)return!0;const a=`${t}/${s}.png`;let c=null;try{if(c=await Je(a),!c||!(c instanceof Blob))return console.warn(`Resize skipped: Could not read valid image data for ${s} from ${a}`),!1}catch(I){return console.warn(`Resize skipped: Error reading ${a}:`,I),!1}let f,u;const d=parseInt(((v=(w=e==null?void 0:e.AI_draw)==null?void 0:w.processing_config)==null?void 0:v.character_width)||"768",10),h=parseInt((($=(k=e==null?void 0:e.AI_draw)==null?void 0:k.processing_config)==null?void 0:$.character_height)||"1024",10);n==="background"?(f=1920,u=1080):!isNaN(d)&&!isNaN(h)&&h>0?(u=h,f=d):(f=1024,u=1024);const p={裁剪:"crop",填充:"pad",拉伸:"stretch"}[r]||r;console.debug(`Resizing ${s} (${n}) to ${f}x${u} using strategy: ${p}`);try{const I=await Qf(c,f,u,p);return!I||!(I instanceof Blob)?(console.error(`Resizing function did not return a valid Blob for ${s}.`),!1):await Qt(a,I)?(console.debug(`Resize successful for ${s}.`),!0):(console.error(`Failed to write resized image back to ${a}.`),!1)}catch(I){return console.error(`Error during resize step for ${s}:`,I),!1}}async function Xf(e,t,s,n,o,r,i=!0){var h,g;const a=((g=(h=e==null?void 0:e.AI_draw)==null?void 0:h.configs)==null?void 0:g[o])||{},c=parseInt(String(a.max_attempts||1),10)||1,f=(parseInt(String(a.delay_time||1),10)||1)*1e3;let u=0,d=s;for(let m=0;m<c;m++){console.log(`Attempt ${m+1}/${c} for ${n} using model ${o}...`);let y=await ra(e,t,d,n,o);if(y==="success"){let p=!0;if(p&&r==="character"&&await Vw(e,t,n,r,o)==="error"&&(console.log(`rembg failed for ${n} on attempt ${m+1}. Treating as generation failure.`),y="rembg_error",p=!1),p&&(await Uw(e,t,n,r)||(u++,u>=2?(y="cheak_error",console.log(`${n} failed quality check twice. Final status: cheak_error`)):(y="error",console.log(`${n} failed quality check on attempt ${m+1}. Retrying if possible.`)),p=!1)),p&&(await jw(e,t,n,r)||console.warn(`Resizing failed or skipped for ${n}, but generation considered successful.`)),p)return console.log(`${n} successfully generated and processed with model ${o}.`),"success"}if(y!=="success"){if(console.log(`Failed attempt ${m+1}/${c} for ${n} with model ${o}. Status: ${y}`),i&&await Rw(y)===1){console.debug(`DEBUG: func1JS returned 1 for ${n}. Calling func2JS...`);const b=await Dw(s,n,o,m,r);return b!=="error"?(console.debug(`DEBUG: func2JS provided new prompt for ${n}. Triggering split.`),["split",b]):(console.warn(`DEBUG: func2JS returned 'error' for ${n}. Triggering split with ORIGINAL prompt.`),["split",s])}m<c-1&&(console.log(`Waiting ${f/1e3}s before next attempt...`),await We(f))}}return console.log(`All ${c} attempts failed for ${n} with model ${o}.`),"failed_model"}async function zw(e,t,s,n,o,r,i,a,c,f){const u=`SplitWorker-${r}`;console.log(`--- ${u}: Started ---`);const d=o;let h=!1,g=!1,m=null;try{if(f.cancelled)throw console.log(`${u}: Cancelled before starting.`),new Error("Cancelled");for(;!s.terminate_flag&&!h&&!f.cancelled;){if(g=!1,m=null,f.cancelled){console.log(`${u}: Cancellation active during model acquisition loop. Breaking inner loop.`);break}let y=null;if(console.log(`${u}: Attempting to get candidate model from sub-manager (Index: ${s.current_priority_index}, Terminated: ${s.terminate_flag})...`),await s.lock.withLock(async()=>{if(f.cancelled)return;if(s.models.length===0){f.cancelled||(console.log(`${u}: Sub-Manager models list empty. Attempting to load next priority...`),s.current_priority_index++,await s.load_models_by_highest_priority()?console.log(`${u}: Sub-Manager loaded next priority.`):console.log(`${u}: Sub-Manager load_models indicated termination.`));return}const v=s.models,k=v.map(I=>I.weigh),$=Yf(v,k,1);$&&$.length>0?y=$[0]:v.length>0?(console.warn(`${u}: Sub-Manager weighted choice failed, using random.`),y=v[Math.floor(Math.random()*v.length)]):y=null,console.log(`${u}: Sub-Manager selected candidate: ${y?y.name:"null"}`)},`${u}-subMgrLock-getCandidate`),!y){if(s.terminate_flag){console.log(`${u}: Sub-manager terminated. Exiting loop.`);break}if(f.cancelled){console.log(`${u}: Cancellation active after candidate selection. Exiting loop.`);break}console.log(`${u}: Could not select candidate model. Waiting and retrying.`),await We(100);continue}const p=y.name;m=p;const b=s.get_current_priority_value();if(f.cancelled){console.log(`${u}: Cancellation active before permission check for ${p}. Exiting loop.`);break}console.log(`${u}: Checking permission to use ${p} (SubPrio: ${b})...`);const w=await n.can_split_task_use_model(p,b);if(g=w,console.log(`${u}: Permission check result for ${p}: ${w}`),f.cancelled){console.log(`${u}: Cancellation active after permission check for ${p}. Exiting loop.`),g&&(console.warn(`${u}: Releasing global concurrency for ${p} acquired just before cancellation.`),await n.release_split_task_model(p).catch(v=>console.error(`${u}: Error releasing on cancel:`,v)),g=!1);break}if(w){console.log(`${u}: Granted use of ${p}. Processing.`);try{if(f.cancelled)throw console.log(`${u}: Cancellation active before generateImageTask with ${p}. Exiting loop.`),new Error("Cancelled");console.log(`${u}: Calling generateImageTask for ${r} with model ${p}...`);const v=await Xf(e,t,d,r,p,i,!1);if(console.log(`${u}: generateImageTask for ${r} returned status: ${v}`),f.cancelled){console.log(`${u}: Cancellation active after generateImageTask for ${r}. Exiting loop.`);break}g?(console.log(`${u}: Releasing global concurrency for ${p} after task completion.`),await n.release_split_task_model(p),g=!1):console.warn(`${u}: Did not acquire global concurrency but finished task? State mismatch.`),(v==="success"?"success":"retry_over_times")==="retry_over_times"?(console.log(`${u}: Model ${p} failed. Removing from sub-manager list.`),await s.lock.withLock(async()=>{s.models=s.models.filter($=>$.name!==p)},`${u}-subMgrLock-removeFailed`)):console.log(`${u}: Model ${p} successful for task. Not removing from sub-manager list.`),v==="success"?(await c.withLock(async()=>{a[r]!=="failed"?(a[r]="success",console.log(`${u}: Task ${r} status set to 'success' in split results.`)):console.warn(`${u}: Task ${r} was already marked 'failed' when successful status received.`)},`${u}-splitLock-setSuccess`),h=!0,console.log(`--- ${u} SUCCESS ---`)):console.log(`${u}: Model ${p} failed generation for ${r}. Trying next candidate.`)}catch(v){if(v.message!=="Cancelled"?console.error(`!!! Error during generateImageTask in ${u} for ${r} (${p}):`,v):console.log(`${u}: generateImageTask was cancelled for ${r}.`),g&&(console.warn(`${u}: Releasing global concurrency for ${p} due to error.`),await n.release_split_task_model(p),g=!1),f.cancelled){console.log(`${u}: Cancellation active during error handling. Breaking inner loop.`);break}console.log(`${u}: Error during task, not cancelled. Trying next model for ${r}.`);continue}}else{if(console.log(`${u}: Denied use of ${p}.`),f.cancelled){console.log(`${u}: Cancellation active during permission denial handling. Exiting loop.`);break}let v=!1,k=null;await n.lock.withLock(async()=>{k=n.get_current_priority_value(),v=n.models.some(R=>R.name===p)},`${u}-mainMgrLock-checkDenial`);let $=!0;const I=s.get_current_priority_value();if(!v&&I!==null&&k!==null&&(I>k?(console.log(`${u}: Instructing sub-manager to remove its prio ${I} (> main ${k}).`),$=!1,s.remove_current_priority_models(`Priority ${I} > Main Priority ${k}`).catch(R=>console.error(`${u}: Error removing prio models:`,R))):I===k&&(console.log(`${u}: Instructing sub-manager to remove model ${p} (== main prio, not in main list).`),$=!1,s.lock.withLock(async()=>{s.models=s.models.filter(R=>R.name!==p)},`${u}-subMgrLock-removeDeniedModel`).catch(R=>console.error(`${u}: Error removing single model:`,R)))),$){if(f.cancelled){console.log(`${u}: Cancellation active during wait after denial. Exiting loop.`);break}console.log(`${u}: Permission denied, waiting before retry.`),await We(500+Math.random()*200)}}}console.log(`${u}: Main while loop finished. Task successful: ${h}. SubMgr terminated: ${s.terminate_flag}. Cancelled: ${f.cancelled}.`)}catch(y){y.message!=="Cancelled"?console.error(`!!! Uncaught error in ${u} for ${r}:`,y):console.log(`${u}: Caught Cancellation Error.`),h=!1,g&&m&&(console.warn(`${u}: Releasing global concurrency for ${m} due to error.`),await n.release_split_task_model(m).catch(p=>console.error(`${u}: Error releasing on worker error:`,p)),g=!1)}finally{h||(await c.withLock(async()=>{a[r]!=="success"?(a[r]="failed",console.log(`${u}: Task ${r} status set to 'failed' in split results.`)):console.warn(`${u}: Task ${r} was already marked 'success' when finally block ran for non-successful exit.`)},`${u}-splitLock-setFinalStatus`),f.cancelled&&a[r]!=="success"?console.log(`--- ${u} CANCELLED ---`):s.terminate_flag&&a[r]!=="success"?console.log(`--- ${u} FAILED (Sub-manager exhausted) ---`):a[r]!=="success"&&console.log(`--- ${u} FAILED (Error/Unknown) ---`)),g&&m&&(console.warn(`${u}: Releasing potentially held global concurrency for ${m} in finally block.`),await n.release_split_task_model(m).catch(y=>console.error(`${u}: Error releasing on finally:`,y))),console.log(`--- ${u}: Async function execution finished. ---`)}}async function Bw(e,t,s,n,o,r,i,a,c,f,u,d,h){console.log(`Worker-${e}: Started`);const g=`Worker-${e}`;for(;;){if(h.cancelled){console.log(`${g}: Cancellation signal received. Exiting loop.`);break}let m=null,y=!1,p=null,b=null;try{if(await a.withLock(async()=>{o.length>0&&(m=o.shift(),b=m?m[1]:null)},`${g}-taskLock-get`),!m){if(h.cancelled){console.log(`${g}: Task queue empty. Cancellation active. Exiting loop.`);break}await We(500);continue}const[w,v]=m;b=v,console.log(`${g}: Picked up task ${v}`);let k=!1;if(!r.cover)try{const I=await Cs(`${s}/${v}.png`);I.exists&&!I.isFolder&&(k=!0)}catch(I){console.warn(`${g}: Error checking metadata for ${v}:`,I)}if(k){console.log(`${g}: Skipping ${v} - File exists.`),await a.withLock(async()=>{r[v]!=="success"&&r[v]!=="failed"&&r[v]!=="failed_cancelled"?r[v]="skipped":console.warn(`${g}: Skipping ${v}, but status was already '${r[v]}'.`)},`${g}-taskLock-skip`);continue}if(h.cancelled){console.log(`${g}: Cancellation signal received after picking task ${v}. Exiting loop.`),await a.withLock(async()=>{r[v]==="pending"&&(r[v]="failed_cancelled")},`${g}-taskLock-cancelPick`);break}let $=!1;for(;!$&&!n.terminate_flag&&!h.cancelled;){if(y=!1,p=null,h.cancelled){console.log(`${g}: Cancellation active during model acquisition loop for ${v}. Breaking inner loop.`);break}console.log(`${g}: Attempting to get model for ${v}...`);const I=await n.get_model();if(console.log(`${g}: get_model for ${v} returned: ${I?I.name:"null"}`),h.cancelled){console.log(`${g}: Cancellation active after get_model for ${v}. Breaking inner loop.`),I&&y&&(console.warn(`${g}: Releasing model ${I.name} acquired just before cancellation.`),await n.release_model(I.name,"error"),y=!1);break}if(I===null)if(n.terminate_flag)console.log(`${g}: Main model manager terminated while waiting for model for ${v}. Cannot process task.`),await a.withLock(async()=>{(r[v]==="pending"||r[v]==="split_pending")&&(r[v]="failed_no_models")},`${g}-taskLock-noModel`),$=!0;else{if(console.debug(`${g}: No model available for ${v}, but manager not terminated. Waiting.`),h.cancelled){console.log(`${g}: Cancellation active before sleep waiting for model for ${v}. Breaking inner loop.`);break}await We(500+Math.random()*200);continue}else{if(p=I.name,y=!0,h.cancelled){console.log(`${g}: Cancellation active after acquiring model ${p} for ${v}. Releasing and breaking inner loop.`),y&&(await n.release_model(p,"error"),y=!1);break}console.log(`${g}: Processing ${v} with acquired model ${p} (Priority ${I.priority})`);const R=!h.cancelled;console.log(`${g}: Calling generateImageTask for ${v} with ${p} (allowSplit: ${R})...`);const O=await Xf(t,s,w,v,p,i,R);if(console.log(`${g}: generateImageTask for ${v} returned status: ${Array.isArray(O)?O[0]:O}`),h.cancelled){console.log(`${g}: Cancellation active after generateImageTask for ${v}. Breaking inner loop.`),y&&(console.warn(`${g}: Releasing model ${p} in worker after generateImageTask due to cancellation.`),await n.release_model(p,"error").catch(E=>console.error(`${g}: Error releasing model on cancel:`,E)),y=!1);break}if(Array.isArray(O)&&O[0]==="split"){const E=O[1];console.log(`${g}: Task ${v} triggered split.`);let N=null;try{await d.withLock(async()=>{if(h.cancelled)throw console.log(`${g}: Cancellation active during split setup for ${v}. Aborting split creation.`),new Error("Cancelled during split setup");if(N=await n.copy(n),!N)throw new Error("Failed to copy ModelManager for split task.");c.push(N),console.log(`${g}: Created sub-manager for split task ${v}.`);const W=[t,s,N,n,E,v,i,f,d,h];u.push({imageName:v,args:W}),console.log(`${g}: Added split task ${v} to pending list.`),await a.withLock(async()=>{r[v]==="pending"?(r[v]="split_pending",console.debug(`${g}: Task ${v} status set to 'split_pending'.`)):console.warn(`${g}: Task ${v} status was already '${r[v]}' when trying to set 'split_pending'.`)},`${g}-taskLock-setSplitPending`)},`${g}-splitLock-splitSetup`),console.log(`${g}: Split setup complete for ${v}.`),console.log(`${g}: Releasing main concurrency for ${p} after splitting off ${v}.`),await n.release_model(p,"success"),y=!1,$=!0}catch(W){if(console.error(`${g}: Error initiating split for ${v}:`,W.message),y&&(console.warn(`${g}: Releasing model ${p} due to split initiation error.`),await n.release_model(p,"error"),y=!1),h.cancelled){console.log(`${g}: Split initiation failed due to cancellation. Breaking inner loop for ${v}.`);break}else{console.log(`${g}: Split initiation failed, not cancelled. Trying next model for ${v}.`);continue}}}else if(O==="success")console.log(`${g}: Task ${v} completed successfully with model ${p}.`),await n.release_model(p,"success"),y=!1,await a.withLock(async()=>{r[v]==="pending"||r[v]==="split_pending"?(r[v]="success",console.debug(`${g}: Task ${v} status set to 'success'.`)):console.warn(`${g}: Task ${v} status was already '${r[v]}' when trying to set 'success'.`)},`${g}-taskLock-setSuccess`),$=!0;else if(O==="failed_model")console.log(`${g}: Model ${p} failed permanently for ${v}. Trying next model.`),await n.release_model(p,"retry_over_times"),y=!1;else if(console.error(`${g}: Unexpected status "${O}" from generateImageTask for ${v}. Treating as model failure.`),await n.release_model(p,"error"),y=!1,h.cancelled){console.log(`${g}: Cancellation active after unexpected status for ${v}. Breaking inner loop.`);break}}n.terminate_flag&&console.log(`${g}: Inner loop breaking for ${v}: Main manager terminated.`),h.cancelled&&console.log(`${g}: Inner loop breaking for ${v}: Cancellation active.`)}if(h.cancelled){console.log(`${g}: Outer loop breaking for ${b} due to cancellation signal.`),await a.withLock(async()=>{r[b]==="pending"||r[b]==="split_pending"?(r[b]="failed_cancelled",console.debug(`${g}: Task ${b} status set to 'failed_cancelled' on outer loop exit.`)):console.warn(`${g}: Task ${b} had status '${r[b]}' when outer loop broke due to cancellation.`)},`${g}-taskLock-cancelOuter`);break}console.log(`${g}: Outer loop continuing to next task.`)}catch(w){if(console.error(`!!! ${g} error processing task ${b||"UNKNOWN"}:`,w),y&&p){console.warn(`${g}: Releasing held concurrency for ${p} due to error.`);try{await n.release_model(p,"error")}catch(v){console.error(`${g}: Error releasing model during error handling:`,v)}y=!1}if(b&&await a.withLock(async()=>{r[b]==="pending"||r[b]==="split_pending"?(r[b]="worker_error",console.debug(`${g}: Task ${b} status set to 'worker_error' on error.`)):console.warn(`${g}: Task ${b} had status '${r[b]}' when error occurred.`)},`${g}-taskLock-setError`),h.cancelled){console.log(`${g}: Cancellation active during error handling. Exiting loop.`);break}}finally{if(y&&p){console.warn(`${g}: Releasing potentially held concurrency for ${p} in finally block (Worker Exit).`);try{await n.release_model(p,"error")}catch(w){console.error(`${g}: Error releasing model in finally:`,w)}}}}console.log(`${g}: Async function execution finished.`)}function rn(){var e;try{const t=localStorage.getItem("aiGalgameConfig");return t?(Hs=JSON.parse(t),Us=((e=Hs==null?void 0:Hs.剧情)==null?void 0:e.story_title)||"",Sn=`${oa}/${Us}/images`,console.log("Config loaded successfully. Story:",Us),Hs):(console.error("Config not found in localStorage (key: aiGalgameConfig)."),null)}catch(t){return console.error("Error loading or parsing config from localStorage:",t),Hs=null,null}}async function Qo(e,t,s,n=0,o=console.log){var X,Ee;o("Loading configuration...");const r=rn();if(!r)return o("Error: Failed to load config."),{error:"Config load failed"};const i=s;s==="title"&&(s="background"),Us=((X=r==null?void 0:r.剧情)==null?void 0:X.story_title)||"",Sn=`${oa}/${Us}/images`,o(`Configuration loaded. Story: ${Us}. Preparing directories...`);try{await Lt(Sn),o("Directories ensured.")}catch(se){return o(`Error creating directories: ${se.message}`),console.error("Error creating directories:",se),{error:"Directory creation failed"}}const a={cover:!!n},c=new Un("TaskQueue"),f=[],u={},d=[],h=[],g=new Un("SplitManagement"),m={cancelled:!1};o("Requesting task list from GPT...");let y=null;const p=pr(1,1e5);let b=!1;for(let se=0;se<3;se++){if(m.cancelled)return o("Operation cancelled before GPT."),await st(p).catch(()=>{}),{error:"Operation cancelled"};try{const ke=await Ms(e,t,s,p);if(m.cancelled)return o("Operation cancelled during GPT."),await st(p).catch(()=>{}),{error:"Operation cancelled"};if(ke==="over_times"){o(`GPT attempt ${se+1} failed (internal retries).`),await We(1e3);continue}if(ke&&ke!=="error")if(y=Ow(ke),y!==null){await st(p),b=!0,o(`GPT returned ${y.length} initial tasks.`),console.log("Initial GPT Tasks:",y);break}else o(`GPT attempt ${se+1} parse failed.`),y=null,await We(1e3);else o(`GPT attempt ${se+1} failed.`),await We(1e3)}catch(ke){o(`GPT attempt ${se+1} error: ${ke.message}`),console.error(`GPT call failed on attempt ${se+1}:`,ke),await We(1e3)}}if(!b)return await st(p).catch(()=>{}),o("Error: Failed GPT task list."),{error:"GPT task list failed"};if(!y)return o("GPT response parsing failed. No tasks to process."),{success:[],failed:[],skipped:[]};if(m.cancelled)return o("Operation cancelled after GPT."),{error:"Operation cancelled"};const w=new Map;y.forEach(se=>w.set(se.name,se));const v=Array.from(w.values()),k=v.length;if(k===0)return o("GPT returned no unique tasks."),{success:[],failed:[],skipped:[]};o(`Processing ${k} unique tasks.`),o("Initializing main model manager...");const $=new na(r,s,k,null,!1);if(await $.initialize(),$.terminate_flag)return o("Error: Main model manager could not initialize any valid models."),{success:[],failed:v.map(ke=>ke.name),skipped:[]};f.push($);const I=[];o("Adding tasks to queue..."),v.forEach(se=>{I.push([se.prompt,se.name]),a[se.name]="pending"});const R=((Ee=r==null?void 0:r.AI_draw)==null?void 0:Ee.max_worker_threads)||5,O=Math.min(R,k);o(`Starting ${O} main workers...`);const E=[];for(let se=0;se<O;se++)E.push(Bw(se+1,r,Sn,$,I,a,s,c,f,u,d,g,m));o("Monitoring progress...");let N=Date.now(),W=!1;for(;;){let se=0,ke={};await c.withLock(()=>{se=I.length,ke={...a}});let V=0,B=0;await g.withLock(()=>{V=h.length,B=d.length});const oe=M(ke,u,m,v);if(!m.cancelled&&oe>=k&&B===0&&V===0){o(`${i} All ${k} tasks completed normally. Finishing up.`),console.log("Normal completion condition met."),W=!0;break}if(!m.cancelled&&$.terminate_flag&&(o(`${i} Main model manager exhausted. Signaling cancellation...`),console.log("Triggering cancellation due to main manager termination."),m.cancelled=!0,await We(100)),m.cancelled){W||(o("Cancellation signalled. Stopping monitoring loop."),console.log("Exiting monitoring loop due to active cancellation signal."));break}Date.now()-N>4e3&&(o(`${i} Progress: ${oe}/${k}. MainQ: ${se}. PendingSp: ${B}. ActiveSp: ${V}. MainMgrTerm: ${$.terminate_flag}. Cancelled: ${m.cancelled}.`),N=Date.now()),B>0&&!m.cancelled&&await g.withLock(async()=>{for(;d.length>0&&!m.cancelled;){const re=d.shift();if(console.log(`Starting split task worker for: ${re.imageName}`),Array.isArray(re.args)){re.args.includes(m)||re.args.push(m);const ae=zw(...re.args).finally(()=>{g.withLock(()=>{const A=h.indexOf(ae);A>-1&&h.splice(A,1)})});h.push(ae)}else console.error(`Split task args for ${re.imageName} not an array! Marking failed.`),await c.withLock(()=>{(a[re.imageName]==="pending"||a[re.imageName]==="split_pending")&&(a[re.imageName]="worker_error")})}}),await We(500)}m.cancelled?console.log("Monitoring loop finished, cancellation signal was already true."):(console.log("Monitoring loop finished. Setting cancellation signal true to ensure all workers/splits exit."),m.cancelled=!0);function M(se,ke,V,B){const oe=["success","skipped","worker_error","failed_no_models","failed","failed_cancelled"],re=new Set;for(const ae of Object.keys(ke))re.add(ae);for(const[ae,A]of Object.entries(se))ae!=="cover"&&(oe.includes(A)||V.cancelled&&(A==="pending"||A==="split_pending"))&&re.add(ae);return V.cancelled&&B.forEach(ae=>re.add(ae.name)),re.size}o(`Waiting for final operations... Cancelled: ${m.cancelled}`),console.log("Awaiting settlement of worker promises..."),await Promise.allSettled(E),console.log("Awaiting settlement of running split promises..."),await Promise.allSettled(h),console.log("All workers and splits have settled."),await We(100),o("Compiling final results...");const z={success:[],failed:[],skipped:[]},G=new Set;let pe={},$e={};await c.withLock(()=>{pe={...a}}),await g.withLock(()=>{$e={...u}});for(const[se,ke]of Object.entries($e))ke==="success"?G.has(se)||(z.success.push(se),G.add(se)):G.has(se)||(z.failed.push(se),G.add(se));for(const[se,ke]of Object.entries(pe))se==="cover"||G.has(se)||(ke==="success"?z.success.push(se):ke==="skipped"?z.skipped.push(se):(m.cancelled||ke!=="pending"&&ke!=="split_pending")&&z.failed.push(se),G.add(se));return new Set(v.map(se=>se.name)).forEach(se=>{G.has(se)||(console.warn(`Warning: Original task '${se}' was never resolved to a final status. Marking as failed.`),z.failed.push(se))}),z.success=[...new Set(z.success)],z.failed=[...new Set(z.failed)],z.skipped=[...new Set(z.skipped)],o(`Processing Complete. Cancelled: ${m.cancelled}`),console.log("--- Final Summary ---"),console.log(`Successful: ${z.success.length}`,z.success),console.log(`Failed: ${z.failed.length}`,z.failed),console.log(`Skipped: ${z.skipped.length}`,z.skipped),z}async function Hl(e=console.log){e("Starting: Get All Persons Images");const[t,s]=await ct("全部人物绘画");return await Qo(t,s,"character",!0,e)}async function Ik(e,t=console.log){var r;t(`Starting: Get Single Person Image for ${e}`);const s=rn();if(!s)return{error:"Config load failed"};const o=`/data/${((r=s==null?void 0:s.剧情)==null?void 0:r.story_title)||""}/character.json`;try{if(!e||e.length===0){t("Character name list is empty, returning.");return}t("Reading character data...");const i=await Je(o);if(!i)return{error:"Failed to read character data."};if(e.length===1){const d=e[0],h=i.find(p=>(p==null?void 0:p.name)===d);if(!h)return t(`Error: Character '${d}' not found in ${o}`),{error:`Character ${d} not found`};t("Processing prompt for single character...");const[g,m]=await ct("单个人物绘画"),y=JSON.stringify(h);return t(`Generating image for ${d}...`),await Qo(g,y,"character",!0,t)}let a=[];for(const d of e){const h=i.find(g=>(g==null?void 0:g.name)===d);if(!h)return t(`Error: Character '${d}' not found in ${o}`),{error:`Character ${d} not found`};a.push(h)}t("Processing prompt for multiple characters...");const[c,f]=await ct("单个人物绘画"),u=JSON.stringify(a);return t(`Generating image for multiple characters: ${e.join(", ")}...`),await Qo(c,u,"character",!0,t)}catch(i){return t(`Error processing character(s) ${e}: ${i.message}`),console.error(`Error in getSinglePersonImageJS for ${e}:`,i),{error:`Failed to process ${e}: ${i.message}`}}}async function jn(e=0,t=console.log){var r;t("Starting: Get Places Images");const s=rn();if(!s)return{error:"Config load failed"};const o=`/data/${((r=s==null?void 0:s.剧情)==null?void 0:r.story_title)||""}/story/place.json`;try{t("Reading places data...");let i=[];try{if(i=await Je(o),JSON.stringify(i)==="[]")return t("No places defined in place.json. Skipping background generation."),{success:[],failed:[],skipped:["No places defined"]}}catch{return t("place.json not found or unreadable. Skipping background generation."),console.log("place.json not found, skipping places generation."),{success:[],failed:[],skipped:["place.json not found"]}}t("Processing prompt for places...");const[a,c]=await ct("故事地点绘画");return t("Generating place images..."),await Qo(a,c,"background",e,t)}catch(i){return t(`Error processing places: ${i.message}`),console.error("Error in getPlacesImagesJS:",i),{error:`Failed to process places: ${i.message}`}}}async function qw(e=0,t=console.log){t("Starting: Get Places Images");try{t("Processing prompt for title image...");const[s,n]=await ct("首页背景生成");return t("Generating title images..."),await Qo(s,n,"title",e,t)}catch(s){return t(`Error processing places: ${s.message}`),console.error("Error in getTitleImagesJS:",s),{error:`Failed to process places: ${s.message}`}}}const Jw={name:"CharacterTabContent",data(){return{drawNonMainCharacter:!1,characterConfig:[],availableModels:[],characterStatus:"准备就绪"}},methods:{getConfigKeys(){try{const e=localStorage.getItem("aiGalgameConfig");if(!e)return[];const t=JSON.parse(e);return!t.AI_draw||!t.AI_draw.configs?[]:Object.keys(t.AI_draw.configs)}catch(e){return console.error("获取配置键名时出错:",e),[]}},loadCharacterConfig(){try{this.availableModels=this.getConfigKeys(),this.availableModels.length===0&&(this.availableModels=["默认模型"]);const e=localStorage.getItem("aiGalgameConfig");if(!e){this.initializeDefaultConfig();return}const t=JSON.parse(e);if(!t.AI_draw){this.initializeDefaultConfig();return}this.drawNonMainCharacter=t.AI_draw.draw_non_main_character||!1,this.characterConfig=t.AI_draw.character_config||[]}catch(e){console.error("加载人物配置时出错:",e),this.initializeDefaultConfig()}},initializeDefaultConfig(){const t={AI_draw:{draw_non_main_character:!1,character_config:[{config:this.availableModels.length>0?this.availableModels[0]:"默认模型",weigh:1,priority:1}]}};try{const s=localStorage.getItem("aiGalgameConfig"),n=s?JSON.parse(s):{};n.AI_draw=n.AI_draw||{},n.AI_draw.draw_non_main_character=t.AI_draw.draw_non_main_character,n.AI_draw.character_config=t.AI_draw.character_config,localStorage.setItem("aiGalgameConfig",JSON.stringify(n)),this.drawNonMainCharacter=t.AI_draw.draw_non_main_character,this.characterConfig=t.AI_draw.character_config}catch(s){console.error("初始化默认配置时出错:",s)}},saveCharacterSwitch(){try{const e=localStorage.getItem("aiGalgameConfig"),t=e?JSON.parse(e):{};t.AI_draw||(t.AI_draw={}),t.AI_draw.draw_non_main_character=this.drawNonMainCharacter,localStorage.setItem("aiGalgameConfig",JSON.stringify(t)),this.$emit("show-message",{title:"success",message:"开关已保存"})}catch(e){this.$emit("show-message",{title:"success",message:"保存开关状态出错"+e}),console.error("保存开关状态时出错:",e)}},saveCharacterConfig(){try{const e=this.characterConfig.filter(n=>n.config&&n.weigh&&/^\d+$/.test(n.weigh.toString()));if(e.length===0){this.$emit("show-message",{title:"warning",message:"至少需要一个有效的模型配置"});return}const t=localStorage.getItem("aiGalgameConfig"),s=t?JSON.parse(t):{};s.AI_draw||(s.AI_draw={}),s.AI_draw.character_config=e,localStorage.setItem("aiGalgameConfig",JSON.stringify(s)),this.characterStatus="配置已保存",setTimeout(()=>{this.characterStatus="准备就绪"},2e3),this.$emit("show-message",{title:"success",message:"人物配置已保存！"})}catch(e){console.error("保存人物配置时出错:",e)}},addConfigEntry(){const e=this.availableModels.length>0?this.availableModels[0]:"";this.characterConfig.push({config:e,weigh:1,priority:0}),this.characterStatus="已添加新模型配置",setTimeout(()=>{this.characterStatus="准备就绪"},2e3)},deleteConfigEntry(e){this.characterConfig.splice(e,1)},async testConfig(e){this.$emit("show-message",{title:"info",message:`开始测试模型: ${e}...`}),this.characterStatus=`正在测试模型: ${e}...`;try{const t=rn();if(!t){this.$emit("show-message",{title:"error",message:"测试失败: 无法加载配置."}),this.characterStatus="测试失败: 无法加载配置";return}const n="/data/test/images",o="(masterpiece), 1girl, micro bangs, widow's peak, black eyes, jungle, kimono skirt, cashmere, scenery, chibi, one eye closed, open mouth, smile, looking at viewer, sparkle, cute creature",i=`test_${e.replace(/[^a-zA-Z0-9_.-]/g,"_")}_${Date.now()}`;this.$emit("show-message",{title:"info",message:`使用模型 ${e} 生成测试图像: ${i}.png 到 ${n}`}),this.characterStatus=`正在生成测试图像 ${i}.png ...`;const a=await ra(t,n,o,i,e);a==="success"?(this.$emit("show-message",{title:"success",message:`模型 ${e} 测试成功! 图像已生成: ${n}/${i}.png`}),this.characterStatus=`模型 ${e} 测试成功!`):a==="forbid"?(this.$emit("show-message",{title:"warning",message:`模型 ${e} 测试被阻止 (Forbid). 可能触发了敏感词或特定规则.`}),this.characterStatus=`模型 ${e} 测试被阻止 (Forbid).`):(this.$emit("show-message",{title:"error",message:`模型 ${e} 测试失败. 返回状态: ${a}`}),this.characterStatus=`模型 ${e} 测试失败 (状态: ${a})`)}catch(t){console.error(`测试模型 ${e} 时发生错误:`,t),this.$emit("show-message",{title:"error",message:`测试模型 ${e} 时发生异常: ${t.message}`}),this.characterStatus=`测试模型 ${e} 时发生异常`}finally{setTimeout(()=>{this.characterStatus.startsWith(`模型 ${e} 测试`)&&(this.characterStatus="准备就绪")},5e3)}},showHelp(){this.$emit("show-message",{title:"success",message:"开启绘制非主要人物则会尝试为配角生成AI绘画提示词并生成图片。这会增加LLM模型和AI绘图消耗量。程序优先选择优先级最高的图像生成模型，并在同等优先级的模型中，根据预设的权重分配生成任务，权重高的模型承担更多任务。当高优先级模型达到并发上限或生成失败时，程序会动态调整任务分配，或自动切换到较低优先级的模型继续生成。"})},validatePositiveInt(e,t,s){const n=e.target.value;if(n==="")return;/^[1-9]\d*$/.test(n)?t[s]=parseInt(n):(e.target.value=t[s].toString().replace(/[^0-9]/g,"")||"1",t[s]=parseInt(e.target.value))},validateNaturalNumber(e,t,s){const n=e.target.value;if(n==="")return;/^(0|[1-9]\d*)$/.test(n)?t[s]=parseInt(n):(e.target.value=t[s].toString().replace(/[^0-9]/g,"")||"0",t[s]=parseInt(e.target.value))}},mounted(){this.loadCharacterConfig()}},Gw={class:"main-container"},Ww={class:"section-frame"},Hw={class:"switch-frame"},Kw={class:"toggle-container2"},Qw={class:"section-frame model-list-frame"},Yw={class:"toolbar-frame"},Xw={class:"left-buttons"},Zw={class:"right-buttons"},e4={class:"entries-container",ref:"entriesContainer"},t4={class:"model-col"},s4=["onUpdate:modelValue"],o4=["value"],n4={class:"weight-col"},r4=["onUpdate:modelValue","onInput"],i4={class:"priority-col"},a4=["onUpdate:modelValue","onInput"],l4={class:"action-col"},c4={class:"action-buttons"},u4=["onClick"],f4=["onClick"],d4={class:"status-frame"},g4={class:"status-label"};function h4(e,t,s,n,o,r){return S(),T("div",Gw,[t[14]||(t[14]=l("div",{class:"title-frame"},[l("h3",{class:"title-label"},"人物绘画模型配置"),l("span",{class:"subtitle-label"},"配置AI绘画人物图片生成模型")],-1)),t[15]||(t[15]=l("div",{class:"separator"},null,-1)),l("div",Ww,[t[9]||(t[9]=l("h4",{class:"section-title"},"基本设置",-1)),l("div",Hw,[t[6]||(t[6]=l("label",{class:"switch-label"},"绘制非主要人物:",-1)),l("div",Kw,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=i=>o.drawNonMainCharacter=i),class:"toggle",onChange:t[1]||(t[1]=(...i)=>r.saveCharacterSwitch&&r.saveCharacterSwitch(...i))},null,544),[[Ve,o.drawNonMainCharacter]]),t[5]||(t[5]=l("div",{class:"toggle-slider"},null,-1))]),t[7]||(t[7]=l("span",{class:"toggle-text"},"启用",-1)),t[8]||(t[8]=l("p",{class:"help-text"}," 启用此功能后，系统将为故事中的非主要人物也生成AI绘画。注意：这会增加LLM模型和AI绘图的使用量。 ",-1))])]),l("div",Qw,[t[11]||(t[11]=l("h4",{class:"section-title"},"模型配置列表",-1)),l("div",Yw,[l("div",Xw,[l("button",{class:"add-button",onClick:t[2]||(t[2]=(...i)=>r.addConfigEntry&&r.addConfigEntry(...i))}," ➕ 新增模型 "),l("button",{class:"save-button",onClick:t[3]||(t[3]=(...i)=>r.saveCharacterConfig&&r.saveCharacterConfig(...i))}," 💾 保存配置 ")]),l("div",Zw,[t[10]||(t[10]=l("span",{class:"help-text-small"},"说明",-1)),l("button",{class:"help-button",onClick:t[4]||(t[4]=(...i)=>r.showHelp&&r.showHelp(...i)),title:"点击查看帮助"},"❔")])]),t[12]||(t[12]=zo('<div class="separator-small" data-v-a8f67b46></div><div class="header-frame" data-v-a8f67b46><div class="model-col" data-v-a8f67b46>模型</div><div class="weight-col" data-v-a8f67b46>权重</div><div class="priority-col" data-v-a8f67b46>优先级</div><div class="action-col" data-v-a8f67b46>操作</div></div>',2)),l("div",e4,[(S(!0),T(ve,null,Ae(o.characterConfig,(i,a)=>(S(),T("div",{key:a,class:ie(["entry-frame",{"even-row":a%2===0}])},[l("div",t4,[U(l("select",{"onUpdate:modelValue":c=>i.config=c,class:"model-select"},[(S(!0),T(ve,null,Ae(o.availableModels,c=>(S(),T("option",{key:c,value:c},F(c),9,o4))),128))],8,s4),[[Ue,i.config]])]),l("div",n4,[U(l("input",{type:"text","onUpdate:modelValue":c=>i.weigh=c,class:"weight-input",onInput:c=>r.validatePositiveInt(c,i,"weigh")},null,40,r4),[[ue,i.weigh]])]),l("div",i4,[U(l("input",{type:"text","onUpdate:modelValue":c=>i.priority=c,class:"priority-input",onInput:c=>r.validateNaturalNumber(c,i,"priority")},null,40,a4),[[ue,i.priority]])]),l("div",l4,[l("div",c4,[l("button",{class:"delete-button",onClick:c=>r.deleteConfigEntry(a),title:"删除"}," 🗑 ",8,u4),l("button",{class:"test-button",onClick:c=>r.testConfig(i.config),title:"测试"}," 🔍 ",8,f4)])])],2))),128))],512)]),l("div",d4,[l("span",g4,F(o.characterStatus),1),t[13]||(t[13]=l("span",{class:"priority-tip"},"提示: 优先级数值越高越优先使用，同级则按权重比例分配",-1))])])}const m4=Be(Jw,[["render",h4],["__scopeId","data-v-a8f67b46"]]),p4={name:"BackgroundTabContent",data(){return{conveyContext:"不传入",contextEntry:"50",backgroundConfig:[],backgroundStatus:"准备就绪"}},methods:{getConfigKeys(){try{const e=localStorage.getItem("aiGalgameConfig");if(!e)return[];const t=JSON.parse(e);return!t.AI_draw||!t.AI_draw.configs?[]:Object.keys(t.AI_draw.configs)}catch(e){return console.error("获取配置键名时出错:",e),[]}},loadBackgroundConfig(){var e;try{this.availableModels=this.getConfigKeys(),this.availableModels.length===0&&(this.availableModels=["默认模型"]);const t=localStorage.getItem("aiGalgameConfig");if(!t){this.initializeDefaultConfig();return}const s=JSON.parse(t);if(!s.AI_draw){this.initializeDefaultConfig();return}this.conveyContext=s.AI_draw.convey_context||"不传入",this.contextEntry=((e=s.AI_draw.context_entry)==null?void 0:e.toString())||"50",this.backgroundConfig=s.AI_draw.background_config||[],this.$nextTick(()=>{this.toggleContextEntry()})}catch(t){console.error("加载背景配置时出错:",t),this.initializeDefaultConfig()}},initializeDefaultConfig(){const e={AI_draw:{convey_context:"不传入",context_entry:50,background_config:[{config:"阿里_fluxdev",weigh:1,priority:1}]}};try{const t=localStorage.getItem("aiGalgameConfig"),s=t?JSON.parse(t):{};s.AI_draw=s.AI_draw||{},s.AI_draw.convey_context=e.AI_draw.convey_context,s.AI_draw.context_entry=e.AI_draw.context_entry,s.AI_draw.background_config=e.AI_draw.background_config,localStorage.setItem("aiGalgameConfig",JSON.stringify(s)),this.conveyContext=e.AI_draw.convey_context,this.contextEntry=e.AI_draw.context_entry.toString(),this.backgroundConfig=e.AI_draw.background_config}catch(t){console.error("初始化默认配置时出错:",t)}},toggleContextEntry(){this.conveyContext!=="部分传入"?this.contextEntry="":this.contextEntry||(this.contextEntry="50"),this.saveBackgroundConfig()},saveBackgroundConfig(){try{const e=this.backgroundConfig.filter(n=>n.config&&n.weigh&&/^\d+$/.test(n.weigh.toString()));if(e.length===0){this.$emit("show-message",{title:"warning",message:"至少需要一个有效的模型配置"});return}const t=localStorage.getItem("aiGalgameConfig"),s=t?JSON.parse(t):{};if(s.AI_draw||(s.AI_draw={}),s.AI_draw.background_config=e,s.AI_draw.convey_context=this.conveyContext,this.conveyContext==="部分传入"){const n=parseInt(this.contextEntry);!isNaN(n)&&n>=0?s.AI_draw.context_entry=n:(this.contextEntry="50",s.AI_draw.context_entry=50)}else s.AI_draw.context_entry="";localStorage.setItem("aiGalgameConfig",JSON.stringify(s)),this.backgroundStatus="配置已保存",setTimeout(()=>{this.backgroundStatus="准备就绪"},2e3),this.$emit("show-message",{title:"success",message:"背景配置已保存！"})}catch(e){this.$emit("show-message",{title:"error",message:"保存背景配置时出错:"+e})}},addConfigEntry(){this.backgroundConfig.push({config:this.availableModels[0],weigh:1,priority:0}),this.backgroundStatus="已添加新模型配置",setTimeout(()=>{this.backgroundStatus="准备就绪"},2e3)},deleteConfigEntry(e){this.backgroundConfig.splice(e,1)},async testConfig(e){this.$emit("show-message",{title:"info",message:`开始测试模型: ${e}...`}),this.backgroundStatus=`正在测试模型: ${e}...`;try{const t=rn();if(!t){this.$emit("show-message",{title:"error",message:"测试失败: 无法加载配置."}),this.backgroundStatus="测试失败: 无法加载配置";return}const n="/data/test/images",o="Design a hyper-realistic scene, showcasing a weathered wooden house teetering on the edge of a rugged cliff, viewed from a low angle. The house features a small balcony with laundry hanging out to dry, casting sharp shadows under the bright midday sun. Lush greenery envelops the base of the cliff, while the expansive landscape is mostly hidden by dense foliage. Although the day is clear, the scene evokes an eerie and isolated atmosphere, with sharp, high-contrast details amplifying the sense of desolation and solitude",i=`test_${e.replace(/[^a-zA-Z0-9_.-]/g,"_")}_${Date.now()}`;this.$emit("show-message",{title:"info",message:`使用模型 ${e} 生成测试图像: ${i}.png 到 ${n}`}),this.backgroundStatus=`正在生成测试图像 ${i}.png ...`;const a=await ra(t,n,o,i,e);a==="success"?(this.$emit("show-message",{title:"success",message:`模型 ${e} 测试成功! 图像已生成: ${n}/${i}.png`}),this.backgroundStatus=`模型 ${e} 测试成功!`):a==="forbid"?(this.$emit("show-message",{title:"warning",message:`模型 ${e} 测试被阻止 (Forbid). 可能触发了敏感词或特定规则.`}),this.backgroundStatus=`模型 ${e} 测试被阻止 (Forbid).`):(this.$emit("show-message",{title:"error",message:`模型 ${e} 测试失败. 返回状态: ${a}`}),this.backgroundStatus=`模型 ${e} 测试失败 (状态: ${a})`)}catch(t){console.error(`测试模型 ${e} 时发生错误:`,t),this.$emit("show-message",{title:"error",message:`测试模型 ${e} 时发生异常: ${t.message}`}),this.backgroundStatus=`测试模型 ${e} 时发生异常`}finally{setTimeout(()=>{this.backgroundStatus.startsWith(`模型 ${e} 测试`)&&(this.backgroundStatus="准备就绪")},5e3)}},showHelp(){this.$emit("show-message",{title:"success",message:"传入上下文选项是指，LLM模型会传入最近对话的多少条来生成背景绘画提示词，这是为了使生成的背景图更贴近故事。程序优先选择优先级最高的图像生成模型，并在同等优先级的模型中，根据预设的权重分配生成任务，权重高的模型承担更多任务。当高优先级模型达到并发上限或生成失败时，程序会动态调整任务分配，或自动切换到较低优先级的模型继续生成。"})},validatePositiveInt(e,t,s){const n=e.target.value;if(n==="")return;/^[1-9]\d*$/.test(n)?t[s]=parseInt(n):(e.target.value=t[s].toString().replace(/[^0-9]/g,"")||"1",t[s]=parseInt(e.target.value))},validateNaturalNumberForEntry(e,t,s){const n=e.target.value;if(n==="")return;/^(0|[1-9]\d*)$/.test(n)?t[s]=parseInt(n):(e.target.value=t[s].toString().replace(/[^0-9]/g,"")||"0",t[s]=parseInt(e.target.value))},validateNaturalNumber(e){const t=e.target.value;if(t==="")return;/^(0|[1-9]\d*)$/.test(t)||(this.contextEntry=this.contextEntry.replace(/[^0-9]/g,"")||"50")}},mounted(){this.loadBackgroundConfig()}},y4={class:"main-container"},b4={class:"section-frame"},v4={class:"context-options-frame"},w4={class:"left-options"},_4={class:"section-frame model-list-frame"},C4={class:"toolbar-frame"},$4={class:"left-buttons"},k4={class:"right-buttons"},S4={class:"entries-container",ref:"entriesContainer"},x4={class:"model-col"},T4=["onUpdate:modelValue"],I4=["value"],M4={class:"weight-col"},P4=["onUpdate:modelValue","onInput"],A4={class:"priority-col"},E4=["onUpdate:modelValue","onInput"],O4={class:"action-col"},L4={class:"action-buttons"},N4=["onClick"],R4=["onClick"],D4={class:"status-frame"},F4={class:"status-label"};function V4(e,t,s,n,o,r){return S(),T("div",y4,[t[17]||(t[17]=l("div",{class:"title-frame"},[l("h3",{class:"title-label"},"背景绘画模型配置"),l("span",{class:"subtitle-label"},"配置AI绘画背景图片生成模型")],-1)),t[18]||(t[18]=l("div",{class:"separator"},null,-1)),l("div",b4,[t[12]||(t[12]=l("h4",{class:"section-title"},"上下文设置",-1)),l("div",v4,[l("div",w4,[t[10]||(t[10]=l("label",{class:"label-bold"},"传入上下文:",-1)),U(l("select",{"onUpdate:modelValue":t[0]||(t[0]=i=>o.conveyContext=i),class:"context-select",onChange:t[1]||(t[1]=(...i)=>r.toggleContextEntry&&r.toggleContextEntry(...i))},t[8]||(t[8]=[l("option",{value:"不传入"},"不传入",-1),l("option",{value:"部分传入"},"部分传入",-1),l("option",{value:"全部传入"},"全部传入",-1)]),544),[[Ue,o.conveyContext]]),o.conveyContext==="部分传入"?(S(),T(ve,{key:0},[t[9]||(t[9]=l("label",{class:"entry-label"},"传入条数:",-1)),U(l("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=i=>o.contextEntry=i),class:"entry-input",onInput:t[3]||(t[3]=(...i)=>r.validateNaturalNumber&&r.validateNaturalNumber(...i)),onBlur:t[4]||(t[4]=(...i)=>r.saveBackgroundConfig&&r.saveBackgroundConfig(...i))},null,544),[[ue,o.contextEntry]])],64)):ge("",!0)]),t[11]||(t[11]=l("div",{class:"right-info"},[l("p",{class:"context-info"}," 传入上下文选项决定AI绘画生成背景图时参考的对话数量，有助于使背景图更贴近故事情境。 ")],-1))])]),l("div",_4,[t[14]||(t[14]=l("h4",{class:"section-title"},"模型配置列表",-1)),l("div",C4,[l("div",$4,[l("button",{class:"add-button",onClick:t[5]||(t[5]=(...i)=>r.addConfigEntry&&r.addConfigEntry(...i))}," ➕ 新增模型 "),l("button",{class:"save-button",onClick:t[6]||(t[6]=(...i)=>r.saveBackgroundConfig&&r.saveBackgroundConfig(...i))}," 💾 保存配置 ")]),l("div",k4,[t[13]||(t[13]=l("span",{class:"help-text-small"},"说明",-1)),l("button",{class:"help-button",onClick:t[7]||(t[7]=(...i)=>r.showHelp&&r.showHelp(...i)),title:"点击查看帮助"},"❔")])]),t[15]||(t[15]=zo('<div class="separator-small" data-v-cb61f451></div><div class="header-frame" data-v-cb61f451><div class="model-col" data-v-cb61f451>模型</div><div class="weight-col" data-v-cb61f451>权重</div><div class="priority-col" data-v-cb61f451>优先级</div><div class="action-col" data-v-cb61f451>操作</div></div>',2)),l("div",S4,[(S(!0),T(ve,null,Ae(o.backgroundConfig,(i,a)=>(S(),T("div",{key:a,class:ie(["entry-frame",{"even-row":a%2===0}])},[l("div",x4,[U(l("select",{"onUpdate:modelValue":c=>i.config=c,class:"model-select"},[(S(!0),T(ve,null,Ae(e.availableModels,c=>(S(),T("option",{key:c,value:c},F(c),9,I4))),128))],8,T4),[[Ue,i.config]])]),l("div",M4,[U(l("input",{type:"text","onUpdate:modelValue":c=>i.weigh=c,class:"weight-input",onInput:c=>r.validatePositiveInt(c,i,"weigh")},null,40,P4),[[ue,i.weigh]])]),l("div",A4,[U(l("input",{type:"text","onUpdate:modelValue":c=>i.priority=c,class:"priority-input",onInput:c=>r.validateNaturalNumberForEntry(c,i,"priority")},null,40,E4),[[ue,i.priority]])]),l("div",O4,[l("div",L4,[l("button",{class:"delete-button",onClick:c=>r.deleteConfigEntry(a),title:"删除"}," 🗑 ",8,N4),l("button",{class:"test-button",onClick:c=>r.testConfig(i.config),title:"测试"}," 🔍 ",8,R4)])])],2))),128))],512)]),l("div",D4,[l("span",F4,F(o.backgroundStatus),1),t[16]||(t[16]=l("span",{class:"priority-tip"},"提示: 优先级数值越高越优先使用，同级则按权重比例分配",-1))])])}const U4=Be(p4,[["render",V4],["__scopeId","data-v-cb61f451"]]),j4={name:"ProcessingTabContent",data(){return{rembgLocation:"http://localhost:7000/api/remove",rembgModel:"isnet-anime",characterResolution:!1,backgroundResolution:!1,characterWidth:1024,characterHeight:1024,characterResize:"裁剪",backgroundResize:"裁剪",processingStatus:"准备就绪"}},methods:{clearSelection(e){e.target.select()},loadProcessingConfig(){try{const e=localStorage.getItem("aiGalgameConfig");if(!e)return;const t=JSON.parse(e);if(!t.AI_draw||!t.AI_draw.processing_config)return;const s=t.AI_draw.processing_config;this.rembgLocation=s.rembg_location||"http://localhost:7000/api/remove",this.rembgModel=s.rembg_model||"isnet-anime",this.characterResolution=s.character_resolution||!1,this.backgroundResolution=s.background_resolution||!1,s.character_width!==void 0&&s.character_width!==null&&(this.characterWidth=s.character_width),s.character_height!==void 0&&s.character_height!==null&&(this.characterHeight=s.character_height),s.character_resize&&(this.characterResize=s.character_resize),s.background_resize&&(this.backgroundResize=s.background_resize)}catch(e){console.error("加载后处理配置时出错:",e)}},saveProcessingConfig(){try{const e=localStorage.getItem("aiGalgameConfig"),t=e?JSON.parse(e):{};t.AI_draw||(t.AI_draw={}),t.AI_draw.processing_config||(t.AI_draw.processing_config={});const s={rembg_location:this.rembgLocation||"http://localhost:7000/api/remove",rembg_model:this.rembgModel||"isnet-anime",character_resolution:this.characterResolution,background_resolution:this.backgroundResolution};this.characterResolution&&(s.character_width=parseInt(this.characterWidth),s.character_height=parseInt(this.characterHeight),s.character_resize=this.characterResize),this.backgroundResolution&&(s.background_resize=this.backgroundResize),t.AI_draw.processing_config=s,localStorage.setItem("aiGalgameConfig",JSON.stringify(t)),this.processingStatus="设置已保存",setTimeout(()=>{this.processingStatus="准备就绪"},2e3),this.$emit("show-message",{title:"success",message:"后处理配置已保存！"}),console.log("后处理配置已保存！")}catch(e){console.error("保存后处理配置时出错:",e)}},validateAndSave(e){e==="width"?(this.characterWidth=parseInt(this.characterWidth),isNaN(this.characterWidth)&&(this.characterWidth=1024),this.characterWidth=Math.max(1,Math.min(4096,this.characterWidth))):(this.characterHeight=parseInt(this.characterHeight),isNaN(this.characterHeight)&&(this.characterHeight=1024),this.characterHeight=Math.max(1,Math.min(4096,this.characterHeight))),this.saveProcessingConfig()}},mounted(){this.loadProcessingConfig()}},z4={class:"main-container"},B4={class:"section-frame"},q4={class:"input-row"},J4={class:"input-row"},G4={class:"button-row"},W4={class:"section-frame"},H4={class:"section-container"},K4={class:"toggle-row"},Q4={class:"toggle-container"},Y4={key:0,class:"settings-container"},X4={class:"grid-container"},Z4={class:"grid-row"},e3={class:"grid-row"},t3={class:"section-container"},s3={class:"toggle-row"},o3={class:"toggle-container"},n3={key:0,class:"settings-container"},r3={class:"grid-container"},i3={class:"grid-row"},a3={class:"status-frame"},l3={class:"status-label"};function c3(e,t,s,n,o,r){return S(),T("div",z4,[t[35]||(t[35]=l("div",{class:"title-frame"},[l("h3",{class:"title-label"},"AI绘画后处理设置"),l("span",{class:"subtitle-label"},"配置图像处理选项和自动调整参数")],-1)),t[36]||(t[36]=l("div",{class:"separator"},null,-1)),l("div",B4,[t[21]||(t[21]=l("h4",{class:"section-title"},"背景去除设置 (rembg)",-1)),l("div",q4,[t[19]||(t[19]=l("label",{class:"input-label"},"rembg地址:",-1)),U(l("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=i=>o.rembgLocation=i),class:"input-field",onFocus:t[1]||(t[1]=(...i)=>r.clearSelection&&r.clearSelection(...i))},null,544),[[ue,o.rembgLocation]])]),l("div",J4,[t[20]||(t[20]=l("label",{class:"input-label"},"rembg模型:",-1)),U(l("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=i=>o.rembgModel=i),class:"input-field",onFocus:t[3]||(t[3]=(...i)=>r.clearSelection&&r.clearSelection(...i))},null,544),[[ue,o.rembgModel]])]),l("div",G4,[l("button",{class:"save-button",onClick:t[4]||(t[4]=(...i)=>r.saveProcessingConfig&&r.saveProcessingConfig(...i))}," 💾 保存Rembg设置 ")])]),l("div",W4,[t[34]||(t[34]=l("h4",{class:"section-title"},"分辨率调整设置",-1)),l("div",H4,[l("div",K4,[l("div",Q4,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=i=>o.characterResolution=i),class:"toggle",onChange:t[6]||(t[6]=(...i)=>r.saveProcessingConfig&&r.saveProcessingConfig(...i))},null,544),[[Ve,o.characterResolution]]),t[22]||(t[22]=l("div",{class:"toggle-slider"},null,-1))]),t[23]||(t[23]=l("label",{class:"toggle-label1"},"启用人物绘画分辨率调整",-1))]),o.characterResolution?(S(),T("div",Y4,[l("div",X4,[l("div",Z4,[t[24]||(t[24]=l("label",{class:"grid-label"},"宽度:",-1)),U(l("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=i=>o.characterWidth=i),class:"size-input",min:"1",onBlur:t[8]||(t[8]=i=>r.validateAndSave("width")),onKeyup:t[9]||(t[9]=qo(i=>r.validateAndSave("width"),["enter"]))},null,544),[[ue,o.characterWidth,void 0,{number:!0}]]),t[25]||(t[25]=l("label",{class:"grid-label ml-15"},"高度:",-1)),U(l("input",{type:"number","onUpdate:modelValue":t[10]||(t[10]=i=>o.characterHeight=i),class:"size-input",min:"1",onBlur:t[11]||(t[11]=i=>r.validateAndSave("height")),onKeyup:t[12]||(t[12]=qo(i=>r.validateAndSave("height"),["enter"]))},null,544),[[ue,o.characterHeight,void 0,{number:!0}]])]),l("div",e3,[t[27]||(t[27]=l("label",{class:"grid-label"},"非指定比例方案:",-1)),U(l("select",{"onUpdate:modelValue":t[13]||(t[13]=i=>o.characterResize=i),class:"medium-select",onChange:t[14]||(t[14]=(...i)=>r.saveProcessingConfig&&r.saveProcessingConfig(...i))},t[26]||(t[26]=[l("option",{value:"裁剪"},"裁剪",-1),l("option",{value:"填充"},"填充",-1),l("option",{value:"拉伸"},"拉伸",-1)]),544),[[Ue,o.characterResize]])])]),t[28]||(t[28]=l("p",{class:"tip-text"},"提示: 设置人物图像的宽高比例，非指定比例时的处理方式",-1))])):ge("",!0)]),l("div",t3,[l("div",s3,[l("div",o3,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[15]||(t[15]=i=>o.backgroundResolution=i),class:"toggle",onChange:t[16]||(t[16]=(...i)=>r.saveProcessingConfig&&r.saveProcessingConfig(...i))},null,544),[[Ve,o.backgroundResolution]]),t[29]||(t[29]=l("div",{class:"toggle-slider"},null,-1))]),t[30]||(t[30]=l("label",{class:"toggle-label1"},"启用背景绘画分辨率调整",-1))]),o.backgroundResolution?(S(),T("div",n3,[l("div",r3,[l("div",i3,[t[32]||(t[32]=l("label",{class:"grid-label"},"非16:9比例方案:",-1)),U(l("select",{"onUpdate:modelValue":t[17]||(t[17]=i=>o.backgroundResize=i),class:"medium-select",onChange:t[18]||(t[18]=(...i)=>r.saveProcessingConfig&&r.saveProcessingConfig(...i))},t[31]||(t[31]=[l("option",{value:"裁剪"},"裁剪",-1),l("option",{value:"填充"},"填充",-1),l("option",{value:"拉伸"},"拉伸",-1)]),544),[[Ue,o.backgroundResize]])])]),t[33]||(t[33]=l("p",{class:"tip-text"},"提示: 背景图像将自动调整为16:9比例，此选项控制调整方法",-1))])):ge("",!0)])]),l("div",a3,[l("span",l3,F(o.processingStatus),1)])])}const u3=Be(j4,[["render",c3],["__scopeId","data-v-a8fdbe44"]]),f3={name:"ImageQualityChecker",data(){return{currentTimestamp:"2025-04-19 06:40:58",username:"djfaaa",imageFile:null,previewUrl:null,processedImageUrl:null,processedBlob:null,isDragging:!1,isProcessing:!1,targetWidth:1024,targetHeight:1024,resizeStrategy:"crop",qualityScores:{"方法A (边缘检测)":0,"方法B (Sobel梯度)":0,"方法C (Laplacian)":0}}},methods:{onDragEnter(e){this.isDragging=!0},onDragOver(e){this.isDragging=!0},onDragLeave(e){this.isDragging=!1},onFileDrop(e){this.isDragging=!1,e.dataTransfer.files.length>0&&this.handleFileSelection(e.dataTransfer.files[0])},onFileSelected(e){e.target.files.length>0&&this.handleFileSelection(e.target.files[0])},handleFileSelection(e){if(!e.type.startsWith("image/")){alert("请选择图片文件");return}this.imageFile=e,this.previewUrl=URL.createObjectURL(e),this.processedImageUrl=null,this.processedBlob=null;for(const t in this.qualityScores)this.qualityScores[t]=0},async checkImageQuality(){if(this.imageFile){this.isProcessing=!0;try{const[e,t,s]=await Promise.all([Wf(this.imageFile,this.targetWidth,this.targetHeight,this.resizeStrategy),Hf(this.imageFile,this.targetWidth,this.targetHeight,this.resizeStrategy),Kf(this.imageFile,this.targetWidth,this.targetHeight,this.resizeStrategy)]);this.animateScores({"方法A (边缘检测)":e,"方法B (Sobel梯度)":t,"方法C (Laplacian)":s})}catch(e){console.error("Image quality assessment failed:",e),alert("图像质量评估失败: "+e.message)}finally{this.isProcessing=!1}}},animateScores(e){const s=performance.now(),n={...this.qualityScores},o=r=>{const i=r-s,a=Math.min(i/1e3,1);for(const c in e){const f=n[c]||0,u=e[c];this.qualityScores[c]=Math.round(f+(u-f)*a)}a<1&&requestAnimationFrame(o)};requestAnimationFrame(o)},async resizeImage(){if(this.imageFile){this.isProcessing=!0;try{const e=await Qf(this.imageFile,this.targetWidth,this.targetHeight,this.resizeStrategy);this.processedImageUrl&&URL.revokeObjectURL(this.processedImageUrl),this.processedBlob=e,this.processedImageUrl=URL.createObjectURL(e)}catch(e){console.error("Image processing failed:",e),alert("图像处理失败: "+e.message)}finally{this.isProcessing=!1}}},downloadProcessedImage(){if(!this.processedBlob)return;const e=this.getProcessedFilename(this.imageFile.name),t=document.createElement("a");t.href=this.processedImageUrl,t.download=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)},getProcessedFilename(e){const t=e.split("."),s=t.pop();return`${t.join(".")}_processed_${this.resizeStrategy}_${this.targetWidth}x${this.targetHeight}.${s}`}},beforeUnmount(){this.previewUrl&&URL.revokeObjectURL(this.previewUrl),this.processedImageUrl&&URL.revokeObjectURL(this.processedImageUrl)}},d3={class:"image-quality-checker"},g3={class:"user-info"},h3={class:"timestamp"},m3={class:"username"},p3={class:"uploader-section"},y3={class:"drop-message"},b3={key:0},v3={key:1},w3={key:0,class:"options-section"},_3={class:"image-preview"},C3=["src"],$3={class:"options-panel"},k3={class:"quality-results"},S3={class:"method-name"},x3={class:"progress-bar"},T3={class:"score-value"},I3=["disabled"],M3={class:"resize-options"},P3={class:"input-group"},A3={class:"input-group"},E3={class:"input-group"},O3=["disabled"],L3={key:1,class:"results-section"},N3={class:"result-image"},R3=["src"],D3={class:"result-actions"};function F3(e,t,s,n,o,r){return S(),T("div",d3,[l("header",null,[t[11]||(t[11]=l("h1",null,"AI图像质量检查 & 处理工具",-1)),l("div",g3,[l("div",h3,F(o.currentTimestamp),1),l("div",m3,F(o.username),1)])]),l("div",p3,[l("div",{class:ie(["file-drop-area",{active:o.isDragging}]),onDragenter:t[1]||(t[1]=ft((...i)=>r.onDragEnter&&r.onDragEnter(...i),["prevent"])),onDragover:t[2]||(t[2]=ft((...i)=>r.onDragOver&&r.onDragOver(...i),["prevent"])),onDragleave:t[3]||(t[3]=ft((...i)=>r.onDragLeave&&r.onDragLeave(...i),["prevent"])),onDrop:t[4]||(t[4]=ft((...i)=>r.onFileDrop&&r.onFileDrop(...i),["prevent"]))},[l("input",{type:"file",ref:"fileInput",onChange:t[0]||(t[0]=(...i)=>r.onFileSelected&&r.onFileSelected(...i)),accept:"image/*",multiple:!1},null,544),l("div",y3,[o.imageFile?(S(),T("span",v3,[t[13]||(t[13]=l("i",{class:"fas fa-check-circle"},null,-1)),te(" 已选择文件: "+F(o.imageFile.name),1)])):(S(),T("span",b3,t[12]||(t[12]=[l("i",{class:"fas fa-cloud-upload-alt"},null,-1),te(" 拖拽图片文件到这里或点击选择 ")])))])],34)]),o.imageFile?(S(),T("div",w3,[l("div",_3,[l("img",{src:o.previewUrl,alt:"Image preview"},null,8,C3)]),l("div",$3,[t[18]||(t[18]=l("h2",null,"图像质量评估",-1)),l("div",k3,[(S(!0),T(ve,null,Ae(o.qualityScores,(i,a)=>(S(),T("div",{class:"quality-method",key:a},[l("div",S3,F(a),1),l("div",x3,[l("div",{class:"progress",style:pt({width:`${i}%`})},null,4)]),l("div",T3,F(i)+"%",1)]))),128)),l("button",{class:"check-quality-btn",onClick:t[5]||(t[5]=(...i)=>r.checkImageQuality&&r.checkImageQuality(...i)),disabled:o.isProcessing},F(o.isProcessing?"处理中...":"检测图像质量"),9,I3)]),t[19]||(t[19]=l("h2",null,"图像处理选项",-1)),l("div",M3,[l("div",P3,[t[14]||(t[14]=l("label",{for:"target-width"},"目标宽度",-1)),U(l("input",{type:"number",id:"target-width","onUpdate:modelValue":t[6]||(t[6]=i=>o.targetWidth=i),min:"1"},null,512),[[ue,o.targetWidth,void 0,{number:!0}]])]),l("div",A3,[t[15]||(t[15]=l("label",{for:"target-height"},"目标高度",-1)),U(l("input",{type:"number",id:"target-height","onUpdate:modelValue":t[7]||(t[7]=i=>o.targetHeight=i),min:"1"},null,512),[[ue,o.targetHeight,void 0,{number:!0}]])]),l("div",E3,[t[17]||(t[17]=l("label",{for:"resize-strategy"},"调整策略",-1)),U(l("select",{id:"resize-strategy","onUpdate:modelValue":t[8]||(t[8]=i=>o.resizeStrategy=i)},t[16]||(t[16]=[l("option",{value:"crop"},"裁剪 (Crop)",-1),l("option",{value:"pad"},"填充 (Pad)",-1),l("option",{value:"stretch"},"拉伸 (Stretch)",-1)]),512),[[Ue,o.resizeStrategy]])]),l("button",{class:"resize-btn",onClick:t[9]||(t[9]=(...i)=>r.resizeImage&&r.resizeImage(...i)),disabled:o.isProcessing},F(o.isProcessing?"处理中...":"调整图片尺寸"),9,O3)])])])):ge("",!0),o.processedImageUrl?(S(),T("div",L3,[t[21]||(t[21]=l("h2",null,"处理结果",-1)),l("div",N3,[l("img",{src:o.processedImageUrl,alt:"Processed image"},null,8,R3)]),l("div",D3,[l("button",{class:"download-btn",onClick:t[10]||(t[10]=(...i)=>r.downloadProcessedImage&&r.downloadProcessedImage(...i))},t[20]||(t[20]=[l("i",{class:"fas fa-download"},null,-1),te(" 下载处理后的图片 ")]))])])):ge("",!0)])}const V3=Be(f3,[["render",F3],["__scopeId","data-v-a5051f15"]]),U3={name:"JudgingTabContent",components:{ImageQualityChecker:V3},data(){return{qualityMethod:"a",characterQualityJudgment:!1,backgroundQualityJudgment:!1,characterQualityThreshold:"",backgroundQualityThreshold:"",judgingStatus:"准备就绪",showQualityCheckerModal:!1,methodInfoMap:{a:"方法A: 基于动态掩码和梯度幅值分位数的自适应锐度评估法",b:"方法B: 基于人物特征识别和背景细节度评估",c:"方法C: 基于综合美学分析和色彩协调度评估"}}},computed:{methodInfoText(){return this.methodInfoMap[this.qualityMethod]||"未知方法"}},methods:{loadConfig(){var e;try{const t=localStorage.getItem("aiGalgameConfig");if(t){const s=JSON.parse(t),n=((e=s==null?void 0:s.AI_draw)==null?void 0:e.judging_config)||{};this.characterQualityJudgment=n.character_quality_judgment||!1,this.backgroundQualityJudgment=n.background_quality_judgment||!1,this.qualityMethod=n.selected_method||"a",this.loadMethodThresholds()}else this.initializeDefaultConfig(),this.loadMethodThresholds()}catch(t){console.error("加载配置时出错:",t),this.initializeDefaultConfig(),this.loadMethodThresholds()}},initializeDefaultConfig(){const e={a:{character_quality_threshold:"10",background_quality_threshold:"15"},b:{character_quality_threshold:"65",background_quality_threshold:"60"},c:{character_quality_threshold:"70",background_quality_threshold:"65"}};try{const t=localStorage.getItem("aiGalgameConfig"),s=t?JSON.parse(t):{};s.AI_draw||(s.AI_draw={}),s.AI_draw.judging_config?s.AI_draw.judging_config.methods||(s.AI_draw.judging_config.methods=e,localStorage.setItem("aiGalgameConfig",JSON.stringify(s)),console.log("Initialized default judging methods.")):(s.AI_draw.judging_config={character_quality_judgment:!1,background_quality_judgment:!1,selected_method:"a",methods:e},localStorage.setItem("aiGalgameConfig",JSON.stringify(s)),console.log("Initialized default judging config."))}catch(t){console.error("初始化默认配置时出错:",t)}},loadMethodThresholds(){var e,t,s,n;try{const o=localStorage.getItem("aiGalgameConfig");if(!o){console.warn("No config found in localStorage for loading thresholds."),this.characterQualityThreshold="",this.backgroundQualityThreshold="";return}const r=JSON.parse(o),i=(t=(e=r==null?void 0:r.AI_draw)==null?void 0:e.judging_config)==null?void 0:t.methods;if(i){const a=i[this.qualityMethod]||{};this.characterQualityThreshold=a.character_quality_threshold||"",this.backgroundQualityThreshold=a.background_quality_threshold||""}else{console.warn("Methods config not found, initializing defaults before loading."),this.initializeDefaultConfig();const a=localStorage.getItem("aiGalgameConfig"),c=a?JSON.parse(a):{},f=(n=(s=c==null?void 0:c.AI_draw)==null?void 0:s.judging_config)==null?void 0:n.methods;if(!f){console.error("Failed to initialize or find methods config."),this.characterQualityThreshold="",this.backgroundQualityThreshold="";return}const u=f[this.qualityMethod]||{};this.characterQualityThreshold=u.character_quality_threshold||"",this.backgroundQualityThreshold=u.background_quality_threshold||""}}catch(o){console.error("加载方法阈值时出错:",o),this.characterQualityThreshold="",this.backgroundQualityThreshold=""}},saveAiDrawJudgingConfig(){try{const e=localStorage.getItem("aiGalgameConfig"),t=e?JSON.parse(e):{};t.AI_draw||(t.AI_draw={}),t.AI_draw.judging_config||(t.AI_draw.judging_config={}),t.AI_draw.judging_config.methods||(t.AI_draw.judging_config.methods={});const s=t.AI_draw.judging_config,n=s.methods;n[this.qualityMethod]||(n[this.qualityMethod]={}),n[this.qualityMethod].character_quality_threshold=this.characterQualityThreshold,n[this.qualityMethod].background_quality_threshold=this.backgroundQualityThreshold,s.character_quality_judgment=this.characterQualityJudgment,s.background_quality_judgment=this.backgroundQualityJudgment,s.selected_method=this.qualityMethod,localStorage.setItem("aiGalgameConfig",JSON.stringify(t)),this.judgingStatus="设置已保存",setTimeout(()=>{this.judgingStatus="准备就绪"},2e3),this.$emit("show-message",{title:"success",message:"质量判断设置已保存！"})}catch(e){console.error("保存配置时出错:",e),this.$emit("show-message",{title:"error",message:"保存配置失败"}),this.judgingStatus="保存失败"}},handleThresholdInput(e,t){let s=e.target.value;if(s===""){this[t]="";return}if(s=s.replace(/\D/g,""),s===""){this[t]="";return}const n=parseInt(s);if(isNaN(n)){this[t]="";return}n<0?this[t]="0":n>100?this[t]="100":this[t]=String(n),this.$nextTick(()=>{})},openJudgingTestWindow(){this.showQualityCheckerModal=!0,this.updateStatus("正在打开测试窗口...")},updateStatus(e){this.judgingStatus=e}},mounted(){this.loadConfig()}},j3={class:"judging-tab"},z3={class:"main-container"},B3={class:"section-frame"},q3={class:"method-select-frame"},J3={class:"method-info"},G3={class:"section-frame"},W3={class:"grid-frame"},H3={class:"grid-row"},K3={class:"toggle-container"},Q3={class:"grid-row"},Y3={class:"toggle-container"},X3={class:"section-frame"},Z3={class:"threshold-grid"},e6={class:"grid-row"},t6={class:"grid-row"},s6={class:"button-frame"},o6={class:"status-frame"},n6={class:"status-label"};function r6(e,t,s,n,o,r){const i=ze("ImageQualityChecker");return S(),T("div",j3,[l("div",z3,[t[27]||(t[27]=l("div",{class:"title-frame"},[l("h3",{class:"title-label"},"图片质量判断设置"),l("span",{class:"subtitle-label"},"配置AI绘画结果的质量评估参数")],-1)),t[28]||(t[28]=l("div",{class:"separator"},null,-1)),l("div",B3,[t[14]||(t[14]=l("h4",{class:"section-title"},"判断方法",-1)),l("div",q3,[t[13]||(t[13]=l("label",{class:"label-bold"},"质量判断方法:",-1)),U(l("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>o.qualityMethod=a),onChange:t[1]||(t[1]=(...a)=>r.loadMethodThresholds&&r.loadMethodThresholds(...a)),class:"method-select"},t[12]||(t[12]=[l("option",{value:"a"},"a",-1),l("option",{value:"b"},"b",-1),l("option",{value:"c"},"c",-1)]),544),[[Ue,o.qualityMethod]]),l("span",J3,F(r.methodInfoText),1)])]),l("div",G3,[t[19]||(t[19]=l("h4",{class:"section-title"},"质量判断开关",-1)),l("div",W3,[l("div",H3,[t[16]||(t[16]=l("label",{class:"label"},"人物绘画质量判断:",-1)),l("div",K3,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=a=>o.characterQualityJudgment=a),class:"toggle"},null,512),[[Ve,o.characterQualityJudgment]]),t[15]||(t[15]=l("div",{class:"toggle-slider"},null,-1))])]),l("div",Q3,[t[18]||(t[18]=l("label",{class:"label"},"背景绘画质量判断:",-1)),l("div",Y3,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=a=>o.backgroundQualityJudgment=a),class:"toggle"},null,512),[[Ve,o.backgroundQualityJudgment]]),t[17]||(t[17]=l("div",{class:"toggle-slider"},null,-1))])])]),t[20]||(t[20]=l("p",{class:"info-text"},"启用质量判断后，系统将自动评估生成图像质量，低于阈值的图像将被丢弃并重新生成",-1))]),l("div",X3,[t[25]||(t[25]=l("h4",{class:"section-title"},"质量阈值设置",-1)),l("div",Z3,[l("div",e6,[t[21]||(t[21]=l("label",{class:"label"},"人物质量阈值:",-1)),U(l("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=a=>o.characterQualityThreshold=a),class:"threshold-input",onInput:t[5]||(t[5]=a=>r.handleThresholdInput(a,"characterQualityThreshold"))},null,544),[[ue,o.characterQualityThreshold]]),t[22]||(t[22]=l("span",{class:"range-text"},"(0-100)",-1))]),l("div",t6,[t[23]||(t[23]=l("label",{class:"label"},"背景质量阈值:",-1)),U(l("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=a=>o.backgroundQualityThreshold=a),class:"threshold-input",onInput:t[7]||(t[7]=a=>r.handleThresholdInput(a,"backgroundQualityThreshold"))},null,544),[[ue,o.backgroundQualityThreshold]]),t[24]||(t[24]=l("span",{class:"range-text"},"(0-100)",-1))])]),t[26]||(t[26]=l("p",{class:"info-text"},"阈值范围为0-100，数值越高要求越严格。不同判断方法的推荐阈值可能有所不同。",-1))]),l("div",s6,[l("button",{class:"test-button",onClick:t[8]||(t[8]=(...a)=>r.openJudgingTestWindow&&r.openJudgingTestWindow(...a))}," 🧪 测试质量判断 "),l("button",{class:"save-button",onClick:t[9]||(t[9]=(...a)=>r.saveAiDrawJudgingConfig&&r.saveAiDrawJudgingConfig(...a))}," 💾 保存设置 ")]),l("div",o6,[l("span",n6,F(o.judgingStatus),1)])]),o.showQualityCheckerModal?(S(),Xe(i,{key:0,onClose:t[10]||(t[10]=a=>o.showQualityCheckerModal=!1),qualityMethod:o.qualityMethod,characterThreshold:parseInt(o.characterQualityThreshold)||0,backgroundThreshold:parseInt(o.backgroundQualityThreshold)||0,characterJudgmentEnabled:o.characterQualityJudgment,backgroundJudgmentEnabled:o.backgroundQualityJudgment,onShowMessage:t[11]||(t[11]=a=>e.$emit("show-message",a)),onUpdateStatus:r.updateStatus},null,8,["qualityMethod","characterThreshold","backgroundThreshold","characterJudgmentEnabled","backgroundJudgmentEnabled","onUpdateStatus"])):ge("",!0)])}const i6=Be(U3,[["render",r6],["__scopeId","data-v-b82ba662"]]),Fr=Zu(),a6={name:"CharacterBackgroundSettings",components:{CharacterTabContent:m4,BackgroundTabContent:U4,ProcessingTabContent:u3,JudgingTabContent:i6},data(){return{activeTabIndex:0,tabs:[{name:"人物绘画配置区"},{name:"背景绘画配置区"},{name:"判断生成质量"},{name:"后处理"}]}},methods:{close(){this.$emit("close")},openJudgingTestWindow(){this.$emit("open-quality-checker")},showMessageBubble(e){e.title==="success"?Fr.success(e.message):e.title==="error"?Fr.error(e.message):Fr.warning(e.message)}}},l6={class:"character-background-settings"},c6={class:"tabs-container"},u6={class:"tabs"},f6=["onClick"],d6={class:"tab-name"},g6={class:"tab-content"},h6={key:0,class:"character-tab"},m6={key:1,class:"background-tab"},p6={key:2,class:"judging-tab"},y6={key:3,class:"processing-tab"};function b6(e,t,s,n,o,r){const i=ze("CharacterTabContent"),a=ze("BackgroundTabContent"),c=ze("JudgingTabContent"),f=ze("ProcessingTabContent");return S(),T("div",l6,[l("div",c6,[l("div",u6,[(S(!0),T(ve,null,Ae(o.tabs,(u,d)=>(S(),T("div",{key:d,class:ie(["tab",{active:o.activeTabIndex===d}]),onClick:h=>o.activeTabIndex=d},[l("span",d6,F(u.name),1)],10,f6))),128))]),l("div",g6,[o.activeTabIndex===0?(S(),T("div",h6,[q(i,{onShowMessage:r.showMessageBubble},null,8,["onShowMessage"])])):ge("",!0),o.activeTabIndex===1?(S(),T("div",m6,[q(a,{onShowMessage:r.showMessageBubble},null,8,["onShowMessage"])])):ge("",!0),o.activeTabIndex===2?(S(),T("div",p6,[q(c,{onOpenQualityChecker:r.openJudgingTestWindow,onShowMessage:r.showMessageBubble},null,8,["onOpenQualityChecker","onShowMessage"])])):ge("",!0),o.activeTabIndex===3?(S(),T("div",y6,[q(f,{onShowMessage:r.showMessageBubble},null,8,["onShowMessage"])])):ge("",!0)])])])}const v6=Be(a6,[["render",b6],["__scopeId","data-v-1be17ef5"]]),w6={name:"AiDrawingConfig",components:{AiDrawingConfig_character_background:v6},data(){return{activeTab:"general",showCharacterBackgroundDialog:!1,notification:{show:!1,message:"",type:"success",timeout:null},configs:[],selectedConfig:"",maxAttempts:1,delayTime:5,maxConcurrency:1,useRembg:!1,useCors:!1,secondRequest:!1,requestType:"一次请求",currentRequestViewType:"一次请求",requestUrl:"",requestMethod:"POST",requestTimeout:30,requestBody:"",headers:[],headersPerPage:6,currentHeaderPage:1,jsonPath:"",parse:"",successCondition:"",failCondition:"",forbidCondition:"",configData:{},currentTimestamp:"2025-04-21 19:05:43"}},computed:{visibleHeaders(){const e=(this.currentHeaderPage-1)*this.headersPerPage,t=e+this.headersPerPage;return this.headers.slice(e,t)},totalHeaderPages(){return Math.max(1,Math.ceil(this.headers.length/this.headersPerPage))}},mounted(){this.loadConfigNames()},methods:{showNotification(e,t="success"){this.$emit("show-message",{title:t,message:e})},loadConfigNames(){try{const e=localStorage.getItem("aiGalgameConfig");if(e){const t=JSON.parse(e);t&&t.AI_draw&&t.AI_draw.configs?(this.configs=Object.keys(t.AI_draw.configs).sort(),this.configData=t,this.configs.length>0&&(this.selectedConfig=this.configs[0],this.loadSelectedConfig())):this.initializeConfig()}else this.initializeConfig()}catch(e){console.error("Error loading config names:",e),this.initializeConfig()}},initializeConfig(){let e={};try{const t=localStorage.getItem("aiGalgameConfig");t&&(e=JSON.parse(t))}catch(t){console.error("Error loading existing config:",t)}this.configData={...e,AI_draw:{configs:{},character_config:[],background_config:[]}},this.saveConfig()},saveConfig(){try{let e={};try{const s=localStorage.getItem("aiGalgameConfig");s&&(e=JSON.parse(s))}catch(s){console.error("Error loading existing config before save:",s)}const t={...e,AI_draw:this.configData.AI_draw};localStorage.setItem("aiGalgameConfig",JSON.stringify(t)),console.log(`Configuration saved at ${this.currentTimestamp} by user ${window.username||"djfaaa"}`)}catch(e){console.error("Error saving config:",e),this.showNotification("保存配置时发生错误","error")}},addConfig(){const e=prompt("请输入配置名称:");if(e){if(this.configs.includes(e)){this.showNotification("配置名称已存在！","error");return}this.configData.AI_draw.configs[e]={max_attempts:"1",delay_time:"5",maxconcurrency:"1",use_rembg:!1,use_cors:!1,request_timeout:"30",request_method:"POST",request_url:"",request_body:"",json_path:"",success_condition:"",fail_condition:"",forbid_condition:"",headers:[],second_request:!1,second_request_timeout:"30",second_request_method:"POST",second_request_url:"",second_request_body:"",second_json_path:"",second_success_condition:"",second_fail_condition:"",second_forbid_condition:"",second_headers:[]},this.configs.push(e),this.configs.sort(),this.selectedConfig=e,this.saveConfig(),this.loadSelectedConfig(),this.showNotification("配置已创建！")}},copyConfig(){if(!this.selectedConfig){this.showNotification("请选择要复制的配置！","error");return}const e=prompt("请输入复制后的配置名称:");if(e){if(this.configs.includes(e)){this.showNotification("配置名称已存在！","error");return}this.configData.AI_draw.configs[e]=JSON.parse(JSON.stringify(this.configData.AI_draw.configs[this.selectedConfig])),this.configs.push(e),this.configs.sort(),this.selectedConfig=e,this.saveConfig(),this.loadSelectedConfig(),this.showNotification("配置已复制！")}},renameConfig(){if(!this.selectedConfig){this.showNotification("请选择要改名的配置！","error");return}const e=prompt("请输入新的配置名称:",this.selectedConfig);if(!e||e===this.selectedConfig)return;if(this.configs.includes(e)){this.showNotification("配置名称已存在！","error");return}this.configData.AI_draw.configs[e]=this.configData.AI_draw.configs[this.selectedConfig],delete this.configData.AI_draw.configs[this.selectedConfig];const t=this.configs.indexOf(this.selectedConfig);this.configs.splice(t,1,e),this.configs.sort(),this.selectedConfig=e,this.saveConfig(),this.showNotification("配置已改名！")},deleteConfig(){if(!this.selectedConfig){this.showNotification("请选择要删除的配置！","error");return}if(!confirm(`确定要删除配置 '${this.selectedConfig}' 吗？`))return;delete this.configData.AI_draw.configs[this.selectedConfig];const e=this.configs.indexOf(this.selectedConfig);this.configs.splice(e,1),this.configs.length>0?(this.selectedConfig=this.configs[0],this.loadSelectedConfig()):(this.selectedConfig="",this.clearConfigFields()),this.saveConfig(),this.showNotification("配置已删除！")},loadSelectedConfig(){if(!this.selectedConfig||!this.configData.AI_draw.configs[this.selectedConfig]){this.clearConfigFields();return}const e=this.configData.AI_draw.configs[this.selectedConfig];this.maxAttempts=e.max_attempts||"1",this.delayTime=e.delay_time||"5",this.maxConcurrency=e.maxconcurrency||"1",this.useRembg=e.use_rembg||!1,this.useCors=e.use_cors||!1,this.secondRequest=e.second_request||!1,this.requestType="一次请求",this.currentRequestViewType="一次请求",this.loadViewFromConfig("一次请求")},loadViewFromConfig(e){if(!this.selectedConfig||!this.configData.AI_draw.configs[this.selectedConfig])return;const t=this.configData.AI_draw.configs[this.selectedConfig],s=e==="一次请求"?"":"second_";this.clearRequestSpecificFields(),this.requestUrl=t[`${s}request_url`]||"",this.requestMethod=t[`${s}request_method`]||"POST",this.requestTimeout=t[`${s}request_timeout`]||"30",this.requestBody=t[`${s}request_body`]||"";try{let n=t[`${s}headers`]||[];typeof n=="string"&&(n=JSON.parse(n)),this.headers=Array.isArray(n)?n.map((o,r)=>({id:r,key:o[0]||"",value:o[1]||""})):[],this.currentHeaderPage=1}catch(n){console.error("Error loading headers:",n),this.headers=[]}this.jsonPath=t[`${s}json_path`]||"",this.parse=t[`${s}userdefine`]||"",this.successCondition=t[`${s}success_condition`]||"",this.failCondition=t[`${s}fail_condition`]||"",this.forbidCondition=t[`${s}forbid_condition`]||""},saveViewToConfig(e){if(!this.selectedConfig||!this.configData.AI_draw.configs[this.selectedConfig])return;const t=this.configData.AI_draw.configs[this.selectedConfig],s=e==="一次请求"?"":"second_";t[`${s}request_url`]=this.requestUrl,t[`${s}request_method`]=this.requestMethod,t[`${s}request_timeout`]=this.requestTimeout,t[`${s}request_body`]=this.requestMethod==="POST"?this.requestBody:"",t[`${s}headers`]=this.headers.map(n=>[n.key,n.value]),t[`${s}json_path`]=this.jsonPath,t[`${s}userdefine`]=this.parse,t[`${s}success_condition`]=this.successCondition,t[`${s}fail_condition`]=this.failCondition,t[`${s}forbid_condition`]=this.forbidCondition,s===""&&(t.second_request=this.secondRequest)},saveCurrentConfig(){if(!this.selectedConfig){this.showNotification("请选择要保存的配置！","error");return}if(!this.configData.AI_draw.configs[this.selectedConfig]){this.showNotification("配置数据丢失，无法保存！","error");return}const e=this.configData.AI_draw.configs[this.selectedConfig];e.max_attempts=this.maxAttempts,e.delay_time=this.delayTime,e.maxconcurrency=this.maxConcurrency,e.use_rembg=this.useRembg,e.use_cors=this.useCors,this.saveViewToConfig(this.currentRequestViewType);let t={};try{const n=localStorage.getItem("aiGalgameConfig");n&&(t=JSON.parse(n))}catch(n){console.error("Error loading existing config for save:",n)}const s={...t,AI_draw:this.configData.AI_draw};localStorage.setItem("aiGalgameConfig",JSON.stringify(s)),this.configData=s,this.showNotification(`配置 '${this.selectedConfig}' 已保存！`),console.log(`Configuration saved at ${this.currentTimestamp} by user ${window.username||"djfaaa"}`)},clearConfigFields(){this.maxAttempts="1",this.delayTime="5",this.maxConcurrency="1",this.useRembg=!1,this.useCors=!1,this.secondRequest=!1,this.requestType="一次请求",this.currentRequestViewType="一次请求",this.clearRequestSpecificFields()},clearRequestSpecificFields(){this.requestUrl="",this.requestMethod="POST",this.requestTimeout="30",this.requestBody="",this.headers=[],this.currentHeaderPage=1,this.jsonPath="",this.parse="",this.successCondition="",this.failCondition="",this.forbidCondition=""},toggleSecondRequest(){this.selectedConfig&&this.configData.AI_draw.configs[this.selectedConfig]&&(this.configData.AI_draw.configs[this.selectedConfig].second_request=this.secondRequest)},switchRequestView(){this.requestType!==this.currentRequestViewType&&(this.saveViewToConfig(this.currentRequestViewType),this.loadViewFromConfig(this.requestType),this.currentRequestViewType=this.requestType)},toggleRequestBody(){},addHeader(){this.headers.push({id:Date.now(),key:"",value:""}),this.currentHeaderPage=this.totalHeaderPages},deleteHeader(e){const t=this.headers.findIndex(s=>s.id===e);t!==-1&&(this.headers.splice(t,1),this.currentHeaderPage>this.totalHeaderPages&&(this.currentHeaderPage=Math.max(1,this.totalHeaderPages)))},copyHeadersFromFirstRequest(){if(this.currentRequestViewType!=="二次请求"||!this.selectedConfig)return;const e=this.configData.AI_draw.configs[this.selectedConfig];if(!e||!Array.isArray(e.headers)){this.showNotification("无法获取一次请求的请求头","error");return}try{let t=e.headers||[];this.headers=t.map((s,n)=>({id:Date.now()+n,key:s[0]||"",value:s[1]||""})),this.currentHeaderPage=1,this.showNotification("已复制一次请求的请求头","success")}catch(t){console.error("Error copying headers:",t),this.showNotification("复制请求头时出错","error")}},updateHeaderPagination(){},validateRequestJson(){try{let e=this.requestBody;e=e.replace("{prompt}","test").replace("{random}","1"),JSON.parse(e),this.showNotification("检验通过","success")}catch(e){this.showNotification(`JSON格式错误: ${e.message}`,"error")}},openCharacterBackgroundSettings(){this.showCharacterBackgroundDialog=!0}}},_6={class:"ai-drawing-config"},C6={class:"config-selection-frame"},$6={class:"top-controls"},k6={class:"left-controls"},S6={class:"config-combo-frame"},x6=["value"],T6={class:"right-controls"},I6={class:"button-frame"},M6={class:"shared-params-section"},P6={class:"shared-params-container"},A6={class:"shared-params-grid"},E6={class:"params-column"},O6={class:"param-group"},L6={class:"param-group"},N6={class:"param-group"},R6={class:"params-column"},D6={class:"switch-wrapper"},F6={class:"switch-container"},V6={class:"switch"},U6={class:"switch-container"},j6={class:"switch"},z6={class:"switch-container"},B6={class:"switch"},q6={key:0,class:"request-selection-container"},J6={class:"request-selection-frame"},G6={class:"config-content"},W6={class:"tabs"},H6={class:"tab-content"},K6={class:"tab-pane"},Q6={class:"request-info-frame"},Y6={class:"url-frame"},X6={class:"method-frame"},Z6={class:"method-group"},e5={class:"timeout-group"},t5={class:"tab-pane"},s5={class:"header-control-frame"},o5={class:"header-actions"},n5={key:0},r5=["value"],i5={class:"headers-entries-frame"},a5=["onClick"],l5=["onUpdate:modelValue"],c5=["onUpdate:modelValue"],u5={class:"tab-pane"},f5={key:0,class:"request-body-frame"},d5={class:"body-label-frame"},g5={key:1,class:"no-body-message"},h5={class:"tab-pane"},m5={class:"json-path-frame"},p5={class:"conditions-frame"},y5={class:"condition-row"},b5={class:"condition-row"},v5={class:"condition-row"},w5={class:"bottom-controls"},_5={class:"modal-content"},C5={class:"modal-header"},$5={class:"modal-body"};function k5(e,t,s,n,o,r){const i=ze("AiDrawingConfig_character_background");return S(),T("div",_6,[t[74]||(t[74]=l("div",{class:"title-section"},[l("h1",null,"AI 绘画配置"),l("p",null,"配置和管理AI绘图服务接口"),l("div",{class:"separator"})],-1)),l("div",C6,[l("div",$6,[l("div",k6,[l("div",S6,[t[38]||(t[38]=l("label",{for:"config-edit-combo"},"选择配置:",-1)),U(l("select",{id:"config-edit-combo",class:"config-edit-combo","onUpdate:modelValue":t[0]||(t[0]=a=>o.selectedConfig=a),onChange:t[1]||(t[1]=(...a)=>r.loadSelectedConfig&&r.loadSelectedConfig(...a))},[(S(!0),T(ve,null,Ae(o.configs,a=>(S(),T("option",{key:a,value:a},F(a),9,x6))),128))],544),[[Ue,o.selectedConfig]])])]),l("div",T6,[l("div",I6,[l("button",{class:"btn add-config",onClick:t[2]||(t[2]=(...a)=>r.addConfig&&r.addConfig(...a))},t[39]||(t[39]=[l("i",{class:"fas fa-plus"},null,-1),te(" 新增 ")])),l("button",{class:"btn copy-config",onClick:t[3]||(t[3]=(...a)=>r.copyConfig&&r.copyConfig(...a))},t[40]||(t[40]=[l("i",{class:"fas fa-copy"},null,-1),te(" 复制配置 ")])),l("button",{class:"btn rename-config secondary",onClick:t[4]||(t[4]=(...a)=>r.renameConfig&&r.renameConfig(...a))},t[41]||(t[41]=[l("i",{class:"fas fa-pen"},null,-1),te(" 配置改名 ")])),l("button",{class:"btn delete-config danger",onClick:t[5]||(t[5]=(...a)=>r.deleteConfig&&r.deleteConfig(...a))},t[42]||(t[42]=[l("i",{class:"fas fa-trash"},null,-1),te(" 删除 ")]))])])])]),l("div",M6,[t[54]||(t[54]=l("h2",null,"全局参数",-1)),l("div",P6,[l("div",A6,[l("div",E6,[l("div",O6,[t[43]||(t[43]=l("label",{for:"max-attempts"},"最大尝试次数:",-1)),U(l("input",{id:"max-attempts",type:"number","onUpdate:modelValue":t[6]||(t[6]=a=>o.maxAttempts=a),min:"1",class:"number-input"},null,512),[[ue,o.maxAttempts]])]),l("div",L6,[t[44]||(t[44]=l("label",{for:"delay-time"},"重试间隔 (秒):",-1)),U(l("input",{id:"delay-time",type:"number","onUpdate:modelValue":t[7]||(t[7]=a=>o.delayTime=a),min:"0",class:"number-input"},null,512),[[ue,o.delayTime]])]),l("div",N6,[t[45]||(t[45]=l("label",{for:"max-concurrency"},"最大并发数:",-1)),U(l("input",{id:"max-concurrency",type:"number","onUpdate:modelValue":t[8]||(t[8]=a=>o.maxConcurrency=a),min:"1",class:"number-input"},null,512),[[ue,o.maxConcurrency]])])]),l("div",R6,[l("div",D6,[l("div",F6,[l("label",V6,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=a=>o.useRembg=a)},null,512),[[Ve,o.useRembg]]),t[46]||(t[46]=l("span",{class:"slider round"},null,-1))]),t[47]||(t[47]=l("span",{class:"switch-label"},"使用本地rembg移除背景",-1))]),l("div",U6,[l("label",j6,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=a=>o.useCors=a)},null,512),[[Ve,o.useCors]]),t[48]||(t[48]=l("span",{class:"slider round"},null,-1))]),t[49]||(t[49]=l("span",{class:"switch-label"},"启用本地代理跨域",-1))]),l("div",z6,[l("label",B6,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=a=>o.secondRequest=a),onChange:t[12]||(t[12]=(...a)=>r.toggleSecondRequest&&r.toggleSecondRequest(...a))},null,544),[[Ve,o.secondRequest]]),t[50]||(t[50]=l("span",{class:"slider round"},null,-1))]),t[51]||(t[51]=l("span",{class:"switch-label"},"启用二次请求",-1))])]),o.secondRequest?(S(),T("div",q6,[l("div",J6,[t[53]||(t[53]=l("label",{for:"request-type"},"当前编辑:",-1)),U(l("select",{id:"request-type","onUpdate:modelValue":t[13]||(t[13]=a=>o.requestType=a),class:"request-type-combo",onChange:t[14]||(t[14]=(...a)=>r.switchRequestView&&r.switchRequestView(...a))},t[52]||(t[52]=[l("option",{value:"一次请求"},"一次请求",-1),l("option",{value:"二次请求"},"二次请求",-1)]),544),[[Ue,o.requestType]])])])):ge("",!0)])])])]),l("div",G6,[l("div",W6,[l("div",{class:ie(["tab",{active:o.activeTab==="general"}]),onClick:t[15]||(t[15]=a=>o.activeTab="general")},"基本设置",2),l("div",{class:ie(["tab",{active:o.activeTab==="headers"}]),onClick:t[16]||(t[16]=a=>o.activeTab="headers")},"请求头",2),l("div",{class:ie(["tab",{active:o.activeTab==="body"}]),onClick:t[17]||(t[17]=a=>o.activeTab="body")},"请求体",2),l("div",{class:ie(["tab",{active:o.activeTab==="response"}]),onClick:t[18]||(t[18]=a=>o.activeTab="response")},"响应处理",2)]),l("div",H6,[U(l("div",K6,[l("div",Q6,[t[59]||(t[59]=l("h3",null,"请求基本信息",-1)),l("div",Y6,[t[55]||(t[55]=l("label",{for:"request-url"},"请求URL:",-1)),U(l("input",{id:"request-url",type:"text","onUpdate:modelValue":t[19]||(t[19]=a=>o.requestUrl=a),class:"request-url-input"},null,512),[[ue,o.requestUrl]])]),l("div",X6,[l("div",Z6,[t[57]||(t[57]=l("label",{for:"request-method"},"请求方法:",-1)),U(l("select",{id:"request-method","onUpdate:modelValue":t[20]||(t[20]=a=>o.requestMethod=a),onChange:t[21]||(t[21]=(...a)=>r.toggleRequestBody&&r.toggleRequestBody(...a))},t[56]||(t[56]=[l("option",{value:"POST"},"POST",-1),l("option",{value:"GET"},"GET",-1)]),544),[[Ue,o.requestMethod]])]),l("div",e5,[t[58]||(t[58]=l("label",{for:"request-timeout"},"超时时间 (秒):",-1)),U(l("input",{id:"request-timeout",type:"number","onUpdate:modelValue":t[22]||(t[22]=a=>o.requestTimeout=a),min:"1",class:"number-input"},null,512),[[ue,o.requestTimeout]])])])])],512),[[Xs,o.activeTab==="general"]]),U(l("div",t5,[l("div",s5,[l("div",o5,[l("button",{class:"btn",onClick:t[23]||(t[23]=(...a)=>r.addHeader&&r.addHeader(...a))},t[60]||(t[60]=[l("i",{class:"fas fa-plus"},null,-1),te(" 新增请求头 ")])),o.secondRequest&&o.currentRequestViewType==="二次请求"?(S(),T("div",n5,[l("button",{class:"btn copy-headers-btn",onClick:t[24]||(t[24]=(...a)=>r.copyHeadersFromFirstRequest&&r.copyHeadersFromFirstRequest(...a))},t[61]||(t[61]=[l("i",{class:"fas fa-copy"},null,-1),te(" 复制一次请求头 ")]))])):ge("",!0)]),r.totalHeaderPages>1?U((S(),T("select",{key:0,"onUpdate:modelValue":t[25]||(t[25]=a=>o.currentHeaderPage=a),onChange:t[26]||(t[26]=(...a)=>r.updateHeaderPagination&&r.updateHeaderPagination(...a)),class:"header-page-combo"},[(S(!0),T(ve,null,Ae(r.totalHeaderPages,a=>(S(),T("option",{key:a,value:a},F(a),9,r5))),128))],544)),[[Ue,o.currentHeaderPage]]):ge("",!0)]),l("div",i5,[(S(!0),T(ve,null,Ae(r.visibleHeaders,(a,c)=>(S(),T("div",{key:c,class:"header-item"},[l("button",{class:"delete-btn",onClick:f=>r.deleteHeader(a.id)},t[62]||(t[62]=[l("i",{class:"fas fa-trash"},null,-1)]),8,a5),U(l("input",{type:"text","onUpdate:modelValue":f=>a.key=f,placeholder:"Header Key",class:"header-key"},null,8,l5),[[ue,a.key]]),U(l("input",{type:"text","onUpdate:modelValue":f=>a.value=f,placeholder:"Header Value",class:"header-value"},null,8,c5),[[ue,a.value]])]))),128))])],512),[[Xs,o.activeTab==="headers"]]),U(l("div",u5,[o.requestMethod==="POST"?(S(),T("div",f5,[l("div",d5,[t[63]||(t[63]=l("label",{for:"request-body"},"请求体 JSON:",-1)),l("button",{class:"btn",onClick:t[27]||(t[27]=(...a)=>r.validateRequestJson&&r.validateRequestJson(...a))},"检验JSON"),t[64]||(t[64]=l("span",{class:"body-help-label"},"请按照JSON格式输入, {prompt}和{random}分别指代提示词和随机数",-1))]),U(l("textarea",{id:"request-body","onUpdate:modelValue":t[28]||(t[28]=a=>o.requestBody=a),class:"request-body-text",spellcheck:"false",placeholder:'{"prompt": "{prompt}", "seed": "{random}"}'},null,512),[[ue,o.requestBody]])])):(S(),T("div",g5," GET 请求没有请求体 "))],512),[[Xs,o.activeTab==="body"]]),U(l("div",h5,[l("div",m5,[t[65]||(t[65]=l("label",{for:"json-path"},"JSON路径:",-1)),U(l("input",{id:"json-path",type:"text","onUpdate:modelValue":t[29]||(t[29]=a=>o.jsonPath=a)},null,512),[[ue,o.jsonPath]]),t[66]||(t[66]=l("label",{for:"parse-entry",class:"parse-label"},"解析响应:",-1)),U(l("input",{id:"parse-entry",type:"text","onUpdate:modelValue":t[30]||(t[30]=a=>o.parse=a)},null,512),[[ue,o.parse]])]),l("div",p5,[t[70]||(t[70]=l("h3",null,"响应条件",-1)),l("div",y5,[t[67]||(t[67]=l("label",{for:"success-condition"},"成功条件:",-1)),U(l("input",{id:"success-condition",type:"text","onUpdate:modelValue":t[31]||(t[31]=a=>o.successCondition=a)},null,512),[[ue,o.successCondition]])]),l("div",b5,[t[68]||(t[68]=l("label",{for:"fail-condition"},"失败条件:",-1)),U(l("input",{id:"fail-condition",type:"text","onUpdate:modelValue":t[32]||(t[32]=a=>o.failCondition=a)},null,512),[[ue,o.failCondition]])]),l("div",v5,[t[69]||(t[69]=l("label",{for:"forbid-condition"},"违禁条件:",-1)),U(l("input",{id:"forbid-condition",type:"text","onUpdate:modelValue":t[33]||(t[33]=a=>o.forbidCondition=a)},null,512),[[ue,o.forbidCondition]])])])],512),[[Xs,o.activeTab==="response"]])])]),l("div",w5,[l("button",{class:"btn accent character-background-config",onClick:t[34]||(t[34]=(...a)=>r.openCharacterBackgroundSettings&&r.openCharacterBackgroundSettings(...a))},t[71]||(t[71]=[l("i",{class:"fas fa-cog"},null,-1),te(" 人物与背景绘画设置 ")])),l("button",{class:"btn save-button accent",onClick:t[35]||(t[35]=(...a)=>r.saveCurrentConfig&&r.saveCurrentConfig(...a))},t[72]||(t[72]=[l("i",{class:"fas fa-save"},null,-1),te(" 保存配置 ")]))]),o.showCharacterBackgroundDialog?(S(),T("div",{key:0,class:"modal",onClick:t[37]||(t[37]=ft(a=>o.showCharacterBackgroundDialog=!1,["self"]))},[l("div",_5,[l("div",C5,[t[73]||(t[73]=l("h2",null,"人物与背景绘画设置",-1)),l("button",{class:"close-btn",onClick:t[36]||(t[36]=a=>o.showCharacterBackgroundDialog=!1)},"×")]),l("div",$5,[q(i)])])])):ge("",!0),o.notification.show?(S(),T("div",{key:1,class:ie(["notification",o.notification.type])},F(o.notification.message),3)):ge("",!0)])}const S5=Be(w6,[["render",k5],["__scopeId","data-v-f94dd480"]]);Object.defineProperty(String.prototype,"isDigit",{get:function(){return/^\d+$/.test(this)}});function x5(e=10){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let s="";for(let n=0;n<e;n++)s+=t.charAt(Math.floor(Math.random()*t.length));return`${s}@nqmo.com`}async function Zf(e){try{const t=`https://mailproxy.qqframe.cn/zh/mail/${e}`,s=await fetch(t,{credentials:"include"});if(s.status>=300&&s.status<400)return console.log(`Redirect status code ${s.status}, skipping.`),null;if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const n=s.headers.get("xx-set-cookie");if(n){const o=/auth_token=([^;]+)/.exec(n);return o?o[1]:(console.log("auth_token not found in cookie"),null)}else return console.log("set-cookie header not found in response"),null}catch(t){return console.error("Request error:",t),null}}async function T5(e){const t=await Zf(e);if(!t)return console.log("Failed to get token"),null;try{const s=`https://mailproxy.qqframe.cn/api/api/v1/mailbox/${e}`,n={Authorization:`bearer ${t}`},o=await fetch(s,{headers:n});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const r=await o.json();return Array.isArray(r)?r.map(i=>i.id):(console.log("Email data format incorrect:",r),[])}catch(s){return console.error("Failed to listen for emails:",s),[]}}async function I5(e,t){const s=await Zf(e);if(!s)return null;try{const n=`https://mailproxy.qqframe.cn/api/api/v1/mailbox/${e}/${t}`,o={Authorization:`bearer ${s}`},r=await fetch(n,{headers:o});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const a=(await r.json()).body.text,c=/\d{6}/.exec(a);return c?c[0]:null}catch(n){return console.error("Failed to read email:",n),null}}async function M5(e){let t=new Set,s=0;const n=15;for(;s<n;){const o=await T5(e);if(o===null)return console.log("Token expired, stopping monitoring"),null;const r=new Set(o),i=[...r].filter(a=>!t.has(a));if(i.length>0){const a=i[0],c=await I5(e,a);if(c)return c;console.log("Failed to read email content")}t=r,await new Promise(a=>setTimeout(a,2e3)),s++}return console.log("Monitor timeout - no verification code received"),null}async function P5(e){try{const o=await fetch("https://auth.acedata.cloud/api/v1/email-code/",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({template:"118462",receiver:e})});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return o.status}catch(t){throw console.error("Failed to send code:",t),t}}async function A5(e){try{const t="https://api.acedata.cloud/captcha/token/hcaptcha",s={accept:"application/json",authorization:`Bearer ${e}`,"content-type":"application/json"},o=await fetch(t,{method:"POST",headers:s,body:JSON.stringify({website_key:"663c73ac-ca1c-42b0-9cca-45de991ad32c",website_url:"https://auth.acedata.cloud"})});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const r=await o.json();return console.log("key获取成功"),r.token}catch(t){throw console.error("Failed to get hCaptcha token:",t),t}}async function E5(e,t,s){try{const i=await fetch("https://auth.acedata.cloud/api/v1/users/",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({email:e,email_code:t,password:"srtgstr",captcha:s})});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return await i.json()}catch(n){throw console.error("Failed to register:",n),n}}async function O5(e,t){try{const r=await fetch("https://auth.acedata.cloud/api/v1/auth/login/",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const i=await r.json();return[i.access_token,i.user_id]}catch(s){throw console.error("Failed to login:",s),s}}async function Kl(e,t,s){try{const n="https://platform.acedata.cloud/api/v1/applications/",o={service_id:s},r={Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${e}`,"x-user-id":t},i=await fetch(n,{method:"POST",headers:r,body:JSON.stringify(o)});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const c=(await i.json()).id,d=await fetch("https://platform.acedata.cloud/api/v1/credentials/",{method:"POST",headers:r,body:JSON.stringify({application_id:c})});if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);const g=(await d.json()).id,m="https://platform.acedata.cloud/api/v1/credentials/",y=new URLSearchParams({ordering:"-created_at",limit:"10",offset:"0",user_id:t,application_id:c}),p=await fetch(`${m}?${y.toString()}`,{headers:r});if(!p.ok)throw new Error(`HTTP error! status: ${p.status}`);return[(await p.json()).items[0].token,c]}catch(n){throw console.error("Failed to request cap key:",n),n}}async function L5(e,t){try{const s="https://platform.acedata.cloud/api/v1/platform-tokens/",n={Accept:"application/json","Content-Type":"application/json",authorization:`Bearer ${e}`,"x-user-id":t},o=await fetch(s,{method:"POST",headers:n,body:JSON.stringify({})});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return(await o.json()).token}catch(s){throw console.error("Failed to get platform key:",s),s}}async function zn(e,t){try{const s=`https://platform.acedata.cloud/api/v1/applications/${t}`,n={accept:"application/json",authorization:`Bearer ${e}`},o=await fetch(s,{headers:n});return o.ok?(await o.json()).remaining_amount:"0"}catch(s){return console.error("Failed to get remaining credits:",s),"0"}}async function N5(e){try{const t=await A5(e),s=x5();console.log(`Generated email address: ${s}`),await P5(s);let n="";for(let d=0;d<30;d++){const h=await M5(s);if(h===null){console.log("Token expired, terminating");break}if(h){n=h;break}await new Promise(g=>setTimeout(g,2e3))}if(!n)return console.log("No verification code received"),["error","","","","",""];console.log(`Verification code: ${n}`),await E5(s,n,t);const[o,r]=await O5(s,"srtgstr"),[i,a]=await Kl(o,r,"018c653e-4f1b-433f-82f9-732ef2767040"),[c,f]=await Kl(o,r,"f2b646d8-3cfd-46ef-969a-1ea9eebde329"),u=await L5(o,r);return["success",i,a,c,f,u]}catch(t){return console.error("Error in get_all_keys:",t),["error","","","","",""]}}async function Bn(e){try{const t=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");t.AI音乐||(t.AI音乐={}),t.AI音乐.tokenpool||(t.AI音乐.tokenpool={music_token_list:[],verify_token_list:[]});const s=t.AI音乐.tokenpool.verify_token_list||[],n=t.AI音乐.tokenpool.music_token_list||[];let o=null;if(s.length>0){const g=[...s];for(;g.length>0;){const m=Math.floor(Math.random()*g.length),y=g[m];try{const p=y.capkey,b=y.platformkey,w=y.capid;if(parseFloat(await zn(b,w))<.016){g.splice(m,1);const k=s.findIndex($=>$.capkey===y.capkey&&$.platformkey===y.platformkey&&$.capid===y.capid);k!==-1&&(s.splice(k,1),t.AI音乐.tokenpool.verify_token_list=s,localStorage.setItem("aiGalgameConfig",JSON.stringify(t)))}else{o=p;break}}catch(p){console.error("Error validating token:",p),g.splice(m,1)}}}if(!o&&(o=t.AI音乐.tokenpool.initial_verify_token,!o))return"error";const[r,i,a,c,f,u]=await N5(o);if(r==="error")return"error";const d={platformkey:u,sunokey:c,sunoid:f};n.push(d),t.AI音乐.tokenpool.music_token_list=n;const h={platformkey:u,capkey:i,capid:a};return s.push(h),t.AI音乐.tokenpool.verify_token_list=s,localStorage.setItem("aiGalgameConfig",JSON.stringify(t)),"success"}catch(t){return console.error("Error in gettoken:",t),"error"}}async function R5(e){console.log(`Starting to clear invalid ${e} tokens...`);const t=Date.now();try{const s=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");if(!s.AI音乐||!s.AI音乐.tokenpool)return"success";const n=`${e}_token_list`,o=s.AI音乐.tokenpool[n]||[];if(!Array.isArray(o))return console.error(`Expected list for ${n} but got: ${typeof o}`),"success";const r=[];let i=0;const a=o.length;for(let f=0;f<o.length;f++){const u=o[f];if(e==="music"){const d=u.platformkey,h=u.sunoid;if(!d||!h){i++,console.log(`${f+1}/${a} Warning: music token missing platformkey or sunoid, removing.`);continue}try{const g=await zn(d,h),m=parseFloat(g);m<.58?(console.log(`${f+1}/${a} Invalid: remain=${m.toFixed(4)} < 0.58`),i++):(r.push(u),console.log(`${f+1}/${a} Valid: remain=${m.toFixed(4)} >= 0.58`))}catch(g){console.error(`${f+1}/${a} Error: Validation failed:`,g),r.push(u);break}}else if(e==="verify"){const d=u.platformkey,h=u.capid;if(!d||!h){i++,console.log(`${f+1}/${a} Warning: verify token missing platformkey or capid, removing.`);continue}try{const g=await zn(d,h),m=parseFloat(g);m<.016?(console.log(`${f+1}/${a} Invalid: remain=${m.toFixed(4)} < 0.016`),i++):(r.push(u),console.log(`${f+1}/${a} Valid: remain=${m.toFixed(4)} >= 0.016`))}catch(g){console.error(`${f+1}/${a} Error: Validation failed:`,g),r.push(u);break}}else return console.error(`Invalid token type: ${e}`),"success";f<o.length-1&&await new Promise(d=>setTimeout(d,1e3))}s.AI音乐.tokenpool[n]=r,localStorage.setItem("aiGalgameConfig",JSON.stringify(s));const c=(Date.now()-t)/1e3;return console.log(`Cleared invalid ${e} tokens. Total=${a}, Invalid=${i}, Duration=${c.toFixed(2)}s`),"success"}catch(s){return console.error(`Error clearing ${e} tokens:`,s),"error"}}async function ed(){var e,t;try{const s=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");if(!s.AI音乐||!s.AI音乐.tokenpool)return((e=s.AI音乐)==null?void 0:e.api_key)||"";const n=s.AI音乐.tokenpool.music_token_list||[];if(n.length>0){const o=[...n];for(;o.length>0;){const r=Math.floor(Math.random()*o.length),i=o[r];try{const a=i.sunokey,c=i.platformkey,f=i.sunoid;if(parseFloat(await zn(c,f))<.58){o.splice(r,1);const d=n.findIndex(h=>h.sunokey===i.sunokey&&h.platformkey===i.platformkey&&h.sunoid===i.sunoid);d!==-1&&(n.splice(d,1),s.AI音乐.tokenpool.music_token_list=n,localStorage.setItem("aiGalgameConfig",JSON.stringify(s)))}else return console.log("Successfully got valid sunokey"),a}catch(a){console.error("Error validating music token:",a),o.splice(r,1)}}}return((t=s.AI音乐)==null?void 0:t.api_key)||""}catch(s){return console.error("Error getting music key:",s),""}}function td(e){const t=e.indexOf("{"),s=e.lastIndexOf("}");if(t===-1||s===-1||t>=s)return console.warn("JSON extraction failed: No valid JSON structure found."),"error";const n=e.substring(t,s+1);try{const o=JSON.parse(n);return console.log("JSON extracted successfully:",o),o}catch(o){return console.error("JSON parsing failed:",o),"error"}}function sd(){const e=localStorage.getItem("aiGalgameConfig");if(e)try{const t=JSON.parse(e);return console.log("Config loaded from localStorage:",t),t.剧情=t.剧情||{},t.AI音乐=t.AI音乐||{},t}catch(t){return console.error("Failed to parse config from localStorage:",t),{剧情:{},AI音乐:{}}}return console.log("No config found in localStorage, using default."),{剧情:{},AI音乐:{}}}async function D5(e){var w,v,k,$,I,R;e("加载配置...");const t=sd(),s=((w=t.剧情)==null?void 0:w.story_title)||"",n=(v=t.AI音乐)==null?void 0:v.base_url;if(!n){const O="生成音乐失败：AI音乐 base_url 未配置。";return e(O),console.error(O),O}const o=`/data/${s}/music`,i=`${o}/background`;e("获取音乐API Key...");const a=await ed();if(!a||a==="MOCK_MUSIC_API_KEY"){const O="生成音乐失败：音乐API Key 未配置或获取失败。";return e(O),console.error(O),O}const c={Authorization:`Bearer ${a}`,Accept:"application/json","Content-Type":"application/json"};e("处理生成音乐的Prompt...");const[f,u]=await ct("背景音乐生成"),d=Math.floor(Math.random()*1e5)+1;let h="error",g=0;const m=5;for(e("调用LLM生成音乐信息...");h==="error"&&g<m;){g++,e(`调用LLM (尝试 ${g}/${m})...`);try{const O=await Ms(f,u,"background_music",d);if(O==="error"){console.warn("LLM returned 'error'. Retrying..."),await new Promise(N=>setTimeout(N,1e3));continue}else if(O==="over_times"){const N="生成音乐失败：LLM调用达到最大尝试次数。";return e(N),console.error(N),N}const E=td(O);E!=="error"&&typeof E=="object"&&E!==null&&"title"in E&&"prompt"in E?(h=E,console.log("LLM response structure valid."),(typeof h.title!="string"||typeof h.prompt!="string")&&(console.warn("LLM response has incorrect type for title or prompt. Retrying..."),h="error")):(console.warn("LLM response has invalid structure. Retrying..."),await new Promise(N=>setTimeout(N,1e3)),h="error")}catch(O){console.error("LLM call failed:",O),e(`LLM调用失败: ${O.message}. Retrying...`),await new Promise(E=>setTimeout(E,1e3)),h="error"}}if(st(d),h==="error"){const O=`生成音乐失败：无法从LLM获取有效音乐信息 (尝试 ${m} 次失败)。`;return e(O),console.error(O),O}const y=h.title,b={action:"generate",model:"chirp-v4",instrumental:!0,custom:!1,prompt:h.prompt,title:y};console.log("开始调用音乐API生成背景音乐..."),e("调用音乐API生成背景音乐...");try{const O=await fetch(n,{method:"POST",headers:c,body:JSON.stringify(b)});if(!O.ok){const G=await O.text();throw new Error(`音乐API响应错误: ${O.status} ${O.statusText} - ${G}`)}const E=await O.json();if(console.log("音乐API响应:",E),!E||!E.data||!Array.isArray(E.data)||E.data.length<2)throw new Error("音乐API返回数据结构无效。");const N=(k=E.data[0])==null?void 0:k.audio_url,W=($=E.data[1])==null?void 0:$.audio_url,M=(I=E.data[0])==null?void 0:I.video_url,z=(R=E.data[1])==null?void 0:R.video_url;if(!N||!W)throw new Error("音乐API返回数据缺少音频URL。");await Lt(o).catch(G=>console.warn("Failed to ensure music directory exists:",G)),e("下载并保存音乐文件 1..."),console.log(`下载音频 1: ${N}`);try{const G=await fetch(N);if(!G.ok)throw new Error(`下载音频 1 失败: ${G.status}`);const pe=await G.blob();await xe(`${i}.mp3`,pe),console.log(`文件 ${i}.mp3 已下载并保存。`)}catch(G){console.error("下载或保存音频 1 失败:",G),e(`下载或保存音频 1 失败: ${G.message}`)}e("下载并保存音乐文件 2..."),console.log(`下载音频 2: ${W}`);try{const G=await fetch(W);if(!G.ok)throw new Error(`下载音频 2 失败: ${G.status}`);const pe=await G.blob();await xe(`${i}1.mp3`,pe),console.log(`文件 ${i}1.mp3 已下载并保存。`)}catch(G){console.error("下载或保存音频 2 失败:",G),e(`下载或保存音频 2 失败: ${G.message}`)}if(M){e("下载并保存视频文件 1..."),console.log(`下载视频 1 (可选): ${M}`);try{const G=await fetch(M);if(G.ok){const pe=await G.blob();await xe(`${i}.mp4`,pe),console.log(`文件 ${i}.mp4 已下载并保存。`)}else console.warn(`下载视频 1 失败: ${G.status}`)}catch(G){console.warn("下载或保存视频 1 失败:",G)}}if(z){e("下载并保存视频文件 2..."),console.log(`下载视频 2 (可选): ${z}`);try{const G=await fetch(z);if(G.ok){const pe=await G.blob();await xe(`${i}1.mp4`,pe),console.log(`文件 ${i}1.mp4 已下载并保存。`)}else console.warn(`下载视频 2 失败: ${G.status}`)}catch(G){console.warn("下载或保存视频 2 失败:",G)}}e("背景音乐生成成功！"),console.log("背景音乐生成成功！")}catch(O){const E=`音乐生成失败: ${O.message}`;return e(E),console.error(E),E}}async function F5(e,t){var $,I,R,O,E,N,W;t("加载配置...");const s=sd(),n=(($=s.剧情)==null?void 0:$.story_title)||"",o=(I=s.AI音乐)==null?void 0:I.base_url;if((R=s.剧情)==null||R.language,!o){const M="生成音乐失败：AI音乐 base_url 未配置。";return t(M),console.error(M),M}const r=`/data/${n}/music`,i=`end_${e}`,a=`${r}/${i}`,c=`/data/${n}/${i}_music.json`;t("获取音乐API Key...");const f=await ed();if(!f||f==="MOCK_MUSIC_API_KEY"){const M="生成音乐失败：音乐API Key 未配置或获取失败。";return t(M),console.error(M),M}const u={Authorization:`Bearer ${f}`,Accept:"application/json","Content-Type":"application/json"};t("处理生成音乐的Prompt...");const[d,h]=await ct("结尾音乐生成"),g=Math.floor(Math.random()*1e5)+1;let m="error",y=0;const p=5;for(t("调用LLM生成音乐信息...");m==="error"&&y<p;){y++,t(`调用LLM (尝试 ${y}/${p})...`);try{const M=await Ms(d,h,"音乐",g);if(M==="error"){console.warn("LLM returned 'error'. Retrying..."),await new Promise(G=>setTimeout(G,1e3));continue}else if(M==="over_times"){const G="生成音乐失败：LLM调用达到最大尝试次数。";return t(G),console.error(G),G}const z=td(M);z!=="error"&&typeof z=="object"&&z!==null&&"title"in z&&"style"in z&&"lyrics"in z?(m=z,console.log("LLM response structure valid."),(typeof m.title!="string"||typeof m.style!="string"||typeof m.lyrics!="string")&&(console.warn("LLM response has incorrect type for title, style, or lyrics. Retrying..."),m="error")):(console.warn("LLM response has invalid structure. Retrying..."),await new Promise(G=>setTimeout(G,1e3)),m="error")}catch(M){console.error("LLM call failed:",M),t(`LLM调用失败: ${M.message}. Retrying...`),await new Promise(z=>setTimeout(z,1e3)),m="error"}}if(st(g),m==="error"){const M=`生成音乐失败：无法从LLM获取有效音乐信息 (尝试 ${p} 次失败)。`;return t(M),console.error(M),M}const b=m.title,w=m.style,k={action:"generate",model:"chirp-v4",instrumental:!1,custom:!0,lyric:m.lyrics,style:w,title:b};console.log("开始调用音乐API生成结尾音乐..."),t("调用音乐API生成结尾音乐...");try{const M=await fetch(o,{method:"POST",headers:u,body:JSON.stringify(k)});if(!M.ok){const X=await M.text();throw new Error(`音乐API响应错误: ${M.status} ${M.statusText} - ${X}`)}const z=await M.json();if(console.log("音乐API响应:",z),!z||!z.data||!Array.isArray(z.data)||z.data.length<2)throw new Error("音乐API返回数据结构无效。");const G=(O=z.data[0])==null?void 0:O.audio_url,pe=(E=z.data[1])==null?void 0:E.audio_url,$e=(N=z.data[0])==null?void 0:N.video_url,ye=(W=z.data[1])==null?void 0:W.video_url;if(!G||!pe)throw new Error("音乐API返回数据缺少音频URL。");await Lt(r).catch(X=>console.warn("Failed to ensure music directory exists:",X)),t("保存LLM原始响应 JSON...");try{const X=`/data/${n}`;await Lt(X).catch(Ee=>console.warn("Failed to ensure json directory exists:",Ee)),await xe(c,m),console.log(`LLM响应 JSON 已保存到 ${c}`)}catch(X){console.error("保存LLM响应 JSON 失败:",X),t(`保存LLM响应 JSON 失败: ${X.message}`)}t("下载并保存音乐文件 1..."),console.log(`下载音频 1: ${G}`);try{const X=await fetch(G);if(!X.ok)throw new Error(`下载音频 1 失败: ${X.status}`);const Ee=await X.blob();await xe(`${a}.mp3`,Ee),console.log(`文件 ${a}.mp3 已下载并保存。`)}catch(X){console.error("下载或保存音频 1 失败:",X),t(`下载或保存音频 1 失败: ${X.message}`)}t("下载并保存音乐文件 2..."),console.log(`下载音频 2: ${pe}`);try{const X=await fetch(pe);if(!X.ok)throw new Error(`下载音频 2 失败: ${X.status}`);const Ee=await X.blob();await xe(`${a}1.mp3`,Ee),console.log(`文件 ${a}1.mp3 已下载并保存。`)}catch(X){console.error("下载或保存音频 2 失败:",X),t(`下载或保存音频 2 失败: ${X.message}`)}if($e){t("下载并保存视频文件 1..."),console.log(`下载视频 1 (可选): ${$e}`);try{const X=await fetch($e);if(X.ok){const Ee=await X.blob();await xe(`${a}.mp4`,Ee),console.log(`文件 ${a}.mp4 已下载并保存。`)}else console.warn(`下载视频 1 失败: ${X.status}`)}catch(X){console.warn("下载或保存视频 1失败:",X)}}if(ye){t("下载并保存视频文件 2..."),console.log(`下载视频 2 (可选): ${ye}`);try{const X=await fetch(ye);if(X.ok){const Ee=await X.blob();await xe(`${a}1.mp4`,Ee),console.log(`文件 ${a}1.mp4 已下载并保存。`)}else console.warn(`下载视频 2 失败: ${X.status}`)}catch(X){console.warn("下载或保存视频 2 失败:",X)}}t("结尾音乐生成成功！"),console.log("结尾音乐生成成功！")}catch(M){const z=`音乐生成失败: ${M.message}`;return t(z),console.error(z),z}}const V5={name:"AiMusicConfig",data(){return{aiMusicSwitch:!1,aiOpeningMusicSwitch:!1,aiEndingMusicSwitch:!1,musicUrl:"",musicToken:"",showTokenManagement:!1,initialVerifyToken:"",musicTokenCount:"音乐token数: 0",verifyTokenCount:"验证token数: 0",logs:[],isProcessingMusic:!1,isProcessingVerify:!1,originalConsole:null,showMessage:!1,messageType:"success",messageContent:"",messageTimeout:null}},computed:{isProcessing(){return this.isProcessingMusic||this.isProcessingVerify}},mounted(){this.loadAiMusicConfig()},methods:{setupConsoleCapture(){this.originalConsole={log:console.log,info:console.info,warn:console.warn,error:console.error},console.log=(e,...t)=>{this.originalConsole.log(e,...t),this.captureConsoleOutput("log",e,t)},console.info=(e,...t)=>{this.originalConsole.info(e,...t),this.captureConsoleOutput("info",e,t)},console.warn=(e,...t)=>{this.originalConsole.warn(e,...t),this.captureConsoleOutput("warning",e,t)},console.error=(e,...t)=>{this.originalConsole.error(e,...t),this.captureConsoleOutput("error",e,t)}},restoreConsole(){this.originalConsole&&(console.log=this.originalConsole.log,console.info=this.originalConsole.info,console.warn=this.originalConsole.warn,console.error=this.originalConsole.error)},captureConsoleOutput(e,t,s){if(!this.showTokenManagement)return;let n=t;if(typeof t=="object")try{n=JSON.stringify(t,null,2)}catch{n=String(t)}if(s&&s.length>0)try{const o=s.map(r=>typeof r=="object"?JSON.stringify(r,null,2):String(r)).join(" ");n=`${n} ${o}`}catch{}this.logToTokenWindow(n,e)},loadAiMusicConfig(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.AI音乐&&(this.aiMusicSwitch=e.AI音乐.if_on||!1,this.aiOpeningMusicSwitch=e.AI音乐.opening_if_on||!1,this.aiEndingMusicSwitch=e.AI音乐.ending_if_on||!1,this.musicUrl=e.AI音乐.base_url||"",this.musicToken=e.AI音乐.api_key||"")}catch(e){console.error("Failed to load AI music config:",e)}},saveAiMusicSwitch(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.AI音乐||(e.AI音乐={}),e.AI音乐.if_on=this.aiMusicSwitch,e.AI音乐.opening_if_on=this.aiOpeningMusicSwitch,e.AI音乐.ending_if_on=this.aiEndingMusicSwitch,localStorage.setItem("aiGalgameConfig",JSON.stringify(e))}catch(e){console.error("Failed to save AI music switch:",e),this.showMessageBubble("error","保存配置失败")}},saveAiMusicConfig(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.AI音乐||(e.AI音乐={}),e.AI音乐.base_url=this.musicUrl,e.AI音乐.api_key=this.musicToken,localStorage.setItem("aiGalgameConfig",JSON.stringify(e)),this.showMessageBubble("success","AI音乐配置保存成功!")}catch(e){console.error("Failed to save AI music config:",e),this.showMessageBubble("error","保存配置失败")}},openTokenManagement(){this.showTokenManagement=!0,this.loadTokenManagementConfig(),this.updateTokenCounts(),this.logs=[],this.logToTokenWindow("Token管理窗口已打开","info"),this.$nextTick(()=>{this.setupConsoleCapture()})},closeTokenManagement(){this.saveInitialToken(),this.restoreConsole(),this.showTokenManagement=!1},loadTokenManagementConfig(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.AI音乐&&e.AI音乐.tokenpool&&(this.initialVerifyToken=e.AI音乐.tokenpool.initial_verify_token||"")}catch(e){console.error("Failed to load token management config:",e)}},saveInitialToken(){try{const e=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}");e.AI音乐||(e.AI音乐={}),e.AI音乐.tokenpool||(e.AI音乐.tokenpool={}),e.AI音乐.tokenpool.initial_verify_token=this.initialVerifyToken,localStorage.setItem("aiGalgameConfig",JSON.stringify(e)),this.logToTokenWindow("初始验证token已保存","success")}catch(e){console.error("Failed to save initial token:",e),this.logToTokenWindow("保存初始验证token失败","error")}},updateTokenCounts(){var e,t,s,n;try{const o=JSON.parse(localStorage.getItem("aiGalgameConfig")||"{}"),r=((t=(e=o.AI音乐)==null?void 0:e.tokenpool)==null?void 0:t.music_token_list)||[],i=((n=(s=o.AI音乐)==null?void 0:s.tokenpool)==null?void 0:n.verify_token_list)||[],a=Array.isArray(r)?r.length:0,c=Array.isArray(i)?i.length:0;this.musicTokenCount=`音乐token数: ${a}`,this.verifyTokenCount=`验证token数: ${c}`,this.logToTokenWindow(`Token数量已刷新 (音乐: ${a}, 验证: ${c})`,"info")}catch(o){console.error("Failed to update token counts:",o)}},logToTokenWindow(e,t="info"){const s=new Date,o=`[${`${s.getHours().toString().padStart(2,"0")}:${s.getMinutes().toString().padStart(2,"0")}:${s.getSeconds().toString().padStart(2,"0")}`}] ${e}`;this.logs.push({message:o,type:t}),this.logs.length>100&&this.logs.shift(),this.$nextTick(()=>{this.$refs.logContainer&&(this.$refs.logContainer.scrollTop=this.$refs.logContainer.scrollHeight)})},async runGetToken(e){this.logToTokenWindow(`开始请求获取 ${e} token...`,"info"),e==="music"?this.isProcessingMusic=!0:this.isProcessingVerify=!0;try{const t=await Bn(e);t==="success"?(this.logToTokenWindow(`获取 ${e} token 成功.`,"success"),this.updateTokenCounts()):this.logToTokenWindow(`获取 ${e} token 失败 (错误信息: ${t}).`,"error")}catch(t){console.error(`Failed to get ${e} token:`,t),this.logToTokenWindow(`获取 ${e} token 失败: ${t.message}`,"error")}finally{e==="music"?this.isProcessingMusic=!1:this.isProcessingVerify=!1}},async runClearToken(e){this.logToTokenWindow(`开始请求清除无效 ${e} token...`,"info"),e==="music"?this.isProcessingMusic=!0:this.isProcessingVerify=!0;try{const t=await R5(e);t==="success"?(this.logToTokenWindow(`清除无效 ${e} token 操作成功.`,"success"),this.updateTokenCounts()):this.logToTokenWindow(`清除无效 ${e} token 操作失败 (结果: ${t}).`,"error")}catch(t){console.error(`Failed to clear ${e} tokens:`,t),this.logToTokenWindow(`清除无效 ${e} token 失败: ${t.message}`,"error")}finally{e==="music"?this.isProcessingMusic=!1:this.isProcessingVerify=!1}},showMessageBubble(e,t){this.messageType=e,this.messageContent=t,this.showMessage=!0,this.messageTimeout&&clearTimeout(this.messageTimeout),this.messageTimeout=setTimeout(()=>{this.showMessage=!1},3e3)}},beforeUnmount(){this.restoreConsole(),this.messageTimeout&&clearTimeout(this.messageTimeout)}},U5={class:"ai-music-config-container"},j5={class:"config-panel"},z5={class:"toggle-grid"},B5={class:"toggle-row"},q5={class:"toggle-switch"},J5={class:"toggle-row"},G5={class:"toggle-switch"},W5={class:"toggle-row"},H5={class:"toggle-switch"},K5={class:"config-panel"},Q5={class:"form-group"},Y5={class:"form-group token-group"},X5={class:"action-container"},Z5={class:"modal-header"},e_={class:"modal-body"},t_={class:"top-section"},s_={class:"initial-token-section"},o_={class:"main-area"},n_={class:"pool-info"},r_={class:"info-panel"},i_={class:"token-info"},a_={class:"button-group"},l_=["disabled"],c_={key:0},u_={key:1},f_=["disabled"],d_={key:0},g_={key:1},h_={class:"token-info"},m_={class:"button-group"},p_=["disabled"],y_={key:0},b_={key:1},v_=["disabled"],w_={key:0},__={key:1},C_={class:"log-section"},$_={class:"log-container",ref:"logContainer"},k_={key:0,class:"pulse-cursor"};function S_(e,t,s,n,o,r){return S(),T("div",U5,[t[37]||(t[37]=l("div",{class:"title-section"},[l("h1",{class:"page-title"},"AI 音乐配置"),l("div",{class:"separator"})],-1)),l("div",j5,[t[26]||(t[26]=l("h2",{class:"panel-title"},"音乐生成选项",-1)),l("div",z5,[l("div",B5,[t[21]||(t[21]=l("label",{class:"toggle-label-music"},"生成背景音乐:",-1)),l("div",q5,[U(l("input",{type:"checkbox",id:"ai-music-switch","onUpdate:modelValue":t[0]||(t[0]=i=>o.aiMusicSwitch=i),onChange:t[1]||(t[1]=(...i)=>r.saveAiMusicSwitch&&r.saveAiMusicSwitch(...i))},null,544),[[Ve,o.aiMusicSwitch]]),t[20]||(t[20]=l("label",{for:"ai-music-switch",class:"toggle-label-switch"},null,-1))])]),l("div",J5,[t[23]||(t[23]=l("label",{class:"toggle-label-music"},"生成开头音乐:",-1)),l("div",G5,[U(l("input",{type:"checkbox",id:"ai-opening-music-switch","onUpdate:modelValue":t[2]||(t[2]=i=>o.aiOpeningMusicSwitch=i),onChange:t[3]||(t[3]=(...i)=>r.saveAiMusicSwitch&&r.saveAiMusicSwitch(...i))},null,544),[[Ve,o.aiOpeningMusicSwitch]]),t[22]||(t[22]=l("label",{for:"ai-opening-music-switch",class:"toggle-label-switch"},null,-1))])]),l("div",W5,[t[25]||(t[25]=l("label",{class:"toggle-label-music"},"生成结尾音乐:",-1)),l("div",H5,[U(l("input",{type:"checkbox",id:"ai-ending-music-switch","onUpdate:modelValue":t[4]||(t[4]=i=>o.aiEndingMusicSwitch=i),onChange:t[5]||(t[5]=(...i)=>r.saveAiMusicSwitch&&r.saveAiMusicSwitch(...i))},null,544),[[Ve,o.aiEndingMusicSwitch]]),t[24]||(t[24]=l("label",{for:"ai-ending-music-switch",class:"toggle-label-switch"},null,-1))])])])]),l("div",K5,[t[29]||(t[29]=l("h2",{class:"panel-title"},"API 配置",-1)),l("div",Q5,[t[27]||(t[27]=l("label",null,"音乐 URL:",-1)),U(l("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=i=>o.musicUrl=i),class:"text-input",placeholder:"输入音乐生成的API端点URL"},null,512),[[ue,o.musicUrl]])]),l("div",Y5,[t[28]||(t[28]=l("label",null,"音乐 Token:",-1)),U(l("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=i=>o.musicToken=i),class:"text-input",placeholder:"输入API Token"},null,512),[[ue,o.musicToken]]),l("button",{class:"btn btn-outline",onClick:t[8]||(t[8]=(...i)=>r.openTokenManagement&&r.openTokenManagement(...i))}," Token管理 ")])]),l("div",X5,[l("button",{class:"btn btn-accent",onClick:t[9]||(t[9]=(...i)=>r.saveAiMusicConfig&&r.saveAiMusicConfig(...i))},t[30]||(t[30]=[l("i",{class:"icon"},"💾",-1),te(" 保存配置 ")]))]),o.showTokenManagement?(S(),T("div",{key:0,class:"modal-overlay",onClick:t[19]||(t[19]=(...i)=>r.closeTokenManagement&&r.closeTokenManagement(...i))},[l("div",{class:"modal-container token-management-modal",onClick:t[18]||(t[18]=ft(()=>{},["stop"]))},[l("div",Z5,[t[31]||(t[31]=l("h2",null,"Token 管理",-1)),l("button",{class:"close-button",onClick:t[10]||(t[10]=(...i)=>r.closeTokenManagement&&r.closeTokenManagement(...i))},"×")]),l("div",e_,[l("div",t_,[l("div",s_,[t[32]||(t[32]=l("label",null,"初始验证token:",-1)),U(l("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=i=>o.initialVerifyToken=i),class:"text-input",onBlur:t[12]||(t[12]=(...i)=>r.saveInitialToken&&r.saveInitialToken(...i)),onKeyup:t[13]||(t[13]=qo((...i)=>r.saveInitialToken&&r.saveInitialToken(...i),["enter"]))},null,544),[[ue,o.initialVerifyToken]])])]),t[36]||(t[36]=l("div",{class:"separator"},null,-1)),l("div",o_,[l("div",n_,[l("div",r_,[t[33]||(t[33]=l("h3",null,"token池信息",-1)),l("div",i_,[l("p",null,F(o.musicTokenCount),1),l("div",a_,[l("button",{class:"btn btn-primary",disabled:o.isProcessingMusic,onClick:t[14]||(t[14]=i=>r.runGetToken("music"))},[o.isProcessingMusic?(S(),T("span",c_,"处理中...")):(S(),T("span",u_,"获取token"))],8,l_),l("button",{class:"btn btn-primary",disabled:o.isProcessingMusic,onClick:t[15]||(t[15]=i=>r.runClearToken("music"))},[o.isProcessingMusic?(S(),T("span",d_,"处理中...")):(S(),T("span",g_,"清除无效token"))],8,f_)])]),t[34]||(t[34]=l("div",{class:"separator token-separator"},null,-1)),l("div",h_,[l("p",null,F(o.verifyTokenCount),1),l("div",m_,[l("button",{class:"btn btn-primary",disabled:o.isProcessingVerify,onClick:t[16]||(t[16]=i=>r.runGetToken("verify"))},[o.isProcessingVerify?(S(),T("span",y_,"处理中...")):(S(),T("span",b_,"获取token"))],8,p_),l("button",{class:"btn btn-primary",disabled:o.isProcessingVerify,onClick:t[17]||(t[17]=i=>r.runClearToken("verify"))},[o.isProcessingVerify?(S(),T("span",w_,"处理中...")):(S(),T("span",__,"清除无效token"))],8,v_)])])])]),l("div",C_,[t[35]||(t[35]=l("h3",null,"日志",-1)),l("div",$_,[(S(!0),T(ve,null,Ae(o.logs,(i,a)=>(S(),T("div",{key:a,class:ie(`log-entry ${i.type}`)},F(i.message),3))),128)),r.isProcessing?(S(),T("div",k_)):ge("",!0)],512)])])])])])):ge("",!0),l("div",{class:ie(["message-bubble",{active:o.showMessage,success:o.messageType==="success",error:o.messageType==="error"}])},F(o.messageContent),3)])}const x_=Be(V5,[["render",S_],["__scopeId","data-v-efa424c9"]]);function $i(){try{const e=localStorage.getItem("aiGalgameConfig");return e?JSON.parse(e):(console.error("配置文件未找到"),null)}catch(e){return console.error("加载配置失败:",e),null}}function T_(e){try{localStorage.setItem("aiGalgameConfig",JSON.stringify(e)),console.log("Config saved to localStorage.")}catch(t){console.error("Failed to save config to localStorage:",t)}}async function I_(e,t,s,n,o,r,i){var y;i(`  - 生成音频 ${n}.wav ...`);const a=o.SOVITS,c=a==null?void 0:a.sovitsURL,f=c&&c.trim()!==""?c.trim():"http://127.0.0.1:9880",d=(a==null?void 0:a.useLocalProxy)===!0?Ci:fetch;console.log(`Using SOVITS base URL: ${f}`),console.log(`Using fetch method: ${d===Ci?"proxyfetch":"fetch"}`);const h=a==null?void 0:a[`model${e}`],g=a==null?void 0:a[`path${e}`],m=a==null?void 0:a[`text${e}`];if(!h||!g||!m)return console.error(`SOVITS config missing for nameId ${e}`),i(`  - SOVITS 配置缺失 nameId ${e}`),"error";try{if(s===0){console.log(`  - Setting SOVITS weights for model: ${h}`),i(`  - 设置模型权重: ${h}`);const E=`${f}/set_gpt_weights?weights_path=GPT_weights_v2/${h}.ckpt`,N=`${f}/set_sovits_weights?weights_path=SoVITS_weights_v2/${h}.pth`,W=await d(E);W.ok?console.log("  - GPT weights set successfully."):console.error("Failed to set GPT weights:",W.statusText);const M=await d(N);M.ok?console.log("  - SoVITS weights set successfully."):console.error("Failed to set SoVITS weights:",M.statusText)}let p="zh";const b=(y=o.剧情)==null?void 0:y.language;b==="英文"?p="en":b==="日文"&&(p="ja"),console.log(`  - Using language: ${p}`);const w=encodeURIComponent(t),v=encodeURIComponent(m),k=encodeURIComponent(g),$=`${f}/tts?text=${w}&text_lang=${p}&ref_audio_path=${k}&prompt_lang=zh&prompt_text=${v}&text_split_method=cut5&batch_size=1&media_type=wav&streaming_mode=false`;console.log(`  - Calling SOVITS TTS: ${$}`);const I=await d($);if(!I.ok){const E=await I.text();throw new Error(`SOVITS TTS API response error: ${I.status} ${I.statusText} - ${E}`)}const R=await I.blob(),O=`${r}/${n}.wav`;return console.log(`  - Saving audio to IndexedDB: ${O}`),await xe(O,R),console.log(`  - Audio saved successfully: ${O}`),i(`  - 音频 ${n}.wav 保存成功`),"ok"}catch(p){return console.error(`Error generating audio for ${n}:`,p),i(`  - 音频 ${n}.wav 生成失败: ${p.message}`),"error"}}async function qn(e,t=console.log){var p,b,w;t(`开始生成故事 ${e} 的语音...`);const s=$i();if(!s){const v="生成语音失败：无法加载配置。";return t(v),console.error(v),v}const n=(p=s.剧情)==null?void 0:p.story_title;if(!n){const v="生成语音失败：配置中 '剧情.story_title' 未设置。";return t(v),console.error(v),v}const o=s.SOVITS;if(!o){const v="生成语音失败：配置中 'SOVITS' 部分未找到。";return t(v),console.error(v),v}!o.model1||!o.path1||o.text1;const r=`/data/${n}`,i=`${r}/audio/${e}`,a=`${r}/story/${e}.json`,c=`${r}/character.json`;t(`确保音频目录存在: ${i}`);try{await Lt(i),console.log(`Ensured audio directory exists: ${i}`)}catch(v){console.warn(`Failed to create audio directory ${i}. writeFile might create parents anyway:`,v)}let f,u;t(`读取故事文件: ${a}`);try{f=await Je(a),console.log(`Story data read successfully from ${a}`)}catch(v){const k=`读取故事文件失败: ${a}. 错误: ${v.message}`;return t(k),console.error(k),k}t(`读取角色文件: ${c}`);try{u=await Je(c),console.log(`Character data read successfully from ${c}`)}catch(v){const k=`读取角色文件失败: ${c}. 错误: ${v.message}`;return t(k),console.error(k),k}if(!f||!Array.isArray(f.conversations)){const v=`故事数据无效或缺少 'conversations' 列表在 ${a}`;return t(v),console.error(v),v}if(!u||!Array.isArray(u)){const v=`角色数据无效或不是数组在 ${c}`;return t(v),console.error(v),v}let d=1,h=null,g=0;const m=f.conversations.filter(v=>v.id>=d);if(m.length===0){const v=`没有找到 ID >= ${d} 的对话需要生成音频。`;return t(v),console.log(v),"ok"}t(`找到 ${m.length} 个对话需要生成音频 (从 ID ${d} 开始)...`);for(const v of m){const k=v.character,$=v.text,I=v.id,R=`${i}/${I}.wav`;if((await Cs(R).catch(()=>({exists:!1}))).exists){console.log(`Audio file already exists for conversation ID: ${I}. Skipping.`),t(`跳过 ID ${I}: 音频文件已存在`),g++;const ye=u.find(X=>X.name===k);if(ye){const X=u.indexOf(ye)+1;h=(b=s.SOVITS)==null?void 0:b[`model${X}`]}else h=null;continue}if(!k){console.log(`Skipping conversation ID ${I}: character name is empty.`),t(`跳过 ID ${I}: 角色名为空`);continue}let W=$.replace(/[\(（].*?[\)）]/g,"").replace(/ /g,"，").replace(/\n/g,"。");for(;W.startsWith("，")||W.startsWith("。");)W=W.substring(1);if(!W.trim()){console.log(`Skipping conversation ID ${I}: text is empty after processing.`),t(`跳过 ID ${I}: 文本处理后为空`);continue}let M=6;const z=u.find(ye=>ye.name===k);z?M=u.indexOf(z)+1:console.warn(`Character "${k}" not found in character data for conversation ID ${I}. Using default placeId ${M}.`);const G=(w=s.SOVITS)==null?void 0:w[`model${M}`];if(!G){console.warn(`SOVITS config missing model for placeId ${M} (character "${k}") for conversation ID ${I}. Skipping.`),t(`跳过 ID ${I}: 角色模型未配置`);continue}let pe=0;h!==null&&G===h&&(pe=1),console.log(`Processing conversation ID ${I} for character ${k} (placeId ${M}) using model ${G}`),t(`处理 ID ${I} (${g+1}/${m.length}) 角色: ${k}`),await I_(M,W,pe,String(I),s,i,t)==="ok"?(g++,h=G):console.error(`Failed to generate audio for conversation ID ${I}. Continuing to next.`)}const y=`完成故事 ${e} 的语音生成。处理了 ${g} 个对话。`;return t(y),console.log(y),"ok"}const M_={class:"voice-generator-test"},P_={class:"config-section"},A_={class:"config-hint"},E_={class:"generator-section"},O_=["disabled"],L_={class:"status-section"},N_=["innerHTML"],R_={key:0,class:"error-message"},D_={key:0,class:"file-list-section"},F_=["disabled"],V_={key:0},U_={__name:"Snapshot",setup(e){const t=Re("MyNewStory"),s=Re("中文"),n=Re(0),o=Re("等待操作..."),r=Re(""),i=Re(!1),a=Re([]),c=Re(!0),f=()=>{var y,p;const m=$i();t.value=((y=m.剧情)==null?void 0:y.story_title)||"MyNewStory",s.value=((p=m.剧情)==null?void 0:p.language)||"中文"},u=()=>{const m=$i();m.剧情=m.剧情||{},m.剧情.story_title=t.value,m.剧情.language=s.value,T_(m)},d=m=>{o.value+=(o.value==="等待操作..."?"":"<br>")+m,(m.includes("失败")||m.includes("错误:"))&&(r.value=m)},h=async()=>{if(!t.value||!n.value){alert("请输入故事标题和故事 ID");return}i.value=!0,r.value="",o.value="开始生成语音...";try{const m=await qn(n.value,d);m!=="ok"?(r.value=m,o.value+=`<br>语音生成失败: ${m}`):(await new Promise(y=>setTimeout(y,500)),g())}catch(m){console.error("Error during voice generation:",m);const y=`发生未预期错误: ${m.message}`;r.value=y,o.value+="<br>"+y}finally{i.value=!1}},g=async()=>{if(!t.value||!n.value){a.value=[],c.value=!1;return}const m=`/data/${t.value}/audio/${n.value}`;console.log(`Listing files in ${m}`),d(`尝试列出文件: ${m}`);try{const y=await Cs(m).catch(()=>({exists:!1}));if(!y.exists||!y.isFolder){console.warn(`Directory ${m} does not exist or is not a folder.`),a.value=[],c.value=!1,d(`目录不存在或为空: ${m}`);return}const p=await sf(m);a.value=p,c.value=!1,console.log(`Files in ${m}:`,p),d(`列出文件成功，共 ${p.length} 个`)}catch(y){console.error(`Failed to list directory ${m}:`,y),a.value=[],c.value=!1,r.value=`列出文件失败: ${y.message}`,o.value+="<br>列出文件失败"}};return Zo(()=>{f(),t.value&&n.value?g():c.value=!1}),bs([t,n],([m,y],[p,b])=>{m&&y&&(m!==p||y!==b)?g():(!m||!y)&&(a.value=[],c.value=!1)}),(m,y)=>(S(),T("div",M_,[y[11]||(y[11]=l("h1",null,"AI 语音生成测试 (SOVITS)",-1)),l("div",P_,[y[6]||(y[6]=l("h2",null,"配置",-1)),l("div",null,[y[3]||(y[3]=l("label",{for:"storyTitle"},"故事标题:",-1)),U(l("input",{id:"storyTitle","onUpdate:modelValue":y[0]||(y[0]=p=>t.value=p),onInput:u},null,544),[[ue,t.value]]),l("p",A_,"语音和角色文件应位于 /data/"+F(t.value)+"/story/ 和 /data/"+F(t.value)+"/character.json",1)]),l("div",null,[y[5]||(y[5]=l("label",{for:"themeLanguage"},"主题语言 (影响SOVITS Lang参数):",-1)),U(l("select",{id:"themeLanguage","onUpdate:modelValue":y[1]||(y[1]=p=>s.value=p),onChange:u},y[4]||(y[4]=[l("option",{value:"中文"},"中文",-1),l("option",{value:"英文"},"英文",-1),l("option",{value:"日文"},"日文",-1)]),544),[[Ue,s.value]])]),y[7]||(y[7]=l("p",{class:"config-hint"},`SOVITS模型配置 (modelX, pathX, textX) 需要在浏览器的 localStorage 中手动编辑 'aiGalgameConfig' 的 "SOVITS" 部分。`,-1))]),l("div",E_,[y[9]||(y[9]=l("h2",null,"生成语音",-1)),l("div",null,[y[8]||(y[8]=l("label",{for:"storyId"},"故事 Segment ID:",-1)),U(l("input",{id:"storyId","onUpdate:modelValue":y[2]||(y[2]=p=>n.value=p)},null,512),[[ue,n.value]])]),l("button",{onClick:h,disabled:i.value||!n.value||!t.value},"生成语音",8,O_)]),l("div",L_,[y[10]||(y[10]=l("h2",null,"状态",-1)),l("p",{innerHTML:o.value},null,8,N_),r.value?(S(),T("div",R_,F(r.value),1)):ge("",!0)]),t.value&&n.value?(S(),T("div",D_,[l("h2",null,"生成的文件 (IndexedDB /data/"+F(t.value)+"/audio/"+F(n.value)+")",1),l("button",{onClick:g,disabled:i.value||!t.value||!n.value},"刷新文件列表",8,F_),l("ul",null,[(S(!0),T(ve,null,Ae(a.value,p=>(S(),T("li",{key:p.path},F(p.name)+" ("+F(p.isFolder?"文件夹":"文件")+") - "+F(p.path),1))),128)),a.value.length===0&&!c.value?(S(),T("li",V_," 暂无文件或目录不存在。 ")):ge("",!0)])])):ge("",!0)]))}},j_=Be(U_,[["__scopeId","data-v-b3a93f72"]]),z_={name:"Logs",data(){return{logs:[],filteredLogs:[],searchQuery:"",filters:{log:!0,info:!0,warn:!0,error:!0},isLoading:!0,currentPage:1,logsPerPage:50,pageCount:1}},methods:{async loadLogs(){try{if(this.isLoading=!0,window.getStoredLogs){const e=await window.getStoredLogs();this.logs=e||[],this.applyFiltersAndPagination()}else console.error("getStoredLogs function not found"),this.logs=[],this.applyFiltersAndPagination()}catch(e){console.error("Error loading logs:",e),this.logs=[],this.applyFiltersAndPagination()}finally{this.isLoading=!1}},async refreshLogs(){await this.loadLogs()},async clearLogs(){if(confirm("确定要清除所有日志吗？此操作不可恢复。"))try{this.isLoading=!0,window.clearStoredLogs?(await window.clearStoredLogs(),this.logs=[],this.applyFiltersAndPagination()):console.error("clearStoredLogs function not found")}catch(e){console.error("Error clearing logs:",e)}finally{this.isLoading=!1}},async downloadLogs(){try{let e;if(window.exportLogs?e=await window.exportLogs():e=this.logs,!e||e.length===0){alert("没有日志可以导出。");return}const t=JSON.stringify(e,null,2),s="data:application/json;charset=utf-8,"+encodeURIComponent(t),n=`logs_${new Date().toISOString().replace(/[:.]/g,"-")}.json`,o=document.createElement("a");o.setAttribute("href",s),o.setAttribute("download",n),o.click()}catch(e){console.error("Error exporting logs:",e),alert("导出日志失败。")}},formatTimestamp(e){try{const t=new Date(e);return isNaN(t.getTime())?"Invalid Date":t.toLocaleString()}catch{return"Invalid Date"}},getIconNameForType(e){switch(e){case"log":return"info";case"info":return"info-circle";case"warn":return"exclamation-triangle";case"error":return"exclamation-circle";default:return"dot-circle"}},countLogsByType(e){return this.logs.filter(t=>t.type===e).length},applyFiltersAndPagination(){const e=this.logs.filter(s=>{if(!this.filters.hasOwnProperty(s.type)||!this.filters[s.type])return!1;if(this.searchQuery&&this.searchQuery.trim()!==""){const n=this.searchQuery.toLowerCase(),o=String(s.message||"").toLowerCase(),r=this.formatTimestamp(s.timestamp).toLowerCase();return o.includes(n)||r.includes(n)}return!0});this.pageCount=Math.max(1,Math.ceil(e.length/this.logsPerPage)),this.currentPage>this.pageCount&&(this.currentPage=this.pageCount);const t=(this.currentPage-1)*this.logsPerPage;this.filteredLogs=e.slice(t,t+this.logsPerPage)},changePage(e){e>=1&&e<=this.pageCount&&(this.currentPage=e,this.applyFiltersAndPagination())}},watch:{searchQuery(){this.currentPage=1,this.applyFiltersAndPagination()},filters:{deep:!0,handler(){this.currentPage=1,this.applyFiltersAndPagination()}}},async mounted(){await this.loadLogs()}},B_={class:"logs-container"},q_={class:"logs-header"},J_={class:"logs-actions"},G_={class:"logs-filter"},W_={class:"filter-group"},H_={class:"filter-options"},K_={class:"filter-checkbox"},Q_={class:"filter-checkbox"},Y_={class:"filter-checkbox"},X_={class:"filter-checkbox"},Z_={class:"search-box"},eC={class:"logs-table-container"},tC={class:"logs-table"},sC={key:0},oC={colspan:"3",class:"loading-logs"},nC={key:1},rC={colspan:"3",class:"no-logs"},iC={class:"type-column"},aC={class:"timestamp-column"},lC={class:"message-column"},cC={class:"logs-footer"},uC={class:"log-stats"},fC={class:"stat-item"},dC={class:"stat-value"},gC={class:"stat-item"},hC={class:"stat-value log"},mC={class:"stat-item"},pC={class:"stat-value info"},yC={class:"stat-item"},bC={class:"stat-value warn"},vC={class:"stat-item"},wC={class:"stat-value error"},_C={key:0,class:"pagination"},CC=["disabled"],$C=["disabled"],kC={class:"page-info"},SC=["disabled"],xC=["disabled"];function TC(e,t,s,n,o,r){const i=ze("font-awesome-icon");return S(),T("div",B_,[l("div",q_,[t[15]||(t[15]=l("h1",null,"系统日志",-1)),l("div",J_,[l("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...a)=>r.refreshLogs&&r.refreshLogs(...a))},[q(i,{icon:["fas","sync-alt"]}),t[12]||(t[12]=te(" 刷新 "))]),l("button",{class:"btn btn-danger",onClick:t[1]||(t[1]=(...a)=>r.clearLogs&&r.clearLogs(...a))},[q(i,{icon:["fas","trash-alt"]}),t[13]||(t[13]=te(" 清除 "))]),l("button",{class:"btn",onClick:t[2]||(t[2]=(...a)=>r.downloadLogs&&r.downloadLogs(...a))},[q(i,{icon:["fas","download"]}),t[14]||(t[14]=te(" 导出 "))])])]),l("div",G_,[l("div",W_,[t[20]||(t[20]=l("label",null,"筛选:",-1)),l("div",H_,[l("label",K_,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=a=>o.filters.log=a)},null,512),[[Ve,o.filters.log]]),t[16]||(t[16]=l("span",{class:"filter-type log"},"日志",-1))]),l("label",Q_,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=a=>o.filters.info=a)},null,512),[[Ve,o.filters.info]]),t[17]||(t[17]=l("span",{class:"filter-type info"},"信息",-1))]),l("label",Y_,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=a=>o.filters.warn=a)},null,512),[[Ve,o.filters.warn]]),t[18]||(t[18]=l("span",{class:"filter-type warn"},"警告",-1))]),l("label",X_,[U(l("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=a=>o.filters.error=a)},null,512),[[Ve,o.filters.error]]),t[19]||(t[19]=l("span",{class:"filter-type error"},"错误",-1))])])]),l("div",Z_,[q(i,{icon:["fas","search"]}),U(l("input",{type:"text",placeholder:"搜索日志...","onUpdate:modelValue":t[7]||(t[7]=a=>o.searchQuery=a)},null,512),[[ue,o.searchQuery]])])]),l("div",eC,[l("table",tC,[t[23]||(t[23]=l("thead",null,[l("tr",null,[l("th",{class:"type-column"},"类型"),l("th",{class:"timestamp-column"},"时间"),l("th",{class:"message-column"},"消息")])],-1)),l("tbody",null,[o.isLoading?(S(),T("tr",sC,[l("td",oC,[q(i,{icon:["fas","spinner"],spin:""}),t[21]||(t[21]=te(" 正在加载日志... "))])])):o.filteredLogs.length===0?(S(),T("tr",nC,[l("td",rC,[q(i,{icon:["fas","info-circle"]}),t[22]||(t[22]=te(" 没有匹配的日志记录 "))])])):ge("",!0),(S(!0),T(ve,null,Ae(o.filteredLogs,(a,c)=>(S(),T("tr",{key:c,class:ie("log-row log-"+a.type)},[l("td",iC,[l("span",{class:ie(["log-badge",a.type])},[q(i,{icon:["fas",r.getIconNameForType(a.type)]},null,8,["icon"])],2)]),l("td",aC,F(r.formatTimestamp(a.timestamp)),1),l("td",lC,F(a.message),1)],2))),128))])])]),l("div",cC,[l("div",uC,[l("div",fC,[t[24]||(t[24]=l("span",{class:"stat-label"},"总计:",-1)),l("span",dC,F(o.logs.length),1)]),l("div",gC,[t[25]||(t[25]=l("span",{class:"stat-label"},"日志:",-1)),l("span",hC,F(r.countLogsByType("log")),1)]),l("div",mC,[t[26]||(t[26]=l("span",{class:"stat-label"},"信息:",-1)),l("span",pC,F(r.countLogsByType("info")),1)]),l("div",yC,[t[27]||(t[27]=l("span",{class:"stat-label"},"警告:",-1)),l("span",bC,F(r.countLogsByType("warn")),1)]),l("div",vC,[t[28]||(t[28]=l("span",{class:"stat-label"},"错误:",-1)),l("span",wC,F(r.countLogsByType("error")),1)])]),o.pageCount>1?(S(),T("div",_C,[l("button",{class:"pagination-btn",disabled:o.currentPage===1,onClick:t[8]||(t[8]=a=>r.changePage(1))},[q(i,{icon:["fas","angle-double-left"]})],8,CC),l("button",{class:"pagination-btn",disabled:o.currentPage===1,onClick:t[9]||(t[9]=a=>r.changePage(o.currentPage-1))},[q(i,{icon:["fas","angle-left"]})],8,$C),l("span",kC,F(o.currentPage)+" / "+F(o.pageCount),1),l("button",{class:"pagination-btn",disabled:o.currentPage===o.pageCount,onClick:t[10]||(t[10]=a=>r.changePage(o.currentPage+1))},[q(i,{icon:["fas","angle-right"]})],8,SC),l("button",{class:"pagination-btn",disabled:o.currentPage===o.pageCount,onClick:t[11]||(t[11]=a=>r.changePage(o.pageCount))},[q(i,{icon:["fas","angle-double-right"]})],8,xC)])):ge("",!0)])])}const IC=Be(z_,[["render",TC],["__scopeId","data-v-85633e8c"]]),MC="modulepreload",PC=function(e){return"/"+e},Ql={},Vr=function(t,s,n){let o=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),a=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.allSettled(s.map(c=>{if(c=PC(c),c in Ql)return;Ql[c]=!0;const f=c.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=f?"stylesheet":MC,f||(d.as="script"),d.crossOrigin="",d.href=c,a&&d.setAttribute("nonce",a),document.head.appendChild(d),f)return new Promise((h,g)=>{d.addEventListener("load",h),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(i){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i}return o.then(i=>{for(const a of i||[])a.status==="rejected"&&r(a.reason);return t().catch(r)})},AC={name:"Manage",data(){return{storageUsage:"计算中...",localStorageInfo:"计算中...",showStoryModal:!1,storyWindowLoaded:!1,animateStoryWindow:!1,showOutlineModal:!1,showFileModal:!1,outlineWindowLoaded:!1,fileWindowLoaded:!1,animateOutlineWindow:!1,animateFileWindow:!1,StoryManageComponent:null,OutlineManageComponent:null,FileManageComponent:null}},methods:{async showStoryManager(){if(this.showStoryModal=!0,this.storyWindowLoaded=!1,!this.StoryManageComponent)try{const e=await Vr(()=>import("./Manage_Story-CODWWb2j.js"),__vite__mapDeps([0,1]));this.StoryManageComponent=e.default}catch(e){console.error("加载故事管理器组件失败:",e),this.showNotification("加载故事管理器组件失败","error"),this.showStoryModal=!1;return}this.$nextTick(()=>{this.animateStoryWindow=!0,setTimeout(()=>{this.storyWindowLoaded=!0},300)})},closeStoryManager(){this.animateStoryWindow=!1,setTimeout(()=>{this.showStoryModal=!1,this.storyWindowLoaded=!1},300)},async showOutlineManager(){if(this.showOutlineModal=!0,this.outlineWindowLoaded=!1,!this.OutlineManageComponent)try{const e=await Vr(()=>import("./Manage_Outline-CCivW2lu.js"),__vite__mapDeps([2,3]));this.OutlineManageComponent=e.default}catch(e){console.error("加载大纲管理器组件失败:",e),this.showNotification("加载组件失败","error"),this.showOutlineModal=!1;return}this.$nextTick(()=>{this.animateOutlineWindow=!0,setTimeout(()=>{this.outlineWindowLoaded=!0},300)})},closeOutlineManager(){this.animateOutlineWindow=!1,setTimeout(()=>{this.showOutlineModal=!1,this.outlineWindowLoaded=!1},300)},async showFileManager(){if(this.showFileModal=!0,this.fileWindowLoaded=!1,!this.FileManageComponent)try{const e=await Vr(()=>import("./Manage_File-D5zh23En.js"),__vite__mapDeps([4,5]));this.FileManageComponent=e.default}catch(e){console.error("加载文件管理器组件失败:",e),this.showNotification("加载组件失败","error"),this.showFileModal=!1;return}this.$nextTick(()=>{this.animateFileWindow=!0,setTimeout(()=>{this.fileWindowLoaded=!0},300)})},closeFileManager(){this.animateFileWindow=!1,setTimeout(()=>{this.showFileModal=!1,this.fileWindowLoaded=!1},300)},showNotification(e,t="info"){this.$emit("show-message",{title:t,message:e}),console.log(`[ManagePage][${t.toUpperCase()}] ${e}`)},calculateStorageUsage(){try{navigator.storage&&navigator.storage.estimate?navigator.storage.estimate().then(({usage:e,quota:t})=>{const s=Math.round(e/1048576*10)/10,n=Math.round(t/(1024*1024*1024)*10)/10;isNaN(s)||!isFinite(s)?this.storageUsage="无法计算使用量":isNaN(n)||!isFinite(n)||n===0?this.storageUsage=`${s} MB / 容量未知`:this.storageUsage=`${s} MB / ${n} GB`}).catch(e=>{console.error("存储估算错误:",e),this.storageUsage="估算失败"}):this.storageUsage="浏览器不支持估算"}catch(e){console.error("计算存储空间使用情况失败:",e),this.storageUsage="计算失败"}},calculateLocalStorageUsage(){try{const t=(this.getLocalStorageSize()/1024).toFixed(2);this.localStorageInfo=`${t} KB`}catch(e){console.error("计算 localStorage 大小失败:",e),this.localStorageInfo="无法计算"}},getLocalStorageSize(){try{const e=JSON.stringify(localStorage);return typeof Blob>"u"?e.length*2:new Blob([e],{type:"application/json"}).size}catch(e){return console.error("获取 localStorage size 失败:",e),0}}},mounted(){this.calculateStorageUsage(),this.calculateLocalStorageUsage()},beforeDestroy(){}},EC={class:"manage-page"},OC={class:"content"},LC={class:"management-cards"},NC={class:"card-icon"},RC={class:"card-action"},DC={class:"action-button"},FC={class:"card-icon"},VC={class:"card-action"},UC={class:"action-button"},jC={class:"card-icon"},zC={class:"card-action"},BC={class:"action-button"},qC={class:"system-info"},JC={class:"info-card"},GC={class:"info-item"},WC={class:"value"},HC={class:"info-item"},KC={class:"value"},QC={class:"window-header"},YC={class:"window-content"},XC={key:1,class:"loading-indicator"},ZC={class:"window-header"},e8={class:"window-content"},t8={key:1,class:"loading-indicator"},s8={class:"window-header"},o8={class:"window-content"},n8={key:1,class:"loading-indicator"};function r8(e,t,s,n,o,r){const i=ze("font-awesome-icon");return S(),T("div",EC,[t[25]||(t[25]=l("div",{class:"header"},[l("h1",null,"管理")],-1)),l("div",OC,[l("div",LC,[l("div",{class:"card",onClick:t[0]||(t[0]=(...a)=>r.showStoryManager&&r.showStoryManager(...a))},[l("div",NC,[q(i,{icon:["fas","book-open"]})]),t[12]||(t[12]=l("div",{class:"card-content"},[l("h2",null,"故事管理"),l("p",null,"创建、编辑和管理游戏故事内容")],-1)),l("div",RC,[l("button",DC,[q(i,{icon:["fas","chevron-right"]})])])]),l("div",{class:"card",onClick:t[1]||(t[1]=(...a)=>r.showOutlineManager&&r.showOutlineManager(...a))},[l("div",FC,[q(i,{icon:["fas","scroll"]})]),t[13]||(t[13]=l("div",{class:"card-content"},[l("h2",null,"大纲管理"),l("p",null,"创建、编辑和管理游戏剧情大纲")],-1)),l("div",VC,[l("button",UC,[q(i,{icon:["fas","chevron-right"]})])])]),l("div",{class:"card",onClick:t[2]||(t[2]=(...a)=>r.showFileManager&&r.showFileManager(...a))},[l("div",jC,[q(i,{icon:["fas","folder-open"]})]),t[14]||(t[14]=l("div",{class:"card-content"},[l("h2",null,"文件管理"),l("p",null,"管理系统文件、资源和配置")],-1)),l("div",zC,[l("button",BC,[q(i,{icon:["fas","chevron-right"]})])])])]),l("div",qC,[l("div",JC,[t[17]||(t[17]=l("h3",null,"信息",-1)),t[18]||(t[18]=l("div",{class:"info-item"},[l("span",{class:"label"},"版本:"),l("span",{class:"value"},"v1.0.5")],-1)),l("div",GC,[t[15]||(t[15]=l("span",{class:"label"},"IndexedDB:",-1)),l("span",WC,F(o.storageUsage),1)]),l("div",HC,[t[16]||(t[16]=l("span",{class:"label"},"LocalStorage:",-1)),l("span",KC,F(o.localStorageInfo),1)])])])]),o.showStoryModal?(S(),T("div",{key:0,class:"floating-window-container",onClick:t[5]||(t[5]=ft((...a)=>r.closeStoryManager&&r.closeStoryManager(...a),["self"]))},[l("div",{class:ie(["floating-window story-window",{"animate-in":o.animateStoryWindow}])},[l("div",QC,[t[19]||(t[19]=l("h2",null,"故事管理",-1)),l("button",{class:"close-button",onClick:t[3]||(t[3]=(...a)=>r.closeStoryManager&&r.closeStoryManager(...a))},[q(i,{icon:["fas","times"]})])]),l("div",YC,[o.storyWindowLoaded?(S(),Xe(ro(o.StoryManageComponent),{key:0,onShowMessage:t[4]||(t[4]=a=>e.$emit("show-message",a))},null,32)):(S(),T("div",XC,[q(i,{icon:["fas","spinner"],spin:"",class:"loading-icon-fa"}),t[20]||(t[20]=l("span",null,"加载中...",-1))]))])],2)])):ge("",!0),o.showOutlineModal?(S(),T("div",{key:1,class:"floating-window-container",onClick:t[8]||(t[8]=ft((...a)=>r.closeOutlineManager&&r.closeOutlineManager(...a),["self"]))},[l("div",{class:ie(["floating-window outline-window",{"animate-in":o.animateOutlineWindow}])},[l("div",ZC,[t[21]||(t[21]=l("h2",null,"大纲管理",-1)),l("button",{class:"close-button",onClick:t[6]||(t[6]=(...a)=>r.closeOutlineManager&&r.closeOutlineManager(...a))},[q(i,{icon:["fas","times"]})])]),l("div",e8,[o.outlineWindowLoaded?(S(),Xe(ro(o.OutlineManageComponent),{key:0,onShowMessage:t[7]||(t[7]=a=>e.$emit("show-message",a))},null,32)):(S(),T("div",t8,[q(i,{icon:["fas","spinner"],spin:"",class:"loading-icon-fa"}),t[22]||(t[22]=l("span",null,"加载中...",-1))]))])],2)])):ge("",!0),o.showFileModal?(S(),T("div",{key:2,class:"floating-window-container",onClick:t[11]||(t[11]=ft((...a)=>r.closeFileManager&&r.closeFileManager(...a),["self"]))},[l("div",{class:ie(["floating-window file-window",{"animate-in":o.animateFileWindow}])},[l("div",s8,[t[23]||(t[23]=l("h2",null,"文件管理",-1)),l("button",{class:"close-button",onClick:t[9]||(t[9]=(...a)=>r.closeFileManager&&r.closeFileManager(...a))},[q(i,{icon:["fas","times"]})])]),l("div",o8,[o.fileWindowLoaded?(S(),Xe(ro(o.FileManageComponent),{key:0,onShowMessage:t[10]||(t[10]=a=>e.$emit("show-message",a))},null,32)):(S(),T("div",n8,[q(i,{icon:["fas","spinner"],spin:"",class:"loading-icon-fa"}),t[24]||(t[24]=l("span",null,"加载中...",-1))]))])],2)])):ge("",!0)])}const i8=Be(AC,[["render",r8],["__scopeId","data-v-c54dc6a4"]]),a8={name:"About",data(){return{currentVersion:"1.0.5",versionList:[],showUpdateModal:!1,showVersionSelectorModal:!1,updateStatus:"",errorMessage:"",latestStableVersion:null,latestTestVersion:null,downloadingVersion:"",selectedOS:this.detectOS()}},methods:{openUrl(e){window.open(e,"_blank")},detectOS(){const e=navigator.userAgent.toLowerCase();return e.indexOf("windows")!==-1?"windows":e.indexOf("mac")!==-1?"mac":e.indexOf("linux")!==-1&&e.indexOf("android")===-1?"linux":e.indexOf("android")!==-1?"android":"windows"},async fetchVersionInfo(){try{const e=await fetch("https://r2.qqframe.cn/aigal/version_web.json");if(!e.ok)throw new Error("无法获取版本信息");return await e.json()}catch(e){return console.error("获取版本信息失败：",e),this.errorMessage=e.message,this.updateStatus="error",[]}},async checkForUpdates(){this.showUpdateModal=!0,this.updateStatus="checking";try{const e=await this.fetchVersionInfo();if(e.length===0){this.updateStatus="error",this.errorMessage="没有找到版本信息";return}const t=e.filter(o=>!this.isTestVersion(o.version)),s=e.filter(o=>this.isTestVersion(o.version));this.latestStableVersion=this.findLatestVersion(t),this.latestTestVersion=this.findLatestVersion(s);const n=this.latestStableVersion&&this.compareVersions(this.latestStableVersion.version,this.currentVersion)>0||this.latestTestVersion&&this.compareVersions(this.latestTestVersion.version.replace("t",""),this.currentVersion)>0;this.updateStatus=n?"update-available":"up-to-date"}catch(e){console.error("检查更新失败：",e),this.updateStatus="error",this.errorMessage=e.message}},async showVersionSelector(){this.showVersionSelectorModal=!0,this.versionList=[];try{const e=await this.fetchVersionInfo();this.versionList=e.sort((t,s)=>this.compareVersions(s.version.replace("t",""),t.version.replace("t","")))}catch(e){console.error("获取版本列表失败：",e)}},downloadVersion(e){this.downloadingVersion=e.version,this.updateStatus="downloading";const s=e[{windows:"url_windows",linux:"url_linux",mac:"url_mac",android:"url_android"}[this.selectedOS]];s?(window.open(s,"_blank"),setTimeout(()=>{this.closeModal()},1e3)):(this.errorMessage=`没有找到适用于 ${this.selectedOS} 的下载链接`,this.updateStatus="error")},closeModal(){this.showUpdateModal=!1,this.showVersionSelectorModal=!1,this.updateStatus=""},isTestVersion(e){return e.startsWith("t")},findLatestVersion(e){return e.length===0?null:e.reduce((t,s)=>{const n=t.version.replace("t",""),o=s.version.replace("t","");return this.compareVersions(o,n)>0?s:t},e[0])},compareVersions(e,t){e=e.replace("t",""),t=t.replace("t","");const s=e.split("."),n=t.split(".");for(let o=0;o<Math.max(s.length,n.length);o++){const r=o<s.length?parseInt(s[o],10):0,i=o<n.length?parseInt(n[o],10):0;if(r>i)return 1;if(r<i)return-1}return s.length===4&&n.length<4&&parseInt(s[3],10)!==0?1:n.length===4&&s.length<4&&parseInt(n[3],10)!==0?-1:0}}},l8={class:"about-container"},c8={class:"title-section"},u8={class:"logo-title"},f8={class:"app-logo"},d8={class:"version-info"},g8={class:"update-section"},h8={class:"content-section"},m8={class:"card"},p8={class:"card-title"},y8={class:"card-content"},b8={class:"action-row"},v8={class:"card"},w8={class:"card-title"},_8={class:"card-content"},C8={class:"features"},$8={class:"feature-item"},k8={class:"feature-item"},S8={class:"feature-item"},x8={class:"feature-item"},T8={class:"footer-section"},I8={key:0,class:"modal"},M8={class:"modal-content"},P8={class:"modal-header"},A8={class:"modal-body"},E8={key:0},O8={key:1},L8={key:2},N8={key:0,class:"version-option"},R8={class:"version-description"},D8={key:1,class:"version-option"},F8={class:"version-description"},V8={key:3},U8={key:4},j8={key:1,class:"modal"},z8={class:"modal-content"},B8={class:"modal-header"},q8={class:"modal-body"},J8={key:0},G8={key:1},W8={class:"os-selector"},H8={class:"version-list"},K8={class:"version-header"},Q8={key:0,class:"version-tag"},Y8={key:1,class:"version-tag stable"},X8={class:"version-description"},Z8=["onClick"];function e$(e,t,s,n,o,r){const i=ze("font-awesome-icon");return S(),T(ve,null,[l("div",l8,[l("div",c8,[l("div",u8,[l("div",f8,[q(i,{icon:["fas","gamepad"]})]),t[11]||(t[11]=l("h1",{class:"app-title"},"AI galgame生成器",-1))]),l("div",d8,"V"+F(o.currentVersion),1)]),t[27]||(t[27]=l("div",{class:"divider"},null,-1)),l("div",g8,[l("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...a)=>r.checkForUpdates&&r.checkForUpdates(...a))},[q(i,{icon:["fas","sync"],class:"btn-icon-fa"}),t[12]||(t[12]=te(" 检查更新 "))]),l("button",{class:"btn btn-secondary",onClick:t[1]||(t[1]=(...a)=>r.showVersionSelector&&r.showVersionSelector(...a))},[q(i,{icon:["fas","download"],class:"btn-icon-fa"}),t[13]||(t[13]=te(" 下载特定版本 "))])]),t[28]||(t[28]=l("div",{class:"divider"},null,-1)),l("div",h8,[l("div",m8,[l("h2",p8,[q(i,{icon:["fas","book"],class:"card-icon-fa"}),t[14]||(t[14]=te(" 帮助与文档 "))]),l("div",y8,[l("div",b8,[t[16]||(t[16]=l("div",{class:"action-label"},[l("span",null,"用户手册")],-1)),l("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=a=>r.openUrl("https://aigal.qqframe.cn"))},[q(i,{icon:["fas","file-alt"],class:"btn-icon-fa"}),t[15]||(t[15]=te(" 查看在线文档 "))])])])]),l("div",v8,[l("h2",w8,[q(i,{icon:["fas","info-circle"],class:"card-icon-fa"}),t[17]||(t[17]=te(" 关于软件 "))]),l("div",_8,[t[22]||(t[22]=l("p",{class:"description"}," 这是一款利用AI自动生成galgame的工具，支持角色、背景音乐、语音和场景的生成。 ",-1)),l("div",C8,[l("div",$8,[q(i,{icon:["fas","users"],class:"feature-icon-fa"}),t[18]||(t[18]=l("span",{class:"feature-text"},"角色生成",-1))]),l("div",k8,[q(i,{icon:["fas","music"],class:"feature-icon-fa"}),t[19]||(t[19]=l("span",{class:"feature-text"},"背景音乐",-1))]),l("div",S8,[q(i,{icon:["fas","microphone"],class:"feature-icon-fa"}),t[20]||(t[20]=l("span",{class:"feature-text"},"语音生成",-1))]),l("div",x8,[q(i,{icon:["fas","image"],class:"feature-icon-fa"}),t[21]||(t[21]=l("span",{class:"feature-text"},"场景生成",-1))])]),t[23]||(t[23]=l("p",{class:"copyright"},"© 2025 开发团队. 保留所有权利。",-1))])])]),l("div",T8,[l("button",{class:"btn btn-link",onClick:t[3]||(t[3]=a=>r.openUrl("https://github.com/1491860506/AIGal"))},[q(i,{icon:["fab","github"],class:"btn-icon-fa"}),t[24]||(t[24]=te(" GitHub "))]),l("button",{class:"btn btn-link",onClick:t[4]||(t[4]=a=>r.openUrl("https://aigal.qqframe.cn"))},[q(i,{icon:["fas","globe"],class:"btn-icon-fa"}),t[25]||(t[25]=te(" 官方网站 "))]),l("button",{class:"btn btn-link",onClick:t[5]||(t[5]=a=>r.openUrl("mailto:admin@qqframe.cn"))},[q(i,{icon:["fas","envelope"],class:"btn-icon-fa"}),t[26]||(t[26]=te(" 联系我们 "))])])]),o.showUpdateModal?(S(),T("div",I8,[l("div",M8,[l("div",P8,[t[29]||(t[29]=l("h3",null,"软件更新",-1)),l("button",{class:"close-button",onClick:t[6]||(t[6]=(...a)=>r.closeModal&&r.closeModal(...a))},[q(i,{icon:["fas","times"]})])]),l("div",A8,[o.updateStatus==="checking"?(S(),T("div",E8,t[30]||(t[30]=[l("p",null,"正在检查更新...",-1),l("div",{class:"loading-spinner"},null,-1)]))):o.updateStatus==="up-to-date"?(S(),T("div",O8,[l("p",null,"当前已是最新版本 (V"+F(o.currentVersion)+")",1)])):o.updateStatus==="update-available"?(S(),T("div",L8,[t[33]||(t[33]=l("p",null,"检测到新版本：",-1)),o.latestStableVersion?(S(),T("div",N8,[l("h4",null,[q(i,{icon:["fas","check-circle"],class:"version-icon stable"}),te(" 正式版 V"+F(o.latestStableVersion.version),1)]),l("p",R8,F(o.latestStableVersion.description),1),l("button",{class:"btn btn-primary",onClick:t[7]||(t[7]=a=>r.downloadVersion(o.latestStableVersion))},[q(i,{icon:["fas","download"],class:"btn-icon-fa"}),t[31]||(t[31]=te(" 下载正式版 "))])])):ge("",!0),o.latestTestVersion?(S(),T("div",D8,[l("h4",null,[q(i,{icon:["fas","flask"],class:"version-icon test"}),te(" 测试版 V"+F(o.latestTestVersion.version),1)]),l("p",F8,F(o.latestTestVersion.description),1),l("button",{class:"btn btn-secondary",onClick:t[8]||(t[8]=a=>r.downloadVersion(o.latestTestVersion))},[q(i,{icon:["fas","download"],class:"btn-icon-fa"}),t[32]||(t[32]=te(" 下载测试版 "))])])):ge("",!0)])):o.updateStatus==="downloading"?(S(),T("div",V8,[l("p",null,"正在准备下载 V"+F(o.downloadingVersion)+"...",1)])):o.updateStatus==="error"?(S(),T("div",U8,[l("p",null,"检查更新时发生错误："+F(o.errorMessage),1)])):ge("",!0)])])])):ge("",!0),o.showVersionSelectorModal?(S(),T("div",j8,[l("div",z8,[l("div",B8,[t[34]||(t[34]=l("h3",null,"选择下载版本",-1)),l("button",{class:"close-button",onClick:t[9]||(t[9]=(...a)=>r.closeModal&&r.closeModal(...a))},[q(i,{icon:["fas","times"]})])]),l("div",q8,[o.versionList.length===0?(S(),T("div",J8,t[35]||(t[35]=[l("p",null,"正在加载版本信息...",-1),l("div",{class:"loading-spinner"},null,-1)]))):(S(),T("div",G8,[l("div",W8,[t[37]||(t[37]=l("label",null,"选择操作系统：",-1)),U(l("select",{"onUpdate:modelValue":t[10]||(t[10]=a=>o.selectedOS=a)},t[36]||(t[36]=[l("option",{value:"windows"},"Windows",-1),l("option",{value:"linux"},"Linux",-1),l("option",{value:"mac"},"macOS",-1),l("option",{value:"android"},"Android",-1)]),512),[[Ue,o.selectedOS]])]),l("div",H8,[(S(!0),T(ve,null,Ae(o.versionList,(a,c)=>(S(),T("div",{key:c,class:"version-item"},[l("div",K8,[l("h4",null,[q(i,{icon:["fas",r.isTestVersion(a.version)?"flask":"check-circle"],class:ie(["version-icon",r.isTestVersion(a.version)?"test":"stable"])},null,8,["icon","class"]),te(" V"+F(a.version),1)]),r.isTestVersion(a.version)?(S(),T("span",Q8,"测试版")):(S(),T("span",Y8,"正式版"))]),l("p",X8,F(a.description),1),l("button",{class:"btn btn-primary",onClick:f=>r.downloadVersion(a)},[q(i,{icon:["fas","download"],class:"btn-icon-fa"}),t[38]||(t[38]=te(" 下载此版本 "))],8,Z8)]))),128))])]))])])])):ge("",!0)],64)}const t$=Be(a8,[["render",e$],["__scopeId","data-v-5e5cb9ef"]]);function s$(e){try{const t=e.indexOf("{"),s=e.lastIndexOf("}");return t===-1||s===-1||t>=s?null:e.substring(t,s+1)}catch(t){return console.error("提取JSON时发生错误:",t),null}}function o$(e){const t={"\\":"、","/":"、",":":"：","*":"＊","?":"？",'"':"”","<":"＜",">":"＞","|":"｜"};let s=e;for(const[n,o]of Object.entries(t))s=s.replace(new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),o);return s=s.replace(/[\\/:*?"<>|]/g,""),s}async function n$(){var o;let e;try{const r=localStorage.getItem("aiGalgameConfig");if(!r)return console.error("配置文件未找到"),"error";e=JSON.parse(r)}catch(r){return console.error("解析配置文件失败:",r),"error"}(o=e.剧情)!=null&&o.outline_content_entry;const[t,s]=await ct("大纲"),n=Math.floor(Math.random()*1e5)+1;for(;;)try{console.log(`[${new Date().toISOString()}] 正在调用GPT生成大纲...`);const r=await Ms(t,s,"大纲",n);if(r==="error"){console.error("尝试失败，失败原因：GPT函数返回错误");continue}else if(r==="over_times")return console.error("GPT调用超出最大重试次数"),"error";const i=s$(r);if(i===null){console.error("尝试失败，失败原因：未提取到有效的JSON对象");continue}let a;try{if(a=JSON.parse(i),!a.title||!a.outline||!a.character){console.error("尝试失败，失败原因：JSON对象不包含必要的键 (title, outline, character)");continue}}catch(c){console.error("尝试失败，失败原因：JSON解码错误:",c);continue}try{const c=a.title,f=o$(c);a.title=f;let u=f;const d=await ao();if(d.includes(f)){let p=1;for(;;){const b=`${f}-${p}`;if(!d.includes(b)){u=b;break}p++}}console.log(`[${new Date().toISOString()}] 使用标题: ${u}`);const h=`/data/${u}`;try{await Lt(h),console.log(`[${new Date().toISOString()}] 创建目录: ${h}`)}catch(p){console.log(`[${new Date().toISOString()}] 目录已存在或创建失败: ${p.message}`)}const g=`${h}/character.json`;await xe(g,a.character),console.log(`[${new Date().toISOString()}] 已保存: ${g}`);const m={...a};delete m.character;const y=`${h}/outline.json`;return await xe(y,m),console.log(`[${new Date().toISOString()}] 已保存: ${y}`),e.剧情=e.剧情||{},e.剧情.story_title=u,localStorage.setItem("aiGalgameConfig",JSON.stringify(e)),console.log(`[${new Date().toISOString()}] 获取大纲成功`),st(n),"success"}catch(c){console.error(`[${new Date().toISOString()}] 尝试失败，失败原因：处理JSON或创建存储时发生错误:`,c);continue}}catch(r){console.error(`[${new Date().toISOString()}] 尝试失败，失败原因：发生内部错误:`,r);continue}}async function Mk(e){try{const t=await Je(`/data/${e}/outline.json`),s=await Je(`/data/${e}/character.json`);return{outline:t,character:s}}catch(t){throw console.error(`[${new Date().toISOString()}] 加载大纲内容失败:`,t),t}}async function Pk(){try{return await ao()}catch(e){return console.error(`[${new Date().toISOString()}] 获取大纲标题列表失败:`,e),[]}}async function Ak(e,t,s){try{return await xe(`/data/${e}/outline.json`,t),await xe(`/data/${e}/character.json`,s),!0}catch(n){return console.error(`[${new Date().toISOString()}] 保存大纲内容失败:`,n),!1}}function an(){try{const e=localStorage.getItem("aiGalgameConfig");return e?JSON.parse(e):(console.error("配置文件未找到"),null)}catch(e){return console.error("解析配置文件失败:",e),null}}async function ki(e){var a;console.log(`开始为目标ID ${e} 获取选项`);const t=an();if(!t)return console.error("加载配置失败"),"error";const s=(a=t.剧情)==null?void 0:a.story_title;if(!s)return console.error("配置中未找到故事标题"),"error";const n=`/data/${s}/choice.json`;let o,r;try{[o,r]=await ct("选项")}catch(c){return console.error("处理提示词失败:",c),"error"}const i=Math.floor(Math.random()*1e5)+1;for(;;)try{const c=await Ms(o,r,"option",i);if(c==="error"){console.error(`GPT 返回错误，requestId: ${i}`);continue}else if(c==="over_times")return console.error(`GPT 调用超出最大重试次数，requestId: ${i}`),"error";const f=c.indexOf("{"),u=c.lastIndexOf("}");if(f!==-1&&u!==-1&&f<u){const d=c.substring(f,u+1);try{const h=JSON.parse(d);if("choice1"in h&&"choice2"in h&&"choice3"in h){const g=h.choice1,m=h.choice2,y=h.choice3;let p={};try{const I=await Je(n);I&&(p=I)}catch(I){console.log(`未找到现有选项文件或读取错误: ${I.message}`)}let b=-1;for(const[I,R]of Object.entries(p))if(Array.isArray(R)){for(const O of R)if(typeof O=="object"&&O!==null&&"id"in O)try{const E=parseInt(O.id);b=Math.max(b,E)}catch{console.warn(`发现无效的ID格式: ${O.id}, 跳过`)}}try{const I=parseInt(e);b=Math.max(b,I)}catch{console.warn(`无效的目标ID格式: ${e}, 在生成新ID时不会考虑它`)}const w=(b+1).toString(),v=(b+2).toString(),k=(b+3).toString(),$=[{choice1:g,id:w},{choice2:m,id:v},{choice3:y,id:k}];return p[e]=$,console.log(`保存最终的JSON结构到: ${n}`),await xe(n,p),console.log(`成功保存目标ID '${e}' 的选项到 ${n}`),st(i),"success"}else{console.error(`解析的JSON不包含必要的键 ('choice1', 'choice2', 'choice3'): ${h}`);continue}}catch(h){console.error(`JSON解析错误，requestId ${i}: ${h.message}`),console.error(`有问题的JSON字符串: ${d}`);continue}}else{console.error(`在GPT输出中未找到JSON起始和结束标记，requestId: ${i}`);continue}}catch(c){console.error(`循环内发生意外错误，requestId ${i}: ${c.message}`),console.error(c.stack);continue}}async function r$(e,t="None"){var i;if(console.log(`开始追溯ID链，起始ID: ${e}`),e=String(e),e==="0")return["0"];if(t==="None"){const a=an();if(!a)return console.error("加载配置失败"),[];if(t=(i=a.剧情)==null?void 0:i.story_title,!t)return console.error("配置中未找到故事标题"),[]}const s=`/data/${t}/choice.json`;let n;try{n=await Je(s)}catch{return console.error(`选项文件未找到或包含无效的JSON: ${s}`),[]}const o=[e];let r=e;for(;r!=="0";){let a=!1;for(const[c,f]of Object.entries(n))if(Array.isArray(f)){for(const u of f)if(typeof u=="object"&&u!==null&&"id"in u&&u.id===r){o.push(c),r=c,a=!0;break}if(a)break}if(!a)return console.error(`无法追溯ID: ${r}，返回空数组`),[]}return o.sort((a,c)=>parseInt(a)-parseInt(c))}async function No(e){e=String(e),console.log(`开始合并故事，目标ID: ${e}`);const t=an();if(!t)return console.error("加载配置失败"),-1;const s=t.剧情.story_title;if(!s)return console.error("配置中未找到故事标题"),-1;const n=`/data/${s}/story`,o=`${n}/story.json`,r=`${n}/story.txt`,i=`${n}/place.json`;await Lt(n);const a=await r$(e);if(!a||a.length===0)return console.error("获取ID链失败"),-1;const c=[];let f=0,u="";const d=new Set,h=[];try{for(const g of a){const m=`${n}/${g}.json`;if(g===e){try{const y=await Je(m);if(y){f=1;const p=y.conversations||[];for(const b of p){const w=b.place||"";w&&!d.has(w)&&(h.push(w),d.add(w))}c.push(...p)}}catch{console.log(`目标文件不存在: ${m}`)}continue}try{const y=await Je(m);if(!y)return console.error(`文件内容无效: ${m}`),-1;const p=y.conversations||[];c.push(...p);for(const b of p){const w=b.place||"";w&&d.add(w)}}catch{return console.error(`无法读取必要的文件: ${m}`),-1}}for(let g=0;g<c.length;g++){"id"in c[g]&&delete c[g].id;const m=c[g].place||"";m!==u&&m!==""?u=m:m===u&&m!==""&&(c[g].place="")}}catch(g){return console.error(`合并故事时发生错误: ${g.message}`),-1}try{await xe(o,{conversations:c}),console.log(`成功合并对话并保存到: ${o}`)}catch(g){return console.error(`保存到输出JSON文件失败: ${g.message}`),-1}try{let g="";for(const m of c){const y=m.character||"",p=m.text||"",b=m.place||"";let w;y?w=`${y}：${p}`:w=`旁白：${p}`,b&&(w+=`[${b}]`),g+=w+`
`}await xe(r,g),console.log(`成功保存对话到TXT文件: ${r}`)}catch(g){return console.error(`保存到输出TXT文件失败: ${g.message}`),-1}if(f)try{await xe(i,h),console.log(`成功保存新场景到: ${i}`)}catch(g){console.error(`保存到场景JSON文件失败: ${g.message}`)}return f?1:0}async function Yl(e,t){var i;if(console.log(`开始获取选项ID，目标ID: ${e}，选项文本: ${t}`),e==="none")return parseInt(t);const s=an();if(!s)return console.error("加载配置失败"),-1;const n=(i=s.剧情)==null?void 0:i.story_title;if(!n)return console.error("配置中未找到故事标题"),-1;const o=`/data/${n}/choice.json`;let r;try{r=await Je(o)}catch{console.log(`选项文件未找到或包含无效的JSON: ${o}`),r={}}if(e in r){for(const a of r[e])if(Object.values(a).includes(t))return a.id.toString()}else console.error(`目标ID '${e}' 在选项文件中未找到`);if(e in r){let a=-1;for(const[u,d]of Object.entries(r))if(Array.isArray(d)){for(const h of d)if(typeof h=="object"&&h!==null&&"id"in h)try{const g=parseInt(h.id);a=Math.max(a,g)}catch(g){console.warn(`发现无效的ID格式: ${h.id}, 跳过: ${g.message}`)}}const c=(a+1).toString(),f={choice:t,id:c};r[e].push(f),console.log(`为目标ID '${e}' 创建了新选项，ID: '${c}'`);try{return await xe(o,r),c}catch(u){return console.error(`保存到选项文件失败: ${u.message}`),-1}}else return console.error(`目标ID不存在: ${e}`),-1}async function i$(e){var r;const s=(r=an().剧情)==null?void 0:r.story_title;if(!s)return console.error("配置中未找到故事标题"),e;const n=`/data/${s}/choice.json`;let o;try{o=await Je(n)}catch{console.log(`选项文件未找到或包含无效的JSON: ${n}`),o={}}for(const i in o)if(o.hasOwnProperty(i)){const a=o[i];for(const c of a)if(c.id===String(e)){for(const f in c)if(f.startsWith("choice"))return c[f]}}return e}function ia(){try{const e=localStorage.getItem("aiGalgameConfig");return e?JSON.parse(e):(console.error("配置文件未找到"),null)}catch(e){return console.error("加载配置失败:",e),null}}async function aa(e,t,s,n,o){const r=[];for(;;)try{console.log(`开始生成故事片段 ID:${n}, 故事ID:${o}`);const i=await Ms(e,t,"plot",n);if(i==="error"){r.push("GPT返回错误");continue}else if(i==="over_times")return console.error("GPT调用超出最大重试次数"),`达到最大尝试次数，失败原因：${r.join(", ")}`;const a=`/data/${s}/story/${o}.json`;if(await a$(i,a)==="success")return st(n),"成功生成对话";r.push("无效的JSON数据")}catch(i){r.push(`异常：${i.message}`),console.error("生成JSON数据失败:",i)}}async function a$(e,t){try{const s=l$(e);if(!s||s.length===0)return console.error("未找到有效的JSON对象"),"error";for(let r=0;r<s.length;r++)s[r].id=r+1;let n=null;for(const r of s){const i=r.place;i===n?r.place="":i!==""&&(n=i)}return await Lt(t.substring(0,t.lastIndexOf("/"))),await xe(t,{conversations:s}),console.log(`成功保存对话到: ${t}`),"success"}catch(s){return console.error("处理JSON数据失败:",s),"error"}}function l$(e){const t=[],s=e.indexOf("[")+1;if(s<=0)try{const r=JSON.parse(e);if(Array.isArray(r))return r.filter(i=>i&&typeof i=="object"&&"place"in i&&"character"in i&&"text"in i)}catch{console.warn("无法直接解析JSON字符串")}let n=0,o=[];for(const r of e.substring(s))if(r==="{")n++,o.push(r);else if(r==="}"){if(n--,o.push(r),n===0)try{const i=JSON.parse(o.join(""));"place"in i&&"character"in i&&"text"in i&&t.push(i),o=[]}catch{o=[]}}else o.length>0&&o.push(r);return t}async function c$(){var i;const e=ia();if(!e)return"配置加载失败";const t=((i=e.剧情)==null?void 0:i.story_title)||"";if(!t)return"未找到故事标题";await Lt(`/data/${t}/story`);const[s,n]=await ct("故事开头"),o=Math.floor(Math.random()*1e5)+1,r=await aa(s,n,t,o,"0");return console.log(r),r}async function u$(e,t){var f;const s=ia();if(!s)return"配置加载失败";const n=((f=s.剧情)==null?void 0:f.story_title)||"";if(!n)return"未找到故事标题";const o=`/data/${n}/answer.txt`;e=await i$(e),await xe(o,e);const[r,i]=await ct("故事继续"),a=Math.floor(Math.random()*1e5)+1,c=await aa(r,i,n,a,t);try{await ts(o)}catch(u){console.warn("删除临时回答文件失败",u)}return console.log(c),c}async function f$(e){var a;console.log("开始end_story");const t=ia();if(!t)return"配置加载失败";const s=((a=t.剧情)==null?void 0:a.story_title)||"";if(!s)return"未找到故事标题";const[n,o]=await ct("故事结尾"),r=Math.floor(Math.random()*1e5)+1;return await aa(n,o,s,r,e)}function Ur(){try{const e=localStorage.getItem("aiGalgameConfig");return e?JSON.parse(e)||{}:(console.warn("aiGalgameConfig not found in localStorage. Returning empty object."),{})}catch(e){return console.error("Failed to parse aiGalgameConfig from localStorage:",e),{}}}function d$(){const e=Re(!1),t=Re([]),s=r=>{console.log("Status Update:",r),t.value.push(`[${new Date().toLocaleTimeString()}] ${r}`)};return{isLoading:e,progressLog:t,generateNewStory:async()=>{var i,a;if(e.value)return"busy";e.value=!0,t.value=[],s("开始生成新故事...");const r=performance.now();try{let c=Ur();const f=[];if(s("正在生成大纲..."),await n$()!=="success")throw new Error("大纲生成失败");c=Ur();const d=(i=c==null?void 0:c.剧情)==null?void 0:i.story_title;if(!d)throw new Error("未能从配置中获取 story_title");s(`获取到故事标题: ${d}`),await xe("/data/test/title.txt",d),f.push(Bn("music")),s("启动并发任务(角色图, 背景音乐，标题图)..."),f.push(Hl(s).catch(y=>{console.error("后台任务失败 - 角色图像生成:",y),s(`警告: 角色图像生成失败 - ${y.message}`)})),((a=c==null?void 0:c.AI音乐)==null?void 0:a.if_on)===!0?f.push(D5(s).catch(y=>{console.error("后台任务失败 - 背景音乐生成:",y),s(`警告: 背景音乐生成失败 - ${y.message}`)})):s("背景音乐已禁用 (配置)。"),f.push(qw(0,s).catch(y=>{console.error("后台任务失败 - 标题图片生成:",y),s(`警告: 标题图像生成失败 - ${y.message}`)})),s("正在生成故事开篇...");const h=await c$();if(!h||typeof h!="string"||h.toLowerCase().includes("fail"))throw new Error(`故事开篇生成失败: ${h||"未知错误"}`);s("故事开篇完成."),s("正在合并初始故事..."),await No("0"),s("初始故事合并完成."),s("启动并发任务 (语音, 选项, 地点图)..."),f.push(qn("0",s).catch(y=>{throw new Error(`语音生成(0)失败: ${y.message}`)})),f.push(ki("0").catch(y=>{throw new Error(`选项生成(0)失败: ${y.message}`)})),f.push(jn(0,s).catch(y=>{throw new Error(`地点图像生成失败: ${y.message}`)})),s("等待任务完成..."),await Promise.all(f),s("任务完成.");const m=((performance.now()-r)/1e3).toFixed(1);return s(`新故事生成成功！总用时: ${m}秒`),e.value=!1,"success"}catch(c){return console.error("generateNewStory 发生错误:",c),s(`错误: ${c.message}`),e.value=!1,"error"}},generateLocalStory:async()=>{var i;if(e.value)return"busy";e.value=!0,t.value=[],s("开始准备本地故事...");const r=performance.now();try{const a=Ur(),c=[],f=(i=a==null?void 0:a.剧情)==null?void 0:i.story_title;if(!f)throw new Error("未能从配置中获取 story_title");s(`获取到故事标题: ${f}`);const u=`/data/${f}/story/0.json`,d=`/data/${f}/zw`;s(`正在读取故事文件 ${u}...`);let h;try{h=await Je(u)}catch(p){throw new Error(`读取初始故事文件失败 (${u}): ${p.message}`)}if(!h||!Array.isArray(h.conversations))throw new Error(`故事文件 ${u} 格式无效或缺少 conversations`);c.push(Bn("music")),s("正在处理故事文件 (添加ID, 清理地点)...");let g=null;h.conversations=h.conversations.map((p,b)=>{const w=p.place||"";let v=w;return w===g&&w!==""?v="":w!==""&&(g=w),{...p,id:b+1,place:v}}),s("正在写回处理后的故事文件...");try{await xe(u,h)}catch(p){throw new Error(`写回故事文件失败 (${u}): ${p.message}`)}s("正在合并故事..."),await No("0"),s("故事合并完成."),s("启动并发任务 (语音, 选项, 角色图, 地点图)..."),c.push(qn("0",s).catch(p=>{throw new Error(`语音生成(0)失败: ${p.message}`)})),c.push(ki("0").catch(p=>{throw new Error(`选项生成(0)失败: ${p.message}`)})),c.push(Hl(s).catch(p=>{throw new Error(`角色图像生成失败: ${p.message}`)})),c.push(jn(0,s).catch(p=>{throw new Error(`地点图像生成失败: ${p.message}`)})),s("等待任务完成..."),await Promise.all(c),s("任务完成."),s(`正在删除标记文件 ${d}...`);try{await ts(d),s("标记文件删除成功.")}catch(p){console.warn(`删除标记文件 ${d} 失败: ${p.message}`),s(`警告: 删除标记文件 ${d} 失败: ${p.message}`)}const y=((performance.now()-r)/1e3).toFixed(1);return s(`本地故事准备完成！总用时: ${y}秒`),e.value=!1,"success"}catch(a){return console.error("generateLocalStory 发生错误:",a),s(`错误: ${a.message}`),e.value=!1,"error"}}}}const g$={class:"start-container"},h$={key:0,class:"loading-indicator"},m$={key:1,class:"progress-status-container"},p$={class:"progress-header"},y$={class:"progress-time"},b$={class:"progress-table"},v$={class:"task-progress"},w$={class:"progress-value"},_$={key:0},C$={class:"task-time"},$$={class:"task-progress"},k$={class:"progress-value"},S$={class:"task-time"},x$={class:"task-progress"},T$={class:"progress-value"},I$={class:"task-time"},M$={class:"task-progress"},P$={class:"progress-value"},A$={class:"task-time"},E$={class:"task-progress"},O$={class:"progress-value"},L$={class:"task-time"},N$={class:"task-progress"},R$={class:"progress-value"},D$={class:"task-time"},F$={class:"task-progress"},V$={class:"progress-value"},U$={class:"task-time"},j$={class:"progress-log-container"},z$={key:2,class:"toast-container"},B$={key:0,class:"toast-icon"},q$={key:1,class:"toast-icon"},J$={key:2,class:"toast-icon"},G$={class:"toast-content"},W$={class:"toast-title"},H$={class:"toast-body"},K$={key:0,class:"toast-countdown"},Q$={key:3,class:"initial-check-message"},Y$={key:4,class:"error-message"},X$={class:"error-content"},Z$={key:5,class:"debug-info"},ek={__name:"Start",setup(e){Rm();const{isLoading:t,progressLog:s,generateNewStory:n,generateLocalStory:o}=d$(),r=Re(""),i=Re(null),a=Re(""),c=Re(!1),f=Re(!1),u=Re(!1),d=Vs({show:!1,type:"info",title:"",text:"",countdown:0,action:"跳转",timer:null});function h(V,B,oe="info",re=0,ae="跳转"){d.timer&&clearInterval(d.timer),Object.assign(d,{show:!0,type:oe,title:V,text:B,countdown:re,action:ae}),re>0&&(d.timer=setInterval(()=>{d.countdown--,d.countdown<=0&&(clearInterval(d.timer),u.value=!0,oe==="success"&&ae==="跳转"&&g())},1e3))}function g(){console.log("Attempting navigation to /webgal/index.html"),f.value=!0;try{window.location.href="/webgal/index.html",setTimeout(()=>{document.location.href.indexOf("/webgal/index.html")===-1&&(console.log("Trying location.replace method"),window.location.replace("/webgal/index.html"))},100)}catch(V){console.error("Navigation error:",V),a.value=`跳转失败: ${V.message}`}}function m(){g()}function y(){d.timer&&clearInterval(d.timer),d.show=!1}const p=Vs({outline:{title:"",status:"pending",progress:"0/1"},story:{status:"pending",progress:"0/1"},music:{status:"pending",progress:"0/1",enabled:!0},imageTitle:{status:"pending",progress:"0/0"},imageCharacter:{status:"pending",progress:"0/0"},imageBackground:{status:"pending",progress:"0/0"},voice:{status:"pending",progress:"0/0"}}),b=Re(null),w=Re(0),v=Re(new Date),k=Re(null),$=Vs({outline:{startTime:null,endTime:null,elapsedTime:null,status:"pending"},story:{startTime:null,endTime:null,elapsedTime:null,status:"pending"},music:{startTime:null,endTime:null,elapsedTime:null,status:"pending"},imageTitle:{startTime:null,endTime:null,elapsedTime:null,status:"pending"},imageCharacter:{startTime:null,endTime:null,elapsedTime:null,status:"pending"},imageBackground:{startTime:null,endTime:null,elapsedTime:null,status:"pending"},voice:{startTime:null,endTime:null,elapsedTime:null,status:"pending"}});function I(V){$[V].status==="pending"&&($[V].startTime=Date.now(),$[V].status="processing",E(V))}function R(V,B="success"){$[V].startTime&&$[V].status==="processing"&&($[V].endTime=Date.now(),$[V].status=B,E(V),B==="success"&&(V==="imageTitle"||V==="imageCharacter"||V==="imageBackground")&&O(V))}function O(V){const B=p[V].progress;if(B){const oe=B.split("/");oe.length===2&&oe[1]!=="0"?p[V].progress=`${oe[1]}/${oe[1]}`:p[V].progress="1/1"}else p[V].progress="1/1"}function E(V){const B=$[V];if(B.startTime){const oe=B.endTime||Date.now();B.elapsedTime=oe-B.startTime}}function N(){Object.keys($).forEach(V=>{$[V].startTime&&!$[V].endTime&&E(V)})}function W(V){if(!V)return"00:00:00";const B=V.getHours().toString().padStart(2,"0"),oe=V.getMinutes().toString().padStart(2,"0"),re=V.getSeconds().toString().padStart(2,"0");return`${B}:${oe}:${re}`}function M(V){if(V==null||V<0)return"--:--";const B=Math.floor(V/1e3),oe=Math.floor(B/3600),re=Math.floor(B%3600/60),ae=B%60;return oe>0?`${oe.toString().padStart(2,"0")}:${re.toString().padStart(2,"0")}:${ae.toString().padStart(2,"0")}`:`${re.toString().padStart(2,"0")}:${ae.toString().padStart(2,"0")}`}function z(V){if(!V||V==="0/0")return"0%";const B=V.split("/");if(B.length!==2)return"0%";const oe=parseInt(B[0],10),re=parseInt(B[1],10);return isNaN(oe)||isNaN(re)||re===0?"0%":`${Math.min(100,Math.max(0,oe/re*100))}%`}function G(V,B=!1){if(B)return"status-disabled";switch(V){case"success":return"status-success";case"failed":return"status-failed";case"processing":return"status-processing";default:return"status-pending"}}function pe(V){switch(V){case"success":return"已完成";case"failed":return"失败";case"processing":return"进行中";default:return"待处理"}}function $e(){k.value&&clearInterval(k.value),b.value||(b.value=Date.now(),I("outline")),k.value=setInterval(()=>{v.value=new Date,b.value&&(w.value=Date.now()-b.value),N()},1e3)}function ye(){k.value&&(clearInterval(k.value),k.value=null)}function X(){Object.keys(p).forEach(B=>{if(B==="music"&&!p[B].enabled)p[B].status="disabled";else{const oe=p[B].progress.match(/\d+\/(\d+)/),re=oe?oe[1]:"1";p[B].status="success",p[B].progress=`${re}/${re}`}});const V=Date.now();Object.keys($).forEach(B=>{$[B].startTime||($[B].startTime=B==="outline"?b.value:V-1e3),$[B].endTime=V,$[B].status=B==="music"&&!p.music.enabled?"disabled":"success",E(B)})}function Ee(){s.value.forEach((V,B)=>{let oe=V.match(/获取到故事标题:\s*(.*)/);if(oe&&p.outline.status!=="success"&&(p.outline.title=oe[1].trim(),p.outline.status="success",p.outline.progress="1/1",R("outline","success"),I("music"),I("imageTitle"),I("imageCharacter")),V.includes("生成故事开篇")&&$.story.status==="pending"&&I("story"),V.includes("故事开篇完成")&&p.story.status!=="success"&&(p.story.status="success",p.story.progress="1/1",R("story","success"),I("imageBackground"),I("voice")),V.includes("背景音乐已禁用")&&p.music.enabled?(p.music.status="disabled",p.music.enabled=!1,p.music.progress="0/1",R("music","disabled")):V.includes("背景音乐生成失败")&&p.music.status!=="failed"&&p.music.enabled?(p.music.status="failed",p.music.progress="0/1",R("music","failed")):V.includes("下载并保存音乐文件")&&p.music.status!=="success"&&p.music.enabled&&(p.music.status="success",p.music.progress="1/1",R("music","success")),oe=V.match(/(title|character|background)\s+Progress:\s*(\d+)\/(\d+)/i),oe){const re=oe[1].toLowerCase(),ae=parseInt(oe[2],10),A=parseInt(oe[3],10),Y=`image${re.charAt(0).toUpperCase()+re.slice(1)}`;p[Y]&&(p[Y].progress=`${ae}/${A}`)}if(oe=V.match(/(title|character|background)\s+Main model manager exhausted/i),oe){const re=oe[1].toLowerCase(),ae=`image${re.charAt(0).toUpperCase()+re.slice(1)}`;p[ae]&&p[ae].status!=="failed"&&(p[ae].status="failed",R(ae,"failed"))}if(oe=V.match(/(title|character|background)\s+All\s+(\d+)\s+tasks completed normally/i),oe){const re=oe[1].toLowerCase(),ae=parseInt(oe[2],10),A=`image${re.charAt(0).toUpperCase()+re.slice(1)}`;p[A]&&p[A].status!=="success"&&(s.value.push(`${re} Progress: ${ae}/${ae}. `),p[A].progress=`${ae}/${ae}`,p[A].status="success",R(A,"success"))}if(oe=V.match(/处理 ID\s+(\d+)\s+\((\d+)\/(\d+)\)/),oe){const re=parseInt(oe[1],10),ae=parseInt(oe[3],10);(p.voice.status==="pending"||p.voice.status==="processing")&&(p.voice.progress=`${re}/${ae}`,p.voice.status="processing",re===ae&&(p.voice.status="success",R("voice","success")))}if(V.includes("语音合成完成")&&p.voice.status!=="success"){p.voice.status="success";const re=p.voice.progress.split("/");re.length===2&&(p.voice.progress=`${re[1]}/${re[1]}`),R("voice","success")}V.includes("语音合成失败")&&p.voice.status!=="failed"&&(p.voice.status="failed",R("voice","failed"))})}const se=He(()=>s.value.join(`
`));bs(t,V=>{V?(b.value=Date.now(),w.value=0,$e()):b.value&&(w.value=Date.now()-b.value)}),bs(()=>s.value.length,()=>{Ee(),i.value&&setTimeout(()=>{i.value.scrollTop=i.value.scrollHeight},10)}),Zo(async()=>{var B;console.log("Start.vue onMounted: Starting initial checks..."),s.value.push("开始检查配置和文件..."),b.value=Date.now(),$e(),I("outline");try{const oe=ke(),re=(B=oe==null?void 0:oe.剧情)==null?void 0:B.story_title;if(re){await xe("/data/test/title.txt",re),s.value.push(`发现故事标题: ${re}`);const ae=`/data/${re}/zw`;s.value.push(`检查标记文件: ${ae}...`);let A=!1;try{const Y=await Cs(ae);A=Y.exists&&!Y.isFolder,s.value.push(A?"标记文件存在.":"标记文件不存在.")}catch(Y){s.value.push(`检查标记文件时出错: ${Y.message}`),console.warn(`Error checking metadata for ${ae}:`,Y),A=!1}if(A){s.value.push("调用本地故事生成...");const Y=await o();s.value.push(`本地故事生成结果: ${Y}`)}else{s.value.push("标记文件不存在，无需生成操作。"),r.value=`故事 '${re}' 已存在无需重新处理。`,t.value=!1,X(),$.outline.status==="processing"&&R("outline","success"),await co(),h("已存在的故事",`故事 '${re}' 已存在，无需重新生成。`,"success",2,"跳转");return}}else{s.value.push("未发现故事标题，调用新故事生成...");const ae=await n();s.value.push(`新故事生成结果: ${ae}`)}}catch(oe){console.error("Start.vue onMounted Error:",oe),s.value.push(`启动过程中发生严重错误: ${oe.message}`),a.value=oe.message||"未知错误",t.value=!1,h("生成错误",`发生错误: ${oe.message}`,"error",0,"");return}s.value.push("生成处理完成，准备跳转..."),console.log("Generation complete. Navigating to /webgal/index.html"),t.value=!1;const V=p.outline.title?`'${p.outline.title}' `:"";await co(),h("生成完成",`故事 ${V}生成完成！`,"success",2,"跳转")}),Zn(()=>{ye(),d.timer&&clearInterval(d.timer)});const ke=()=>{try{const V=localStorage.getItem("aiGalgameConfig");return V?JSON.parse(V):{}}catch(V){return console.error("Config load error in Start.vue:",V),{}}};return(V,B)=>(S(),T("div",g$,[B[14]||(B[14]=l("h1",null,"故事生成",-1)),ss(t)?(S(),T("div",h$,B[0]||(B[0]=[l("div",{class:"spinner"},null,-1),l("span",null,"正在处理中，请稍候...",-1)]))):ge("",!0),ss(t)||V.showCompletionMessage?(S(),T("div",m$,[l("div",p$,[B[2]||(B[2]=l("h2",null,"实时进度",-1)),l("div",y$,[B[1]||(B[1]=l("i",{class:"time-icon"},null,-1)),te(" "+F(M(w.value))+" ("+F(W(v.value))+") ",1)])]),l("table",b$,[l("tbody",null,[l("tr",null,[B[3]||(B[3]=l("td",{class:"task-name"},"大纲:",-1)),l("td",v$,[l("div",{class:ie(["progress-bar",{success:$.outline.status==="success",failed:$.outline.status==="failed",processing:$.outline.status==="processing"}])},[l("div",{class:"progress-fill",style:pt({width:z(p.outline.progress)})},null,4)],2),l("div",w$,F(p.outline.progress),1)]),l("td",{class:ie(["task-status",G($.outline.status)])},[te(F(pe($.outline.status))+" ",1),p.outline.title?(S(),T("span",_$," - "+F(p.outline.title),1)):ge("",!0)],2),l("td",C$,F(M($.outline.elapsedTime)),1)]),l("tr",null,[B[4]||(B[4]=l("td",{class:"task-name"},"故事文本:",-1)),l("td",$$,[l("div",{class:ie(["progress-bar",{success:$.story.status==="success",failed:$.story.status==="failed",processing:$.story.status==="processing"}])},[l("div",{class:"progress-fill",style:pt({width:z(p.story.progress)})},null,4)],2),l("div",k$,F(p.story.progress),1)]),l("td",{class:ie(["task-status",G($.story.status)])},F(pe($.story.status)),3),l("td",S$,F(M($.story.elapsedTime)),1)]),l("tr",null,[B[5]||(B[5]=l("td",{class:"task-name"},"音乐:",-1)),l("td",x$,[l("div",{class:ie(["progress-bar",{success:$.music.status==="success",failed:$.music.status==="failed",disabled:!p.music.enabled,processing:$.music.status==="processing"}])},[l("div",{class:"progress-fill",style:pt({width:z(p.music.progress)})},null,4)],2),l("div",T$,F(p.music.progress),1)]),l("td",{class:ie(["task-status",G($.music.status,!p.music.enabled)])},F(p.music.enabled?pe($.music.status):"已禁用"),3),l("td",I$,F(M($.music.elapsedTime)),1)]),l("tr",null,[B[6]||(B[6]=l("td",{class:"task-name"},"图片-标题:",-1)),l("td",M$,[l("div",{class:ie(["progress-bar",{success:$.imageTitle.status==="success",failed:$.imageTitle.status==="failed",processing:$.imageTitle.status==="processing"}])},[l("div",{class:"progress-fill",style:pt({width:z(p.imageTitle.progress)})},null,4)],2),l("div",P$,F(p.imageTitle.progress),1)]),l("td",{class:ie(["task-status",G($.imageTitle.status)])},F(pe($.imageTitle.status)),3),l("td",A$,F(M($.imageTitle.elapsedTime)),1)]),l("tr",null,[B[7]||(B[7]=l("td",{class:"task-name"},"图片-角色:",-1)),l("td",E$,[l("div",{class:ie(["progress-bar",{success:$.imageCharacter.status==="success",failed:$.imageCharacter.status==="failed",processing:$.imageCharacter.status==="processing"}])},[l("div",{class:"progress-fill",style:pt({width:z(p.imageCharacter.progress)})},null,4)],2),l("div",O$,F(p.imageCharacter.progress),1)]),l("td",{class:ie(["task-status",G($.imageCharacter.status)])},F(pe($.imageCharacter.status)),3),l("td",L$,F(M($.imageCharacter.elapsedTime)),1)]),l("tr",null,[B[8]||(B[8]=l("td",{class:"task-name"},"图片-背景:",-1)),l("td",N$,[l("div",{class:ie(["progress-bar",{success:$.imageBackground.status==="success",failed:$.imageBackground.status==="failed",processing:$.imageBackground.status==="processing"}])},[l("div",{class:"progress-fill",style:pt({width:z(p.imageBackground.progress)})},null,4)],2),l("div",R$,F(p.imageBackground.progress),1)]),l("td",{class:ie(["task-status",G($.imageBackground.status)])},F(pe($.imageBackground.status)),3),l("td",D$,F(M($.imageBackground.elapsedTime)),1)]),l("tr",null,[B[9]||(B[9]=l("td",{class:"task-name"},"语音:",-1)),l("td",F$,[l("div",{class:ie(["progress-bar",{success:$.voice.status==="success",failed:$.voice.status==="failed",processing:$.voice.status==="processing"}])},[l("div",{class:"progress-fill",style:pt({width:z(p.voice.progress)})},null,4)],2),l("div",V$,F(p.voice.progress),1)]),l("td",{class:ie(["task-status",G($.voice.status)])},F(pe($.voice.status)),3),l("td",U$,F(M($.voice.elapsedTime)),1)])])])])):ge("",!0),l("div",j$,[B[10]||(B[10]=l("h2",null,"进度日志:",-1)),l("div",{class:"progress-log",ref_key:"logContainer",ref:i},F(se.value),513)]),d.show?(S(),T("div",z$,[l("div",{class:ie(["toast-message",d.type])},[d.type==="success"?(S(),T("div",B$,"✓")):d.type==="error"?(S(),T("div",q$,"✕")):(S(),T("div",J$,"!")),l("div",G$,[l("div",W$,F(d.title),1),l("div",H$,F(d.text),1),d.countdown>0?(S(),T("div",K$,F(d.countdown)+"秒后"+F(d.action)+"... ",1)):ge("",!0)]),l("button",{class:"toast-close",onClick:y},"×")],2)])):ge("",!0),r.value?(S(),T("div",Q$,F(r.value),1)):ge("",!0),a.value?(S(),T("div",Y$,[B[12]||(B[12]=l("div",{class:"error-icon"},"!",-1)),l("div",X$,[B[11]||(B[11]=l("h3",null,"发生错误",-1)),l("p",null,F(a.value),1)])])):ge("",!0),c.value?(S(),T("div",Z$,[B[13]||(B[13]=l("h3",null,"调试信息",-1)),l("p",null,"跳转状态: "+F(f.value?"已尝试":"未尝试"),1),l("p",null,"倒计时完成: "+F(u.value?"是":"否"),1),l("button",{onClick:m,class:"debug-button"},"手动跳转")])):ge("",!0)]))}},tk=Be(ek,[["__scopeId","data-v-28ea5259"]]),sk="/assets/window_icon-CYAy5ckK.png",jr=Zu(),ok={data(){return{isDarkMode:!1}},methods:{toggleTheme(){this.isDarkMode=!this.isDarkMode,document.body.classList.toggle("dark-theme",this.isDarkMode)},exportConfig(){try{const e=localStorage.getItem("aiGalgameConfig");if(!e){this.showMessageBubble({title:"error",message:"没有找到配置数据"});return}const t=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(t),n=new Date().toISOString().replace(/[:.]/g,"-"),o=document.createElement("a");o.href=s,o.download=`ai-galgame-config-${n}.json`,document.body.appendChild(o),o.click(),setTimeout(()=>{document.body.removeChild(o),URL.revokeObjectURL(s)},100),this.showMessageBubble({title:"success",message:"配置导出成功"})}catch(e){console.error("导出配置失败:",e),this.showMessageBubble({title:"error",message:"导出配置失败"})}},triggerFileInput(){this.$refs.fileInput.click()},importConfig(e){const t=e.target.files[0];if(!t)return;const s=new FileReader;s.onload=n=>{try{const o=n.target.result,r=JSON.parse(o);let i={};try{const w=localStorage.getItem("aiGalgameConfig");w&&(i=JSON.parse(w))}catch(w){console.error("获取当前配置失败:",w),i={}}const a=Object.keys(r);if(a.length===0){this.showMessageBubble({title:"error",message:"导入文件没有有效的配置项"});return}const c=document.createElement("div");c.style.position="fixed",c.style.top="50%",c.style.left="50%",c.style.transform="translate(-50%, -50%)",c.style.backgroundColor="var(--content-bg)",c.style.padding="20px",c.style.borderRadius="8px",c.style.boxShadow="var(--shadow)",c.style.zIndex="1000",c.style.maxWidth="400px",c.style.width="90%";const f=document.createElement("h3");f.textContent="选择要导入的配置项",f.style.marginBottom="15px",f.style.color="var(--text-primary)",c.appendChild(f);const u=document.createElement("div");u.style.marginBottom="10px";const d=document.createElement("input");d.type="checkbox",d.id="select-all",d.checked=!0,d.style.marginRight="8px";const h=document.createElement("label");h.htmlFor="select-all",h.textContent="全选",h.style.color="var(--text-primary)",u.appendChild(d),u.appendChild(h),c.appendChild(u);const g=document.createElement("hr");g.style.margin="10px 0",g.style.border="none",g.style.borderTop="1px solid var(--border-color)",c.appendChild(g);const m={};a.forEach(w=>{const v=document.createElement("div");v.style.marginBottom="8px";const k=document.createElement("input");k.type="checkbox",k.id=`select-${w}`,k.checked=!0,k.style.marginRight="8px",m[w]=k;const $=document.createElement("label");$.htmlFor=`select-${w}`,$.textContent=w,$.style.color="var(--text-primary)",v.appendChild(k),v.appendChild($),c.appendChild(v)}),d.addEventListener("change",()=>{for(const w in m)m[w].checked=d.checked});const y=document.createElement("div");y.style.display="flex",y.style.justifyContent="flex-end",y.style.marginTop="20px",y.style.gap="10px";const p=document.createElement("button");p.textContent="取消",p.style.padding="8px 16px",p.style.backgroundColor="var(--btn-bg)",p.style.color="var(--text-secondary)",p.style.border="none",p.style.borderRadius="4px",p.style.cursor="pointer";const b=document.createElement("button");b.textContent="确认导入",b.style.padding="8px 16px",b.style.backgroundColor="var(--primary-color)",b.style.color="white",b.style.border="none",b.style.borderRadius="4px",b.style.cursor="pointer",y.appendChild(p),y.appendChild(b),c.appendChild(y),document.body.appendChild(c),p.addEventListener("click",()=>{document.body.removeChild(c)}),b.addEventListener("click",()=>{try{for(const w in m)m[w].checked&&r[w]!==void 0&&(i[w]=r[w]);localStorage.setItem("aiGalgameConfig",JSON.stringify(i)),this.showMessageBubble({title:"success",message:"配置导入成功"})}catch(w){console.error("合并配置失败:",w),this.showMessageBubble({title:"error",message:"导入配置失败: "+w.message})}document.body.removeChild(c)})}catch(o){console.error("导入配置失败:",o),this.showMessageBubble({title:"error",message:"导入配置失败: 无效的JSON格式"})}},s.readAsText(t),e.target.value=""},showMessageBubble(e){e.title==="success"?jr.success(e.message):e.title==="error"?jr.error(e.message):jr.warning(e.message)}},mounted(){localStorage.getItem("theme")==="dark"&&(this.isDarkMode=!0,document.body.classList.add("dark-theme"))},watch:{isDarkMode(e){localStorage.setItem("theme",e?"dark":"light")}}};(function(){let e=console.log,t=console.warn,s=console.error,n=console.info;const o="LogsDatabase",r=1,i="consoleLogs";let a;function c(){return new Promise((h,g)=>{const m=indexedDB.open(o,r);m.onerror=y=>{console.error("IndexedDB error:",y.target.error),g(y.target.error)},m.onsuccess=y=>{a=y.target.result,h(a)},m.onupgradeneeded=y=>{const p=y.target.result;if(!p.objectStoreNames.contains(i)){const b=p.createObjectStore(i,{keyPath:"id",autoIncrement:!0});b.createIndex("timestamp","timestamp",{unique:!1}),b.createIndex("type","type",{unique:!1})}}})}c().catch(h=>{s.call(console,"Failed to initialize IndexedDB, falling back to localStorage:",h)});function f(h,g){const m={type:h,message:typeof g=="object"?JSON.stringify(g):String(g),timestamp:new Date().toISOString()};if(a)try{const b=a.transaction([i],"readwrite").objectStore(i).add(m);b.onerror=w=>{s.call(console,"Error storing log in IndexedDB:",w.target.error),u(m)}}catch(y){s.call(console,"Failed to store log to IndexedDB:",y),u(m)}else u(m)}function u(h){try{const g="capturedConsoleLogs";let m=[];try{const y=localStorage.getItem(g);y&&(m=JSON.parse(y))}catch{m=[]}m.push(h),m.length>100&&(m=m.slice(-100)),localStorage.setItem(g,JSON.stringify(m))}catch(g){s.call(console,"Failed to store log to localStorage fallback:",g)}}console.log=function(h){f("log",h),e.apply(console,arguments)},console.warn=function(h){f("warn",h),t.apply(console,arguments)},console.error=function(h){f("error",h),s.apply(console,arguments)},console.info=function(h){f("info",h),n.apply(console,arguments)},window.getStoredLogs=function(){return new Promise((h,g)=>{if(!a){try{const y=localStorage.getItem("capturedConsoleLogs");h(y?JSON.parse(y):[])}catch(m){g(m)}return}try{const b=a.transaction([i],"readonly").objectStore(i).index("timestamp").openCursor(null,"prev"),w=[];b.onsuccess=v=>{const k=v.target.result;k?(w.push(k.value),k.continue()):h(w)},b.onerror=v=>{g(v.target.error)}}catch(m){g(m)}})},window.clearStoredLogs=function(){return new Promise((h,g)=>{if(!a){try{localStorage.removeItem("capturedConsoleLogs"),h()}catch(m){g(m)}return}try{const p=a.transaction([i],"readwrite").objectStore(i).clear();p.onsuccess=()=>{h()},p.onerror=b=>{g(b.target.error)}}catch(m){g(m)}})},window.exportLogs=function(){return window.getStoredLogs()};function d(){if(a)try{const g=localStorage.getItem("capturedConsoleLogs");if(g){const m=JSON.parse(g);if(m.length>0){const p=a.transaction([i],"readwrite").objectStore(i);m.forEach(b=>{p.add(b)})}}}catch(h){s.call(console,"Failed to migrate logs from localStorage:",h)}}c().then(()=>{d()}).catch(()=>{})})();const nk={id:"app"},rk={class:"sidebar"},ik={class:"sidebar-footer"},ak={class:"theme-toggle-container"},lk={class:"data-actions"},ck={class:"main-content"},uk={class:"content"};function fk(e,t,s,n,o,r){const i=ze("font-awesome-icon"),a=ze("router-link"),c=ze("router-view");return S(),T("div",nk,[l("div",rk,[t[16]||(t[16]=l("div",{class:"logo"},[l("img",{src:sk,alt:"Logo"}),l("h1",null,"AI Galgame生成")],-1)),l("nav",null,[l("ul",null,[l("li",null,[q(a,{to:"/",class:ie({active:e.$route.path==="/"})},{default:it(()=>[q(i,{icon:["fas","home"]}),t[4]||(t[4]=l("span",null,"首页",-1))]),_:1},8,["class"])]),l("li",null,[q(a,{to:"/llm-config",class:ie({active:e.$route.path==="/llm-config"})},{default:it(()=>[q(i,{icon:["fas","brain"]}),t[5]||(t[5]=l("span",null,"LLM 配置",-1))]),_:1},8,["class"])]),l("li",null,[q(a,{to:"/voice-config",class:ie({active:e.$route.path==="/voice-config"})},{default:it(()=>[q(i,{icon:["fas","microphone"]}),t[6]||(t[6]=l("span",null,"语音配置",-1))]),_:1},8,["class"])]),l("li",null,[q(a,{to:"/ai-drawing-config",class:ie({active:e.$route.path==="/ai-drawing-config"})},{default:it(()=>[q(i,{icon:["fas","paint-brush"]}),t[7]||(t[7]=l("span",null,"AI 绘画配置",-1))]),_:1},8,["class"])]),l("li",null,[q(a,{to:"/ai-music-config",class:ie({active:e.$route.path==="/ai-music-config"})},{default:it(()=>[q(i,{icon:["fas","music"]}),t[8]||(t[8]=l("span",null,"AI 音乐配置",-1))]),_:1},8,["class"])]),l("li",null,[q(a,{to:"/snapshot",class:ie({active:e.$route.path==="/snapshot"})},{default:it(()=>[q(i,{icon:["fas","camera"]}),t[9]||(t[9]=l("span",null,"快照",-1))]),_:1},8,["class"])]),l("li",null,[q(a,{to:"/logs",class:ie({active:e.$route.path==="/logs"})},{default:it(()=>[q(i,{icon:["fas","clipboard-list"]}),t[10]||(t[10]=l("span",null,"日志",-1))]),_:1},8,["class"])]),l("li",null,[q(a,{to:"/manage",class:ie({active:e.$route.path==="/manage"})},{default:it(()=>[q(i,{icon:["fas","magic"]}),t[11]||(t[11]=l("span",null,"管理",-1))]),_:1},8,["class"])]),l("li",null,[q(a,{to:"/about",class:ie({active:e.$route.path==="/about"})},{default:it(()=>[q(i,{icon:["fas","info-circle"]}),t[12]||(t[12]=l("span",null,"关于",-1))]),_:1},8,["class"])])])]),l("div",ik,[l("div",ak,[l("button",{class:"theme-toggle",onClick:t[0]||(t[0]=(...f)=>r.toggleTheme&&r.toggleTheme(...f))},[q(i,{icon:["fas",o.isDarkMode?"sun":"moon"]},null,8,["icon"]),l("span",null,F(o.isDarkMode?"亮色模式":"深色模式"),1)])]),l("div",lk,[l("button",{class:"action-btn",onClick:t[1]||(t[1]=(...f)=>r.exportConfig&&r.exportConfig(...f)),title:"导出配置"},[q(i,{icon:["fas","download"]}),t[13]||(t[13]=l("span",null,"导出配置",-1))]),l("input",{type:"file",ref:"fileInput",style:{display:"none"},accept:".json",onChange:t[2]||(t[2]=(...f)=>r.importConfig&&r.importConfig(...f))},null,544),l("button",{class:"action-btn",onClick:t[3]||(t[3]=(...f)=>r.triggerFileInput&&r.triggerFileInput(...f)),title:"导入配置"},[q(i,{icon:["fas","upload"]}),t[14]||(t[14]=l("span",null,"导入配置",-1))])]),t[15]||(t[15]=l("span",{class:"version"},"v1.0.5",-1))])]),l("div",ck,[l("div",uk,[q(Zg,{name:"fade",mode:"out-in"},{default:it(()=>[q(c,{onShowMessage:r.showMessageBubble},null,8,["onShowMessage"])]),_:1})])])])}const dk=Be(ok,[["render",fk]]);function gk(){try{const e=localStorage.getItem("aiGalgameConfig");return e?JSON.parse(e)||{}:(console.warn("aiGalgameConfig not found in localStorage. Returning empty object."),{})}catch(e){return console.error("Failed to parse aiGalgameConfig from localStorage:",e),{}}}function hk(){return{callTextGeneration:async(o,r)=>{try{if(!o||r===void 0||r===null)throw new Error("Missing required parameters: story_id or answer");const i=await Yl(o,r);if(!i&&i!==0)throw new Error(`Failed to calculate next story_id from ${o} with answer "${r}"`);await No(i);const a=await u$(r,i);if(typeof a=="string"&&a.toLowerCase().includes("fail"))throw new Error(`continueStory failed: ${a}`);return await No(i),{status:"success",story_id:i}}catch(i){return console.error("Error in callTextGeneration:",i),{status:"error",message:i.message||"Unknown error during text generation"}}},callJoinTasks:async(o,r)=>{var i;try{if(!o||!r)throw new Error("Missing required parameters: story_id or type ('continue'/'end')");const a=gk(),c=[];if(Bn("music"),r==="continue")c.push(ki(o).catch(f=>{throw new Error(`getChoice(${o}) failed: ${f.message}`)})),c.push(jn(0).catch(f=>{throw new Error(`getPlacesImagesJS(${o}) failed: ${f.message}`)}));else if(r==="end")((i=a==null?void 0:a.AI音乐)==null?void 0:i.ending_if_on)===!0&&c.push(F5(o).catch(u=>{throw new Error(`generateEndMusic(${o}) failed: ${u.message}`)})),c.push(jn(0).catch(u=>{throw new Error(`getPlacesImagesJS(${o}) failed: ${u.message}`)}));else throw new Error(`Invalid type specified for callJoinTasks: ${r}`);return c.length>0&&await Promise.all(c),{status:"success"}}catch(a){return console.error("Error in callJoinTasks:",a),{status:"error",message:a.message||"Unknown error during joined tasks execution"}}},callNoJoinTasks:async(o,r)=>{try{if(!o||!r)throw new Error("Missing required parameter: story_id or type ('continue'/'end')");return qn(o).then(()=>{}).catch(i=>{console.error(`Non-joined task generateVoice(${o}) failed in background: ${i.message}`)}),{status:"success"}}catch(i){return console.error("Error initiating callNoJoinTasks:",i),{status:"error",message:i.message||"Unknown error initiating non-joined tasks"}}},callEndGeneration:async o=>{try{if(!o)throw new Error("Missing required parameter: story_id");const r=await Yl(o,"结束游戏");if(!r&&r!==0)throw new Error(`Failed to calculate end story_id from ${o}`);const i=await f$(r);if(typeof i=="string"&&i.toLowerCase().includes("fail"))throw new Error(`endStory failed: ${i}`);return await No(r),{status:"success",story_id:r}}catch(r){return console.error("Error in callEndGeneration:",r),{status:"error",message:r.message||"Unknown error during end generation"}}}}}const mk={key:0},pk={key:1},yk={key:2},bk={key:3,style:{color:"orange"}},zr="/data/test/title.txt",vk=1e3,wk={__name:"Continue",setup(e){const t=Re("Initializing..."),s=Re(null),n=Re(""),o=Re(!1),r=Re(null),i=hk(),a=(g,m=null)=>{console.log(`Status update: ${g}`,m?`Error: ${m}`:""),t.value=g,n.value=m?String(m.message||m):""},c=async(g,m)=>{try{return await xe(g,m),console.log(`Successfully wrote "${m}" to ${g}`),!0}catch(y){return console.error(`Failed to write "${m}" to ${g}:`,y),n.value=`Failed writing "${m}" to ${g}: ${y.message}`,!1}},f=async g=>{var m,y,p;try{return await ts(g),console.log(`Successfully deleted ${g}`),!0}catch(b){return(m=b.message)!=null&&m.includes("不存在")||(y=b.message)!=null&&y.toLowerCase().includes("not found")||(p=b.message)!=null&&p.toLowerCase().includes("failed to execute 'delete'")?(console.warn(`Attempted to delete ${g}, but it might have been already gone or deletion failed non-critically.`),!0):(console.error(`Failed to delete ${g}:`,b),n.value=`Failed deleting ${g}: ${b.message}`,!1)}},u=async g=>{var v,k;if(o.value){console.warn("processTask called while already processing. Ignoring.");return}o.value=!0,a("Starting Task");const m=`/data/${s.value}/continue.txt`,y=`/data/${s.value}/status.txt`;let p=null,b="continue",w=!1;try{if(!await c(y,"start")){a("Error: Failed to write start status. Aborting task.",n.value),o.value=!1;return}g=g.trim();const $=!isNaN(parseFloat(g))&&isFinite(g),I=g.includes("-");let R;if($){const N=parseFloat(g);b="continue",a(`Generating Text (ID: ${N})...`),R=i.callTextGeneration("none",N)}else if(I){const N=g.split("-"),W=(v=N[0])==null?void 0:v.trim(),M=(k=N.slice(1).join("-"))==null?void 0:k.trim();if(!W||M===void 0||M===null)throw new Error(`Invalid a-b format: a='${W}', b='${M}'`);M==="结束游戏"?(b="end",a(`Generating End Sequence (ID: ${W})...`),R=i.callEndGeneration(W)):(b="continue",a(`Generating Text (Choice: ${W} -> ${M})...`),R=i.callTextGeneration(W,M))}else{a("Error: Invalid content format in continue.txt",`Content: "${g}"`),await c(y,"error_invalid_format"),await f(m),o.value=!1;return}const O=await R;if(O.status==="error"){a("Error: Text Generation Failed",O.message),await c(y,"text_fail"),await f(m),o.value=!1;return}p=O.story_id,await c(y,`text_success:${p}`)||a("Error: Failed to write text_success status. Continuing cleanup.",n.value),a(`Text Generation Success (Story ID: ${p}). Running post-tasks...`),i.callNoJoinTasks(p,b).then(N=>{N.status==="success"?console.log(`Successfully initiated NoJoinTasks (Type: ${b}, StoryID: ${p})`):console.error(`Failed to initiate NoJoinTasks (Type: ${b}, StoryID: ${p}):`,N.message)}).catch(N=>{console.error(`Error initiating NoJoinTasks (Type: ${b}, StoryID: ${p}):`,N)}),a(`Waiting for JoinTasks (Type: ${b}, StoryID: ${p})...`);let E=!1;try{const N=await i.callJoinTasks(p,b);N.status==="success"?(console.log(`JoinTasks completed successfully (Type: ${b}, StoryID: ${p})`),E=!0):(console.warn(`JoinTasks failed (Type: ${b}, StoryID: ${p}):`,N.message),n.value=`JoinTasks failed: ${N.message}`)}catch(N){console.error(`Error during callJoinTasks (Type: ${b}, StoryID: ${p}):`,N),n.value=`Error in JoinTasks: ${N.message}`}a("Finalizing Task..."),await c(y,`end:${p}`)||a("Error: Failed to write end status. Cleanup may be incomplete.",n.value),await f(m)||a("Error: Failed to delete continue.txt after task completion.",n.value),w=E,a(w?"Task Completed Successfully. Monitoring...":"Task Completed (Join Tasks had issues). Monitoring...")}catch($){console.error("Unhandled error during processTask:",$),a("Critical Error during processing",$),await c(y,"error_unexpected"),await f(m)}finally{o.value=!1,console.log("Processing finished. Lock released.")}},d=async()=>{var m,y;if(o.value||!s.value)return;const g=`/data/${s.value}/continue.txt`;try{if(!(await Cs(g)).exists){!t.value.startsWith("Monitoring")&&!t.value.startsWith("Idle")&&!t.value.startsWith("Task Completed")&&!o.value&&a("Monitoring...");return}const b=await Je(g),w=b?String(b).trim():"";if(w===""){!t.value.startsWith("Monitoring")&&!t.value.startsWith("Idle")&&!t.value.startsWith("Task Completed")&&!o.value&&a("Idle (continue.txt empty)");return}console.log(`Found valid trigger in ${g}. Content: "${w}"`),await u(w)}catch(p){(m=p.message)!=null&&m.includes("不存在")||(y=p.message)!=null&&y.toLowerCase().includes("not found")?!t.value.startsWith("Monitoring")&&!t.value.startsWith("Idle")&&!t.value.startsWith("Task Completed")&&!o.value&&a("Monitoring..."):(console.error("Error checking continue file:",p),a("Error checking file system",p))}},h=async()=>{try{const g=await Je(zr),m=g?String(g).trim():null;return m?(s.value=m,a("Monitoring..."),!0):(a("Error: title.txt is empty or invalid."),!1)}catch(g){return console.error(`Failed to load title from ${zr}:`,g),a(`Error: Failed to load ${zr}`,g),!1}};return Zo(async()=>{a("Initializing..."),await h()&&s.value?(console.log(`Starting monitor for title: ${s.value}`),r.value=setInterval(d,vk),d()):console.error("Monitoring cannot start: Title not loaded.")}),Zn(()=>{r.value&&(clearInterval(r.value),console.log("Monitor interval cleared.")),a("Monitor stopped.")}),(g,m)=>(S(),T("div",null,[m[1]||(m[1]=l("h1",null,"Task Monitor",-1)),l("p",null,"Status: "+F(t.value),1),n.value?(S(),T("p",mk,"Last Error: "+F(n.value),1)):ge("",!0),s.value?(S(),T("p",pk,[m[0]||(m[0]=te("Monitoring Title: ")),l("strong",null,F(s.value),1)])):(S(),T("p",yk,"Waiting for title file...")),o.value?(S(),T("p",bk,"Working...")):ge("",!0)]))}},_k=Be(wk,[["__scopeId","data-v-5a3168ae"]]),Ck=[{path:"/",component:dk,children:[{path:"/",name:"Home",component:hb},{path:"/llm-config",name:"LLMConfig",component:Zv},{path:"/voice-config",name:"VoiceConfig",component:Iw},{path:"/ai-drawing-config",name:"AiDrawingConfig",component:S5},{path:"/ai-music-config",name:"AiMusicConfig",component:x_},{path:"/snapshot",name:"Snapshot",component:j_},{path:"/logs",name:"Logs",component:IC},{path:"/manage",name:"Manage",component:i8},{path:"/about",name:"About",component:t$}]},{path:"/start",name:"Start",component:tk},{path:"/continue",name:"Continue",component:_k}],$k=Lm({history:um(),routes:Ck});/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const kk={prefix:"fab",iconName:"markdown",icon:[640,512,[],"f60f","M593.8 59.1H46.2C20.7 59.1 0 79.8 0 105.2v301.5c0 25.5 20.7 46.2 46.2 46.2h547.7c25.5 0 46.2-20.7 46.1-46.1V105.2c0-25.4-20.7-46.1-46.2-46.1zM338.5 360.6H277v-120l-61.5 76.9-61.5-76.9v120H92.3V151.4h61.5l61.5 76.9 61.5-76.9h61.5v209.2zm135.3 3.1L381.5 256H443V151.4h61.5V256H566z"]},Sk={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]};Vf.add(j0,my,w0,f0,cy,L0,o0,ay,O0,B0,ly,V0,z0,ty,qf,H0,sy,Z2,hy,i0,c0,ny,fy,h0,C0,uy,a0,g0,v0,p0,A0,Sk,x0,F0,q0,m0,by,e0,M0,n0,I0,T0,Y0,py,$0,d0,dy,ry,Z0,S0,K0,N0,Gf,y0,kk,J0,b0,X0);const yr=bu(Vm);yr.component("font-awesome-icon",Bf);const xk={timeout:3e3};yr.use(Np,xk);yr.use($k);yr.mount("#app");"serviceWorker"in navigator?window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("SW registered: ",e)}).catch(e=>{console.log("SW registration failed: ",e)})}):console.warn("Service workers are not supported in this browser.");export{bs as A,Re as B,Vs as C,Jt as D,He as E,ve as F,xe as G,Lt as H,sf as I,Cs as J,Ve as K,r$ as L,D5 as M,No as N,jn as O,Ik as P,qw as Q,qn as R,Be as _,l as a,ge as b,T as c,q as d,te as e,Ae as f,Xe as g,ro as h,ts as i,Ys as j,Vr as k,ao as l,Je as m,ie as n,S as o,U as p,Ue as q,ze as r,qo as s,F as t,Mk as u,ue as v,ft as w,Ak as x,Pk as y,Tk as z};
